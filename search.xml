<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021 | 肆意随心</title>
      <link href="2022/01/01/2021-annual-reviewed/"/>
      <url>2022/01/01/2021-annual-reviewed/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="Yeah"><a href="#Yeah" class="headerlink" title="Yeah"></a>Yeah</h2><p>“兜兜转转”又一年了，又到了该水年度 Review 的时候啦✅❇️。</p><p>算下来，博客三年了，准备开启新的三年了。这篇总结也算是第三篇总结了，3 - 可以说是我很喜欢的数字，挺多网名（ShanSan、yeshan333），还有博客域名（shansan.top、shan333.cn、…）是和“三”有关的（and so on），也算是“谐音梗”啦😎？</p><p>回头看看之前写的几篇总结，还挺有意思的。21 年似乎并没有太多那么刻意去做的事，想到了就去试试了。这一次，不需要那么的有条理性，随手一记。</p><span id="more"></span><h2 id="博客-amp-技术-Blog-amp-Techs"><a href="#博客-amp-技术-Blog-amp-Techs" class="headerlink" title="博客 &amp; 技术-Blog &amp; Techs"></a>博客 &amp; 技术-Blog &amp; Techs</h2><p>21 年的博客没有多大的变化，实现了个简单的 <a href="https://shan333.cn/2021/01/19/hexo-blog-synchronization-with-rsync/">GitHub Action</a> 做了下 CI/CD 到腾讯云的 CVM 服务器（对应域名 shan333.cn 下的一个备份 [backup] 博客），切换了下评论系统到 Waline，更有范了~。</p><p>仔细算算，博客的 PV 应该有 10w 了吧（算上我中途干掉的 PV 统计😂）？博客太水，之前没敢甩群被 dalao 一波吐槽 &amp; 本来就写着玩的，不需要过多的 PV/UV。</p><p>BTW，当初甩下的一个月至少一篇文章的 🚩，好像完成的还可以，就二月份少了篇（那时候我应该在锤《Command &amp; Conquer : Mental Omega》🤦‍♂️）</p><ul><li>十年之约（2021.09.15-Begin）</li></ul><blockquote><p>十年之约，即从加入这个活动起，我们的博客十年不关闭，保持更新和活力。- 来自十年之约站点首页</p></blockquote><p>写到这个我想起了最近一个月在看的斗破苍穹，就离谱。</p><p><a href="https://www.foreverblog.cn/about.html"><img src="https://img.foreverblog.cn/logo_en_default.png" class="lazyload" data-srcset="https://img.foreverblog.cn/logo_en_default.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="十年之约"></a></p><p>十年之约 &lt;<a href="https://www.foreverblog.cn/">www.foreverblog.cn</a>&gt;，印象之中好像是 18 年的时候在 <a href="https://valine.js.org/">Valine</a> 的交流群知道的？我记得我申请过一次，被 reject 掉了（太水了，😶‍🌫️），回头看看<a href="https://shansan.top/archives/">归档页</a>，那时候写得文章挺水的，挺想删掉，但是我在 20 年初的时候给博客套了下 Git -&gt; ⌈<a href="https://github.com/yeshan333/actions-for-hexo-blog">actions-for-hexo-blog</a>⌋，博客的变更历史已经追踪起来了，不删了不删了，费劲😊，我还每年都到互联网档案馆（<a href="https://archive.org/">Internet Archive</a>）做下 Snapshot，<strong>多重手段保留回忆</strong>，我被自己制裁了😢。</p><p>十年，好像挺长啊，但它三年了，文章质量慢慢好起来了 &lt;不过还是挺水，但我还能更“水”&gt;，是时候了，Brother！</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2021/12/30/TWvhtA.png" class="lazyload" data-srcset="https://s4.ax1x.com/2021/12/30/TWvhtA.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="十年之约审核"></p>            </div><h3 id="Techs-amp-Coding"><a href="#Techs-amp-Coding" class="headerlink" title="Techs &amp; Coding"></a>Techs &amp; Coding</h3><p>再看看 21 年 GitHub 的小绿点，有点差强人意啊，有很多小点是一个 rss-feed 的 CI 打的，21 年的 Coding 时间是少了点，挪了很多的时间去做点其他事情去了，最近编码量稍增，能感觉到代码质量越来越 low 了 &lt;2333，好像原来就挺拉跨的🙃，裂开了&gt;。我感觉 22 年差不多可以去“水”一下感兴趣的开源项目了吧？</p><p>在 Twitter 上看了一圈，dalao 们太恐怖了🤐。</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/01/T54E5V.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T54E5V.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="GitHub"></p>            </div><p>21 年折腾的新玩意好像不多，照旧耍着 Go、TypeScript、Kubernetes，“蜻蜓点水”般看了下 Prometheus。再想想看了啥技术相关的书，好像挺少有技术深度的，我看了很多和 DevOps、CloudNative 、工程化相关的书。打开自己本想专门用来 Reading 的“小平板子”，好像和上年没多大变化，电子书还是那几本，哈哈哈，吃灰了吃灰了~(<em>^_^</em>)：</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2021/12/31/T4aUhV.png" class="lazyload" data-srcset="https://s4.ax1x.com/2021/12/31/T4aUhV.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="iPads 上的电子书"></p>            </div><p>如果说 21 年看过的印象最深刻的技术书是哪几本，那么应该就是<a href="https://draveness.me/golang/">《Go 语言设计与实现》</a>和<a href="https://icyfenix.cn/">《凤凰架构-构建可靠的大型分布式系统》</a>，《Go 语言设计与实现》作者的功底很强，膜了❤️，21 年我冒出了个想接触 Compile 技术的想法，就是因为这本书。</p><p><a href="https://time.geekbang.org/">Geektime</a> 用的时间减少了，不剁手了，回头看看一些老的东西。</p><p>忽然间想起来因为毕设还看了下《普林斯顿微积分读本》，虽然没用上，但我居然看得津津有味，我怕是个假的数学系学生，这本书是挺入门的，我还反手剁手到 App Store 买了下 MarginNote3 去看这本书，一直没怎么用上这个 App，2022 年应该能用上了吧😢？</p><h2 id="校园-Campus"><a href="#校园-Campus" class="headerlink" title="校园-Campus"></a>校园-Campus</h2><p>2021，21 年最大的一件事应该就是毕业了，21 年的毕业季因为疫情的原因好像是那般的“常规”，好像没有做下过什么承诺，好像没有怎么和同学 &amp; 老师聊过对未来的期待，因为经历过 2020 年的春招和秋招的摧残，好像并没有找工作的焦虑感，更多的我想因该还是迷惑，一切似都那么的“平淡”，并没有做什么“惊心动魄”的事，好像并没有电影中的那些桥段？🐇🐇🐇👀</p><p>离开学校前，微微整理了下那些年吹过的水，把 Speak 稍微整理了下，将之前的吹水站 <a href="https://slides.shan333.cn/">slide.shan333.cn</a> 迁移到了 React &amp; Gastby 写的 <a href="https://slides.shan333.cn/">slides.shan333.cn</a> 上。</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/01/T5AagU.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T5AagU.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="那些年的 Slides"></p>            </div><iframe src="https://slides.shan333.cn/" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe><p>12 月份在 koukou 空间捞了手学校的照片，越来越好看了😲：</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2021/12/31/T4wWOe.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2021/12/31/T4wWOe.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="学校风景"></p>            </div><p>我还顺便拿抖音的剪映稍微理了个短视频，音视频技术 tql，真是“降维打击”，释放灵感：☁☁☁</p><!-- <iframe src="//player.bilibili.com/player.html?aid=380332262&bvid=BV1gZ4y1Q7tT&cid=474119967&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe> --><iframe src="https://player.bilibili.com/player.html?aid=380332262&bvid=BV1gZ4y1Q7tT&cid=474119967&page=1" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe><p>不得不承认，现在的确是个好的时代，很多东西不会都可以去搜索着学，就看自己想不想接触，有没有兴趣，愿不愿意花时间，想做得多专业。</p><h2 id="工作-Work"><a href="#工作-Work" class="headerlink" title="工作-Work"></a>工作-Work</h2><p>不知不觉已经来到 A 厂工作快六个月了，近距离从内网 yuque &amp; 技术站观摩之前知道的一些 dalao 在做的事情 &amp; 写的东西。瞬间发现这些人好像比想象中的还要强。</p><p>毕业后，我选择了比较感兴趣的一门行业，我觉得我选择的是一个极具创造力和思考力的职业。我觉得这里应该有很多的话记录才对，但在这写不出来了，我在另一个地方“写了”。</p><h2 id="生活-Life"><a href="#生活-Life" class="headerlink" title="生活-Life"></a>生活-Life</h2><p>2021 年的下半年我也经历了很多的事情，我也渐渐明白了一些事情，有些事真的得自己经历过，才会有更多得体会，一切似乎是那么得难以理解，又似乎那么的理所当然。我甚至觉得我似乎开始质疑起了某样东西，但又没全盘否定。于局中仍可保持清醒，于局外，又可以看到很多的东西。“当局者迷，旁观者清”有时候也可予以驳斥。这一年同样也认识了一些人，</p><p>缘起于那本<a href="https://book.douban.com/subject/26877306/">《微习惯》</a>，仔细回忆起来，我好像多了很多的习以为常的“小动作”，几乎是下意识的动作，上班的路途反手就是打开读书 App，看那么几页，没有多大的压力，一天想看多少看多少，哪怕只是一页。好了，当我敲出这行字的时候，顺便做了几个俯卧撑😂。</p><p>21 年 12 月中，来了次十多公里的徒步，相当的放松，博客首次贴张 chou 照🤗：</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/03/TbUfPJ.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/03/TbUfPJ.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kubi"></p>            </div><h3 id="游戏-Games"><a href="#游戏-Games" class="headerlink" title="游戏-Games"></a>游戏-Games</h3><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/01/T5sPFH.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T5sPFH.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="真三国无双 7 帝国"></p>            </div><p>回忆了一下，21 年一如既往的锤老游戏多一点，我把电脑给换了，锤 SC2 更爽了，但是 8 月份的时候国服差不多 GG 了，退出江湖选择养老游戏了。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/11/14/I6tEr9.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6tEr9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="火焰纹章-晓之女神"></p>            </div><p>11 &amp; 12 月有部分时间在和位 dalao 打，“真滴菜”：</p><p><img src="https://s4.ax1x.com/2022/01/01/T5yQHO.png" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T5yQHO.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Sniper Elite4"></p><h3 id="阅读-Reading"><a href="#阅读-Reading" class="headerlink" title="阅读-Reading"></a>阅读-Reading</h3><p>2021，阅读源更多还是语雀和书，知乎看得没有那么频繁了，我还接触了个叫做<a href="https://sspai.com/">少数派</a>的网站，内容质量很高。我与<a href="https://www.yuque.com/">语雀🕊️</a>的缘分应该起于大二的时候？我在这里了解了一波体验设计 &amp; 交互 &amp; 前端知识，见识了很多有“思考度”的文章还有dalao，疯狂 follow。好像那些年我对体验设计的兴起就是缘于这里，想起来拿教育邮箱薅的 Figma 还在“我的桌面”很久没打开过了，我还想着试着拿 iPad 试试插画（illustration）来着，Edge 的集锦功能真不错，存了很多插画网站，又多个收藏吃灰的地方🐕。</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2021/12/31/T4OJbD.png" class="lazyload" data-srcset="https://s4.ax1x.com/2021/12/31/T4OJbD.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="我的语雀"></p>            </div><p>21年看的“闲书”多了起来，看着一些别人描述的事，想想自己是怎么样的人，如何去描述自己，再看看自己会变成什么样的人，可能会是什么样的人（in the future），我想要的是有更广的看问题的视角 &amp; 锻炼下思考力？：</p><ul><li>《活着》</li><li>《微习惯》</li><li>《蛤蟆先生去看心理医生》</li><li>《分寸感》</li><li>《杨绛：谈定从容，便是优雅》</li><li>《黑客与画家》</li><li>……</li></ul><p>可能是因为之前周刊看多了，我把 21 年阅读看到的一些内容（随手抄 &amp; 一些碎片话思考）反手在语雀上开了个周刊记录了下来 👉<a href="https://www.yuque.com/yeshan/me7h87">记录这一周我 看/听 让我有感触的一些文字</a> ，颇有“万物皆可周刊”那意思了。</p><details green open><summary> 2021 年印象深刻的三句话 </summary>              <div class='content'>              <ul><li>最恐怖的是你自己不知道你不知道；</li><li>因为如果你不爱一件事，你不可能把它做得真正优秀；</li><li>我们一生可能会做很多很多的事情，有些事情之所以去做，并非它是有多么大的意义，而是因为我们感兴趣。</li></ul>              </div>            </details><p>但有些灵感和想法，总是那么的容易消逝。哪怕是我将它即刻记录下来了，可当我再看的时候，好像已经不是之前那个“味道”了。翻了下 Microsoft ToDo 这一年我好像积压了很多 Items。RSS Reed 阅读信息流似乎没那么好了，最近有试试 <a href="https://github.com/iovxw/rssbot">TG RSS Feed Robot</a> + yuque 的想法，虽然在某推上看到了许多 dalao KM 管理的方式，但好像没有特别适合我的。Exploring！</p><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/01/T5AoVA.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T5AoVA.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="折磨"></p>            </div><h3 id="看-amp-听-See-amp-Listen"><a href="#看-amp-听-See-amp-Listen" class="headerlink" title="看 &amp; 听-See &amp; Listen"></a>看 &amp; 听-See &amp; Listen</h3><ul><li><p>21 年又关注了下 <a href="https://www.redbull.com/int-en/event-series/bc-one">Red Bull BC One</a>，Respect 一下那些年耍过的街舞，21 年没有我特别喜欢的 Style，这应该是第二次在 World Final 有 Bgirl 了，不知道啥时候能出现中国区的 dalao🙃。</p></li><li><p>21 年 10 月开始，我一个人开启了基本每周一场电影的模式（累计 10 场，人生目前累计 13 场？🏄），还挺有意思的，或许这就是传说中的成长了？相比之前，我有了更多的视角，我看懂了更多电影要描绘的故事，外加一些经历和看到或者听到过的故事，我可以更多的对个人的理解进行描述了。</p></li></ul><div class="gallery ">              <p><img src="https://s4.ax1x.com/2022/01/01/T5A3Hs.jpg" class="lazyload" data-srcset="https://s4.ax1x.com/2022/01/01/T5A3Hs.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="21 年的电影"></p>            </div><ul><li>2021年，听技术 Podcast（播客）没有那么多了，还是一如既往的关注着<a href="https://pythonhunter.org/">捕蛇者说</a>，转战某推围观 dalao 了，深夜听喜马拉雅催眠。</li></ul><h2 id="未来-Future"><a href="#未来-Future" class="headerlink" title="未来-Future"></a>未来-Future</h2><p>2021 如果用一句话描述的话，那么应该是：有挺多的事是想到了，便去做了，不需要那么的有规划性。</p><p>2022 年，我想怎么操作：更有挑战，更有趣，更有思考，更有深度的事？2333，这里就不立 🚩 了，我还需要想段时间。</p><h2 id="流年"><a href="#流年" class="headerlink" title="流年"></a>流年</h2><ul><li><a href="https://shansan.top/2021/01/06/2020-annual-reviewed/">关注思考的过程，终将更加卓越 | 2020 年总结</a></li><li><a href="https://shansan.top/2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/">2019 年总结</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 仓库瘦身与 LFS 大文件存储</title>
      <link href="2021/12/26/git-lfs-and-thin-repo/"/>
      <url>2021/12/26/git-lfs-and-thin-repo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>熟悉 Git 的小伙伴应该都知道随着 Git 仓库维护的时间越来越久，追踪的文件越来越多，git 存储的 <a href="https://git-scm.com/book/en/v2/Git-Internals-Git-Objects">objects</a> 数量会极其庞大，每次从远程仓库 git clone 的时候都会墨迹很久。如果我们不小心 <code>git add</code> 了一个体积很大的文件，且 <code>git push</code> 到了远程仓库，那么我们 <code>git clone</code> 的时候也会很慢。</p><p>看一下 GitHub 上的 <a href="https://github.com/microsoft/vscode">microsoft/vscode</a> 仓库，都有 九万多个 commit 了，可想而知 objects 的数量应该很恐怖，尝试 clone 一下（一百多万个 objects）：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/github_vscode.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/github_vscode.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="github vscode repo"></p><span id="more"></span><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/clone_vscode.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/clone_vscode.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="clone vscode repository"></p><p>这里微微记录下 Git 仓库瘦身和使用 Git LFS 进行大文件存储管理的几个常规操作。</p><h2 id="Git-仓库瘦身"><a href="#Git-仓库瘦身" class="headerlink" title="Git 仓库瘦身"></a>Git 仓库瘦身</h2><blockquote><p>瘦身背景：错误把大文件 push 到了远程仓库</p></blockquote><p>我们可以通过以下命令或者 <code>du -mh</code> 查看 Git 仓库的体积，<a href="https://www.git-scm.com/docs/git-count-objects">git-count-objects</a>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看仓库体积情况</span></span><br><span class="line">git count-objects -vH</span><br></pre></td></tr></table></figure><p>示例：可以看到当前仓库体积只有 12.00 KiB 左右</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/git_repo.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/git_repo.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo git repository"></p><p>现在我们模拟错误的将大文件上传到远程 Git 仓库的动作：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1、生成一个 90MB 大小的文件，Github 做了限制超过 100 MB 大小的文件建议使用 LFS，直接拒绝 push</span></span><br><span class="line">➜ dd if=/dev/zero of=bigfile bs=90MB count=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2、将这个文件 push 到远程仓库</span></span><br><span class="line">➜ git add bigfile</span><br><span class="line">➜ git commit -m &quot;add 90MB bigfile&quot;</span><br><span class="line">➜ git push origin master</span><br><span class="line">Enumerating objects: 4, done.</span><br><span class="line">Counting objects: 100% (4/4), done.</span><br><span class="line">Delta compression using up to 16 threads</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (3/3), 85.71 KiB | 306.00 KiB/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">remote: warning: See http://git.io/iEPt8g for more information.</span><br><span class="line">remote: warning: File bigfile is 85.83 MB; this is larger than GitHub&#x27;s recommended maximum file size of 50.00 MB</span><br><span class="line">remote: warning: GH001: Large files detected. You may want to try Git Large File Storage - https://git-lfs.github.com.</span><br><span class="line">To github.com:yeshan333/git-lfs-prune-repo.git</span><br><span class="line">   e3baf1a..f057313  master -&gt; master</span><br></pre></td></tr></table></figure><p>好，接下来我们假装这个仓库有很多文件，不知道具体是那个文件让 Git 仓库的体积突然变大，导致 clone 很慢🤣。<strong>就算知道了是哪里个文件造成的，我们直接删除那个文件是没有用的，我们还需要删除那个文件对应的 Git Object 文件</strong>。</p><p>接下来我们可以通过一下命令将本地 clone 的仓库历史提交过的体积较大的前 5 个文件名与对应的 Object 文件的 ID 罗列出来：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-list --objects --all | grep &quot;$(git verify-pack -v .git/objects/pack/*.idx | sort -k 3 -n | tail -5 | awk &#x27;&#123;print$1&#125;&#x27;)&quot;</span><br></pre></td></tr></table></figure><p>然后我们删除历史提交过的大文件 bigfile，从日志中我们可以看到本地仓库已经移除大文件成功了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">➜ git filter-branch --force --index-filter &#x27;git rm -rf --cached --ignore-unmatch bigfile&#x27; --prune-empty --tag-name-filter cat -- --all</span><br><span class="line">WARNING: git-filter-branch has a glut of gotchas generating mangled history</span><br><span class="line">         rewrites.  Hit Ctrl-C before proceeding to abort, then use an</span><br><span class="line">         alternative filtering tool such as &#x27;git filter-repo&#x27;</span><br><span class="line">         (https://github.com/newren/git-filter-repo/) instead.  See the</span><br><span class="line">         filter-branch manual page for more details; to squelch this warning,</span><br><span class="line">         set FILTER_BRANCH_SQUELCH_WARNING=1.</span><br><span class="line">Proceeding with filter-branch...</span><br><span class="line"></span><br><span class="line">Rewrite e3baf1ac709ae54b60afac9038adcf26fd086748 (1/1) (0 seconds passed, remaining 0 predicted)</span><br><span class="line">WARNING: Ref &#x27;refs/heads/master&#x27; is unchanged</span><br><span class="line">WARNING: Ref &#x27;refs/remotes/origin/master&#x27; is unchanged</span><br><span class="line">WARNING: Ref &#x27;refs/remotes/origin/main&#x27; is unchanged</span><br><span class="line">WARNING: Ref &#x27;refs/remotes/origin/master&#x27; is unchanged</span><br></pre></td></tr></table></figure><p>接下来我们使用 reflog 和 gc 压缩（清理和回收大文件占用的 objects 空间）看看瘦身效果，最后将变动推送到远程仓库即可：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">➜ git reflog expire --expire=now --all &amp;&amp; git gc --prune=now --aggressive</span><br><span class="line"></span><br><span class="line">➜ git count-objects -vH</span><br><span class="line"></span><br><span class="line">➜ git push --mirror</span><br><span class="line">Total 0 (delta 0), reused 0 (delta 0)</span><br><span class="line">To github.com:yeshan333/git-lfs-prune-repo.git</span><br><span class="line"> - [deleted]         main</span><br><span class="line"> + f057313...e3baf1a master -&gt; master (forced update)</span><br><span class="line"> * [new branch]      origin/HEAD -&gt; origin/HEAD</span><br><span class="line"> * [new branch]      origin/main -&gt; origin/main</span><br><span class="line"> * [new branch]      origin/master -&gt; origin/master</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://stackoverflow.com/questions/3959924/whats-the-difference-between-git-clone-mirror-and-git-clone-bare">What’s the difference between git clone –mirror and git clone –bare</a></p></blockquote><h2 id="Git-LFS-大文件存储"><a href="#Git-LFS-大文件存储" class="headerlink" title="Git LFS 大文件存储"></a>Git LFS 大文件存储</h2><p>如果我们之前生成的大文件 bigfile 大小超过 100 MB，那么 push 到 Github 的时候，会抛出个 error 错误，并会有条建议使用 LFS (Large File Storage)：<a href="https://git-lfs.github.com/">https://git-lfs.github.com/</a> 管理这个大文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">➜ git push origin main</span><br><span class="line">Enumerating objects: 4, done.</span><br><span class="line">Counting objects: 100% (4/4), done.</span><br><span class="line">Delta compression using up to 16 threads</span><br><span class="line">Compressing objects: 100% (2/2), done.</span><br><span class="line">Writing objects: 100% (3/3), 1.85 MiB | 752.00 KiB/s, done.</span><br><span class="line">Total 3 (delta 0), reused 1 (delta 0)</span><br><span class="line">remote: error: Trace: 993cb74d30fdb2342e7243f5a7002c1892d00d3a216b80e64b43ef7e4382b947</span><br><span class="line">remote: error: See http://git.io/iEPt8g for more information.</span><br><span class="line">remote: error: File bigfile is 1907.35 MB; this exceeds GitHub&#x27;s file size limit of 100.00 MB</span><br><span class="line">remote: error: GH001: Large files detected. You may want to try Git Large File Storage - https://git-lfs.github.com.</span><br><span class="line">To github.com:yeshan333/git-lfs-prune-repo.git</span><br><span class="line"> ! [remote rejected] main -&gt; main (pre-receive hook declined)</span><br><span class="line">error: failed to push some refs to &#x27;git@github.com:yeshan333/git-lfs-prune-repo.git&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 仓库初始化 LFS</span></span><br><span class="line">➜ git lfs install</span><br><span class="line">Updated git hooks.</span><br><span class="line">Git LFS initialized.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建大文件</span></span><br><span class="line">➜ dd if=/dev/zero of=bigfile200 bs=200MB count=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">200000000 bytes (200 MB, 191 MiB) copied, 0.176594 s, 1.1 GB/s</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定 LFS 追踪大文件</span></span><br><span class="line">➜ git lfs track &quot;bigfile200&quot;</span><br><span class="line">Tracking &quot;“bigfile200”&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 被追踪的文件会记录再 .gitattributes 文件中我们将 .gitattributes 文件 push 到远程仓库即可</span></span><br><span class="line">➜ cat .gitattributes</span><br><span class="line">&quot;bigfile200&quot; filter=lfs diff=lfs merge=lfs -text</span><br><span class="line">➜ git add .gitattributes</span><br><span class="line">➜ git commit -m &quot;add .gitattributes&quot;</span><br><span class="line">➜ git push</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交大文件</span></span><br><span class="line">➜ git add bigfile200</span><br><span class="line">➜ git commit -m &quot;bigfile 200MB&quot;</span><br><span class="line">[master 84fb90b] bigfile 200MB</span><br><span class="line"> 1 file changed, 3 insertions(+)</span><br><span class="line"> create mode 100644 bigfile200</span><br><span class="line">➜ git push</span><br><span class="line">Uploading LFS objects: 100% (1/1), 200 MB | 3.7 MB/s, done.</span><br><span class="line">Enumerating objects: 4, done.</span><br><span class="line">Counting objects: 100% (4/4), done.</span><br><span class="line">Delta compression using up to 16 threads</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (3/3), 423 bytes | 423.00 KiB/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To github.com:yeshan333/git-lfs-prune-repo.git</span><br><span class="line">   aef9a0b..84fb90b  master -&gt; master</span><br></pre></td></tr></table></figure><blockquote><p>开启了 LFS 之后，对应大文件的内容存储在 LFS 服务器中，不再是存储在 Git 仓库中，Git 仓库中存储的是大文件的指针文件，LFS 的指针文件是一个文本文件。</p></blockquote><p>Done?</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://docs.gitlab.com/ee/user/project/repository/mirror/push.html">Push Mirroring-Gitlab</a></li><li><a href="http://palanceli.com/2017/12/18/2017/1218GitReduceSize/">git 瘦身 | Palance’s Blog</a></li><li><a href="https://zhuanlan.zhihu.com/p/146683392">详解 Git 大文件存储（Git LFS）</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deserve</title>
      <link href="2021/12/04/deserve/"/>
      <url>2021/12/04/deserve/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>今天凌晨五点就醒了，积累了好多好多的情绪啊！</p><!-- 年轻的战场 --><!-- 我们都一样 -->    <div id="aplayer-EvHPExqn" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="1340001174" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86"    ></div>    <div id="aplayer-wXLrsAES" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="191252" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86"    ></div><span id="more"></span>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>回环地址的一点儿破事</title>
      <link href="2021/11/27/loopback-addr/"/>
      <url>2021/11/27/loopback-addr/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>心血来潮，小水一篇！</p><h2 id="回环地址（loopback-address）"><a href="#回环地址（loopback-address）" class="headerlink" title="回环地址（loopback address）"></a>回环地址（loopback address）</h2><blockquote><p><a href="https://en.wikipedia.org/wiki/Loopback">loopback</a> 在维基百科上有一段这样的解释：Loopback (also written loop-back) is the routing of electronic signals or digital data streams back to their source without intentional processing or modification. It is primarily a means of testing the communications infrastructure.<br>通熟的说就是将由“源”发送出去的数据路由回“源”。</p></blockquote><span id="more"></span><p>作为划水选手，我们肯定会接触过这样一个东西 -&gt; Virtual loopback interface。当我们写的应用/服务想在同一台机器上进行通信的时候，基本都会使用到它。</p><p>在类 Unix 系统中，虚拟回环接口（Virtual loopback interface）通常被命名为 <strong>lo</strong> 或者 <strong>lo0</strong>。我们可以使用 <code>ipconfig</code> 看一下：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/blogloopback.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/blogloopback.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="ipconfig loopback address"></p><p>emmm，127.0.0.1，好家伙，没错，127.0.0.1 就是一个 IPv4 的回环地址。IETF 标准中（<a href="https://www.rfcreader.com/#rfc1122_line1324">RFC1122</a>、<a href="https://www.rfcreader.com/#rfc5735_line97">RFC5735</a>）将 IPv4 <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR</a> 地址块 127.0.0.0/8 划为回环地址（即 127.0.0.0 ~ 127.255.255.255）。IPv6 下回环地址为 <code>::1/128</code>。</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/cidr.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/cidr.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="CIDR 表示"></p><blockquote><p>IPv6 下 127.0.0.1 表示为 ::1</p></blockquote><h2 id="几个常见的小家伙"><a href="#几个常见的小家伙" class="headerlink" title="几个常见的小家伙"></a>几个常见的小家伙</h2><p>OK, 回环地址简介完了，接下来让我们看下以下几个常用的“小家伙”：</p><ul><li>localhost</li><li>0.0.0.0</li><li>127.0.0.1</li></ul><p>在这里，抛出几个问题？再自问自答！😎</p><ul><li>这三个家伙有什么区别？</li></ul><p>显而易见，0.0.0.0 和 127.0.0.1 是 IP 地址嘛，localhost 是 hostname。至于再具体点的东西，可以看下后面两个问题。</p><ul><li>为什么断网后，我们还能 ping 通这三个东西？</li></ul><p>断网的情况下，我们使用 ping 命令，ping 一下公网的 IP 地址，一般是不通的。但是 <code>ping 127.0.0.1</code> 却可以。因为 127.0.0.1 是一个回环地址（Loopback Address），操作系统对于走真实网卡的公网 IP 数据包的处理和走虚拟网卡的本机回环地址（之前介绍的 lo 和 lo0，Virtual loopback interface）的处理是不一样的。相对于目标是公网 IP 的数据包走的 ring buffer，回环地址的数据包走了一个数据结构 input_pkt_queue 触发软中断 ksoftirqd 处理，这篇文章有较为深入的介绍 👉<a href="https://zhuanlan.zhihu.com/p/381408859">🔗</a>🐂。</p><p>至于 <code>ping localhost</code> 也是通的是因为 localhost DNS 解析到了回环地址 127.0.0.1，可以使用 <code>cat /etc/hosts</code> 查看 Linux hosts 文件。IETF 标准 <a href="https://www.rfcreader.com/#rfc6761_line336">RFC6761</a> 将域名 localhost 默认保留给了回环地址 127.0.0.1。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ cat /etc/hosts</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     ip6-localhost ip6-loopback</span><br></pre></td></tr></table></figure><p>至于为什么断网能 ping 通 0.0.0.0，可以结合下一个问题思考一下。</p><ul><li>开发完后的 Web Service，我们一般会 listen 0.0.0.0，这有什么用？</li></ul><p><code>listen 0.0.0.0</code> 会监听本机上的所有IPV4地址。让服务访问方就可以通过本机的多个 IP 地址（包括回环地址，只要服务访问方与本机处于同一个网络下）访问本机的 Web 服务。<a href="https://datatracker.ietf.org/doc/html/rfc5735#section-3">RFC 5735</a> 对特殊的 0.0.0.0 地址做了介绍。</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/ping0000.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/ping0000.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="ping 0.0.0.0"></p><h2 id="Wireshark-回环地址抓包"><a href="#Wireshark-回环地址抓包" class="headerlink" title="Wireshark 回环地址抓包"></a>Wireshark 回环地址抓包</h2><p>在这里介绍下使用 <a href="https://www.wireshark.org/#download">Wireshark</a> 抓取回环地址的数据包，</p><blockquote><p>Wireshark 如果想要抓取回环地址的包（(loopback packets)），需要安装 <a href="https://nmap.org/npcap/">Npcap</a>。</p></blockquote><p>1、我们本地使用 Go 的 Gin 起个粗糙版 Web 服务：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;pong&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">r.Run() <span class="comment">// listen and serve on 0.0.0.0:8080 (for windows &quot;localhost:8080&quot;)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/gogin.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/gogin.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Go-Gin"></p><p>2、打开 Wireshark，capture 回环地址的虚拟网卡：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/wireshark_loopback.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/wireshark_loopback.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Wireshark capture loopback"></p><p>3、过滤一下 TCP 端口，curl 一下 localhost:8080/ping：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --location --request GET <span class="string">&#x27;localhost:8080/ping&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/wireshark_port_filter.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/wireshark_port_filter.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Wireshark TCP port filter"></p><p>水完，收工！😊</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://en.wikipedia.org/wiki/Loopback">LoopBack (Virtual loopback interface) - wikipedia</a></li><li><a href="https://en.wikipedia.org/wiki/Localhost">Localhost - wikipedia</a></li><li><a href="https://zhuanlan.zhihu.com/p/381408859">断网了，还能ping通 127.0.0.1 吗？为什么？</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>回到十月-生活中的一点儿小确幸</title>
      <link href="2021/11/14/back-to-october/"/>
      <url>2021/11/14/back-to-october/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>不知不觉，离开校园将近四个月了，正式工作（摸🐟~）也差不多四个多月了，最近经历了很多事，头发也掉了不少😂 {微微害怕了}。之前一直有想法想补充一些带有生活气息的博文到自己的博客中，印象中 2021 年的 reviewed 有提到过，总觉得自己的博客少了点味儿（生活的味道），毕竟我也是个活脱脱的人啊，也是有 “感觉” 的。</p><p>趁着周末，来一篇。略微回顾了下这几个月，觉得最应该写的就是 10 月（屁事多😄），虽然说现在都 11 月了，但也不妨碍我写 10 月的事。</p><h2 id="10-月的那些小确幸"><a href="#10-月的那些小确幸" class="headerlink" title="10 月的那些小确幸"></a>10 月的那些小确幸</h2><ul><li>国庆</li><li>答辩</li><li>或许注定的遇见</li></ul><h3 id="国庆七天"><a href="#国庆七天" class="headerlink" title="国庆七天"></a>国庆七天</h3><p>emmm，说到 10 月，首当其冲的当然是国庆七天的假期了。这七天我有下面的一个小总结，2333：</p><ul><li>Day 1，游戏（FPS）；</li><li>Day 2，游戏（FPS）；</li><li>Day 3，游戏（SRPG）；</li><li>Day 4，现代文学小说《活着》 + 电影《活着》；</li><li>Day 5，爬个山；</li><li>Day 6，动物园 &amp; 北京路 &amp; 书店；</li><li>Day 7，看了个电影，写篇文章；</li><li>Day 8，上了个班儿。</li></ul><p>游戏：我在 7 月份换了个配置还可以电脑，终于能打点像样点的游戏了，之前那小破电脑，我只能打个《细胞分裂：断罪》意思一下，哦，还有《星际争霸 2》也能勉强玩玩，当初看着室友玩新出的游戏，那叫一个羡慕啊（那时候我一般只好甩个门出去卷了）。10 月前，《Sniper Elite 4》狙击精英 4 正好打折，反手在 Steam 入手了我的第二款游戏（之前老白嫖党了，花点钱，意思下）。BTW，国庆前一个同事推荐过我耍下《Hearts of Iron》钢铁雄心，玩了下，真复杂，不适合我。被某《王者荣耀》影响，打习惯学习成本没么高的游戏了（这就是传说中的迫于生活？）。于是机智的我，巧妙的避开了国庆前三天的人海，决定不出去，打开两天的《狙击精英 4》，唉，真香！</p><p><img src="https://z3.ax1x.com/2021/11/14/I6Ym9S.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6Ym9S.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Sniper Elite 4"></p><p>第三天，反手打开了海豚模拟器（没办法，条件它不允许），玩起了 SRPG 游戏 -&gt; 《火焰纹章：晓之女神》，火焰纹章系列游戏玩了很多年了，不知道我什么时候能嫖上 2019 年出的《火焰之纹章：风花雪月》/(ㄒoㄒ)/~~，Google 了一遍，没翻到镜像，太难了😭。每次玩这种略微带点年代感的游戏，都会回忆起小时候玩插卡带游戏的那种快乐。</p><p><img src="https://z3.ax1x.com/2021/11/14/I6tEr9.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6tEr9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="火焰纹章：晓之女神"></p><p>oh，这个月我还通过某小程序耍了下当初小时候玩过的《热血格斗》，快乐就这么简单😎？</p><p><img src="https://z3.ax1x.com/2021/11/14/I6tfRU.jpg" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6tfRU.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="热血格斗"></p><p>小说：第四天，我尝试着看了下余华的长篇小说《活着》，丰富下自己的精神世界。所幸它的篇幅也没有那么长（想起来，当初我那套周易也没看完，虽然一小本挺薄的😢，但小本本堆起来就很多了）。小说在用死亡去“象征”活着，尽管主人公的一生是那么的不幸，但他最后仍然是那么的乐观豁达。仔细想想，我觉得福贵还是挺幸运的，遇到了那么多对自己好的人。尽管我没有生长在那个年代，但我在这小说中从一个平凡人的视角（相比于之前的经常看的抗战电视剧）又看到了的当初那些年代的不容易。第四天稍微晚些的时候，我顺便看了下张艺谋执导的同名电影，电影稍微美化了下小说，但不得不说 94 年的电影这么棒，那箱贯穿整部电影的皮影箱，让我印象很深刻，电影的虽然没有拍完整部小说，但描绘得很到位了。也许多年后的我再看会有更多得体会🤔，下面是我看小说的时候喜欢得一段话：</p><p><img src="https://z3.ax1x.com/2021/11/14/I6wEAs.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6wEAs.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="小说-《活着》"></p><p>爬山：第五天的爬山其实并没有列入我的规划中（想了想，我的国庆当初也没规划🤣），这可以说是说走就走了，出去呼吸下新鲜空气。这天相当的 relax，这广州的白云山还挺矮，不过快到山顶的那段路也不好走啊。我以为过完一遍山上的景点了，但是和某个人聊的时候，我发现我居然还有那么多的地点没去，后面再去次（囧.jpg）。</p><p><img src="https://z3.ax1x.com/2021/11/14/I6fKiT.jpg" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/14/I6fKiT.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="mountain"></p><p>动物园 &amp; 北京路 &amp; 电影：这里要特别提一下，我都是一个人去的，2333，我骄傲（😎）。吐槽一下，动物园 &amp; 北京路 也就这了，不过如此🤣，感觉每个城市都有。电影看的是最近很火的《长津湖》，人生的第一次一个人去看的电影，只能说我太勇了，之前看电影一直是和同学去的，一直害怕一个人去看（有种想法一直围绕着我的脑海：一个人去不太好吧？周围都是小情侣？被暴击）。被朋友疯狂 push，悟了，想看就看，关注那么多别人的看法干嘛（别人也未必关注你）。</p><p>书店：谈到阅读，我经历了从纸质书到电子书再到纸质书 &amp; 电子书混合双打的变换。最近几个月去书店的频率有点高了，被语雀上 dalao 们丰富的精神世界刺激到了🤣，我对自己精神世界的探索又更加热切了，去书店攒点“气”。自己之前是很多喜欢到知乎还有微信公众号去看别人写的文章的，奈何还是没有能够很好的把自己的想法真实写出来。我又悟了🤣，是我没有料，料储备不够多，Maybe，一本完整的书相比于片段化的文章能让我有更深刻的感受！那么就微微提高了下看书的频率，做点突破。</p><h2 id="答辩"><a href="#答辩" class="headerlink" title="答辩"></a>答辩</h2><p>这个月还有一件重要的事，就是我的转正答辩。不得不说写 PPT 是个很痛苦的事情，但是为了给自己个交代，必须得写一个。准备答辩的过程我也慢慢对自己有了更加清楚的认知。</p><p>直至现在，我仍然能很清楚得感受到自己的变化。</p><p>最近认识的同事 &amp; 朋友都跟我说过一句话（Social 还得是你啊！），实际上，Social？我并没有那么的 Social。我觉得我以前是那么一个孤僻的人，哪怕是对家人也是如此。我是那么的喜欢一个人呆着（呆着？或许可以称之为独处），不愿意于太多的人接触，能自己做的事绝不找别人，就算不能自己做，也会继续坚持找着法去做，就是不太愿意找别人帮忙。我感觉知乎上的一个话题对我这一类人的描述是很到位的 -&gt; <a href="https://www.zhihu.com/question/438833344/answer/1892590099?utm_campaign=shareopn&utm_medium=social&utm_oi=908413169096077312&utm_source=wechat_session&s_r=0">为什么说内向的人精神内耗很严重呢?</a>。有些时候，我会觉得我是那么的不自信。工作上的事，最初是比较厌恶沟通的，周围的同事还是不错的，但我还是不愿意去沟通，总觉得我自己能解决😢，但这效率相对于合作来说，就没那么的好了。</p><p>现在感觉好多了，我慢慢的踏出了那一步，主动和别人沟通稍微多了点。但还是有种类似于“厌恶”的心理存在，不想别人知道太多。好了，这里我也不想写太多，我期待自己的下一步变化🙂。</p><p>这里的话可能有点乱，稍（日）后再理一理。</p><h2 id="遇见"><a href="#遇见" class="headerlink" title="遇见"></a>遇见</h2><p>……</p><!-- 这个月我通过一个特殊的渠道（感觉本不应该是我这个 age 的人去使用的渠道）认识了一位 girl。我称之为 Cauliflower。不知道我们接下来会有什么样的故事。![Cabbage](https://z3.ax1x.com/2021/11/14/I6ftdx.jpg) --><blockquote><p>Life is not over.</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Kubeadm 搭建个公网 k8s 集群（单控制平面集群）</title>
      <link href="2021/10/24/create-k8s-cluster/"/>
      <url>2021/10/24/create-k8s-cluster/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>YY：国庆的时候趁着阿里云和腾讯云的轻量级服务器做促销一不小心剁了个手😎😢，2 Cores，4G RAM 还是阔以的，既然买了，那不能不用呀🚩，之前一直想着搭建个 k8s 集群玩玩，本地开发机虽然起了个 k8s（拿 Docker Desktop 起的，不 dei 劲），但就一个 Node，不爽，对 k8s 的体验不到位😒，1024，是时候用起来了，折腾一下，顺便让最近浮躁的心冷静一下。</p><p>这次拿官方的 Kubeadm 耍一下，以阿里云的轻量级应用服务器为 Control 节点，腾讯云的轻量级应用服务器为 Worker 节点，说干就干。</p><span id="more"></span><h2 id="Check-一下文档要求-准备工作"><a href="#Check-一下文档要求-准备工作" class="headerlink" title="Check 一下文档要求 - 准备工作"></a>Check 一下文档要求 - 准备工作</h2><p>Kubenetes 官方文档给出了 Kubeadm 起 k8s 集群的几点要求，在这里微微检查下两台轻量级云服务器：</p><ul><li><input checked="" disabled="" type="checkbox"> A compatible Linux host. The Kubernetes project provides generic instructions for Linux distributions based on Debian and Red Hat, and those distributions without a package manager.[我们用的 Ubuntu 20.04，那肯定符合 Debian 系的].</li><li><input checked="" disabled="" type="checkbox"> 2 GB or more of RAM per machine (any less will leave little room for your apps).[4G, 我们很 OK, 但感觉后面会拉跨].</li><li><input checked="" disabled="" type="checkbox"> 2 CPUs or more. [正好一台 2个 CPU, nice].</li><li><input checked="" disabled="" type="checkbox"> Full network connectivity between all machines in the cluster (public or private network is fine).[两台轻量级应用服务器都有公网 IP，那必须互通啊].</li><li><input checked="" disabled="" type="checkbox"> Unique hostname, MAC address, and product_uuid for every node.[这里得微微 check 一下两台服务器，<code>cat /sys/class/net/eth0/address</code> 看下 MAC 地址，<code>sudo cat /sys/class/dmi/id/product_uuid</code> 看下 product_uuid, <code>hostname</code> 看下主机名，emmm, correct！]</li><li><input checked="" disabled="" type="checkbox"> Certain ports are open on your machines. [这里得到阿里云轻量级服务器 &amp; 腾讯云的轻量级应用服务器的防火墙开放下相关 TCP 端口]。</li></ul><p>阿里云轻量级应用服务器开启 Control（控制平面）节点的 TCP 端口，这里要对照下<a href="https://kubernetes.io/docs/reference/ports-and-protocols/#control-plane">文档</a>给出的需要开放的端口：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/10/24/5W83Ae.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/24/5W83Ae.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Control Plane Open Ports"></p><p><img src="https://z3.ax1x.com/2021/10/24/5W3Azt.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/24/5W3Azt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Aliyun Control Node"></p>            </div><p>腾讯云轻量级应用服务器开启 Worker（工作）节点的 TCP 端口：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/10/24/5W8H3R.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/24/5W8H3R.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Worker Node Open Ports"></p><p><img src="https://z3.ax1x.com/2021/10/24/5W3hYd.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/24/5W3hYd.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Tencent Cloud Worker Node"></p>            </div><ul><li><input checked="" disabled="" type="checkbox"> Swap disabled. You MUST disable swap in order for the kubelet to work properly. [为了让 kubelet 起来，要把 Swap 分区关闭，使用 <code>free -mh</code> 看下 Swap 是否在使用， <code>swapoff -a</code> <a href="https://askubuntu.com/questions/214805/how-do-i-disable-swap">关闭 Swap 分区</a>].</li></ul><p>参考：<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/</a></p><p>为什么需要关闭 Swap 分区，有 dalao 做了分析：<a href="https://www.jianshu.com/p/6f3268ce642f">https://www.jianshu.com/p/6f3268ce642f</a></p><ul><li><input checked="" disabled="" type="checkbox"> Letting iptables see bridged traffic.</li></ul><p>这里照着<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#letting-iptables-see-bridged-traffic">文档</a>，一波操作下两台服务器：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo modprobe br_netfilter</span><br><span class="line"></span><br><span class="line">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf</span><br><span class="line">br_netfilter</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">EOF</span><br><span class="line">sudo sysctl --system</span><br><span class="line"></span><br><span class="line">lsmod | grep br_netfilter</span><br></pre></td></tr></table></figure><ul><li><input checked="" disabled="" type="checkbox"> Container Runtime Interface（CRI）. [这里需要安装下 Pod 运行需要的容器运行时，我们选择 <a href="https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository">Docker</a>].</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y apt-transport-https \</span><br><span class="line">    software-properties-common \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release</span><br><span class="line">curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository &quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure><p>安装完毕还需要将 Docker 的 cgroup driver 替换为 systemd，确保与 Kubeneters 使用的一致。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">cat&gt;</span><span class="bash">&gt;/etc/docker/daemon.json&lt;&lt;<span class="string">EOF</span></span></span><br><span class="line">&#123;</span><br><span class="line">  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="安装-kubeadm-kubelet-kubectl"><a href="#安装-kubeadm-kubelet-kubectl" class="headerlink" title="安装 kubeadm, kubelet, kubectl"></a>安装 kubeadm, kubelet, kubectl</h2><p>上面检查工作如果很顺利的话，接下来就可以准备 kubeadm, kubelet, kubectl 安装了，不过我们还得给 apt 添加 Kubenetest <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-kubeadm-kubelet-and-kubectl">软件源</a>，官方文档中使用的如软件源是 Google 域名下的，国内云服务器访问会有问题（懂得都懂了😂），这里使用国内得源，这里两台服务器都操作一下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1、添加 GPG Key</span></span><br><span class="line">sudo curl -fsSL http://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2、添加 k8s 软件源</span></span><br><span class="line">sudo add-apt-repository &quot;deb http://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main&quot;</span><br><span class="line">3、update 一下</span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure><p>上面执行没有问题的话，就可以开始安装 kubelet kubeadm kubectl了：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y kubelet kubeadm kubectl</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看安装的版本, apt install apt-show-versions</span></span><br><span class="line">apt-show-versions kubectl kubelet kubeadm</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让 kubelet 开机启动</span></span><br><span class="line">sudo systemctl start kubelet</span><br><span class="line">sudo systemctl enable kubelet</span><br></pre></td></tr></table></figure><ul><li>kubeadm: 引导启动 Kubernate 集群的命令行工具。</li><li>kubelet: 在群集中的所有计算机上运行的组件, 并用来执行如启动 Pods 和 Containers 等操作。</li><li>kubectl: 用于操作运行中的集群的命令行工具。</li></ul><h2 id="初始化集群"><a href="#初始化集群" class="headerlink" title="初始化集群"></a>初始化集群</h2><p>为了能够让集群初始化更快，我们可以先预拉取集群初始化依赖的镜像，emmm，官方文档给出的又是 Google 的网址，这里我们基于 GitHub -&gt; <a href="https://github.com/AliyunContainerService/k8s-for-docker-desktop">AliyunContainerService/k8s-for-docker-desktop</a> 项目做镜像的快速拉取。确保相关镜像版本与 kubelet 保持一致（这里是 v1.22.2）, <code>kubeadm config images list --kubernetes-version v1.22.2</code> 可查看需要哪些镜像。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/AliyunContainerService/k8s-for-docker-desktop.git &amp;&amp; cd k8s-for-docker-desktop</span><br><span class="line"></span><br><span class="line">rm -f images.properties</span><br><span class="line"><span class="meta">#</span><span class="bash"> 调整镜像版本</span></span><br><span class="line"><span class="meta">cat&gt;</span><span class="bash">&gt;images.properties&lt;&lt;<span class="string">EOF</span></span></span><br><span class="line">k8s.gcr.io/pause:3.5=registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.5</span><br><span class="line">k8s.gcr.io/kube-controller-manager:v1.22.2=registry.cn-hangzhou.aliyuncs.com/google_containers/kube-controller-manager:v1.22.2</span><br><span class="line">k8s.gcr.io/kube-scheduler:v1.22.2=registry.cn-hangzhou.aliyuncs.com/google_containers/kube-scheduler:v1.22.2</span><br><span class="line">k8s.gcr.io/kube-proxy:v1.22.2=registry.cn-hangzhou.aliyuncs.com/google_containers/kube-proxy:v1.22.2</span><br><span class="line">k8s.gcr.io/kube-apiserver:v1.22.2=registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.22.2</span><br><span class="line">k8s.gcr.io/etcd:3.5.0-0=registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:3.5.0-0</span><br><span class="line">k8s.gcr.io/coredns/coredns:v1.8.4=registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:1.8.4</span><br><span class="line">quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.26.1=registry.cn-hangzhou.aliyuncs.com/google_containers/nginx-ingress-controller:0.26.1</span><br><span class="line">EOF</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 拉取镜像</span></span></span><br><span class="line">./load_images.sh</span><br></pre></td></tr></table></figure><h3 id="初始化控制平面节点（Control-Plane-Node-s-）"><a href="#初始化控制平面节点（Control-Plane-Node-s-）" class="headerlink" title="初始化控制平面节点（Control Plane Node(s)）"></a>初始化控制平面节点（Control Plane Node(s)）</h3><p>控制（Control）节点 {阿里云轻量级应用服务器} 的镜像预拉取完毕后，可执行如下命令进行初始化操作：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> api server IPv4 地址使用公网 IP</span></span><br><span class="line">kubeadm init \</span><br><span class="line">  --pod-network-cidr=10.244.0.0/16 \</span><br><span class="line">  --kubernetes-version v1.22.2</span><br><span class="line"><span class="meta">  #</span><span class="bash"> --apiserver-advertise-address 120.79.73.159</span></span><br></pre></td></tr></table></figure><p>为当前 root 用户生成 kubeconfig：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure><p>安装 CNI（Container Network Interface） -&gt; Flannel</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --insecure -sfL https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml | kubectl apply -f -</span><br></pre></td></tr></table></figure><p>查看节点状况，emmm，Ready 没毛病</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@iZwz92a65mqaa8zwy83dpnZ:~/k8s-for-docker-desktop# kubectl get nodes</span><br><span class="line">NAME                      STATUS   ROLES                  AGE    VERSION</span><br><span class="line">izwz92a65mqaa8zwy8   Ready    control-plane,master   4m6s   v1.22.2</span><br></pre></td></tr></table></figure><h3 id="添加工作节点（Worker-Node-s-）"><a href="#添加工作节点（Worker-Node-s-）" class="headerlink" title="添加工作节点（Worker Node(s)）"></a>添加工作节点（Worker Node(s)）</h3><p>接下来我们将 Worker 节点加入到集群中，由于我们在初始化控制平面所在的主节点时并没有指定公网 IP，所以这里先做个 IP 转发，让 Worker 节点能够和控制平面节点间进行通信。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -A OUTPUT -d &lt;初始化控制平面节点得到的 IP&gt; -j DNAT --to-destination &lt;阿里云轻量级服务器公网 IP&gt;</span><br></pre></td></tr></table></figure><p>然后我们将 Worker 节点 join 进集群中：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm join &lt;初始化控制平面节点得到的 IP&gt;:6443 --token 4zicbp.d1wertghxdgcgz6y --discovery-token-ca-cert-hash sha256:1912dbf415da652f97b9fa728cb85dd338e17b24ee338ec48b073c8fa8sdfgth</span><br></pre></td></tr></table></figure><p>顺利的话😊，那么结果如下：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/10/24/5fFKtU.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/24/5fFKtU.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="worker join"></p>            </div><p>然后到控制节点看下集群节点状态，<strong>顺利的话</strong>结果如下🤣：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@iZwz92a65mqdpnZ:~/k8s-for-docker-desktop# kubectl get nodes</span><br><span class="line">NAME                      STATUS   ROLES                  AGE    VERSION</span><br><span class="line">izwz92a65mqaa8zwy83dpnz   Ready    control-plane,master   48m    v1.22.2</span><br><span class="line">vm-8-4-ubuntu             Ready    &lt;none&gt;                 8m9s   v1.22.2</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Installing kubeadm</a></li><li><a href="http://icyfenix.cn/appendix/deployment-env-setup/setup-kubernetes/setup-kubeadm.html">使用 Kubeadm 部署</a></li><li><a href="https://www.cnblogs.com/life-of-coding/p/11879067.html">解决阿里云ECS下kubeadm部署k8s无法指定公网IP</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> Kubeadm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从平均负载开始，这进程是 CPU Bound 还是 IO Bound 的？</title>
      <link href="2021/10/07/io-bound-cpu-bound-with-average-load/"/>
      <url>2021/10/07/io-bound-cpu-bound-with-average-load/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>在排查性能问题的时候，我们经常会使用 top 或者 uptime 两个 Linux 命令，top 命令和 uptime 命令都会给出最近机器 1 min，5 min，15 min 的平均负载情况，一般平均负载值（Average Load）接近甚至超出 CPU cores (现在一般指 processors 的个数, 现在 CPU 的一个 core 一般有两个 processor, 可以处理两个进程) 时，系统会有性能瓶颈.</p><blockquote><p>平均负载是指单位时间内，系统处于可运行状态和不可中断状态的平均进程数，也就是平均活跃进程.</p></blockquote><p>造成平均负载升高的原因一般有以下几种：</p><ul><li>1、有 IO Bound 进程（即存在 IO 密集型任务）</li><li>2、有 CPU Bound 进程（即存在 CPU 密集型任务）</li><li>3、处于就绪状态（Ready）的进程多</li><li>…..</li></ul><p>本篇文章主要记录下造成平均负载升高的两个场景. IO 密集型场景和 CPU 密集型场景.</p><p>这里的实验环境在一个操作系统为 Ubuntu 20.04.3 LTS 的容器内, 通过 stress 进行 IO Bound 与 CPU Bound 场景的模拟, 宿主机有 16 个 processors, 8G 运行内存.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -it  ubuntu:latest</span><br><span class="line"></span><br><span class="line">root@bfdbc798879c:/<span class="comment"># cat /etc/os-release</span></span><br><span class="line">NAME=<span class="string">&quot;Ubuntu&quot;</span></span><br><span class="line">VERSION=<span class="string">&quot;20.04.3 LTS (Focal Fossa)&quot;</span></span><br><span class="line">ID=ubuntu</span><br><span class="line">ID_LIKE=debian</span><br><span class="line">PRETTY_NAME=<span class="string">&quot;Ubuntu 20.04.3 LTS&quot;</span></span><br><span class="line">VERSION_ID=<span class="string">&quot;20.04&quot;</span></span><br><span class="line">HOME_URL=<span class="string">&quot;https://www.ubuntu.com/&quot;</span></span><br><span class="line">SUPPORT_URL=<span class="string">&quot;https://help.ubuntu.com/&quot;</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">&quot;https://bugs.launchpad.net/ubuntu/&quot;</span></span><br><span class="line">PRIVACY_POLICY_URL=<span class="string">&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;</span></span><br><span class="line">VERSION_CODENAME=focal</span><br><span class="line">UBUNTU_CODENAME=focal</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">root@bfdbc798879c:/<span class="comment"># top</span></span><br><span class="line">top - 11:21:53 up  3:10,  0 users,  load average: 0.66, 0.79, 0.46</span><br><span class="line">Tasks:   2 total,   1 running,   1 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu0  :  1.0 us,  0.6 sy,  0.0 ni, 93.3 id,  0.0 wa,  0.0 hi,  5.1 si,  0.0 st</span><br><span class="line">%Cpu1  : 10.2 us,  0.3 sy,  0.0 ni, 88.1 id,  0.0 wa,  0.0 hi,  1.3 si,  0.0 st</span><br><span class="line">%Cpu2  : 10.4 us,  2.7 sy,  0.0 ni, 87.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu3  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu4  : 11.1 us,  0.7 sy,  0.0 ni, 88.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu5  :  0.0 us,  0.3 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu6  :  0.7 us,  1.3 sy,  0.0 ni, 98.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu7  :  3.0 us,  0.0 sy,  0.0 ni, 97.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu8  :  0.3 us,  1.0 sy,  0.0 ni, 98.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu9  :  0.7 us,  0.0 sy,  0.0 ni, 99.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu10 :  0.0 us,  0.0 sy,  0.0 ni, 99.7 id,  0.3 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu11 :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu12 :  0.3 us,  0.3 sy,  0.0 ni, 99.0 id,  0.3 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu13 :  0.3 us,  0.0 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu14 : 10.7 us,  0.7 sy,  0.0 ni, 88.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu15 :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">MiB Mem :   7829.4 total,   1913.4 free,   1582.2 used,   4333.7 buff/cache</span><br><span class="line">MiB Swap:   2048.0 total,   2047.7 free,      0.3 used.   5582.8 avail Mem</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND</span><br><span class="line">    1 root      20   0    4232   3504   2952 S   0.0   0.0   0:00.02 bash</span><br><span class="line">   12 root      20   0    6092   3332   2828 R   0.0   0.0   0:00.08 top</span><br><span class="line"></span><br><span class="line">root@bfdbc798879c:/<span class="comment"># free -mh</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          7.6Gi       1.6Gi       1.8Gi       410Mi       4.3Gi       5.4Gi</span><br><span class="line">Swap:         2.0Gi       0.0Ki       2.0Gi</span><br></pre></td></tr></table></figure><p>让我们先安装一下 <a href="https://linux.die.net/man/1/stress">stress</a> 压力测试工具和系统观测要用到的工具.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y stress sysstat</span><br></pre></td></tr></table></figure><h2 id="CPU-Bound-场景"><a href="#CPU-Bound-场景" class="headerlink" title="CPU Bound 场景"></a>CPU Bound 场景</h2><p>这里我们让三个逻辑 CPU 满载:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 持续 10 min, 3 CPU 满载</span></span><br><span class="line">stress -c 3 -t 600</span><br></pre></td></tr></table></figure><p>我们用 watch 命令持续观察平均负载情况, 平均负载在逐渐变高，此时我的电脑 CPU 风扇也很响了😂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -d uptime</span><br></pre></td></tr></table></figure><p>我们在使用 top 命令可以看到有三个 CPU 已经满载了，使用率百分百，还可以看到是哪个 COMMMAND 造成的，</p><p><img src="https://z3.ax1x.com/2021/10/07/5pfxOK.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/07/5pfxOK.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="TOP 命令查看系统情况"></p><p>但是上面不能很清楚的看到 IO 的情况，接下来我们用 <a href="https://www.linuxcool.com/mpstat">mpstat</a> 每隔 5 秒将所有 CPU 的观测情况打出来：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mpstat -P ALL 5</span><br></pre></td></tr></table></figure><p><img src="https://z3.ax1x.com/2021/10/07/5pfWzq.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/07/5pfWzq.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="所有 CPU 使用情况"></p><p>可以很清楚的看到，的确有三个 CPU 的空闲状态为 0（满载），使用率百分百，且 IO Wait 等待时间是很低的，所以单单 CPU Bound 场景可造成 Average Load 的升高.</p><p>不使用 top 命令,使用 pidstat 每隔 5 秒, 三次打印进程的 CPU 情况可定位出是哪个进程造成的平均负载升高.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@bfdbc798879c:/<span class="comment"># pidstat -u 5 3</span></span><br><span class="line">Linux 5.4.72-microsoft-standard-WSL2 (bfdbc798879c)     10/07/21        _x86_64_        (16 CPU)</span><br><span class="line"></span><br><span class="line">12:01:29      UID       PID    %usr %system  %guest   %<span class="built_in">wait</span>    %CPU   CPU  Command</span><br><span class="line">12:01:34        0       571  100.00    0.00    0.00    0.00  100.00     9  stress</span><br><span class="line">12:01:34        0       572  100.00    0.00    0.00    0.00  100.00    15  stress</span><br><span class="line">12:01:34        0       573  100.00    0.00    0.00    0.00  100.00    11  stress</span><br></pre></td></tr></table></figure><h2 id="IO-Bound-场景"><a href="#IO-Bound-场景" class="headerlink" title="IO Bound 场景"></a>IO Bound 场景</h2><p>stress 压力工具也可以方便的进行 IO Bound 场景的模拟,</p><p>开始之前将上面 CPU Bound 场景给终止, 同样地, 我们先开好一个 Terminal 观察平均负载的变化:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -d uptime</span><br></pre></td></tr></table></figure><p>使用 strees 调起 50 个进程(这里要高于 CPU processors 的数量, 让进程争夺 CPU), 不断打 IO, 持续 10 min:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@bfdbc798879c:/<span class="comment"># stress -i 50 -t 600</span></span><br><span class="line">stress: info: [1756] dispatching hogs: 0 cpu, 50 io, 0 vm, 0 hdd</span><br></pre></td></tr></table></figure><p>可以观察到, 平均负载在不断升高, 再使用 mpstat 可以观测到 IO Wait 很高.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mpstat -P ALL 5</span><br></pre></td></tr></table></figure><p><img src="https://z3.ax1x.com/2021/10/07/5poZCQ.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/07/5poZCQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="IO Bound"></p><p>可以 GET 到 IO Bound 任务的确会造成平均负载升高, 结合 iostat, 我们还可以观测磁盘设备的读写性能情况:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d -x</span><br></pre></td></tr></table></figure><p><img src="https://z3.ax1x.com/2021/10/07/5powb6.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/10/07/5powb6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="iostat"></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 压力测试 </tag>
            
            <tag> CPU Bound </tag>
            
            <tag> IO Bound </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用的 Linux 网络相关的命令</title>
      <link href="2021/09/25/common-use-linux-network-command/"/>
      <url>2021/09/25/common-use-linux-network-command/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>水文警告⚠😂，最近这些玩意用得多，微微记录一下，目前写的比较水，后面应该会补点实践经验🚩。</p><span id="more"></span><h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><p>netstat 一般用于查看 Socket 的使用情况。这命令在 <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/netstat">Windows</a> 下也可直接使用（但参数有一定的差异）。如使用 Ubuntu 需要安装 <a href="https://helpmanual.io/packages/apt/net-tools/">net-tools</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ubuntu</span><br><span class="line">$ apt install net-tools</span><br></pre></td></tr></table></figure><p>常用命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、查看 TCP Socket 情况，TCP 连接的状态</span></span><br><span class="line">$ netstat -at</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">tcp        0      0 172.25.239.216:51430    aerodent.canonical:http TIME_WAIT</span><br><span class="line"><span class="comment"># 2、查看 TCP Socket 统计信息</span></span><br><span class="line">$ netstat -st</span><br><span class="line">Tcp:</span><br><span class="line">    3 active connection openings</span><br><span class="line">    0 passive connection openings</span><br><span class="line">    0 failed connection attempts</span><br><span class="line">    0 connection resets received</span><br><span class="line">    0 connections established</span><br><span class="line">    248 segments received</span><br><span class="line">    195 segments sent out</span><br><span class="line">    5 segments retransmitted</span><br><span class="line">    0 bad segments received</span><br><span class="line">    0 resets sent</span><br></pre></td></tr></table></figure><h2 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h2><p>ss 的作用跟 netstat 很相似，但当服务器连接数非常多的时候，执行速度比 netstat <a href="https://stackoverflow.com/a/11778337">快很多</a>，如果 <code>man netstat</code> 一下，netstat 的手册中也推荐使用 ss。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ man netstat</span><br><span class="line">NOTES</span><br><span class="line">       This program is mostly obsolete.  Replacement <span class="keyword">for</span> netstat is ss.  Replacement <span class="keyword">for</span> netstat -r is ip route.  Replacement <span class="keyword">for</span> netstat -i  is  ip  -s</span><br><span class="line">       link.  Replacement <span class="keyword">for</span> netstat -g is ip maddr.</span><br></pre></td></tr></table></figure><p>常用命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、显示 TCP Socket 使用状况</span></span><br><span class="line">$ ss -t -a</span><br><span class="line">State       Recv-Q Send-Q    Local Address:Port     Peer Address:Port</span><br><span class="line">ESTABLISH   0      0         172.16.0.12:46148      13.229.188.59:https</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、列出所有打开的端口，配合 grep，可查看指定端口使用情况</span></span><br><span class="line">$ ss -pl | grep 8080</span><br></pre></td></tr></table></figure><h2 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h2><p>域名查询工具，一般用于查看主机 DNS 轮询解析状况。一般 Linux 系统都会自带这个命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">$ apt-get install dnsutils</span><br></pre></td></tr></table></figure><p>常用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、指定 DNS Server 查看域名 DNS 解析情况</span></span><br><span class="line">$ dig @8.8.8.8 shansan.top</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @8.8.8.8 shansan.top</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 44094</span></span><br><span class="line"><span class="string">;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; OPT PSEUDOSECTION:</span></span><br><span class="line"><span class="string">; EDNS: version: 0, flags:; udp: 512</span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;shansan.top.                   IN      A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">shansan.top.            600     IN      CNAME   yeshan333.github.io.</span></span><br><span class="line"><span class="string">yeshan333.github.io.    3600    IN      A       185.199.108.153</span></span><br><span class="line"><span class="string">yeshan333.github.io.    3600    IN      A       185.199.109.153</span></span><br><span class="line"><span class="string">yeshan333.github.io.    3600    IN      A       185.199.110.153</span></span><br><span class="line"><span class="string">yeshan333.github.io.    3600    IN      A       185.199.111.153</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 160 msec</span></span><br><span class="line"><span class="string">;; SERVER: 8.8.8.8#53(8.8.8.8)</span></span><br><span class="line"><span class="string">;; WHEN: Sat Sep 25 21:00:48 CST 2021</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 137</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 2、查看指定 DNS 类型记录，如 CNAME</span></span><br><span class="line"><span class="string">$ dig shansan.top CNAME</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 3、反向解析 IP 地址对应域名</span></span><br><span class="line"><span class="string">$ dig -x 8.8.8.8 +short</span></span><br></pre></td></tr></table></figure><h2 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h2><p>nslookup 命令的作用和 dig 命令类似，在 Windows 下的 <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup">PowerShell</a> &amp; Linux 可以直接使用。</p><p>常用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、指定 DNS Server 查询域名解析信息</span></span><br><span class="line">➜ nslookup shan333.cn f1g1ns1.dnspod.net</span><br><span class="line">Server:         f1g1ns1.dnspod.net</span><br><span class="line">Address:        61.151.180.44<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Name:   shan333.cn</span><br><span class="line">Address: 111.230.58.139</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于 Docker 搭建一个最小化的 Prometheus Federation「联邦」集群</title>
      <link href="2021/08/28/prometheus-federation/"/>
      <url>2021/08/28/prometheus-federation/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>一不小心就八月末了，我敲，最近大部分的时间都在了解 Prometheus，一直想“搂”篇文章出来，奈何一直在墨迹，是时候了，不然就九月了，完不成博客的 Flag 了，233333。</p></blockquote><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇文章主要介绍了 Promethues Federation 集群化机制 &amp; 基于 Docker 搭建一个最小化的 Prometheus Federation 集群娱乐环境的相关操作。不是 Step By Step 的。</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/%E4%B9%B1%E6%9D%80.gif" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/%E4%B9%B1%E6%9D%80.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="乱杀"></p><span id="more"></span><h2 id="Prometheus"><a href="#Prometheus" class="headerlink" title="Prometheus"></a>Prometheus</h2><p>先回顾一下 Prometheus 的各个生态组件，了解下它们各自承担的责任是是什么。基于下面一张来自 Prometheus 官方文档的架构 &amp; 生态组件图做下简介：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/prometheus_architecture.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/prometheus_architecture.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Prometheus Architecture &amp;  Ecosystem Components"></p><ul><li>Prometheus targets（Jobs/exporters）：提供监控 Metrics 的数据源，Prometheus 是基于拉（Pull-Based）模型的监控系统；</li><li>Pushgateway：Metrics 推送网关，Prometheus 拉取 Metrics 是有时间间隔的，有时候一些短时任务（Short-lived jobs）没有等到 Prometheus 过来拉取其 Metrics 就没了，所以提供了一个这样的组件让 Jobs 主动推送 Metrics 到作为中介的 Pushgateway 组件；</li><li>Prometheus Server：核心组件<ul><li>Retrieval：Prometheus 的通过 yaml 配置文件进行配置的，可以配置 Prometheus 拉取 Metrics 的时间间隔，告警规则计算配置，爬取数据源配置等能力；</li><li>TSDB：Prometheus 内置的本地存储时间序列数据库，该数据库经历了从原型到 V1 到现在 V2 版本的演进，做了许多的优化，想了解更多细节可以看看这篇文章 <a href="https://zhenghe-md.github.io/blog/2020/02/27/The-Evolution-of-Prometheus-Storage-Layer/">The Evolution of Prometheus Storage Layer</a>；Exporters 是基于文本格式进行 Metrics 的暴露的， V2 版本Prometheus 放弃了原有的 Protocol Buffers 序列化协议，实现了 Text Decoder，优化了性能，官方对此更多的考虑可以看看这篇文档： <a href="https://github.com/OpenObservability/OpenMetrics/blob/main/legacy/markdown/protobuf_vs_text.md">protobuf_vs_text</a>；</li><li>HTTP Server：提供了与 TSDB 和 Prometheus 交互的 HTTP API，方便在更多的场景下做一些自定义操作；</li></ul></li><li>Service discovery：服务发现机制，Prometheus 内置了基于文本文件、DNS Server和 Consul 的服务发现机制（都可以在配置文件进行配置），规模化监控场景下，方便发现 Prometheus 的爬取对象进行 Metrics 拉取；</li><li>Alertmanager：告警通知组件，提供了告警分组，告警抑制（Inhibit），告警静默（Silence），邮件通知，WebHook 等机制；值得注意的是 Prometheus Server 提供了告警规则的计算能力，但是通知并不由它完成，而是由 Alertmanager 完成。告警通知是个重活，并不简单。文章<a href="https://aleiwu.com/post/alertmanager/">搞搞 Prometheus: Alertmanager</a> 对 Alertmanager 进行了深层次的分析，可以微微看下；</li><li>PromQL：Prometheus 提供的一个 DSL，同于用于时序数据的查询与聚合运算等操作，告警规则（Alerting Rules &amp; Recording Rules）的计算也用到了 PromQL；</li><li>Prometheus Web UI：Prometheus 自带的一个 Web UI，提供了许多的数据可视化能力，但其对可视化图表的支持有限，所以社区出现了 Grafana 可视化工具，其提供的 Dashboard 管理能力是很强大的，但仍然有缺点，比如这篇文章就说了一点 <a href="https://xie.infoq.cn/article/be5d880666c29c66b7eff65dc">如何使 Grafana as code</a>。</li></ul><h2 id="Federation-机制"><a href="#Federation-机制" class="headerlink" title="Federation 机制"></a>Federation 机制</h2><p>Pormetheus Federation（联邦）机制是 Promehteus 本身提供的一种集群化的扩展能力。当我们要监控的服务很多的时候，我们会部署很多的 Prometheus 节点分别 Pull 这些服务暴露的 Metrics，Federation 机制可以讲这些分别部署的 Prometheus 节点所获得的指标聚合起来，存放在一个中心点的 Prometheus。如下图：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/20210828210143.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/20210828210143.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Federation"></p><p>在 Prometheus 的配置配置文件，调整如下字段即可使用 Federation 机制：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;federate&#x27;</span></span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">10s</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">honor_labels:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">&#x27;/federate&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过 match 参数，配置要拉取的 Metrics，</span></span><br><span class="line">    <span class="comment"># 不要 Pull full metrics</span></span><br><span class="line">    <span class="attr">params:</span></span><br><span class="line">      <span class="string">&#x27;match[]&#x27;</span><span class="string">:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;&#123;job=&quot;prometheus&quot;&#125;&#x27;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;&#123;job=&quot;node&quot;&#125;&#x27;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;&#123;job=&quot;blackbox&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="comment"># 其他 Prometheus 节点</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;prometheus-follower-1:9090&#x27;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;prometheus-follower-2:9090&#x27;</span></span><br></pre></td></tr></table></figure><p>关于 Federation 联邦集群更多的讨论可以看看：<a href="https://segmentfault.com/a/1190000039931588">别再乱用prometheus联邦了，分享一个multi_remote_read的方案来实现prometheus高可用</a></p><p>基于服务功能分区，我们可以通过 Federation 集群的特性在任务级别对 Prometheus 采集任务进行划分，以支持规模的扩展。</p><h2 id="基于-Docker-搭建最小化的-Federation-集群"><a href="#基于-Docker-搭建最小化的-Federation-集群" class="headerlink" title="基于 Docker 搭建最小化的 Federation 集群"></a>基于 Docker 搭建最小化的 Federation 集群</h2><p>上文微微 Recap 了一下 Prometheus「普罗米修斯」相关知识，现在回到最小化 Federation 的搭建，本次要搭建的一个最小化 Federation 集群（Architecture）如下图：</p><p><img src="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/20210828211705.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/yeshan333/blog_images@main/images/20210828211705.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Minimal Federation"></p><p>可以看到，这里我们使用了两个 Prometheus Follower Container 分别对 Node Exporter 和 Black Exporter 暴露的主机状态相关的 Metrics 和 网络状况相关的 Metrics 进行拉（Pull）取，然后通过一个中心的 Prometheus Leader 对上述指标进行聚合。我们还分别给 Leader 和 一个 Follower 部署了可视化面板 Grafana 用于查看 Metrics。Alertmanager 也通过容器化的方式启动。</p><p>告警的通知基于 WebHook，这里使用到了钉钉群机器人，配置了主机内存 &amp; CPU 使用情况的告警，规则如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">targets</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">monitor_service_down</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">up</span> <span class="string">==</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">critical</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;Monitor service non-operational&quot;</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">&quot;Service <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> is down.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">host</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">high_cpu_load</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">node_load1</span> <span class="string">&gt;</span> <span class="number">1.5</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;Server under high load&quot;</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">&quot;Docker host is under high load, the avg load 1m is at <span class="template-variable">&#123;&#123; $value&#125;&#125;</span>. Reported by instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> of job <span class="template-variable">&#123;&#123; $labels.job &#125;&#125;</span>.&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">high_memory_load</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">(sum(node_memory_MemTotal_bytes)</span> <span class="bullet">-</span> <span class="string">sum(node_memory_MemFree_bytes</span> <span class="string">+</span> <span class="string">node_memory_Buffers_bytes</span> <span class="string">+</span> <span class="string">node_memory_Cached_bytes)</span> <span class="string">)</span> <span class="string">/</span> <span class="string">sum(node_memory_MemTotal_bytes)</span> <span class="string">*</span> <span class="number">100</span> <span class="string">&gt;</span> <span class="number">45</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;Server memory is almost full&quot;</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">&quot;Docker host memory usage is <span class="template-variable">&#123;&#123; humanize $value&#125;&#125;</span>%. Reported by instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> of job <span class="template-variable">&#123;&#123; $labels.job &#125;&#125;</span>.&quot;</span></span><br></pre></td></tr></table></figure><p>我们通过 Docker Volume 挂载的方式讲 Prometheus 的配置文件和告警规则文件挂载到对应的识别路径；Grafana 的 Dashboard 与登陆相关的配置我们也基于此方式。Prometheus 的更多配置可参考 <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/">prometheus configuration</a>：；Grafana 更多的配置参数可以参考：<a href="https://grafana.com/docs/grafana/latest/administration/provisioning/">Grafana Provisioning</a>。</p><p>Federation 集群的通信我们创建了一个 Docker Network「monitoring_network」。我们使用 Docker—Compose 进行容器的编排，编排文件内容如下：</p><details ><summary> docker-compose.yml </summary>              <div class='content'>              <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.5&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">    <span class="attr">monitoring_network:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">    <span class="attr">prometheus_leader_data:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">prometheus_follower_1_data:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">prometheus_follower_2_data:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">grafana_leader_data:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">grafana_follower_data:</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">prometheus-leader:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">prometheus-leader</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">prom/prometheus</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-leader/prometheus.yml:/etc/prometheus/prometheus.yml</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-leader/alerts/alert.rules:/etc/prometheus/alert.rules</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">prometheus_leader_data:/prometheus</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9090:9090&quot;</span></span><br><span class="line">        <span class="attr">command:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--config.file=/etc/prometheus/prometheus.yml&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--storage.tsdb.path=/prometheus&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.libraries=/etc/prometheus/console_libraries&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.templates=/etc/prometheus/consoles&#x27;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">prometheus-follower-1:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">prometheus-follower-1</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">prom/prometheus</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-follower-1/prometheus.yml:/etc/prometheus/prometheus.yml</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-follower-1/records/node_exporter_recording.rules:/etc/prometheus/node_exporter_recording.rules</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-follower-1/alerts/node_exporter_alert.rules:/etc/prometheus/node_exporter_alert.rules</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">prometheus_follower_1_data:/prometheus</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9099:9090&quot;</span></span><br><span class="line">        <span class="attr">command:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--config.file=/etc/prometheus/prometheus.yml&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--storage.tsdb.path=/prometheus&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.libraries=/etc/prometheus/console_libraries&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.templates=/etc/prometheus/consoles&#x27;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">prometheus-follower-2:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">prometheus-follower-2</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">prom/prometheus</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/prometheus-follower-2/prometheus.yml:/etc/prometheus/prometheus.yml</span></span><br><span class="line">            <span class="comment"># - ./configs/prometheus-follower-2/records/node_exporter_recording.rules:/etc/prometheus/node_exporter_recording.rules</span></span><br><span class="line">            <span class="comment"># - ./configs/prometheus-follower-2/alerts/node_exporter_alert.rules:/etc/prometheus/node_exporter_alert.rules</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">prometheus_follower_2_data:/prometheus</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9098:9090&quot;</span></span><br><span class="line">        <span class="attr">command:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--config.file=/etc/prometheus/prometheus.yml&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--storage.tsdb.path=/prometheus&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.libraries=/etc/prometheus/console_libraries&#x27;</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;--web.console.templates=/etc/prometheus/consoles&#x27;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">grafana_leader:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">grafana_leader</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">grafana/grafana</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/grafana-leader/provisioning/dashboards:/etc/grafana/provisioning/dashboards</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/grafana-leader/provisioning/datasources/config.yml:/etc/grafana/provisioning/datasources/config.yml</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">grafana_leader_data:/etc/grafana</span></span><br><span class="line">        <span class="attr">environment:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">TERM=linux</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_SECURITY_ADMIN_USER=admin</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_SECURITY_ADMIN_PASSWORD=admin123456</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">grafana_follower:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">grafana_follower</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">grafana/grafana</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/grafana-follower/provisioning/dashboards:/etc/grafana/provisioning/dashboards</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/grafana-follower/provisioning/datasources/config.yml:/etc/grafana/provisioning/datasources/config.yml</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">grafana_follower_data:/etc/grafana</span></span><br><span class="line">        <span class="attr">environment:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">TERM=linux</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_SECURITY_ADMIN_USER=admin</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">GF_SECURITY_ADMIN_PASSWORD=admin123456</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;3001:3000&quot;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">node_exporter:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">quay.io/prometheus/node-exporter:latest</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">node_exporter_stats</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9100:9100&quot;</span></span><br><span class="line">        <span class="attr">expose:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9100&quot;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">blackbox_exporter:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">prom/blackbox-exporter</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">blackbox_exporter</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9115:9115&quot;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">alertmanager:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">prom/alertmanager</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">alertmanager</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/alertmanager/alertmanager.yml:/etc/alertmanager/alertmanager.yml</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;9093:9093&quot;</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">dingtalk-robot:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">timonwong/prometheus-webhook-dingtalk</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">dingtalk-robot</span></span><br><span class="line">        <span class="attr">networks:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">monitoring_network</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;8060:8060&quot;</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./configs/dingtalk/config.yml:/etc/prometheus-webhook-dingtalk/config.yml</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>dingtalk 通知的配置参考了这篇文章：<a href="https://theo.im/blog/2017/10/16/release-prometheus-alertmanager-webhook-for-dingtalk/">将钉钉接入 Prometheus AlertManager WebHook</a>。</p><p>已经相关的配置文件和容器编排文件上传到了 GitHub，更多的配置细节可以到 GitHub 的项目仓库 <a href="https://github.com/yeshan333/prometheus-federation-minimal-demo">yeshan333/prometheus-federation-minimal-demo</a> 查看，也可将该项目 clone 到本地，跑一下看看：</p><ul><li>1、git clone；</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/yeshan333/prometheus-federation-minimal-demo</span><br><span class="line">cd prometheus-federation-minimal-demo</span><br></pre></td></tr></table></figure><ul><li>2、更换钉钉机器人的 WebHook 地址，机器人配置的 Webhook 地址在 <code>configs/dingtalk/config.yml</code> 文件；</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim configs/dingtalk/config.yml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">targets:</span></span><br><span class="line">  <span class="attr">webhook1:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://oapi.dingtalk.com/robot/send?access_token=&lt;dingtalk-robaot-access-token&gt;</span></span><br></pre></td></tr></table></figure><ul><li>3、通过 docker-compose 启动联邦集群，你可能需要安装 Docker &amp; docker-compose，可参考：<a href="https://docs.docker.com/get-docker/">Get Docker</a>；</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><ul><li>4、期待的容器运行状况如下：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker-compose ps</span></span><br><span class="line">NAME                    COMMAND                  SERVICE                 STATUS              PORTS</span><br><span class="line">alertmanager            &quot;/bin/alertmanager -…&quot;   alertmanager            running             0.0.0.0:9093-&gt;9093/tcp, :::9093-&gt;9093/tcp</span><br><span class="line">blackbox_exporter       &quot;/bin/blackbox_expor…&quot;   blackbox_exporter       running             0.0.0.0:9115-&gt;9115/tcp, :::9115-&gt;9115/tcp</span><br><span class="line">dingtalk-robot          &quot;/bin/prometheus-web…&quot;   dingtalk-robot          running             0.0.0.0:8060-&gt;8060/tcp, :::8060-&gt;8060/tcp</span><br><span class="line">grafana_follower        &quot;/run.sh&quot;                grafana_follower        running             0.0.0.0:3001-&gt;3000/tcp, :::3001-&gt;3000/tcp</span><br><span class="line">grafana_leader          &quot;/run.sh&quot;                grafana_leader          running             0.0.0.0:3000-&gt;3000/tcp, :::3000-&gt;3000/tcp</span><br><span class="line">node_exporter_stats     &quot;/bin/node_exporter&quot;     node_exporter           running             0.0.0.0:9100-&gt;9100/tcp, :::9100-&gt;9100/tcp</span><br><span class="line">prometheus-follower-1   &quot;/bin/prometheus --c…&quot;   prometheus-follower-1   running             0.0.0.0:9099-&gt;9090/tcp, :::9099-&gt;9090/tcp</span><br><span class="line">prometheus-follower-2   &quot;/bin/prometheus --c…&quot;   prometheus-follower-2   running             0.0.0.0:9098-&gt;9090/tcp, :::9098-&gt;9090/tcp</span><br><span class="line">prometheus-leader       &quot;/bin/prometheus --c…&quot;   prometheus-leader       running             0.0.0.0:9090-&gt;9090/tcp, :::9090-&gt;9090/tcp</span><br></pre></td></tr></table></figure><ul><li>5、查看 Grafana Leader：<a href="http://localhost:3000/">http://localhost:3000</a>，Alertmanager UI：<a href="http://localhost:9093/">http://localhost:9093</a></li></ul><p>End.</p><p>　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　</p>]]></content>
      
      
      <categories>
          
          <category> Monitoring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Prometheus </tag>
            
            <tag> Grafana </tag>
            
            <tag> Federation </tag>
            
            <tag> Docker </tag>
            
            <tag> Monitoring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对下载软件/文件进行校验的工具（Checksum and GPG）</title>
      <link href="2021/07/10/checksum-gpg-tools/"/>
      <url>2021/07/10/checksum-gpg-tools/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前装软件一直都没有验证安装文件的习惯，信息安全意识不高，碰巧最近没啥事，微微写篇文章记录下校验工具（互联网http、https、ftp 服务并没有那么安全，是可以被劫持篡改。老装软件选手了，是该养成个校验文件的习惯了）。</p><p>在互联网下载软件/文件的时候经常会看到官方提供了一段⌈校验和（checksum）⌋或包含校验和的文件供校验。常见的校验和有 md5、SHA 家族等。还有部分软件/文件会提供 GPG 校验文件（signature file, SIG）给下载者进行校验。</p><p>来看看这两种校验方式相关的工具。</p><span id="more"></span><h2 id="校验和校验工具"><a href="#校验和校验工具" class="headerlink" title="校验和校验工具"></a>校验和校验工具</h2><blockquote><p><a href="https://zh.wikipedia.org/wiki/%E6%A0%A1%E9%AA%8C%E5%92%8C">校验和</a>（英语：Checksum）是冗余校验的一种形式。 它是通过错误检测方法，对经过空间（如通信）或时间（如计算机存储）所传送数据的完整性进行检查的一种简单方法。 -来自维基百科</p></blockquote><h3 id="Windows-CertUtil"><a href="#Windows-CertUtil" class="headerlink" title="Windows CertUtil"></a>Windows CertUtil</h3><p>CertUtil 是 Windows 自带的文件校验和计算程序，我们可以通过它计算下载的软件/文件的 checksum 与官方提供的 checksum 作对比。</p><p>在 PowerShell 或 CMD 中可以执行 <code>CertUtil -?</code> 命令查看 CertUtil 支持的参数。CertUtil 的计算文件校验和命令的一般形式为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CertUtil -hashfile &lt;path to file&gt; &lt;hash algorithm&gt;</span><br></pre></td></tr></table></figure><p>CertUtil 支持的校验和计算的哈希算法有 MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512 等。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Usage:</span><br><span class="line">  CertUtil [Options] -hashfile InFile [HashAlgorithm]</span><br><span class="line">  Generate and display cryptographic hash over a file</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -Unicode          -- Write redirected output in Unicode</span><br><span class="line">  -gmt              -- Display times as GMT</span><br><span class="line">  -seconds          -- Display times with seconds and milliseconds</span><br><span class="line">  -v                -- Verbose operation</span><br><span class="line">  -privatekey       -- Display password and private key data</span><br><span class="line">  -pin PIN                  -- Smart Card PIN</span><br><span class="line">  -sid WELL_KNOWN_SID_TYPE  -- Numeric SID</span><br><span class="line">            22 -- Local System</span><br><span class="line">            23 -- Local Service</span><br><span class="line">            24 -- Network Service</span><br><span class="line"></span><br><span class="line">Hash algorithms: MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512</span><br></pre></td></tr></table></figure><p>让我们看个例子，就装个 Go 吧（嘿嘿，最近在装系统，什么软件都没了），直接官方（<a href="https://golang.org/dl/">https://golang.org/dl/</a>）下载 Go 的安装程序，下载页面给出了 SHA256 Checksum。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/10/WpK4aQ.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/10/WpK4aQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Go 下载页"></p>            </div><p>使用 Certutil 计算 go1.16.5.windows-amd64.msi 安装程序的校验和。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CertUtil -hashfile go1.16.5.windows-amd64.msi SHA256</span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/10/WpMUWn.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/10/WpMUWn.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="CertUtil 计算结果"></p>            </div><p>CertUtil 计算结果（322dd8c585f37b62c9e603c84747b97a7a65b56fcef56b64e3021ccad90785b2）和下载页提供的校验和（322dd8c585f37b62c9e603c84747b97a7a65b56fcef56b64e3021ccad90785b2）比对，emmm，没毛病，微微放心安装了。</p><p>文档：<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil">microsoft windows-commands certutil</a></p><h3 id="Linux-md5sum"><a href="#Linux-md5sum" class="headerlink" title="Linux md5sum"></a>Linux md5sum</h3><p>md5sum 是大多数 Linux 系统都预装的校验 128 位 MD5 哈希值，用于检查文件完整性的校验和工具。</p><p>命令的一般形式如下，使用 <code>md5sum --help</code> 查看更多操作：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5sum &lt;file-path or files-path&gt;</span><br></pre></td></tr></table></figure><p>输出格式一般示例如下（校验和 + 文件名）</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/10/Wpa4XQ.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/10/Wpa4XQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="md5sum 计算校验和"></p>            </div><p>部分软件下载时会拿到一个类似如下内容格式的 checksum 文件，姑且命名为 demo_hash.md5</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f4e81ade7d6f9fb342541152d08e7a97  .profile</span><br><span class="line">0f077c02d1303b89b9c5cb92e5d7d112  .bashrc</span><br></pre></td></tr></table></figure><p>那么使用 md5sum 进行校验时可以这么操作，md5sum 会自动根据 demo_hash.md5 里面的文件逐个检查 md5：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> md5sum -c demo_hash.md5 <span class="comment"># 加个 `-c` 参数</span></span></span><br><span class="line">.profile: OK</span><br><span class="line">.bashrc: OK</span><br></pre></td></tr></table></figure><p>文档：<a href="https://www.gnu.org/software/coreutils/manual/html_node/md5sum-invocation.html#md5sum-invocation">md5sum-invocation</a></p><h2 id="GPG-key-校验工具"><a href="#GPG-key-校验工具" class="headerlink" title="GPG key 校验工具"></a>GPG key 校验工具</h2><blockquote><p><a href="https://www.gnupg.org/index.html">GPG</a>（GnuPG）是一个实现了 OpenPGP 标准的用于数据加密和数字签名的工具。</p></blockquote><p>互联网上存在着部分软件/文件通过 GPG 密钥进行签名来证明其来源。GitHub 也有着一种使用 GPG 密钥来检验 Git Commit 来源可靠性的手段，如果可靠，会在前端页面 commit log 历史那里显示一个如下的小绿标：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/10/Wps4PA.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/10/Wps4PA.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="GitHub commit signature"></p>            </div><p>btw，之前微微写过一篇文章 -&gt; <a href="https://shansan.top/2020/06/26/%E7%BB%99%20GitHub%20commit%20%E5%8A%A0%E4%B8%AA%E5%B0%8F%E7%BB%BF%E6%A0%87/">给 GitHub commit 加个小绿标</a>。</p><p>使用 GPG key 进行软件/文件校验的一般步骤如下：</p><ul><li>step 1：获取软件/文件作者的<strong>公钥</strong>（public key），导入到 GPG key 管理器；</li><li>step 2：根据作者的 gpg key <strong>指纹</strong>（fingerprint）验证公钥（public key）的可靠性；</li><li>step 3：根据软件/文件的<strong>签名文件</strong>（signature file，SIG）校验来源是否可靠。</li></ul><h3 id="Gpg4win"><a href="#Gpg4win" class="headerlink" title="Gpg4win"></a>Gpg4win</h3><p>Gpg4win 是官方的 Windows GnuPG 发行版，全家桶软件，官网为 <a href="https://gpg4win.org/about.html">gpg4win.org</a>。通过自带的 GUI 客户端 Kleopatra，我们可以很方便的完成文件的校验。直接官网下载安装即可 -&gt; <a href="https://gpg4win.org/get-gpg4win.html">Download Page</a>。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/11/W9YnX9.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9YnX9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Kleopatra"></p>            </div><p>这里我们以 Windows 下 Python 3.9.6 的安装为例，看下使用 Kleopatra 进行校验的过程是怎么样的 ⌈以下操作下载的文件均在同一个目录下⌋。</p><p>先到官方下载页<a href="https://www.python.org/downloads/release/python-396/">release/python-396</a>下载 Windows Python 3.9.6 的安装文件和对应的 GPG 密钥签名文件（sig）：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/10/WpK4aQ.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/10/WpK4aQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="安装文件和签名文件下载"></p>            </div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sSlO https://www.python.org/ftp/python/3.9.6/python-3.9.6-amd64.exe</span><br><span class="line">curl -O https://www.python.org/ftp/python/3.9.6/python-3.9.6-amd64.exe.asc</span><br></pre></td></tr></table></figure><p><img src="https://z3.ax1x.com/2021/07/11/W9tKgg.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9tKgg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="下载 installer &amp; sig 文件"></p><p>现在开始对着之前所的校验步骤操作一下。</p><p><strong>Step 1</strong>：获取软件/文件作者的<strong>公钥</strong>（public key），导入到 GPG key 管理器；</p><p>从 <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a> 页面大概四分之三的地方，我们可以看到之前下载的 Windows Banaries 的 release manager 是 Steve Dower，我们根据官网提供的链接获取<a href="https://keybase.io/stevedower/">公钥</a>。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/11/W9UCmd.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9UCmd.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="获取 Steve Dower 公钥"></p><p><img src="https://z3.ax1x.com/2021/07/11/W9U738.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9U738.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="keybase 上的公钥"></p>            </div><p>下载公钥。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://keybase.io/stevedower/pgp_keys.asc</span><br></pre></td></tr></table></figure><p>使用 Kleopatra 导入下载好的公钥 pgp_keys.asc。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/11/W9wpXF.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9wpXF.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="导入公钥"></p>            </div><p><strong>Step 2</strong>：根据作者的 gpg key <strong>指纹</strong>（fingerprint）验证公钥（public key）的可靠性；</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/11/W9w5NR.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9w5NR.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="验证指纹"></p>            </div><p>导入的公钥指纹与提供的指纹一致，一般就无问题了。</p><p><strong>Step 3</strong>：根据软件/文件的<strong>签名文件</strong>（signature file，SIG）校验来源是否可靠。</p><p>使用之前下载好的 signature file（python-3.9.6-amd64.exe.asc）进行校验，如下：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/07/11/W9Bb0e.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/07/11/W9Bb0e.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="SIG 校验"></p>            </div><p>emmm，没问题。Good job！</p><h3 id="GnuPG-GPG"><a href="#GnuPG-GPG" class="headerlink" title="GnuPG(GPG)"></a>GnuPG(GPG)</h3><p>GnuPG 是之前提到的 Gpg4win 的后端，适合命令行选手。大部分 Linux 系统自带。下面我们在 WSL（Ubuntu-20.04）感受下。</p><p>这里我们以对 <a href="https://www.gnupg.org/download/index.html">GnuPG（LTS） Tarball</a> 的下载校验为例子。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir gnupg_tarball</span><br><span class="line">cd gnupg_tarball</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载 GnuPG（LTS） tarball</span></span><br><span class="line">curl -O https://www.gnupg.org/ftp/gcrypt/gnupg/gnupg-2.2.29.tar.bz2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载校验文件</span></span><br><span class="line">curl -O https://www.gnupg.org/ftp/gcrypt/gnupg/gnupg-2.2.29.tar.bz2.sig</span><br></pre></td></tr></table></figure><ul><li>Step 1：保存公钥，导入公钥。在 <a href="https://www.gnupg.org/signature_key.html">https://www.gnupg.org/signature_key.html</a> 拿到作者的 signature key，保存到 gnupg-2.2.29.asc。</li></ul><details open red><summary> 保存公钥 </summary>              <div class='content'>              <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">➜ cat&gt;gnupg-2.2.29.asc&lt;&lt;EOF</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -----BEGIN PGP PUBLIC KEY BLOCK-----</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br><span class="line"><span class="bash">&gt; mQENBE0ti4EBCACqGtKlX9jI/enhlBdy2cyQP6Q7JoyxtaG6/ckAKWHYrqFTQk3I</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Ue8TuDrGT742XFncG9PoMBfJDUNltIPgKFn8E9tYQqAOlpSA25bOb30cA2ADkrjg</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> jvDAH8cZ+fkIayWtObTxwqLfPivjFxEM//IdShFFVQj+QHmXYBJggWyEIil8Bje7</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> KRw6B5ucs4qSzp5VH4CqDr9PDnLD8lBGHk0x8jpwh4V/yEODJKATY0Vj00793L8u</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> qA35ZiyczUvvJSLYvf7STO943GswkxdAfqxXbYifiK2gjE/7SAmB+2jFxsonUDOB</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 1BAY5s3FKqrkaxZr3BBjeuGGoCuiSX/cXRIhABEBAAG0Fldlcm5lciBLb2NoIChk</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> aXN0IHNpZymJAVUEEwEIAD8CGwMGCwkIBwMCBhUIAgkKCwQWAgMBAh4BAheAFiEE</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 2GkhI8QGXepeDzq1JJs50k8l47YFAl4MxBkFCRShVzYACgkQJJs50k8l47YImQf9</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> HaqHWor+aSmaEwQnaAN0zRa4kPbAWya182aJtsFzLZJf6BbS0aoiMhwtREN/DMvB</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> jzxARKep/cELaM+mc7oDK4mEwqSX/u6BE8D7FaNA9sut8P+4xjpoLPU+UzILMg29</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> t1remjyT9rs6sbu8BqufIxueArkjoi4WCOSRiVTdw+YDd88volPkXlPfS8hg9Rct</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> wZ8kEEDywa+NrxiLx+kDgDNTNdk3PJdfcnesf8S1a+KLUTNRds5+xGTYz0JSQ9BZ</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 7Q9r4VQ/NL55muQZi5W7lVxdp3HxQFUNjHzzBfGtkpS4xqZpJvNjW50Wh5Vi5RYZ</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> LZ3M1EuIHXHmRiY4dmqqcpkBDQRUUDsjAQgA5hBwN9F3OqKf+9mXCXUDK4lb5wMj</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> dti96xG04gAn7wWo7On6c5ntriZQuRdR5GHcdw73XC6CFehHeo/eSVYiWqBNBAfE</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 9UzbkES+cY+4wDzqVacqhKxd70XmHQgyK7ppRG/MwkL1UyArCGGAKN6MV/2fzO6I</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> GQw3jntRue3/2PGGnGaisNAKlvttHWZ91uy4KY5fBM19uQCgZdx4v8/rP0+yQqsW</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> TwJUKvymx5GIfNaCJvgF+v+aPrwspxBMf9jpHXqDXnh4Lo8C/GsQMD6GClVfQjsv</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> vzUHKH2eoL4oNfku+Ua5BuAHYi+uAuzqV9TdpF9PCpQMyPfuuZclMPLdMwARAQAB</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> tDJOSUlCRSBZdXRha2EgKEdudVBHIFJlbGVhc2UgS2V5KSA8Z25paWJlQGZzaWou</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> b3JnPokBPAQTAQgAJgIbAwULBwgJAwQVCAkKBRYCAwEAAh4BAheABQJYDxRZBQkL</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> S5A2AAoJECBxsIozvT8GvG8IAMBIlGz9voYcSSXAdQOuvz2gM2kOjvMHzN6VlS9V</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> P06IjnTz2DnejFZwLmxJw8e8mZjUo0jw22uo1HREQhDrne3S1IazPMeTUCUNzpWF</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> MxXNc6SAyrw9apWa8gouGUWJv3HOwVs8EFA2E9UdtDJ2uG7MY/+eC5K/aeOAyudZ</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> EbvS8rgZypTFrBtBcNKUWZhz7FRn63HxEmYLE3p6I19ZDXrc1WTazF2oz18zym6c</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> uURr6waRbdSemUTshpLnKCBZXzJ82bXBgXNnfdmc3gtS24ZmM3ZfK/rYztEDkiTk</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> s2R1gwDwf5RtDpaf5LD2ufESdbLuT+8blAlscbgYLBcwDquZAY0EWMu6rgEMAKcz</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> vM1IhpUwBpxPCNdrlMZh7XeLqKUd7hUvQ1KHOuDONxCDnfXdxGCKKI0Ds5I7Kkyp</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Wzvcl7PplRy2fYZWwcGtL+Kj01y4L2lXB/xrrVaVwRr4S0FrcbseUGYRafBpR0C1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Yo24CL1ef4ivsfbER2SyaZ3lrT9Ccv6xfvTluhU8X+2li1ssak/Frvy02u3EORLD</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> LxaaLQgANgsjnIjv/JQZ4l3xFIJT98tEoL18btg5lGrS2w4yFU1aa1SNsbp7vcu7</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> wsqcJmCzX98LyG8/IBGJ5JXmZ03yzWhZ3uhhy1+Avi4GV4Mi0ADwaGMp6O63Mc3w</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> SL8A/DoCKJLISOc+D5xNfw6C8sYlaOSzQfqY9l4HW/+QbJmEFL2+bnjSHb8yaVU3</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ae2IIrlNkZ5Jamp12Kq6x9Vei0xGk3gd4sqhmHhECdxoJtkX9L5gt436QxdjiTcW</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> q3V+NNfq94UJu2Ej2kN0fNT0t9RU2n0P/mS0L+1gw5Ex6BX7BIzGL0bZhYomQwAR</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> AQABiQHOBB8BCAA4FiEEW4DFdUKY8MtV2O1qvO9+KUsJLigFAljLwN0XDIABlKXJ</span></span><br><span class="line"><span class="meta">co7CV2&gt;</span><span class="bash"> oDwv5co7CV2OH99yPPRitrECBwAACgkQvO9+KUsJLig2Cgv/T4rXEjHwlbsuTkzp</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> tgK80Dh92URzBAhPhSJ0kUz2b6y7FgVYgZ95u8elGUS4lOB0GOQSK3y4sCgldTQF</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> GQpMuvNMX6oNQTv1Z/H9H7Sc6AntozKRA6LQC+7DMxjPh2DEhVLYNqi7gMXtuH8o</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Xz5+quarw/xbVmuS4UNqcxakd4A/HW6PayRhuju4+oV2+UmGU0etzGVwKSN/UicC</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 3Re3mUy8SwJFQ9/3EAfiY0SGzSWH1z7bTRg9Ga2ctYDNzUpyQsgLxD6ZRHcONkOo</span></span><br><span class="line"><span class="meta">MEQ9&gt;</span><span class="bash"> GUMEQ96BeSsjT4yW9ED70CcCbhg+pMxR+lnpk4BZ4WML/plBjEb8B1YaRvhYWKd3</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> OSVB/JsS6J6Q/y9TTsAJDBLAfw9h7RQKibViuVFSNftAuSdktah5mDwFnL0ZMzVS</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 3tDVDa5PDqbHEhK55/5EWBg4eNbAukVZmmoLzzERGXuj+LOIRElG3/n3chy1uM73</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> B6da3al4gDDNHifPsuozpkVN1EAROZx1K9hGGDZC3yFQTjsJtCRBbmRyZSBIZWlu</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ZWNrZSAoUmVsZWFzZSBTaWduaW5nIEtleSmJAdQEEwEIAD4WIQRbgMV1Qpjwy1XY</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 7Wq8734pSwkuKAUCWMu6rgIbAwUJEswDAAULCQgHAgYVCAkKCwIEFgIDAQIeAQIX</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> gAAKCRC8734pSwkuKEL9DACEIL5IS9wUty62Bnwd9wK2hmwihXNkTLsOOoi8aCdO</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ywPwcIucgAcIO+c/t0lbe4y4sJ1KrKbdyOUQiJAyxobLCSV/MkhIDAmsZB1ZIpF3</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> nfmNekRdCVcMpqX8jAwoBS3Q9m2UJz1LeDCLFCvLF0nbyUnqHZP19UOvxmzAyZMA</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Ub3W5y1+GMo4yA+3xSFI8ZbjzhawixCCRs69/4p+zCXR4e7LBf6koAHllD/0ZULp</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> SDjF+t2IkvRrMlM+e+Mxjklinr8v1FRGzmE/kCcdHaP88+iwC2wUKOZtFs4yIBLO</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> SWdQk9tLPmR8uWgNZmatRJyNvOaxd6EbK3jfckbJGFkmXjH+M9vMqFpoAewZ359F</span></span><br><span class="line"><span class="meta">Us7AX&gt;</span><span class="bash"> qjq+Us7AXLAMNUynom7IrtR5Rvsjx6RNtKQYUD6XY5rc7r9js9iGruHDAAW5lyRg</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> j3wikc0IbV9L1bTsXIp29BsrU9sXUkVEp+xQJZgwqoOduoSjmOK88QdkibDqJiGF</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> dzIRiXx+Nxv1Pr9L7A4/tq+YMwRfQ+WJFgkrBgEEAdpHDwEBB0DPvkeV6RzXomGF</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 8jQwp0RXEt2TGFwwI7RkbpYwECY2l7QfV2VybmVyIEtvY2ggKGRpc3Qgc2lnbmlu</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ZyAyMDIwKYiaBBMWCgBCFiEEbapuZKdtKEBXG0kCUoiXuCZAOtoFAl9D7DUCGwMF</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> CRKFxxEFCwkIBwIDIgIBBhUKCQgLAgQWAgMBAh4HAheAAAoJEFKIl7gmQDraea4A</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> /24v8c50HSC/Basf4WlREkuzhudplo8iT0BGtTQRdGAmAP9gIZ8dBekg9PRlpe7A</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> l7ErThn6owVH9szWrUt6jkKOBg==</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> =h7e4</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -----END PGP PUBLIC KEY BLOCK-----</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">EOF</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>接下来导入公钥到 gpg。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜ cat gnupg-2.2.29.asc | gpg --import</span><br><span class="line">gpg: key 249B39D24F25E3B6: public key &quot;Werner Koch (dist sig)&quot; imported</span><br><span class="line">gpg: key 2071B08A33BD3F06: public key &quot;NIIBE Yutaka (GnuPG Release Key) &lt;gniibe@fsij.org&gt;&quot; imported</span><br><span class="line">gpg: key BCEF7E294B092E28: public key &quot;Andre Heinecke (Release Signing Key)&quot; imported</span><br><span class="line">gpg: key 528897B826403ADA: public key &quot;Werner Koch (dist signing 2020)&quot; imported</span><br><span class="line">gpg: Total number processed: 4</span><br><span class="line">gpg:               imported: 4</span><br></pre></td></tr></table></figure><ul><li>Step 2：查看导入的公钥的指纹是否与官网上公布的一致</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜ gpg --list-keys --keyid-format=long Werner Koch</span><br><span class="line">pub   rsa2048/249B39D24F25E3B6 2011-01-12 [SC] [expires: 2021-12-31]</span><br><span class="line">      D8692123C4065DEA5E0F3AB5249B39D24F25E3B6</span><br><span class="line">uid                 [ unknown] Werner Koch (dist sig)</span><br><span class="line"></span><br><span class="line">pub   ed25519/528897B826403ADA 2020-08-24 [SC] [expires: 2030-06-30]</span><br><span class="line">      6DAA6E64A76D2840571B4902528897B826403ADA</span><br><span class="line">uid                 [ unknown] Werner Koch (dist signing 2020)</span><br></pre></td></tr></table></figure><p>如果一致的话，信任此公钥。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">➜ gpg --edit-key D8692123C4065DEA5E0F3AB5249B39D24F25E3B6</span><br><span class="line">gpg (GnuPG) 2.2.19; Copyright (C) 2019 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pub  rsa2048/249B39D24F25E3B6</span><br><span class="line">     created: 2011-01-12  expires: 2021-12-31  usage: SC</span><br><span class="line">     trust: unknown       validity: unknown</span><br><span class="line">[ unknown] (1). Werner Koch (dist sig)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> sign</span></span><br><span class="line"></span><br><span class="line">pub  rsa2048/249B39D24F25E3B6</span><br><span class="line">     created: 2011-01-12  expires: 2021-12-31  usage: SC</span><br><span class="line">     trust: unknown       validity: unknown</span><br><span class="line"> Primary key fingerprint: D869 2123 C406 5DEA 5E0F  3AB5 249B 39D2 4F25 E3B6</span><br><span class="line"></span><br><span class="line">     Werner Koch (dist sig)</span><br><span class="line"></span><br><span class="line">This key is due to expire on 2021-12-31.</span><br><span class="line">Are you sure that you want to sign this key with your</span><br><span class="line">key &quot;yeshan333 &lt;1329441308@qq.com&gt;&quot; (582AAB66132A3FDA)</span><br><span class="line"></span><br><span class="line">Really sign? (y/N) y</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> save</span></span><br></pre></td></tr></table></figure><p>这玩意还需要一个指纹 sign  公钥，可通过下面的命令快速操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --lsign-key &quot;6DAA6E64A76D2840571B4902528897B826403ADA&quot;</span><br></pre></td></tr></table></figure><blockquote><p>Signing a key tells your software that you trust the key that you have been provided with and that you have verified that it is associated with the person in question.</p></blockquote><ul><li>Step 3：使用 signature file 校验 Tarball</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">➜ gpg --verify gnupg-2.2.29.tar.bz2.sig</span><br><span class="line">gpg: assuming signed data in &#x27;gnupg-2.2.29.tar.bz2&#x27;</span><br><span class="line">gpg: Signature made Sun Jul  4 22:54:50 2021 CST</span><br><span class="line">gpg:                using EDDSA key 6DAA6E64A76D2840571B4902528897B826403ADA</span><br><span class="line">gpg: checking the trustdb</span><br><span class="line">gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span><br><span class="line">gpg: depth: 0  valid:   2  signed:   2  trust: 0-, 0q, 0n, 0m, 0f, 2u</span><br><span class="line">gpg: depth: 1  valid:   2  signed:   0  trust: 2-, 0q, 0n, 0m, 0f, 0u</span><br><span class="line">gpg: next trustdb check due at 2021-12-31</span><br><span class="line">gpg: Good signature from &quot;Werner Koch (dist signing 2020)&quot; [full]</span><br></pre></td></tr></table></figure><p>emmm，问题不大。这里有一丢丢问号❓<a href="https://security.stackexchange.com/questions/41208/what-is-the-exact-meaning-of-this-gpg-output-regarding-trust">What is the exact meaning of this gpg output regarding trust?</a></p><details ><summary> 微微提升下信任水平 </summary>              <div class='content'>              <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">➜ gpg --edit-key 6DAA6E64A76D2840571B4902528897B826403ADA D8692123C4065DEA5E0F3AB5249B39D24F25E3B6</span><br><span class="line">gpg (GnuPG) 2.2.19; Copyright (C) 2019 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pub  ed25519/528897B826403ADA</span><br><span class="line">     created: 2020-08-24  expires: 2030-06-30  usage: SC</span><br><span class="line">     trust: undefined     validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist signing 2020)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Invalid command  (try &quot;help&quot;)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> trust</span></span><br><span class="line">pub  ed25519/528897B826403ADA</span><br><span class="line">     created: 2020-08-24  expires: 2030-06-30  usage: SC</span><br><span class="line">     trust: undefined     validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist signing 2020)</span><br><span class="line"></span><br><span class="line">Please decide how far you trust this user to correctly verify other users&#x27; keys</span><br><span class="line">(by looking at passports, checking fingerprints from different sources, etc.)</span><br><span class="line"></span><br><span class="line">  1 = I don&#x27;t know or won&#x27;t say</span><br><span class="line">  2 = I do NOT trust</span><br><span class="line">  3 = I trust marginally</span><br><span class="line">  4 = I trust fully</span><br><span class="line">  5 = I trust ultimately</span><br><span class="line">  m = back to the main menu</span><br><span class="line"></span><br><span class="line">Your decision? 4</span><br><span class="line"></span><br><span class="line">pub  ed25519/528897B826403ADA</span><br><span class="line">     created: 2020-08-24  expires: 2030-06-30  usage: SC</span><br><span class="line">     trust: full          validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist signing 2020)</span><br><span class="line">Please note that the shown key validity is not necessarily correct</span><br><span class="line">unless you restart the program.</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> save</span></span><br><span class="line">Key not changed so no update needed.</span><br><span class="line"></span><br><span class="line">➜ gpg --edit-key D8692123C4065DEA5E0F3AB5249B39D24F25E3B6</span><br><span class="line">gpg (GnuPG) 2.2.19; Copyright (C) 2019 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gpg: checking the trustdb</span><br><span class="line">gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span><br><span class="line">gpg: depth: 0  valid:   2  signed:   2  trust: 0-, 0q, 0n, 0m, 0f, 2u</span><br><span class="line">gpg: depth: 1  valid:   2  signed:   0  trust: 0-, 1q, 0n, 0m, 1f, 0u</span><br><span class="line">gpg: next trustdb check due at 2021-12-31</span><br><span class="line">pub  rsa2048/249B39D24F25E3B6</span><br><span class="line">     created: 2011-01-12  expires: 2021-12-31  usage: SC</span><br><span class="line">     trust: undefined     validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist sig)</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> trust</span></span><br><span class="line">pub  rsa2048/249B39D24F25E3B6</span><br><span class="line">     created: 2011-01-12  expires: 2021-12-31  usage: SC</span><br><span class="line">     trust: undefined     validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist sig)</span><br><span class="line"></span><br><span class="line">Please decide how far you trust this user to correctly verify other users&#x27; keys</span><br><span class="line">(by looking at passports, checking fingerprints from different sources, etc.)</span><br><span class="line"></span><br><span class="line">  1 = I don&#x27;t know or won&#x27;t say</span><br><span class="line">  2 = I do NOT trust</span><br><span class="line">  3 = I trust marginally</span><br><span class="line">  4 = I trust fully</span><br><span class="line">  5 = I trust ultimately</span><br><span class="line">  m = back to the main menu</span><br><span class="line"></span><br><span class="line">Your decision? 4</span><br><span class="line"></span><br><span class="line">pub  rsa2048/249B39D24F25E3B6</span><br><span class="line">     created: 2011-01-12  expires: 2021-12-31  usage: SC</span><br><span class="line">     trust: full          validity: full</span><br><span class="line">[  full  ] (1). Werner Koch (dist sig)</span><br><span class="line">Please note that the shown key validity is not necessarily correct</span><br><span class="line">unless you restart the program.</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">gpg&gt;</span><span class="bash"> save</span></span><br><span class="line"></span><br><span class="line">➜ gpg --verify gnupg-2.2.29.tar.bz2.sig</span><br><span class="line">gpg: assuming signed data in &#x27;gnupg-2.2.29.tar.bz2&#x27;</span><br><span class="line">gpg: Signature made Sun Jul  4 22:54:50 2021 CST</span><br><span class="line">gpg:                using EDDSA key 6DAA6E64A76D2840571B4902528897B826403ADA</span><br><span class="line">gpg: checking the trustdb</span><br><span class="line">gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span><br><span class="line">gpg: depth: 0  valid:   2  signed:   2  trust: 0-, 0q, 0n, 0m, 0f, 2u</span><br><span class="line">gpg: depth: 1  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 2f, 0u</span><br><span class="line">gpg: next trustdb check due at 2021-12-31</span><br><span class="line">gpg: Good signature from &quot;Werner Koch (dist signing 2020)&quot; [full]</span><br></pre></td></tr></table></figure>              </div>            </details><p>更多 GPG Key 校验工具查看 GnuPG 主页：<a href="https://www.gnupg.org/download/index.html">https://www.gnupg.org/download/index.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Cryptography </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GPG </tag>
            
            <tag> MD5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 osmosfeed 创建自己的 Web RSS 阅读器</title>
      <link href="2021/06/29/osmosfeed-rss-reader/"/>
      <url>2021/06/29/osmosfeed-rss-reader/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>之前一直用 App Store 上的一个 RSS 阅读器 RSS Reader Prime 订阅技术周刊和 dalao 的技术博客，不得不说挺好用的，奈何全线下架了，现在就平板上保留着这个 App，手机上没有（国区好用的 RSS 阅读器基本无了）。有时候又想着用手机读读技术文章（板子太大，不好拿），于是乎翻了下 GitHub <a href="https://github.com/topics/rss-reader">rss-reader topic</a> 下的相关阅读器项目，挑了手基于 Web 和 GitHub Pages 的 RSS 阅读器（Web 才是真的“跨端”，2333~），水篇文章微微记录下。</p><span id="more"></span><h2 id="什么是-RSS"><a href="#什么是-RSS" class="headerlink" title="什么是 RSS"></a>什么是 RSS</h2><blockquote><p><a href="https://baike.baidu.com/item/rss/24470">RSS</a>, Really Simple Syndication. 一种描述和同步网站内容的 XML 格式，一般网站都会提供 RSS，有利于让用户通过 <strong>RSS Feed</strong>（RSS源，一般即为站点的RSS地址） 获取网站内容的最新更新。</p></blockquote><p>更多关于 RSS 的内容在 GitHub 上有个名为 ALL-about-RSS 的项目有介绍。</p><h2 id="使用-osmosfeed-搭建-Web-based-RSS-阅读器"><a href="#使用-osmosfeed-搭建-Web-based-RSS-阅读器" class="headerlink" title="使用 osmosfeed 搭建 Web-based RSS 阅读器"></a>使用 osmosfeed 搭建 Web-based RSS 阅读器</h2><p>osmosfeed 是 GitHub 上开源的一个 RSS Web 版阅读器，可以使用 GitHub Pages 托管，主题可自定义。</p><p>1、首先根据 osmosfeed 的模板仓 <a href="https://github.com/osmoscraft/osmosfeed-template">osmosfeed-template</a> 新建个人仓库。</p><blockquote><p>戳此链接使用模板仓库：<a href="https://github.com/osmoscraft/osmosfeed-template/generate">https://github.com/osmoscraft/osmosfeed-template/generate</a></p></blockquote><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629211254.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629211254.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="通过模板库新建个人公共仓库"></p>            </div><p>2、仓库建好后，GitHub Actions 会自动触发 RSS Web Reader 构建的 action<a href="https://github.com/yeshan333/osmosfeed-rss-reader/blob/main/.github/workflows/update-feed.yaml"><code>Build site on schedule or main branch update</code></a>，构建产物将会被推送到仓库的 gh-pages 分支。</p><p>3、最近 GitHub 更新了波，GitHub Pages 的开启有了新的选项卡，仓库顶部 <code>Settings</code> -&gt; 左侧边栏 <code>Pages</code>，调整发布源分支<em>gh-pages</em>，反手一个 Save 就好了。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629212354.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629212354.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="开启仓库 Pages，源分支为 gh-pages"></p>            </div><p>4、订阅源可直接编辑根目录下的 <a href="https://github.com/yeshan333/osmosfeed-rss-reader/blob/main/osmosfeed.yaml">osmosfeed.yaml</a> 文件，反手把自己博客订阅上👻😎。preview: <a href="https://shansan.top/osmosfeed-rss-reader/">https://shansan.top/osmosfeed-rss-reader/</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cacheUrl: https://GITHUB_USERNAME.github.io/REPO_NAME/cache.json</span></span><br><span class="line"><span class="attr">sources:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">href:</span> <span class="string">https://github.com/osmoscraft/osmosfeed/releases.atom</span> <span class="comment"># Get new feature announcement via this feed</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">href:</span> <span class="string">https://shansan.top/rss2.xml</span></span><br></pre></td></tr></table></figure><p>action 在没有对仓库 main 分支变动的情况下，会每天自动触发一次。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629214608.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210629214608.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="action schedule, crontab.guru"></p>            </div><p>更多操作可参考 osmosfeed 项目的 README：<a href="https://github.com/osmoscraft/osmosfeed">https://github.com/osmoscraft/osmosfeed</a></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
          <category> RSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSS Reader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>热传导方程非特征 Cauchy 问题的一些笔记</title>
      <link href="2021/05/16/heat-conduction-equation/"/>
      <url>2021/05/16/heat-conduction-equation/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>毕设工作即将结束之际，附上一份笔记到博客-数学物理方程-热传导方程.</p><span id="more"></span><h2 id="反问题与不适定问题"><a href="#反问题与不适定问题" class="headerlink" title="反问题与不适定问题"></a>反问题与不适定问题</h2><h3 id="反问题描述"><a href="#反问题描述" class="headerlink" title="反问题描述"></a>反问题描述</h3><div class="note quote"><p>note quote 一对问题称为是互逆的,如果一个问题的构成(已知数据)需要另一个问题解的(部分)信息.把其中一个称为正问题（direct problem）,另一个就称为反问题（inverse problem）.-<a href="https://www.maa.org/programs/maa-awards/writing-awards/inverse-problems">Joseph B.Keller</a></p></div><h3 id="不适定问题的三个判断标准"><a href="#不适定问题的三个判断标准" class="headerlink" title="不适定问题的三个判断标准"></a>不适定问题的三个判断标准</h3><ul><li>问题的解是存在的；</li><li>问题的解是唯一的；</li><li>问题的解是稳定的；</li></ul><blockquote><p>该概念由现法国科学院院士 <a href="https://doi.org/10.1063/1.3061337">J.Hadamard</a> 在耶鲁大学提出. 适定（well-posed）问题 &amp; 不适定（ill-posed）问题.</p></blockquote><p>$$ Ax=y, A: X \rightarrow Y 的线性紧算子 $$</p><p>1、解的存在性：$ \forall y \in Y, \exist x \in X, $ 使得 $ Ax=y. $<br>2、解的唯一性：$ \forall y_1, y_2 \in Y, y_1 \neq y_2, $ 有 $ Ax_1=y_1, Ax_2=y_2, $ 使得 $ x_1 \neq x_2. $<br>3、解的稳定性（即解的连续性）：若有 $ Ax_1=y_1, Ax_2=y_2, $ 则当 $ y_1 \rightarrow y_2 $ 时, 使得 $ x_1 \rightarrow x_2. $</p><div class="note info"><p>note info 当定解条件（初值条件，边界条件）以及方程中的系数有微小变动时，相应的解也只有微小变动. <strong>解的稳定性也称为解关于参数的连续依赖性</strong>.</p></div><h2 id="微分方程"><a href="#微分方程" class="headerlink" title="微分方程"></a>微分方程</h2><blockquote><p>微分方程：包含导数的方程，常用于描述现实事物的变化. 微积分学是一门研究变化的学问. 微分应用包括对速度、加速度、曲线斜率、最优化等的计算.</p></blockquote><ul><li>微分方程的定解条件：即初值条件和边界条件；</li><li>三类边界条件<ul><li>第一类：狄利克雷边界条件（Dirichlet boundary condition）也被称为常微分方程或偏微分方程的“第一类边界条件”，指定微分方程的解在边界处的值. 求出这样的方程的解的问题被称为狄利克雷问题.</li><li>第二类：诺伊曼边界条件（Neumann boundary condition) 也被称为常微分方程或偏微分方程的“第二类边界条件”. 诺伊曼边界条件指定了微分方程的解在边界处的微分.</li><li>第三类：Robbin条件/混合边界条件，未知函数在边界上的函数值和外法向导数的线性组合.</li></ul></li><li>偏微分方程三大问题<ul><li>初边值问题或混合问题：偏微分方程 + 初值条件 + 边界条件；</li><li>初值问题或 Cauchy 问题：偏微分方程 + 初值条件；</li><li>边值问题：偏微分方程 + 边界条件；</li></ul></li><li>方程式与方程组<ul><li>方程式：方程个数为 1；</li><li>方程组：方程个数大于 1；</li></ul></li><li>欠定与超定<ul><li>欠定：方程个数少于未知函数个数；</li><li>超定：方程个数多于未知函数个数；</li></ul></li><li>方程（组）中出现的未知函数的最高阶偏导数的阶数称为方程（组）的阶数.</li></ul><h3 id="数学物理微分方程反问题的分类"><a href="#数学物理微分方程反问题的分类" class="headerlink" title="数学物理微分方程反问题的分类"></a>数学物理微分方程反问题的分类</h3><p>文献<a href="https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CMFD&dbname=CMFD2012&filename=1011261245.nh&v=joX1pOpPDKFRDYlQC3pl9eAy%25mmd2FFR6JQF03PRrUGgLtqHWDNOAV1MZLVHJTWP8lvee">[1]</a>根据以下一般形式的微分方程组，给出了数学物理反问题的五大分类.</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210516235852.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210516235852.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="usual formula"></p><!--$$ \begin{align*}& 微分方程：Lu(x,t)=f(x,t), x \in \Omega, t \in  (0, \infty) \\& 初值条件： Iu(x,t)=\varphi(x), x \in \Omega, t=0 \\& 边界条件： Bu(x,t)=\psi(x,t), x \in \partial \Omega \\& 附加条件： Au(x,t)=k(x,t), x \in \partial \Omega^{\prime}\end{align*}$$--><p>其中 $ u(x,t) $ 为微分方程组的解；$ L, I, B, A $ 分别是微分算子，初始算子，边界算子和附加算子. $ \Omega $ 为求解区域，$ \partial \Omega $ 为求解区域的边界. $ \partial \Omega^{\prime} $ 为 $ \Omega $ 的一部分. $ f(x,t) $ 为方程的右端项，$ \varphi(x), \psi(x,t), k(x,t) $ 分别为初始条件、边界条件和附加条件. 上述任一已量变为未知量，即为微分方程反问题.</p><ul><li>参数识别问题：算子 $ L $ 未知（通常 $ L $ 的结构是已知的，未知的为算子中的参数）；</li><li>寻源反问题：右端方程源项 $ f(x,t) $ 未知；</li><li>逆时反问题：$ \varphi(x) $ 条件未知时，附加条件为系统某一时刻的状态，该反问题从后面的状态去确定初始状态；</li><li>边界控制问题：边界条件 $ \psi(x,t) $ 未知；</li><li>几何反问题：区域边界 $ \partial \Omega $ 未知；</li></ul><p>反问题通常是不适定的，即初始条件上的一个微小的扰动，将导致结果的巨大变化. 克服反问题不适定性是比较棘手的，这也是反问题研究的重要课题.</p><p>随机微分方程解的爆破：在大多数时间里，解是有解的。但存在某一时间点，解趋于 $ \infty $.</p><p>任何一个物理现象都是处在特定条件下的.</p><details green open><summary> 关于反问题的更多描述 </summary>              <div class='content'>              <p>关于反问题的一个比较适用的数学定义是“由定解问题的解的部分信息去求定解问题中的未知成分”. 有效反问题的数值算法以正问题的高精度解法为基础.</p><p>反问题的不适定性主要表现在两个方面: 一方面，由于客观条件限制的输入数据(即给定的解的部分已知信息)往往是欠定的或者是超定的，这就导致解的不唯一性或者是解的不存在性; 另一方面，反问题的解对输入数据往往不具有连续依赖性。由于输入数据中不可避免的测量误差，人们就必须提出由扰动数据求反问题在一定意义下近似解的稳定的方法. 因此，反问题和不适定问题是紧密联系在一起的.</p><p>定解条件都是通过测量和统计而得到的，在测量和统计的过程中误差总是难免的，同时在建立数学模型的过程中也多次用了近似. 如果解的稳定性不成立，那么所建立的定解问题就失去了实际意义. 如果一个定解问题的适定性不成立，就要对定解问题作进一步地修改，直到它具有适定性[3].</p>              </div>            </details><h2 id="热传导方程"><a href="#热传导方程" class="headerlink" title="热传导方程"></a>热传导方程</h2><blockquote><p>Direct heat conduction problems (DHCPs) 直接热传导问题, Inverse heat conduction problem (IHCPs) 逆热传导问题</p></blockquote><h3 id="热传导正-反问题"><a href="#热传导正-反问题" class="headerlink" title="热传导正/反问题"></a>热传导正/反问题</h3><ul><li>热传导反问题：在热交换情形下，通过研究物体内部或边界的一点或多点温度分布信息来反演热源项、初始条件、边界条件、物理的几何条件等未知量.</li><li>热传导方程非特征 Cauchy 问题的[4]：典型的热传导方程的非特征Cauchy问题是通过一部分边界上的或者内部的数据来判定另一部分边界的热流.</li></ul><h3 id="一维热传导方程初边值问题"><a href="#一维热传导方程初边值问题" class="headerlink" title="一维热传导方程初边值问题"></a>一维热传导方程初边值问题</h3><p>有限域上边界条件为第一类 Dirichlet 边界条件的数学模型：</p><!--$$\left\{\begin{aligned}u_t(x,t) & = a^2u_{xx}, \quad (x,t) \in (0,1) \times (0,T)\\u(x,0) & = g(x), \quad \quad \quad x \in [0,1] \\u(0,t) & = f_1(t), \quad \quad \quad t \in [0,T] \\u(1,t) & = f_2(t), \quad \quad \quad t \in [0,T]\end{aligned}\right.$$--><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210517000025.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210517000025.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1D heat conduction equation"><br>求解区域：</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210516203140.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210516203140.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="solution area"></p><h2 id="处理热传导方程非特征-Cauchy-问题的相关方法"><a href="#处理热传导方程非特征-Cauchy-问题的相关方法" class="headerlink" title="处理热传导方程非特征 Cauchy 问题的相关方法"></a>处理热传导方程非特征 Cauchy 问题的相关方法</h2><h3 id="基本解方法"><a href="#基本解方法" class="headerlink" title="基本解方法"></a>基本解方法</h3><p>基本解方法（the method of fundamental solutions, MFS）使用微分算子的基本解去近似数值解.</p><p>热传导方程非特征 Cauchy 问题使用基本解方求解时，数值近似解由以下基本解的线性组合得到[5]：</p><p>$$<br>\begin{array}{c}<br>\tilde{u}(x) = \sum_{i = 1}^{N} a_{i} u^{*}\left(x-\mu_{i}\right)<br>\end{array}<br>$$</p><p>待定系数 $ a_{i} $ 通过对求解区域边界和虚边界进行配置点配置得到. 基本解方法是一种无网格的径向基函数类方法.</p><p>因 Cauchy 问题的不适定性，基本解方法所得到的线性系统是高度病态的，常规方法求解已没有意义. 需要使用正则化方法处理线性系统的病态性.</p><h3 id="正则化方法"><a href="#正则化方法" class="headerlink" title="正则化方法"></a>正则化方法</h3><blockquote><p>正则化方法求解不适定问题的本质是, 对问题的解进行一定的限制, 考虑一个近似的适定问题来保证原问题近似解的稳定性.</p></blockquote><ul><li>Tikhonov 正则化方法</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210517000100.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210517000100.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Tikhonov Regulation Method"></p><p>正则化参数 $ \alpha  $ 的选取.</p><ul><li>确定式方法<ul><li>偏差原则</li><li>拟最优方法</li></ul></li><li>启发式方法<ul><li>广义交叉核式</li><li>L-曲线法则</li></ul></li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li>[1] 张智倍. 热传导方程反问题的若干方法研究[D]. 哈尔滨: 哈尔滨工业大学, 2010.</li><li>[2] 臧顺全. 热传导方程正问题和反问题的数值解研究[D]. 西安: 西安理工大学, 2019.</li><li>[3] 王明新. 数学物理方程[M]. 清华大学出版社, 2005: 1-171.</li><li>[4] 贾现正. 热传导方程中的若干反问题[D]. 上海: 复旦大学, 2005.</li><li>[5] 金邦梯. 一类椭圆型偏微分方程反问题的无网格方法[D]. 杭州: 浙江大学, 2005.</li></ul>]]></content>
      
      
      <categories>
          
          <category> math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单了解波 Mono-repo &amp; Multi-repo（Poly-repo）</title>
      <link href="2021/04/30/term-monorepo-multirepo/"/>
      <url>2021/04/30/term-monorepo-multirepo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>Mono-repo 和 Multi-repo 是软件开发中代码管理的两个不同策略。Mono-repo &amp; Multi-repo 孰优孰劣是个老生常谈得话题了，这里就不 <a href="https://hackernoon.com/mono-repo-vs-multi-repo-vs-hybrid-whats-the-right-approach-dv1a3ugn">PK</a> 了，“略微”看下两者区别。</p><p>当我们使用 Git 作为版本控制系统管理项目的代码时，那么 monorepo 与 multirepo 的定义表述如下：</p><ul><li>monorepo，使用一个 Git 仓库管理项目相关的多个 模块/包/功能/应用。</li><li>multirepo（又称为 polyrepo），使用多个 Git 仓库分别管理项目的每一个 模块/包/功能/应用。</li></ul><span id="more"></span><h2 id="Monorepo-的应用实例"><a href="#Monorepo-的应用实例" class="headerlink" title="Monorepo 的应用实例"></a>Monorepo 的应用实例</h2><p>GitHub 有很多的使用 Monorepo 风格管理代码的开源项目，比如大名鼎鼎的 Babel，项目结构如下图：</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501015251.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501015251.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Babel GitHub Repo"></p>            </div><p>packages 目录下存放了很多个 Babel 相关的子项目。</p><p><a href="https://github.com/paul-hammant/googles-monorepo-demo">googles-monorepo-demo</a>给出了一个基于 Maven 构建工具的 Google 风格的 Monorepo 项目。</p><p>还有大佬给出了有 CI/CD pipeline 基于 Java, Maven, GitHub Actions 的 Demo 👉 <a href="https://github.com/kgunnerud/monorepo-maven-example">monorepo-maven-example</a>。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501021345.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501021345.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="monorepo-maven-example-with-github-actions"></p>            </div><h3 id="使用工具快速搭建-Monorepo-风格的项目"><a href="#使用工具快速搭建-Monorepo-风格的项目" class="headerlink" title="使用工具快速搭建 Monorepo 风格的项目"></a>使用工具快速搭建 Monorepo 风格的项目</h3><p>现今，有许多可以创建 Monorepo 风格项目的工具，在前端社区有 Lerna、Nx、Rush Stack、Yarn Workspaces 等，还有许多其它的构建工具可以用于创建 Monorepo 风格的项目，见项目 -&gt; <a href="https://github.com/korfuri/awesome-monorepo#build-systems--dependency-management-tools">awesome-monorepo</a>。这里让我们看看通过 Nx 创建的 Monorepo 风格的项目是怎么样的：</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501145451.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501145451.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Nx create project"></p>            </div><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501152226.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501152226.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="project structure"></p><p>medium 上有篇文章简述了 11 种不同 Monorepo 构建工具的特点：<a href="">11 Great Tools for a Monorepo in 2021</a></p><h2 id="一图看-Monorepo-和-Multirepo-的区别"><a href="#一图看-Monorepo-和-Multirepo-的区别" class="headerlink" title="一图看 Monorepo 和 Multirepo 的区别"></a>一图看 Monorepo 和 Multirepo 的区别</h2><p>这里我们用一张图来看下使用 Git 管理多个 package 时，Monorepo 和 Multirepo（Polyrepo） 的区别：</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501151658.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/20210501151658.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Monorepo &amp; Multirepo(Polyrepo)"></p>            </div><p>Don’t say so much. 就这样了🤨🕊️，又水了一篇文章。</p>]]></content>
      
      
      <categories>
          
          <category> Architecture </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目管理 </tag>
            
            <tag> Monorepo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows Insiders WSLg Linux GUI App 支持尝鲜</title>
      <link href="2021/04/25/enjoy-wslg/"/>
      <url>2021/04/25/enjoy-wslg/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>2021 年 4 月 21 日，微软在 Developer Blogs 发布了 Windows 预览版 WSL（Windows Linux 子系统） 对 Linux GUI App 的支持的<a href="https://devblogs.microsoft.com/commandline/the-initial-preview-of-gui-app-support-is-now-available-for-the-windows-subsystem-for-linux-2">公告🔗</a>，碰巧😀我最近重装了波电脑，系统换成了 Windows Insiders（Dev），正好可以感受波 Linux GUI App 的支持。btw，预览版的文件管理器支持访问 WSL 的文件了，6~ 的。</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/czJUAO.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/czJUAO.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Windows new icons"></p>            </div><p>WSL 现在居然支持跑 Linux 图形应用了，真香（😎，虽然上一年 WSL 的 <a href="https://devblogs.microsoft.com/commandline/the-windows-subsystem-for-linux-build-2020-summary/#wsl-gui">Roadmap</a> 中有说过要支持，但我没关注，老二手知识党了）。Quickstart -&gt;</p><span id="more"></span><h2 id="WSLg-的架构"><a href="#WSLg-的架构" class="headerlink" title="WSLg 的架构"></a>WSLg 的架构</h2><p><a href="https://github.com/microsoft/wslg">WSLg</a> 是支持 Windows 运行 Linux 图形应用的核心项目， Windows Subsystem for Linux GUI 的简写，看了眼 Git commit，8 天前开源的，🐂。README 里面有张 WSLg 的架构图，略微操作下帖到这里：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/czneit.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/czneit.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="WSLg Architecture"></p>            </div><p>扫了眼，只有 RDP 和 X11 有点印象，这个 Wayland 在最近关于 Ubuntu 21.04 的新闻有看到过，具体原理这里就不了解了，骚就完事了，先跑个 Linux GUI App 感受波。</p><p>已有微软大佬对 WSLg 的架构做了详细的介绍，参见文章：<a href="https://devblogs.microsoft.com/commandline/wslg-architecture/">WSLg Architecture</a></p><h2 id="Windows-Insiders-Dev-跑下-Linux-GUI-App"><a href="#Windows-Insiders-Dev-跑下-Linux-GUI-App" class="headerlink" title="Windows Insiders Dev 跑下 Linux GUI App"></a>Windows Insiders Dev 跑下 Linux GUI App</h2><p>这里又到了经典的环境配置环节（干啥啥不行，老装环境选手了）。不得不说，Windows 系统换成 Insiders 版本真香，WSL 安装一句命令就完事了。虽然又碰到了许久未见到的经典蓝屏问题，但还是阔以接受的，我 giao。</p><p>看波 WSLg 的 README，配下环境，操作系统版本要 21362+，还得微微更新波🤨：</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/czKy26.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/czKy26.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Upgrade Windows System"></p>            </div><p>Sometime later……………….</p><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/czMjOO.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/czMjOO.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Windows insiders version"></p>            </div><p>OK，可以操作了，之前我已经安装过 WSL，且切换到了 v2 版本，so，按照 README 所说，只需要进行如下操作即可。</p><p>以 <strong>Administrator 身份</strong>启动 Powershell 执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、重启下 WSL</span></span><br><span class="line">wsl --shutdown</span><br><span class="line"><span class="comment"># 2、Update</span></span><br><span class="line">wsl --update</span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/cz8Rqf.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/cz8Rqf.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="WSL Update"></p>            </div><p>然后随意装个 GUI App 感受下，装个 gedit 吧：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nautilus 文件管理器，可在 Windows 开始菜单启动 Linux GUI App</span></span><br><span class="line">sudo apt install nautilus -y</span><br><span class="line">sudo apt install gedit -y</span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://z3.ax1x.com/2021/04/25/cz8LLV.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/04/25/cz8LLV.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Windows Desktop Gedit"></p>            </div><p>还阔以，虽然我是“命令行仔”了，但时不时用下 GUI App 还是香的。</p>]]></content>
      
      
      <categories>
          
          <category> WSL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> WSL </tag>
            
            <tag> GUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初探 Git Submodules</title>
      <link href="2021/03/10/git-submodules/"/>
      <url>2021/03/10/git-submodules/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>之前一直想将一个 Git 仓库放到另一个 Git 仓库，有 Maven 多模块项目（Maven Multimodule Project）和 Gradle 多项目构建（Gradle Multiproject Build）那味儿。Git 这么骚，肯定也可以。“扫”了多个开源仓库，Get 到了 Git <code>submodule</code> 可以做这种操作，水篇文章记录波。</p><span id="more"></span><h2 id="没有使用-Git-Submodules-之前"><a href="#没有使用-Git-Submodules-之前" class="headerlink" title="没有使用 Git Submodules 之前"></a>没有使用 Git Submodules 之前</h2><p>没有使用 submodule 之前，如果在一个 Git 项目追踪另一个 Git 项目，会报一个 warning「我敲，有暗示用 submodule，之前没注意」，操作如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir git-submodule</span><br><span class="line">cd git-submodule</span><br><span class="line">git init</span><br><span class="line">git clone https://github.com/volantis-x/hexo-theme-volantis --depth 1</span><br></pre></td></tr></table></figure><p>执行 <code>git add hexo-theme-volantis</code>，会出现如下 warning（adding embedded git repository）：</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310182846.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310182846.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="追踪执行结果"></p>            </div><p>然后使用 <code>git status</code> 查看，虽然 <code>git add</code> 成功了，但是并没有成功 <code>add</code> 到 hexo-theme-volantis 里面的内容。提示也说了（will not contain the contents of the embedded repository），提交到 GitHub 后，显示结果如下， folder 戳也戳不开。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310182904.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310182904.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="push to GitHub"></p>            </div><p>可以明显的看到，并不能保证 子目录/文件 的完整性。就我之前如果想在一个 Git 项目保留另一个 Git 项目，那么我只能将一个项目的 Git 版本库去掉，从后续的使用感受来看，此后我追踪另一个项目的更新会有点麻烦。从 yeshan333/actions-for-hexo-blog 项目的对 volantis 项目追踪的历史commit@3ce9316 可以看得出来 <img src="https://github.com/yeshan333/actions-for-hexo-blog/tree/3ce93169ec7bfd49d91e8dc38415cc08886e052a" class="lazyload" data-srcset="https://github.com/yeshan333/actions-for-hexo-blog/tree/3ce93169ec7bfd49d91e8dc38415cc08886e052a" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="actions-for-hexo-blog@3ce9316"></p><h2 id="Git-Submodules-的作用"><a href="#Git-Submodules-的作用" class="headerlink" title="Git Submodules 的作用"></a>Git Submodules 的作用</h2><p>是时候该见识 submodule 的作用了，从官方文档可以看到，它可以解决之前上面提到的一些问题。略微概括下就是：</p><ul><li>Git的 submodule 可以将一个 Git 版本库<strong>作为一个子目录</strong>保存在另一个 Git 版本库中，并可以保留两个版本库之间 commit 的分离，保持父项目和子项目相互独立，实现更为精确的版本控制。</li></ul><h2 id="Git-Submodules-的本质"><a href="#Git-Submodules-的本质" class="headerlink" title="Git Submodules 的本质"></a>Git Submodules 的本质</h2><p>拿 <a href="https://github.com/yeshan333/actions-for-hexo-blog">actions-for-hexo-blog</a> 项目来实践感受下 submodule。操作如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:yeshan333/actions-for-hexo-blog.git &amp;&amp; cd actions-for-hexo-blog</span><br><span class="line">git submodule add git@github.com:volantis-x/hexo-theme-volantis.git themes/volantis</span><br></pre></td></tr></table></figure><p>执行上述命令之后，会看到当前项目下生成了个 <code>.gitmodules</code> 文件，内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[submodule &quot;themes/volantis&quot;]</span><br><span class="line">path = themes/volantis</span><br><span class="line">url = git@github.com:volantis-x/hexo-theme-volantis.git</span><br></pre></td></tr></table></figure><p>同时，<code>.git/config</code> 文件也会被追加写入如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[submodule &quot;themes/volantis&quot;]</span><br><span class="line">url = git@github.com:volantis-x/hexo-theme-volantis.git</span><br><span class="line">active = true</span><br></pre></td></tr></table></figure><p>再看看 <code>theme/volantis</code> 目录，发现该项目的 Git 版本库不见了，之前提到 <code>git submodule</code> 可以保留两个版本库之间 commit 的分离，那么项目 volantis 的版本库放哪了？摸索下当前项目的版本库可以看到被放在了 <code>.git/modules/themes/volantis</code> 下。尝试提交到 GitHub 看看。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310183050.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310183050.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="GitHub 提交结果"></p>            </div><p>emm……，收工，目录名显示多个 commit 引用，可以进行跳转。</p><h2 id="更多操作"><a href="#更多操作" class="headerlink" title="更多操作"></a>更多操作</h2><ul><li>与 submodule 类似的 subtree：<a href="https://martowen.com/2016/05/01/git-submodules-vs-git-subtrees/">Git Submodules vs Git Subtrees</a></li><li>子模块更新：<code>git submodule update</code></li><li><a href="http://reader.epubee.com/books/mobile/ed/ededfda8184ebf210b5960a5f22be1c7/text00025.html">submodule 最佳实践</a></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 子模块删除</span><br><span class="line">- 删除.gitsubmodule文件中子模块的相关字段；</span><br><span class="line">- 删除.git/config文件中子模块的相关字段；</span><br><span class="line">- 删除模块目录：</span><br><span class="line">- git rm --cached &lt;submodule-path&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 rsync-deploy-action 同步 Hexo 博客到个人服务器</title>
      <link href="2021/01/19/hexo-blog-synchronization-with-rsync/"/>
      <url>2021/01/19/hexo-blog-synchronization-with-rsync/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>前几天写了个基于 rsync 进行文件同步的 Action -&gt; <a href="https://github.com/yeshan333/rsync-deploy-action">rsync-deploy-action</a>。目的有三个：</p><ul><li>1、深入了解波 <a href="https://docs.github.com/en/actions/creating-actions">GitHub Actions</a>，感受下 GitHub 的文档；</li><li>2、个人博客在我的腾讯云 CVM 服务器上是部署有一份的「域名：<a href="https://shan333.cn/">shan333.cn</a>」，之前的博客同步方式是通过 Linux 的定时任务，觉得不太行，当前博客的更新并没有那么频繁，没必要每隔几个小时就 <code>git pull</code> 一下，且服务器还挂着其他东西，性能还是有点损耗的，换成通过 rsync 进行主动推送的方式好点；</li><li>3、熟悉波 SSH 协议和 rsync 协议。</li></ul><p>今天撸一篇文章简单记录下这次折腾。</p><span id="more"></span><h2 id="rsync-deploy-action-的创建"><a href="#rsync-deploy-action-的创建" class="headerlink" title="rsync-deploy-action 的创建"></a>rsync-deploy-action 的创建</h2><p>挑 rsync 协议，不挑 FTP 或 scp 的新建 GitHub Actions 的部分原因是 rsync 可以做增量备份。GitHub Action 有三种类别，即 Docker container、JavaScript 和 Composite run steps。这次手撸的 Action 归属于 GitHub 官方文档介绍的 <a href="https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action">Docker container action</a>。rsync-deploy-action 已经发布到 GitHub 的 Marketplace。源仓库地址：<a href="https://github.com/yeshan333/rsync-deploy-action">https://github.com/yeshan333/rsync-deploy-action</a>。</p><blockquote><p>rsync 与其他文件传输工具（如 FTP 或 scp）不同，rsync 的最大特点是会检查发送方和接收方已有的文件，仅传输有变动的部分（默认规则是文件大小或修改时间有变动）。</p></blockquote><p>rsync-deploy-action 基于 SSH 协议进行文件的远程同步，从元数据文件 action.yml 可以看到，Action 支持 8 个参数「6个必选，2个可选」。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">&#x27;rsync-deploy-action&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;Synchronize files to the remote server using the SSH private key&#x27;</span></span><br><span class="line"><span class="attr">inputs:</span></span><br><span class="line">  <span class="attr">ssh_login_username:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;SSH login username&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">remote_server_ip:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;remote server ip&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">ssh_port:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;remote server SSH port&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">default:</span> <span class="string">&quot;22&quot;</span></span><br><span class="line">  <span class="attr">ssh_private_key:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;login user SSH private key&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">source_path:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;The source storage path of the synchronous files&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">destination_path:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;The destination storage path of the synchronous files&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">ssh_args:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;SSH args&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">rsync_args:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;rsync args&#x27;</span></span><br><span class="line">    <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">outputs:</span></span><br><span class="line">  <span class="attr">start_time:</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;Start time of synchronization&#x27;</span></span><br><span class="line">  <span class="attr">end_time:</span> <span class="comment"># id of output</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&#x27;End time of synchronization&#x27;</span></span><br><span class="line"><span class="attr">runs:</span></span><br><span class="line">  <span class="attr">using:</span> <span class="string">&#x27;docker&#x27;</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">&#x27;Dockerfile&#x27;</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.ssh_login_username</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.remote_server_ip</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.ssh_port</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.ssh_private_key</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.source_path</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.destination_path</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.ssh_args</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">$&#123;&#123;</span> <span class="string">inputs.rsync_args</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branding:</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">&#x27;file&#x27;</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&#x27;green&#x27;</span></span><br></pre></td></tr></table></figure><p>利用 rsync-deploy-action 的 Dockerfile 文件配合 <a href="https://github.com/yeshan333/github-actions-test-repo/runs/1709315134?check_suite_focus=true">Action 执行日志</a>可以一窥 GitHub Actions 背后是如何执行的。 Action 的 <a href="https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idstepswith">with</a> 参数的传递在一定程度上利用了 Dockerfile 的 ENTRYPOINT。</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Container image that runs your code</span></span><br><span class="line"><span class="keyword">FROM</span> alpine:latest</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apk update \</span></span><br><span class="line"><span class="bash"> &amp;&amp; apk upgrade \</span></span><br><span class="line"><span class="bash"> &amp;&amp; apk add --no-cache \</span></span><br><span class="line"><span class="bash">            rsync \</span></span><br><span class="line"><span class="bash">            openssh-client</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copies your code file from your action repository to the filesystem path `/` of the container</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> entrypoint.sh /entrypoint.sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> chmod +x /entrypoint.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Code file to execute when the docker container starts up (`entrypoint.sh`)</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;/entrypoint.sh&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>接下来介绍下利用 rsync-deploy-action 进行 Hexo 博客同步到个人腾讯云 CVM 服务器的过程。</p><h2 id="Hexo-博客同步到云服务器"><a href="#Hexo-博客同步到云服务器" class="headerlink" title="Hexo 博客同步到云服务器"></a>Hexo 博客同步到云服务器</h2><p>由于 rsync 是基于 SSH 协议的，rsync-deploy-action 需要使用到 SSH 私钥，所以需要先创建一个可以进行 SSH 远程登录的用户，不建议直接使用 root 用户。</p><h3 id="SSH-密钥登录"><a href="#SSH-密钥登录" class="headerlink" title="SSH 密钥登录"></a>SSH 密钥登录</h3><p>1、先配置好远程腾讯云 CVM 服务器 SSH 允许密钥登录。编辑 SSH 配置文件 /etc/ssh/sshd_config。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><ul><li>StrictModes yes 改成 StrictModes no （去掉注释后改成 no）</li><li>找到 #PubkeyAuthentication yes 改成 PubkeyAuthentication yes （去掉注释）</li><li>找到 #AuthorizedKeysFile .ssh/authorized_keys 改成 AuthorizedKeysFile .ssh/authorized_keys （去掉注释）</li></ul><p>保存后，重启 sshd。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure><p>2、新建用户 github，用于远程 SSH 免密登录。</p><p>在远程服务器执行如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> root 用户下创建用户 github 并且指定 HOME 目录</span></span><br><span class="line">useradd -d /home/github github</span><br><span class="line"><span class="meta">#</span><span class="bash"> 也可以使用 adduser github，adduser会自动创建 HOME 目录等</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置 github 用户密码，用于后续 SSH 登录公钥的上传</span></span><br><span class="line">passwd github</span><br></pre></td></tr></table></figure><p>3、在本地 PC 执行如下命令，创建用于登录的密钥对。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 生成密钥对</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C &quot;1329441308@qq.com&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将生成的公钥上传到云服务器，server_ip 为服务器 IP 地址，ssh_port 为 SSH 端口号</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub | ssh github@server_ip -p ssh_port &quot;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ssh 密钥登录测试，server_ip 为服务器 IP 地址，ssh_port 为 SSH 端口号</span></span><br><span class="line">ssh -p ssh_port -i ~/.ssh/id_rsa github@server_ip</span><br></pre></td></tr></table></figure><p>以上操作完成没问题之后，即可使用 <a href="https://github.com/yeshan333/rsync-deploy-action">rsync-deploy-action</a> 了，后面以个人 Hexo 博客的同步为例子，简单看下如何使用此 Action。</p><h3 id="Hexo-博客同步"><a href="#Hexo-博客同步" class="headerlink" title="Hexo 博客同步"></a>Hexo 博客同步</h3><p>个人 Hexo 博客之前已经配置过 GitHub Action 的 workflows 进行博客的自动部署「博客源仓库：<a href="https://github.com/yeshan333/actions-for-hexo-blog/blob/master/.github/workflows/hexo-ci.yaml#L54">yeshan333/actions-for-hexo-blog</a>」，所以再添加个 step 给  rsync-deploy-action 即可启用博客同步。step 声明如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Site</span> <span class="string">CI</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">master</span>]</span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">master</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="string">......</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Release</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git config --global user.email &quot;1329441308@qq.com&quot;</span></span><br><span class="line"><span class="string">          git config --global user.name &quot;yeshan333&quot;</span></span><br><span class="line"><span class="string">          git clone git@github.com:yeshan333/yeshan333.github.io.git .deploy_git</span></span><br><span class="line"><span class="string">          chmod 755 -R .deploy_git</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          hexo deploy</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Push</span> <span class="string">to</span> <span class="string">tencentyun</span> <span class="string">CVM</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">yeshan333/rsync-deploy-action@v1.0.0</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ssh_login_username:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SSH_LOGIN_USERNAME</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">remote_server_ip:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.REMOTE_SERVER_IP</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">ssh_port:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SSH_PORT</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">ssh_private_key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SSH_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">source_path:</span> <span class="string">./.deploy_git/*</span></span><br><span class="line">          <span class="attr">destination_path:</span> <span class="string">~/shan333.cn</span></span><br><span class="line">          <span class="attr">rsync_args:</span> <span class="string">--exclude=&quot;./.deploy_git/.git/*&quot;</span></span><br></pre></td></tr></table></figure><p>workflow 中名为 Push to tencentyun CVM 的 <a href="https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idstepswith">step</a> 会将 .deploy_git 下的所有文件上传到云服务器「存放到 ~/shan333.cn 目录下」，熟悉 Hexo 的朋友应该知道 <code>hexo deploy</code> 生成的文件会放在 <code>.deploy_git</code> 目录下，这里用到了 Hexo 的一个 Plugin -&gt; <a href="https://www.npmjs.com/package/hexo-deployer-git">hexo-deployer-git</a>。其实也可以将 <code>hexo generate</code> 生成的 <a href="https://hexo.io/docs/generating.html">public</a> 目录下的所有文件同步到云服务器。</p><p><a href="https://github.com/yeshan333/rsync-deploy-action">rsync-deploy-action</a> 使用到的参数解释「有部分数据也算是隐私数据，这里意思下用了 GitHub 的 <a href="https://docs.github.com/en/actions/reference/encrypted-secrets">repository secrets</a>」：</p><ul><li>ssh_login_username：可以进行 SSH 密钥登录的用户名，即之前配置好的 <strong>github</strong> 用户。</li><li>remote_server_ip：云服务器 IP</li><li>ssh_private_key：SSH 登录用户的私钥，即之前的 ~/.ssh/id_rsa 文件的内容</li><li>source_path：博客相关所有文件路径</li><li>destination_path：同步到云服务器的目标路径<code>~/shan333.cn</code>，即<code>/home/github/shan333.cn</code></li><li>rsync_args：action 的可选参数，.git 目录是没必要同步上传的，排除掉</li></ul><p>“大功告成”。rsync 协议的更多介绍可参考：<a href="https://wangdoc.com/ssh/rsync.html">WangDoc.com rsync</a>。</p><h3 id="More"><a href="#More" class="headerlink" title="More"></a>More</h3><p>个人的腾讯云 CVM 服务器之前为了方便维护安装了个运维面板<a href="https://www.bt.cn/bbs/thread-19376-1-1.html">BT.CN</a>，Hexo 博客是用过 Nginx Serving 的，但 Nginx 是通过运维面板安装的，默认的 user 为 www「宝塔对 Nginx 的配置文件进行了拆分」，但同步后的博客是放在 github 用户的 HOME 目录下的 shan333.cn 目录中的，www 无权限执行博客的相关文件（403 Forbidden），所以需要操作波给 www 用户可执行权限，让 Nginx Worker 可以 serving 博客：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> root 用户下执行，github 目录下的所有文件 755 权限</span></span><br><span class="line">chmod -R 755 /home/github</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将 www 用户添加到 github user group</span></span><br><span class="line">usermod www -G -a github</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://github.com/features/actions">GitHub Actions-Creating actions</a></li><li><a href="https://docs.github.com/en/actions/reference#workflow-syntax">GitHub Actions-Workflow syntax</a></li><li><a href="https://wangdoc.com/ssh/key.html">SSH 密钥登录-网道文档</a></li><li><a href="https://serverfault.com/questions/707955/nginx-split-large-configuration-file">nginx-split-large-configuration-file</a></li><li><a href="https://docs.docker.com/engine/reference/builder/#entrypoint">Dockerfile ENTRYPOINT</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> DevOps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github Actions </tag>
            
            <tag> DevOps </tag>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关注思考的过程，终将更加卓越 | 2020 年总结</title>
      <link href="2021/01/06/2020-annual-reviewed/"/>
      <url>2021/01/06/2020-annual-reviewed/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://s3.ax1x.com/2021/01/07/sZGi24.png" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/07/sZGi24.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="2021 new chapter"></p><span id="more"></span><h2 id="开篇碎语"><a href="#开篇碎语" class="headerlink" title="开篇碎语"></a>开篇碎语</h2><p>2020 年末和 2021 年初在<a href="https://juejin.cn/post/6901125532729999374">掘金社区</a>和 Twitter 看了诸多大佬的 2020 年总结「顺便膜拜 dalao 的同时学习波文法😀，方便写自己的年度总结」。</p><p>2020 年 12 月 08 日，我在 QQ 空间发布了篇“预总结”，特地立了个 flag 🚩『2020年最后一周或者 2021 年第一周把年度总结写出来』，防止自己“赖账”😂。毕竟 2019 年都写了份总结了，2020 年的不能少吧！从那时候开始，就在磨磨唧唧的准备材料，写篇文章不容易啊 /(ㄒoㄒ)/~~。第二次写年度总结，今年写份长点的。</p><p>最近使用了“毕生的 EN 功力”去翻译一篇毕设相关的论文 -&gt; <a href="https://www.sciencedirect.com/science/article/abs/pii/S0955799706001433">《Method of fundamental solutions with regularization techniques for Cauchy problems of elliptic operators》</a>，敲打着一堆的数学公式「Latex 和 plain 混着用」，回顾着诸多<a href="https://en.wikipedia.org/wiki/Partial_differential_equation">偏微分方程（PDE）</a>的知识「裂开了~」，瞬间感觉自己又是一个数学系的学生了。</p><p>话不多说，回到正题，总结来了！</p><h2 id="回顾-2020"><a href="#回顾-2020" class="headerlink" title="回顾 2020"></a>回顾 2020</h2><p>可以注意到，在这篇年度总结的题目中我特别提到了思考，且这一年博客首页的 Banner 换了几次 Title 也是和<strong>“思考过程”</strong>有关的。可以引申出一点 - 这一年，相对于结果的产出，我更关注的是过程的收获-解决问题过程中的思考。校招时部分面试的背书式回答让我很不爽「自己太菜😒」，逼自己了解把某项技术出现的历史与原因，这算是部分原因。另一部分嘛，以前入门时一步一步跟着别人做 demo，跟着别人的思路走，按照别人的方法解决问题，现在深受其害库😥，缺少了点“独立思考”，太不爽了。So，2020 年关注了下<strong>解决问题的思考过程，方案如何高效高质产出</strong>。</p><h3 id="学习-成长"><a href="#学习-成长" class="headerlink" title="学习 - 成长"></a>学习 - 成长</h3><p>谈到学习，这一年看得书不算多，但是感觉还挺硬核。我汲取知识的方式不仅有读书 &amp; 文档 &amp; 博客，还会看一些 dalao 在极客时间开的技术专栏，略微看下我的<a href="https://promo.geekbang.org/activity/report-2020/3EBF3AE4863D57">极客时间 2020 年终报告</a>：</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sVT2Z9.jpg" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sVT2Z9.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="极客时间 2020 年终报告"></p>            </div><p>“有一天肝得太晚了，不得，以后好好摸鱼呀，啊 sir。”</p><p>跟着<a href="https://coolshell.cn/haoel">耗子叔</a>认识了这个平台，剁了好几次手 2333~，不过到现在看来并不亏，相对于视频学习，个人还是比较喜欢这种文字形式的学习的，可以很方便的反复琢磨，通过这个平台还了解到了许多各个领域的 dalao。</p><h4 id="Podcast"><a href="#Podcast" class="headerlink" title="Podcast"></a>Podcast</h4><p>从上一年（2019） GET 到的播客「<a href="https://pythonhunter.org/">捕蛇者说</a>」汲取知识的姿势 2020 年仍然保持着，对个人来说又新颖、又有趣，可以听到 dalao 的声音『小声 bb，校招面试总感觉有个面试官声音在哪里听过🤣』。</p><h4 id="Reading"><a href="#Reading" class="headerlink" title="Reading"></a>Reading</h4><p>这一年看得书还真的不算多，略微罗列下：</p><ul><li>在读，有部分差不多读完了<ul><li>《React 设计模式与最佳实践》</li><li>《计算机是怎样跑起来的》</li><li>《网络是怎样连接的》</li><li>《Python 云原生：构建应对海量用户数据的高可扩展 Web 应用》</li><li>《现代操作系统 原书第四版》</li><li>《云原生 Java》</li><li>《Cloud Native Go 构建基于 Go 和 React 的云原生 Web 应用与微服务》</li><li>《Kubernetes Handbook》</li><li>《TypeScript Deep Dive》</li><li>《大型网站技术架构：核心原理与案例分析》</li><li>《Nginx 高性能与 Web 服务器详解》</li></ul></li><li>今年准备了解下<ul><li>《Go 语言设计与实现》</li><li>《程序员的自我修养 - 链接、装载与库》</li><li>……</li></ul></li></ul><p>这一年，我关注了许多 CS 基础相关「深知与 CS 专业的 dalao 的差距还是很大的」的书籍，为了校招面试，更为了以后更好的发展。今年看的书有部分是和 <a href="https://jimmysong.io/about/">Jimmy Song</a> dalao 相关的，也因这位 dalao 关注上了 Cloud Native。感叹下《Go 语言设计与实现》作者深厚的功底，2021 年想再深入了解波编译原理。</p><h4 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h4><p>到了，Coding 相关的，不得不提 GitHub，作为“资深 GitHub 打卡混子”，除了 Gitee 上为了感受下 DevOps 做的 AI 相关的入门级项目的代码，今年写的大部分代码都以放到了 GitHub 个人公有仓或者私有仓上。看看我的 <a href="https://report.mdnice.com/">GitHub 年度报告</a>，可以大致了解下我的 Coding 情况：</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sZSA2j.jpg" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sZSA2j.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="2020 GitHub annual report"></p>            </div><p>再看看小绿点，这一年过得还算“充实”。</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sZSRdf.png" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sZSRdf.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="GitHub Card"></p>            </div><h3 id="诸多的第一次"><a href="#诸多的第一次" class="headerlink" title="诸多的第一次"></a>诸多的第一次</h3><p>2020 年，有着诸多对于我来说特别有意义的第一次，认识了许多的朋友、dalao。</p><h4 id="第一次一个人的远途"><a href="#第一次一个人的远途" class="headerlink" title="第一次一个人的远途"></a>第一次一个人的远途</h4><p>2020 年的 21 届暑假实习春招，我最终接了一家杭州互联网大厂的 offer，大老远的从桂林跑去杭州实习。这还是我第一次一个人跑这么远，大学入学时还有父母陪同，这真的是第一次跑到杭州这么远的地方。哪个厂？看下图😀「学院社团，瞒天过海，嘿嘿嘿~(<em>^_^</em>)，对不住-对不住」：</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210106231223.jpg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20210106231223.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="HangZhou Netease"></p>            </div><p>顺带一提，第一次白天坐“灰机”，见识了下祖国的大好河山「东南丘陵、江浙平原」。</p><h4 id="第一次实习"><a href="#第一次实习" class="headerlink" title="第一次实习"></a>第一次实习</h4><p>说起实习，这还是我第一次实习「“打工仔”」，不像有些大佬从大一就开始有实习机会了。三个月的实习期都在“混”一个平台的开发，复习巩固 &amp; 学习了挺多的前端、服务端、性能优化相关的技术，这里有 <a href="https://cloudnative.to/">Cloud Native</a> 相关技术的落地，在这里痛快的玩了几下 <a href="https://kubernetes.io/">Kubernetes</a> 和 <a href="https://xebialabs.com/periodic-table-of-devops-tools/">DevOps 元素周期表</a>里面的东西，看了波“传说”中的 <a href="https://pingcap.com/about-cn/">PingCAP</a> dalao 的分享。在这里要非常感谢我的 mentor 给了我很多机会让我实践我的想法，将相关技术、规范融入到平台的开发中来。不得不提的是-我所在的部门归属于 Netease 的一个 AI Lab，很幸运能够了解到前沿 <a href="https://easyai.tech/ai-definition/reinforcement-learning/">RL</a> 相关技术的落地实践，具体就不展开港了。</p><p>在杭州实习认识了几个来自武大、浙大、北大、电子科大、HongKong 的朋友 &amp; 策划dalao、动效dalao、美术dalao，有同厂的也有不同厂的，这些人真的强，我吐了，我一直想跟他们说能不能给点机会，别吊打我了，求放过，疯狂暗示+明示🤪抬几手。和几个大佬开了很多次小灶，涨了很多知识，只想感叹：差距咋这么大，不比了-不必了。</p><h4 id="第一次校招"><a href="#第一次校招" class="headerlink" title="第一次校招"></a>第一次校招</h4><p>2020 年，第一次参加校招（2021届春、秋招），也许是最后一次校招了，无读研打算（“菜”就一个字）。没想到我个菜鸡居然有机会大厂一轮游（BAT、TMD、菊厂、🐖厂等），非常感谢每个面试官给的机会，还顺带给了我非常多成长、沟通方面的建议，印象最深刻的就是美团和鹅厂的面试，知识面打满了，还顺带问了数理统计相关的知识，帮我打通了下知识体系。总得来说，这次校招不亏不亏，拿了几个不算好也不算差的 offer，可能因为我太菜，没能留🐖厂，最终选择了 A 厂，继续努力，期待以后更好的成长。</p><p>再次顺带一提，20 年凑（“白嫖”）了几个厂的小物件。</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/07/selsFU.jpg" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/07/selsFU.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Gift"></p>            </div><h4 id="第一次支持杰哥的演唱会"><a href="#第一次支持杰哥的演唱会" class="headerlink" title="第一次支持杰哥的演唱会"></a>第一次支持杰哥的演唱会</h4><p>作为杰哥将近八年的歌迷，今年听了场网易云音乐的线上演唱会，2333~，终于支持了波杰哥，希望 2021 年有机会线下听一场杰哥的巡回演唱会。</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sZlajI.jpg" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sZlajI.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="WE LIVE 生日演唱会"></p>            </div><h4 id="第一次把自己的笔记本“干掉了”"><a href="#第一次把自己的笔记本“干掉了”" class="headerlink" title="第一次把自己的笔记本“干掉了”"></a>第一次把自己的笔记本“干掉了”</h4><p>2020 年，安奈不住心中的“冲动”，把自己的渣渣笔记本电脑“解剖”了，「特别想换一下，奈何没资本，跑个 IDEA 真费劲，等我入职第一个月 salary 到手，反手“屠”了它」。</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sZlwut.jpg" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sZlwut.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="个人笔记本配置"></p>            </div><h2 id="展望-2021"><a href="#展望-2021" class="headerlink" title="展望 2021"></a>展望 2021</h2><p>一波操作水下来，发现 2020 年过得还凑合。2021 年希望活得更精彩、更快乐。一波面试和实习下来，发现自己各方面的能力还是不行啊，希望今年能学好冰山上层的同时好好提升下冰山下层的能力。</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2021/01/06/sZlXK1.png" class="lazyload" data-srcset="https://s3.ax1x.com/2021/01/06/sZlXK1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="网图-冰山模型"></p>            </div><p>2020 年的开源技术社区参与程度还是不行，2021 年继续努力。2020 年末，有幸受赵老师邀请给上 Linux 课的学弟学妹做了次 Linux 相关的分享，特地回顾了下之前学到的东西，太多纰漏（“虽然我在吹水，而且我也没讲多少 Linux，对不住，哈哈哈，还白嫖了个小米手环~哈哈哈！”）。<a href="https://slide.shan333.cn/slides/20201112/">Slides</a> 「Tip：下图可以拨动哦(<em>^_^</em>)」</p><iframe src="https://slide.shan333.cn/slides/20201112/" width="100%" height="300" frameborder="0" loading="lazy" allowfullscreen></iframe><p>2021 年，坚持输出，希望个人博客更有味道，不只是技术文章，能有点生活味儿~！</p><hr><ul><li><a href="https://shansan.top/2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/">2019 年总结</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021 Happy New Year</title>
      <link href="2021/01/01/2021-new-year/"/>
      <url>2021/01/01/2021-new-year/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://s3.ax1x.com/2020/12/31/rvR7lj.png" class="lazyload" data-srcset="https://s3.ax1x.com/2020/12/31/rvR7lj.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="2020 Happy New Year"></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单耍一下-Kafka</title>
      <link href="2020/12/13/%E8%80%8D%E4%B8%80%E4%B8%8BKafka/"/>
      <url>2020/12/13/%E8%80%8D%E4%B8%80%E4%B8%8BKafka/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>趁着毕设初期，还能摸会儿🐟，了解波 Kafka。</p></blockquote><h2 id="Kafka-术语一览"><a href="#Kafka-术语一览" class="headerlink" title="Kafka 术语一览"></a>Kafka 术语一览</h2><blockquote><p>Kafka，分布式消息引擎系统，主要功能是提供一套完备的消息发布与订阅解决方案。Kafka 也是一个分布式的、分区的、多副本的多订阅者，基于 Zookeeper 协调的分布式日志系统，可用于处理 Web 日志和消息服务。</p></blockquote><ul><li>Topic：主题，承载消息（Record）的逻辑容器，每条发布到 Kafka 集群的消息都归属于某一个 Topic，实际应用中，不同的 topic 对应着不同的业务；</li><li>Broker：Kafka 服务进程，一个 Kafka 集群由多个 Broker 服务进程组成，虽然多个 Broker 可在同一服务器上进行部署，但为了高可用，会将不同的 Broker 部署在不同的机器上；</li><li>Partition：分区，一组有序的消息序列，一个 Topic 可以有多个分区，同一 Topic 下的 Partition 可以分布在不同的 Broker 中。Producer 生产的每一条消息都会被放到一个 Partition 中，每条消息在 Partition 中的位置信息由一个 Offset（偏移量）数据表征。Kafka 通过偏移量（Offset）来保证消息在分区内的顺序性；</li></ul><span id="more"></span><ul><li>Leader：每个 Partition 下可以配置多个 Replica（副本），Replica 由一个 Leader 和多个 Follower 组成，Leader 负责当前 Partition 消息的读写；</li><li>Follower：用于同步 Leader 中的数据，数据冗余，Leader 失效时会从 Followers 中选取；</li><li>Producer：生产者即数据的发布者。Producer 将消息发送给 Kafka 对应的 Topic 中，Broker 接收到消息后，会将消息存储到 Partition 中；</li><li>Consumer：消费者，消费者可以消费多个 Topic 中的消息，一个 Topic 中的消息也可以被多个消费者消费；</li><li>Consumer Group：消费者组，每一个消费者都会归属于某一个消费者组，如果未指定，则取默认的 Group；</li><li>Consumer Offset：消费者位移，用于表示消费者的消费进度；</li></ul><p>与 Kafka 相关的几个问题：</p><div class="tabs" id="kafka-problem"><ul class="nav-tabs"><li class="tab active"><a class="#kafka-problem-1">Kafka 实现高可用的手段</a></li><li class="tab"><a class="#kafka-problem-2">Kafka 实现伸缩性的手段</a></li><li class="tab"><a class="#kafka-problem-3">Zookeeper在Kafka中的作用</a></li><li class="tab"><a class="#kafka-problem-4">Kafka如何实现消息的有序</a></li></ul><div class="tab-content"><div class="tab-pane active" id="kafka-problem-1"><ul><li>Broker 分布式部署</li><li>备份机制（Replacation），把相同的数据拷贝到多台机器上。即 Kafka Replica，Leader Replica 提供数据的读写操作，Follower Replica 负责同步数据。</li></ul></div><div class="tab-pane" id="kafka-problem-2"><p>Partition 机制，一个 Topic 划分为多个 Partition，防止单台 Broker 机器无法容纳太多的数据，Partition 机制与 Replica 机制联系紧密，每个 Partition 可以有多个 Replica（1 Leader + N Followers）。</p></div><div class="tab-pane" id="kafka-problem-3"><blockquote><p>Zookeeper 可为分布式系统提供分布式配置服务、同步服务和命名注册服务。</p></blockquote><ul><li><p>Broker 注册；</p></li><li><p>Topic 注册，Partition 与 Broker 信息的保存；</p></li><li><p>负载均衡服服务，Producer 与 Consumer 的负载均衡；</p></li><li><p>分区与消费者关系的管理；</p></li><li><p>…等</p></li><li><p><a href="https://zhuanlan.zhihu.com/p/41953232">源码解说zookeeper在kafka中的作用</a></p></li></ul></div><div class="tab-pane" id="kafka-problem-4"><p>从前文可知，Kafka 的消息存储在 Topic 中，一个 Topic 又可以划分为多个 Partition，多 Partition 时，Kafka 只能保证 Partition 内的消息有序（Offset保证有序），如需保证 Topic 消息的有序，那么只能使用单个Partition了。如果仍要使用多个 Partition，消息的分区写入策略应选择按键（Key）保存。</p><ul><li><a href="https://www.cnblogs.com/listenfwind/p/12465409.html">详细解析kafka之kafka分区和副本</a></li></ul></div></div></div><h2 id="通过-Go-体验一下-Kafka"><a href="#通过-Go-体验一下-Kafka" class="headerlink" title="通过 Go 体验一下 Kafka"></a>通过 Go 体验一下 Kafka</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>既然只是玩一下，不如使用 Docker 搭建 Kafka 环境吧，“即用即焚”。</p><blockquote><p>环境：Windows 10 Docker Desktop + WSL</p></blockquote><p>这里通过 Docker-Compose 搭建个单机版的 kafka 集群，编排文件如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">zoo1:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zookeeper-one</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">zookeeper:3.4.9</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">zoo1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;2181:2181&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ZOO_MY_ID:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ZOO_PORT:</span> <span class="number">2181</span></span><br><span class="line">      <span class="attr">ZOO_SERVERS:</span> <span class="string">server.1=zoo1:2888:3888</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./zk-single-kafka-single/zoo1/data:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./zk-single-kafka-single/zoo1/datalog:/datalog</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">kafka1:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kafka-one</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">confluentinc/cp-kafka:5.3.1</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">kafka1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9092:9092&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KAFKA_ADVERTISED_LISTENERS:</span> <span class="string">LISTENER_DOCKER_INTERNAL://kafka1:19092,LISTENER_DOCKER_EXTERNAL://$&#123;DOCKER_HOST_IP:-127.0.0.1&#125;:9092</span></span><br><span class="line">      <span class="attr">KAFKA_LISTENER_SECURITY_PROTOCOL_MAP:</span> <span class="string">LISTENER_DOCKER_INTERNAL:PLAINTEXT,LISTENER_DOCKER_EXTERNAL:PLAINTEXT</span></span><br><span class="line">      <span class="attr">KAFKA_INTER_BROKER_LISTENER_NAME:</span> <span class="string">LISTENER_DOCKER_INTERNAL</span></span><br><span class="line">      <span class="attr">KAFKA_ZOOKEEPER_CONNECT:</span> <span class="string">&quot;zoo1:2181&quot;</span></span><br><span class="line">      <span class="attr">KAFKA_BROKER_ID:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">KAFKA_LOG4J_LOGGERS:</span> <span class="string">&quot;kafka.controller=INFO,kafka.producer.async.DefaultEventHandler=INFO,state.change.logger=INFO&quot;</span></span><br><span class="line">      <span class="attr">KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./zk-single-kafka-single/kafka1/data:/var/lib/kafka/data</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zoo1</span></span><br></pre></td></tr></table></figure><p>该编排文件来自：<a href="https://github.com/simplesteph/kafka-stack-docker-compose">https://github.com/simplesteph/kafka-stack-docker-compose</a> 的 zk-single-kafka-single.yml。使用 <code>docker-compose up</code> 启动容器。</p><p>编排文件中所使用到的镜像 <code>confluentinc/cp-kafka:5.3.1</code> 和 <code>zookeeper:3.4.9</code> 配置参考：</p><ul><li><a href="https://hub.docker.com/_/zookeeper">https://hub.docker.com/_/zookeeper</a></li><li><a href="https://hub.docker.com/r/confluentinc/cp-kafka">https://hub.docker.com/r/confluentinc/cp-kafka</a></li></ul><p>Kafka 和 Zookeeper 容器启动后，配合 IDEA 的两个插件 <code>Kafkalytic</code> 和 <code>Zoolytic</code> ，我们可以很方便的观察集群的情况：</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2020/12/14/rmg9W6.png" class="lazyload" data-srcset="https://s3.ax1x.com/2020/12/14/rmg9W6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Cluster Management"></p>            </div><p>通过 vscode 插件我们可以方便的对启动的容器进行管理（日志追踪、shell attach等）：</p><div class="gallery ">              <p><img src="https://s3.ax1x.com/2020/12/14/rnTN0P.png" class="lazyload" data-srcset="https://s3.ax1x.com/2020/12/14/rnTN0P.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="vscode docker plugin"></p>            </div><p>通过 Kafka 自带的命令行工具可以查看 Topic：（先连接到 Kafka 容器：<code>docker exec -it kafka-one bash</code>）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kafka1:/# kafka-topics --describe --zookeeper zoo1:2181</span><br><span class="line">Topic:__confluent.support.metrics       PartitionCount:1        ReplicationFactor:1     Configs:retention.ms=31536000000</span><br><span class="line">        Topic: __confluent.support.metrics      Partition: 0    Leader: 1       Replicas: 1      Isr: 1</span><br><span class="line">Topic:__consumer_offsets        PartitionCount:50       ReplicationFactor:1     Configs:s</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h3 id="使用-confluent-kafka-go-体验-Kafka"><a href="#使用-confluent-kafka-go-体验-Kafka" class="headerlink" title="使用 confluent-kafka-go 体验 Kafka"></a>使用 confluent-kafka-go 体验 Kafka</h3><p>Go 中有两个比较有名的 Go Client，即 <a href="https://github.com/segmentio/kafka-go">kafka-go</a> 和 <a href="https://github.com/confluentinc/confluent-kafka-go">confluent-kafka-go</a>。我都不熟悉😂，但是前面编排时用到了 confluent 公司的 Kafka 镜像，所以这里选用 <code>confluent-kafka-go</code> 创建 Client。confluent-kafka-go 项目的 example 拿来即用。</p><p>1、创建 Go Module</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir go-kafka-demo</span><br><span class="line">cd go-kafka-demo</span><br><span class="line">go mod init github.com/yeshan333/go-kafka-demo</span><br><span class="line">go get -u github.com/confluentinc/confluent-kafka-go</span><br></pre></td></tr></table></figure><p>2、创建 Consumer。这个 Consumer 订阅的 Topic 为 myTopic。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// kafka_consumer.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/confluentinc/confluent-kafka-go/kafka&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">c, err := kafka.NewConsumer(&amp;kafka.ConfigMap&#123;</span><br><span class="line"><span class="string">&quot;bootstrap.servers&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line"><span class="string">&quot;group.id&quot;</span>:          <span class="string">&quot;myGroup&quot;</span>,</span><br><span class="line"><span class="string">&quot;auto.offset.reset&quot;</span>: <span class="string">&quot;earliest&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.SubscribeTopics([]<span class="keyword">string</span>&#123;<span class="string">&quot;myTopic&quot;</span>, <span class="string">&quot;^aRegex.*[Tt]opic&quot;</span>&#125;, <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">msg, err := c.ReadMessage(<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Message on %s: %s\n&quot;</span>, msg.TopicPartition, <span class="keyword">string</span>(msg.Value))</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// The client will automatically try to recover from all errors.</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;Consumer error: %v (%v)\n&quot;</span>, err, msg)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、创建 Producer。这个 Producer 向 myTopic Topic 发送了 7 条消息。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// kafka_producer.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/confluentinc/confluent-kafka-go/kafka&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">p, err := kafka.NewProducer(&amp;kafka.ConfigMap&#123;<span class="string">&quot;bootstrap.servers&quot;</span>: <span class="string">&quot;localhost&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">defer</span> p.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Delivery report handler for produced messages</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> e := <span class="keyword">range</span> p.Events() &#123;</span><br><span class="line"><span class="keyword">switch</span> ev := e.(<span class="keyword">type</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> *kafka.Message:</span><br><span class="line"><span class="keyword">if</span> ev.TopicPartition.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Delivery failed: %v\n&quot;</span>, ev.TopicPartition)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Delivered message to %v\n&quot;</span>, ev.TopicPartition)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Produce messages to topic (asynchronously)</span></span><br><span class="line">topic := <span class="string">&quot;myTopic&quot;</span></span><br><span class="line"><span class="keyword">for</span> _, word := <span class="keyword">range</span> []<span class="keyword">string</span>&#123;<span class="string">&quot;Welcome&quot;</span>, <span class="string">&quot;to&quot;</span>, <span class="string">&quot;the&quot;</span>, <span class="string">&quot;Confluent&quot;</span>, <span class="string">&quot;Kafka&quot;</span>, <span class="string">&quot;Golang&quot;</span>, <span class="string">&quot;client&quot;</span>&#125; &#123;</span><br><span class="line">p.Produce(&amp;kafka.Message&#123;</span><br><span class="line">TopicPartition: kafka.TopicPartition&#123;Topic: &amp;topic, Partition: kafka.PartitionAny&#125;,</span><br><span class="line">Value:          []<span class="keyword">byte</span>(word),</span><br><span class="line">&#125;, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Wait for message deliveries before shutting down</span></span><br><span class="line">p.Flush(<span class="number">15</span> * <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、两个 terminal，先跑 Consumer，再跑 Producer。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> terminal 1</span></span><br><span class="line">go run kafka_consumer.go</span><br><span class="line"><span class="meta">#</span><span class="bash"> ternimal 2</span></span><br><span class="line">go run kafka_producer.go</span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://s3.ax1x.com/2020/12/14/rmcYRK.png" class="lazyload" data-srcset="https://s3.ax1x.com/2020/12/14/rmcYRK.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="run result"></p>            </div><p>收工，其他东西后续慢慢啃。本文源文件：<a href="https://github.com/yeshan333/go-kafka-demo">https://github.com/yeshan333/go-kafka-demo</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://docs.confluent.io/clients-confluent-kafka-go/current/#go-example-code">CONFLUENT-Kafka Go Client</a></li><li><a href="http://kafka.apache.org/documentation/#operations">Apache Kafka Operations</a></li><li><a href="https://github.com/simplesteph/kafka-stack-docker-compose/blob/master/zk-single-kafka-single.yml">kafka-stack-docker-compose</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 中间件 </category>
          
          <category> Kafka </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kafka </tag>
            
            <tag> 消息引擎系统 </tag>
            
            <tag> 流处理平台 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用tcpdump和Wireshark看下TCP握手</title>
      <link href="2020/11/15/%E4%BD%BF%E7%94%A8tcpdump%E5%92%8Cwireshark%E7%9C%8B%E4%B8%8BTCP%E6%8F%A1%E6%89%8B/"/>
      <url>2020/11/15/%E4%BD%BF%E7%94%A8tcpdump%E5%92%8Cwireshark%E7%9C%8B%E4%B8%8BTCP%E6%8F%A1%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>tcpdump 和 Wireshark 是最常用的网络抓包和分析工具，作为经常和网络打交道的划水选手，怎么能不了解下呢？补篇博文回顾下相关操作。这里以 example.com 的一次 GET 请求为例，先使用 tcpdump 抓个包，再使用 Wireshark 看下 TCP 的握手。</p><blockquote><p>操作环境：WSL2(Ubuntu 20.04 LTS) + Windows 10</p></blockquote><span id="more"></span><h2 id="用-tcpdump-抓个包"><a href="#用-tcpdump-抓个包" class="headerlink" title="用 tcpdump 抓个包"></a>用 tcpdump 抓个包</h2><p>先在 WSL2 Ubuntu 安装下 tcpdump。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 wsl</span></span><br><span class="line">wsl</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装 tcpdump</span></span><br><span class="line">apt-get install tcpdump</span><br></pre></td></tr></table></figure><p>抓包需要使用两个终端，一个终端使用 curl 向 example.com 发送请求，一个用于 packets 的抓取。OK，抓包开始：</p><p>1、一个终端使用 tcpdump 监听 example.com。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> terminal 1，监听 example.com 的网络包</span></span><br><span class="line">tcpdump -nn host example.com -w web.pcap</span><br></pre></td></tr></table></figure><p>2、另一个终端使用 curl 发送网络请求。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> terminal 2，发送网络请求</span></span><br><span class="line">curl example.com</span><br></pre></td></tr></table></figure><p>请求发送完毕后，<code>Ctrl + C</code> 终止终端 1 的监听，将抓取结果 <code>wep.pcap</code> 拷贝到 Windows 10 桌面。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv web.pcap /mnt/c/Users/yeshan/Desktop/web.pcap</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/15/DFPm6O.gif" class="lazyload" data-srcset="https://s3.ax1x.com/2020/11/15/DFPm6O.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="操作"></p><h2 id="拿-Wireshark-看下包"><a href="#拿-Wireshark-看下包" class="headerlink" title="拿 Wireshark 看下包"></a>拿 Wireshark 看下包</h2><p>由于 tcpdump 的输出格式并不直观，所以之前将抓取结果写入到 web.pcap。然后这里使用有图形化界面的 Wireshark 去看下刚刚抓下来的网络包 web.pcap。</p><ul><li>下载安装 Wireshark：<a href="https://www.wireshark.org/download.html">https://www.wireshark.org/download.html</a></li></ul><p>1、使用 Wireshark 打开 web.pcap。</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115173534.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115173534.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="wireshark 看包"></p><p>2、使用 Wireshark 的统计工具可以看到 TCP 握手的流程。<code>分析-&gt;流量图</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 确定 example.com ip</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> dig +short example.com</span></span><br><span class="line">93.184.216.34</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174333.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174333.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="流量图"></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174144.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174144.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="TCP 流"></p><p>完美，可以看到经典的 TCP 握手过程。「TCP三次握手，四次挥手：」</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174718.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20201115174718.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="TCP三次握手，四次挥手"></p><p>很香的是 Wireshark 提供了许多示例网络包『<a href="https://gitlab.com/wireshark/wireshark/-/wikis/SampleCaptures#grpc">SampleCaptures</a>』，计网学习新世界？</p>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wireshark </tag>
            
            <tag> 计算机网路 </tag>
            
            <tag> TCP </tag>
            
            <tag> tcpdump </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅解shallow copy、deep copy</title>
      <link href="2020/10/09/%E6%B5%85%E8%A7%A3shallow%20copy%E3%80%81deep%20copy/"/>
      <url>2020/10/09/%E6%B5%85%E8%A7%A3shallow%20copy%E3%80%81deep%20copy/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>“回👋掏”。最近做东西，有点儿玩不转复杂数据类型，写篇博文再回顾下深、浅拷贝相关知识。深、浅的区分主要在对复杂数据类型进行操作的时候。</p><blockquote><p>By the way：时间过得很快，十月了，之前定了个小目标：<code>一个月至少一篇文章产出</code>。2020年的 $ \frac{5}{6} $ 已经过去。很庆幸自己坚持了下来，学到了不少东西。实习期间其实有不少的文章主题的想法，但真正想动手写篇博文的时候，发现事情并没有想想中的那么简单，一个主题涉及到的知识点还是蛮多的，再加上实践经验的不足，有些东西很难写道点上，copy &amp; paste 总是不太好的『努力提高文章质量，hhh~』。希望自己后续继续加油。<br><img src="https://s1.ax1x.com/2020/10/11/0cgxOg.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/10/11/0cgxOg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="一些想法"></p></blockquote><span id="more"></span><h2 id="浅拷贝（shallow-copy）"><a href="#浅拷贝（shallow-copy）" class="headerlink" title="浅拷贝（shallow copy）"></a>浅拷贝（shallow copy）</h2><blockquote><ul><li>浅拷贝总结：新对象内容为<strong>原对象内第一层对象的引用</strong>。</li></ul></blockquote><h3 id="Python-中的浅拷贝"><a href="#Python-中的浅拷贝" class="headerlink" title="Python 中的浅拷贝"></a>Python 中的浅拷贝</h3><p>关键点就在于这第一层对象。让我们先看看 Python 中的浅拷贝。</p><p>先看看不含嵌套元素的情形：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">l1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接赋值，使用 is 比较地址</span></span><br><span class="line">l2 = l1</span><br><span class="line"><span class="built_in">print</span>(l1 <span class="keyword">is</span> l2)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用构造器</span></span><br><span class="line">l3 = <span class="built_in">list</span>(l1)</span><br><span class="line"><span class="built_in">print</span>(l1 <span class="keyword">is</span> l3)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切片</span></span><br><span class="line">l4 = l1[:]</span><br><span class="line"><span class="built_in">print</span>(l1 <span class="keyword">is</span> l4)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(l1), <span class="built_in">id</span>(l2), <span class="built_in">id</span>(l3), <span class="built_in">id</span>(l4))  <span class="comment"># 查看内存地址</span></span><br><span class="line"><span class="comment"># 2124445454144 2124445454144 2124445477568 2124445029248</span></span><br></pre></td></tr></table></figure><p>含嵌套元素的情形：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">l1 = [<span class="number">1</span>, [<span class="number">2</span>,<span class="number">3</span>], <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接赋值</span></span><br><span class="line">l2 = l1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造器</span></span><br><span class="line">l3 = <span class="built_in">list</span>(l1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切片</span></span><br><span class="line">l4 = l1[:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> first, second, third, fourth <span class="keyword">in</span> <span class="built_in">zip</span>(l1, l2, l3, l4):</span><br><span class="line">    <span class="comment"># 查看每层对象的地址</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;value&quot;</span>, first, <span class="string">&quot;address:&quot;</span>, <span class="built_in">id</span>(first), <span class="built_in">id</span>(second), <span class="built_in">id</span>(third), <span class="built_in">id</span>(fourth))</span><br><span class="line"><span class="comment"># value 1 address: 140729744430752 140729744430752 140729744430752 140729744430752</span></span><br><span class="line"><span class="comment"># value [2, 3] address: 1924217248768 1924217248768 1924217248768 1924217248768</span></span><br><span class="line"><span class="comment"># value 4 address: 140729744430848 140729744430848 140729744430848 140729744430848</span></span><br><span class="line"></span><br><span class="line">l4[<span class="number">1</span>].append(<span class="string">&quot;new&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(l1)  <span class="comment"># [1, [2, 3, &#x27;new&#x27;], 4]</span></span><br><span class="line"><span class="built_in">print</span>(l2)  <span class="comment"># [1, [2, 3, &#x27;new&#x27;], 4]</span></span><br><span class="line"><span class="built_in">print</span>(l3)  <span class="comment"># [1, [2, 3, &#x27;new&#x27;], 4]</span></span><br><span class="line"><span class="built_in">print</span>(l4)  <span class="comment"># [1, [2, 3, &#x27;new&#x27;], 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> first, second, third, fourth <span class="keyword">in</span> <span class="built_in">zip</span>(l1, l2, l3, l4):</span><br><span class="line">    <span class="comment"># 查看每层对象的地址</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;value&quot;</span>, first, <span class="string">&quot;address:&quot;</span>, <span class="built_in">id</span>(first), <span class="built_in">id</span>(second), <span class="built_in">id</span>(third), <span class="built_in">id</span>(fourth))</span><br><span class="line"><span class="comment"># value 1 address: 140729744430752 140729744430752 140729744430752 140729744430752</span></span><br><span class="line"><span class="comment"># value [2, 3, &#x27;new&#x27;] address: 1639298767872 1639298767872 1639298767872 1639298767872</span></span><br><span class="line"><span class="comment"># value 4 address: 140729744430848 140729744430848 140729744430848 140729744430848</span></span><br></pre></td></tr></table></figure><p>从上面的示例可以看到，Python中切片操作、工厂函数和<code>=</code>操作均是浅拷贝，只拷贝了原对象的第一层对象的引用，对第一层对象的操作会影响到其它对元对象进行浅拷贝的对象。但<code>=</code>操作和切片、构造器（工厂函数）不同的是，<code>=</code>操作不会创建新的对象。</p><p>值得注意的是，Python 中 tuple 的 tuple() 和切片操作和<code>=</code>进行的拷贝一样，不会创建新的对象。字典的浅拷贝可以使用 dict.copy()。</p><h3 id="JS-中的浅拷贝"><a href="#JS-中的浅拷贝" class="headerlink" title="JS 中的浅拷贝"></a>JS 中的浅拷贝</h3><p>让我们再来看看 JS 中的浅拷贝操作。</p><p>老规矩，先看看简单对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 赋值</span></span><br><span class="line"><span class="keyword">let</span> obj2 = obj1;  <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object.assign</span></span><br><span class="line"><span class="keyword">let</span> obj3 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1);  <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// spread</span></span><br><span class="line"><span class="keyword">let</span> obj4 = &#123;...obj1&#125;;  <span class="comment">// // &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj2.a = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123; a: &#x27;new&#x27;, b: 2 &#125; &#123; a: &#x27;new&#x27;, b: 2 &#125; &#123; a: 1, b: 2 &#125; &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1, obj2, obj3, obj4)</span><br></pre></td></tr></table></figure><p>再看下复杂对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="number">2</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">d</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接赋值</span></span><br><span class="line"><span class="keyword">let</span> obj2 = obj1;  <span class="comment">// &#123; a: &#123; b: 1, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object.assign</span></span><br><span class="line"><span class="keyword">let</span> obj3 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1);  <span class="comment">// &#123; a: &#123; b: 1, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object Spread</span></span><br><span class="line"><span class="keyword">let</span> obj4 = &#123;...obj1&#125;;  <span class="comment">// &#123; a: &#123; b: 1, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"></span><br><span class="line">obj2.a.b = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj1);  <span class="comment">// &#123; a: &#123; b: &#x27;new&#x27;, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2);  <span class="comment">// &#123; a: &#123; b: &#x27;new&#x27;, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj3);  <span class="comment">// &#123; a: &#123; b: &#x27;new&#x27;, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj4);  <span class="comment">// &#123; a: &#123; b: &#x27;new&#x27;, c: 2 &#125;, d: 3 &#125;</span></span><br></pre></td></tr></table></figure><p>可以看到，JS 对象的<code>=</code>操作、Object.assign({}, originObject) 和对象扩展运算均是浅拷贝。但是 Object.assign和对象的扩展运算对只有一层的对象进行的是深拷贝。此外 JS 数组「array 也是 object」的 map、reduce、filter、slice 等方法对嵌套数组进行的也是浅拷贝操作。</p><p><strong>可以明显的看到，JS 和 Python 中的浅拷贝拷贝的均是第一层对象的引用。</strong></p><h2 id="深拷贝（deep-copy）"><a href="#深拷贝（deep-copy）" class="headerlink" title="深拷贝（deep copy）"></a>深拷贝（deep copy）</h2><blockquote><ul><li>深拷贝总结：创建一个新的对象，并且将原对象中的元素，以递归的方式，通过创建新的子对象拷贝到新对象中。深拷贝拷贝了对象的所有元素，包括多层嵌套的元素。</li></ul></blockquote><h3 id="Python-中的深拷贝"><a href="#Python-中的深拷贝" class="headerlink" title="Python 中的深拷贝"></a>Python 中的深拷贝</h3><p>在 Python 中实现复杂对象的拷贝可以通过标准库<a href="https://docs.python.org/zh-cn/3/library/copy.html">copy</a> 提供的 copy.deepcopy 实现，此外 copy 模块还提供了 copy.copy 进行对象的浅拷贝。</p><p>看下深拷贝的情况：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">l1 = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>]</span><br><span class="line">l2 = copy.deepcopy(l1)</span><br><span class="line"></span><br><span class="line">l2[<span class="number">1</span>].append(<span class="string">&quot;new&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(l1)  <span class="comment"># [1, [2, 3], 4]</span></span><br><span class="line"><span class="built_in">print</span>(l2)  <span class="comment"># [1, [2, 3, &#x27;new&#x27;], 4]</span></span><br></pre></td></tr></table></figure><p>可以看到，有别于浅拷贝，对深拷贝 l1 的新对象 l2 的子元素增加新元素，并不会影响到 l1。</p><h3 id="JS-中的深拷贝"><a href="#JS-中的深拷贝" class="headerlink" title="JS 中的深拷贝"></a>JS 中的深拷贝</h3><p>在 JS 中进行复杂对象的深拷贝，可以使用 JSON.stringify 先将 JS 对象转成 JSON 再转 JS 对象，如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="number">2</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">d</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj1));</span><br><span class="line"></span><br><span class="line">obj2.a.b = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj1);  <span class="comment">// &#123; a: &#123; b: 1, c: 2 &#125;, d: 3 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj2); <span class="comment">// &#123; a: &#123; b: &#x27;new&#x27;, c: 2 &#125;, d: 3 &#125;</span></span><br></pre></td></tr></table></figure><p>可以看到，深拷贝后对新对象深层次对象的更改不会使原对象发生变更。</p><h2 id="手动实现深拷贝操作"><a href="#手动实现深拷贝操作" class="headerlink" title="手动实现深拷贝操作"></a>手动实现深拷贝操作</h2><p>在某些情况下需要我们实现深拷贝操作，比如对自定义数据类型进行深拷贝。前面 JS 所述使用 JSON 进行的深拷贝方法仍有缺陷，比如：会忽略 undefined、会忽略 symbol、不能序列化函数、不能解决循环引用的对象。这时候就需要了解波深拷贝的实现了。</p><p>从前面所述可知，深拷贝与浅拷贝的区别主要在于 copy 的层次，浅拷贝 copy 的是第一层对象的引用，深拷贝需要 copy 深层次对象。So，以 deepcopy 层次 Object 为例子，要实现真正的深拷贝操作则需要通过遍历键来赋值对应的值，这个过程中如果遇到 Object 类型还需要再次进行遍历「同样的方法」。递归无疑了。来看波实现：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepclone</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>(); <span class="comment">// 解决循环引用</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">deep</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line">    <span class="comment">// 支持 Symbol 类型的属性</span></span><br><span class="line">    <span class="keyword">const</span> keys = [...Object.getOwnPropertyNames(data), ...Object.getOwnPropertySymbols(data)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!keys.length) <span class="keyword">return</span> data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> exist = map.get(data);</span><br><span class="line">    <span class="keyword">if</span> (exist) <span class="keyword">return</span> exist;</span><br><span class="line"></span><br><span class="line">    map.set(data, result);</span><br><span class="line"></span><br><span class="line">    keys.forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> item = data[key];</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> item === <span class="string">&#x27;object&#x27;</span> &amp;&amp; item) &#123;</span><br><span class="line">        result[key] = deep(item);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result[key] = item;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> deep(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OK，再看些 Python 的 copy.deepcopy 的实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deepcopy</span>(<span class="params">x, memo=<span class="literal">None</span>, _nil=[]</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Deep copy operation on arbitrary Python objects.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  See the module&#x27;s __doc__ string for more info.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> memo <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        memo = &#123;&#125;</span><br><span class="line">    d = <span class="built_in">id</span>(x) <span class="comment"># 查询被拷贝对象x的id</span></span><br><span class="line">  y = memo.get(d, _nil) <span class="comment"># 查询字典里是否已经存储了该对象</span></span><br><span class="line">  <span class="keyword">if</span> y <span class="keyword">is</span> <span class="keyword">not</span> _nil:</span><br><span class="line">      <span class="keyword">return</span> y <span class="comment"># 如果字典里已经存储了将要拷贝的对象，则直接返回</span></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure><p>emm…，实现思想也是使用递归，同时借助了 memo （备忘录）解决对象的循环引用问题，避免 StackOverflow。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://github.com/tc39/proposal-object-rest-spread/blob/master/Spread.md">Object Spread Initializer</a></li><li><a href="https://github.com/python/cpython/blob/20bdeedfb4ebd250dad9834c96cb858d83c896cb/Lib/copy.py#L128">Python copy.deepcopy</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Symbol">JS Symbol</a></li><li><a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=180#/detail/pc?id=3178">关于 JavaScript 的数据类型，你知多少？</a></li><li><a href="https://time.geekbang.org/column/article/100105">Python对象的比较、拷贝</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深拷贝与浅拷贝 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>负载均衡技术小记</title>
      <link href="2020/09/20/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%8A%80%E6%9C%AF%E5%B0%8F%E8%AE%B0/"/>
      <url>2020/09/20/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%8A%80%E6%9C%AF%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><details open red><summary> OSI 模型 </summary>              <div class='content'>              <p><img src="https://i.loli.net/2020/03/22/qthHTNlXyOvEfm3.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/22/qthHTNlXyOvEfm3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="网络模型"></p>              </div>            </details><h2 id="常见-OSI-模型负载均衡方案"><a href="#常见-OSI-模型负载均衡方案" class="headerlink" title="常见 OSI 模型负载均衡方案"></a>常见 OSI 模型负载均衡方案</h2><ul><li><p>2 层负载均衡：一般是用虚拟 MAC 地址方式，外部对虚拟 MAC 地址请求，负载均衡器接收后分配后端实际的 MAC 地址响应。</p></li><li><p>3 层负载均衡：一般采用虚拟 IP 地址方式，外部对虚拟的 IP 地址请求，负载均衡器接收后分配后端实际的 IP 地址响应。</p></li></ul><span id="more"></span><ul><li><p>4 层负载均衡：基于 IP + 端口的负载均衡方案，对应于 OSI 七层模型的第四层。基于传输层的底层负载均衡方案，可以实现 TCP 连接层的会话保持。</p></li><li><p>7 层负载均衡：即应用层的负载均衡。7 层的负载均衡更加针对特定的应用协议。基于 HTTP 应用的负载均衡可以实现对 URL 的转发应用、HTTP 请求的处理、session 信息会话保持等等。</p></li></ul><details open blue><summary> 4 层与 7 层负载均衡 </summary>              <div class='content'>              <p>4 层的负载均衡更偏向底层能力的转发，相对于 7 层负载均衡，负载性能更好。7 层负载均衡能做更细微粒度的负载决策。</p><ul><li>常见负载均衡器（Load Balancer）：<ul><li><a href="https://www.f5.com/zh_cn/products/f5-technologies">F5</a>：硬件负载均衡器；</li><li><a href="http://www.linuxvirtualserver.org/zh/lvs1.html">LVS</a>：基于IP层和基于内容请求分发的负载均衡器；</li><li><a href="https://www.nginx.com/">Nginx</a>：轻量级负载均衡器，TCP/UDP、HTTP 负载均衡支持；</li><li><a href="https://www.haproxy.org/#feat">HAProxy</a>：支持 TCP/HTTP 的负载均衡；</li></ul></li></ul>              </div>            </details><h2 id="常见负载均衡算法"><a href="#常见负载均衡算法" class="headerlink" title="常见负载均衡算法"></a>常见负载均衡算法</h2><ul><li>轮询（Round Robin）<ul><li>将外部请求按顺序轮流分配到集群中的真实服务器上，它均等地对待每一台服务器，而不管服务器上实际的连接数和系统负载。</li></ul></li><li>加权轮询（Weighted Round Robin）<ul><li>根据真实服务器的不同处理能力来调度访问请求。这样可以保证处理能力强的服务器处理更多的访问流量。自动问询真实服务器的负载情况，并动态地调整其权值。</li></ul></li><li>目标地址散列（Destination Hashing）<ul><li>“目标地址散列”调度算法根据请求的目标IP地址，作为散列键（Hash Key）从静态分配的散列表找出对应的服务器，若该服务器是可用的且未超载，将请求发送到该服务器，否则返回空。</li></ul></li><li>源地址散列（Source Hashing）<ul><li>“源地址散列”调度算法根据请求的源IP地址，作为散列键（Hash Key）从静态分配的散列表找出对应的服务器，若该服务器是可用的且未超载，将请求发送到该服务器，否则返回空。</li></ul></li><li>最少链接（Least Connections）<ul><li>将请求分配到连接数最少的服务器上（目前处理请求最少的服务器）。根据服务器当前的请求处理情况，动态分配.</li></ul></li><li>加权最少链接（Weighted Least Connections）<ul><li>在集群系统中的服务器性能差异较大的情况下，负载均衡器采用”加权最少链接”调度算法优化负载均衡性能，具有较高权值的服务器将承受较大比例的活动连接负载。负载均衡器可以自动问询真实服务器的负载情况，并动态地调整其权值。</li></ul></li><li>随机法、加权随机（Random）<ul><li>通过系统随机函数，根据后台服务器列表的大小值来随机选取其中一台进行访问。由概率概率统计理论可以得知，随着调用量的增大，其实际效果越来越接近于平均分配流量到后台的每一台服务器，也就是轮询法的效果。 加权随机法跟加权轮询法类似，根据后台服务器不同的配置和负载情况，配置不同的权重。不同的是，它是按照权重来随机选取服务器的，而非顺序。</li></ul></li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.nginx.com/resources/glossary/layer-7-load-balancing/">What Is Layer 7 Load Balancing?</a></li><li><a href="https://www.cnblogs.com/will-shun/archive/2017/09/22/7574644.html">常见负载均衡算法</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Load Balance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>setTimeout 是到了xx ms 就执行吗，了解浏览器的 Event-Loop 机制</title>
      <link href="2020/08/22/setTimeout%E6%98%AF%E5%88%B0%E4%BA%86xx%20ms%20%E5%B0%B1%E6%89%A7%E8%A1%8C%E5%90%97%EF%BC%8C%E4%BA%86%E8%A7%A3%20Event-Loop%20%E6%9C%BA%E5%88%B6/"/>
      <url>2020/08/22/setTimeout%E6%98%AF%E5%88%B0%E4%BA%86xx%20ms%20%E5%B0%B1%E6%89%A7%E8%A1%8C%E5%90%97%EF%BC%8C%E4%BA%86%E8%A7%A3%20Event-Loop%20%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>要想 JavaScript 玩得溜，还得了解波 JavaScript 执行机制/(ㄒoㄒ)/~~。</p></blockquote><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近看了波 JavaScript 相关的文章，不得不说，JavaScript 我还真没玩明白（给我哭~。。。😅）。也挺久没写文了，实习（“摸🐟”）之余小记一波。</p><blockquote><p>回顾一句话：JavaScript 是一门单线程、非阻塞、异步、解释性脚本语言。</p></blockquote><p>本文的标题是：setTimeout 是到了xx ms 就执行吗，了解 Event-Loop 机制。先回答波：不是。</p><p>来看下网上的一段经典 js 代码在浏览器中「Microsoft Edge 84.0.522.63（64位）」的执行结果。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script start&#x27;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout&#x27;</span>);</span><br><span class="line">&#125;,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">&#125;).then(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script end&#x27;</span>);</span><br></pre></td></tr></table></figure><span id="more"></span><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822164050.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822164050.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="执行结果"></p><p>可以明显看到 <code>setTimeout</code> 的 callback 并非在 0 ms 后立即执行。那么，这是问什么？要了解原因，需要了解后续介绍的 Event Loop 机制。</p><h2 id="概念一览"><a href="#概念一览" class="headerlink" title="概念一览"></a>概念一览</h2><ul><li>浏览器的内核-多线程的渲染进程：<strong>页面的渲染、js 的执行、事件的循环</strong>都在渲染进程中进行。渲染进程主要包含以下几个线程：</li></ul><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822183240.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822183240.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="JS内核中的线程"></p>            </div><ul><li>Task：Task 有 MicroTask 和 MacroTask 之分，MicroTask 在 Promise 出现之后引入。MacroTask 和 MicroTask 分别在以下几种场景形成：<ul><li>MacroTask：主代码块、setTimeout、setInterval、IO 事件等。</li><li>MicroTask：Promise、process.nextTick 等。</li></ul></li></ul><h2 id="浏览器中的Event-Loop"><a href="#浏览器中的Event-Loop" class="headerlink" title="浏览器中的Event Loop"></a>浏览器中的Event Loop</h2><p>有了基础概念，让我们来了解一下文章开头给出的代码是怎么执行的，代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script start&#x27;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout&#x27;</span>);</span><br><span class="line">&#125;,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">&#125;).then(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;promise2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script end&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li>1、首先，整个代码块作为第一个 MacroTask 被执行，<strong>同步的代码</strong>直接被压入执行栈被执行「同步任务在JS引擎线程上执行」，script start 和 script end 被打印；</li><li>2、setTimeout 被作为 MacroTask 处理，加入宏任务队列中；</li><li>3、Promise 被作为 MicroTask 处理，加入微任务队列中；</li><li>4、本次 MacroTask 处理完毕，检查微任务队列，发现 promise then 的 callback，promise1，promise2 先后打印；</li><li>5、接下来执行下一个 MacroTask，即 setTimeout 推送给任务队列的 callback，打印 setTimeout。</li></ul><p>so，代码执行结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">script start</span><br><span class="line">script end</span><br><span class="line">promise1</span><br><span class="line">promise2</span><br><span class="line">setTimeout</span><br></pre></td></tr></table></figure><p>由此，可大致了解到浏览器下 Event-Loop 执行机制大致如下：</p><details open red><summary> Event-Loop 执行机制 </summary>              <div class='content'>              <ul><li>1、一开始，整段脚本被当作 MacroTask 执行</li><li>2、执行过程中，同步代码进入可执行栈中直接执行，MacroTask 进入宏任务队列，MicroTask 进入微任务队列</li><li>3、当前 MacroTask 执行完就出队，检查微任务队列，如果不为空，则依次执行微任务队列中的 MicroTask，直到微任务队列为空</li><li>4、执行浏览器的 UI 线程的渲染工作「两个 MicroTask 执行空隙，有次 render 工作」</li><li>6、执行队首的 MacroTask，回到 2，依此循环，直至宏任务队列和微任务队列都为空</li></ul><p>可通过下图简单理解一波：</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822201854.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200822201854.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="浏览器 Event-Loop 简览"></p>              </div>            </details><p>由此可知道，setTimeout 中的 callback 不能按时执行是因为 Event-Loop，导致 JS 引擎线程还有其它的 task （promise MicroTask）要处理，主线程还未空闲下来。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.youtube.com/watch?reload=9&v=8aGhZQkoFbQ">What the heck is the event loop anyway?</a>「很精彩的演讲🐂」</li><li><a href="https://segmentfault.com/a/1190000012925872">从浏览器多进程到JS单线程，JS运行机制最全面的一次梳理</a></li><li><a href="https://zhuanlan.zhihu.com/p/187069497">精读《Tasks, microtasks, queues and schedules》</a></li><li><a href="https://juejin.im/post/6844904004007247880#heading-6">😇原生JS灵魂之问(下)</a></li><li><a href="https://juejin.im/post/6844903955286196237">【THE LAST TIME】彻底吃透 JavaScript 执行机制</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Event-Loop </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统笔记-IPC 机制</title>
      <link href="2020/08/02/Process-IPC/"/>
      <url>2020/08/02/Process-IPC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>进程间通信（IPC，Inter-Process Communication），指至少两个进程或线程间传送数据或信号的一些技术或方法。</p></blockquote><h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/08/02/atGjjf.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/08/02/atGjjf.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="IPC"></p>            </div><span id="more"></span><h3 id="进程间通信的问题"><a href="#进程间通信的问题" class="headerlink" title="进程间通信的问题"></a>进程间通信的问题</h3><ul><li>竞态条件（race condition）：多个进程对共享数据进行修改，影响程序的正确运行。在计算机内存或者存储里，如果<strong>同时</strong>发出读写大量数据的指令的时候竞态条件可能发生，机器试图覆盖相同的或者旧的数据，而此时旧的数据仍然在被读取。</li><li>临界区（critical section）：对共享资源进行访问的程序片段。</li></ul><h3 id="进程的同步与互斥"><a href="#进程的同步与互斥" class="headerlink" title="进程的同步与互斥"></a>进程的同步与互斥</h3><details open red><summary> 进程的同步与互斥 </summary>              <div class='content'>              <ul><li>进程的同步（Synchronization）是<strong>解决进程间协作关系(直接制约关系) 的手段</strong>。进程同步指两个以上进程基于某个条件来协调它们的活动。一个进程的执行依赖于另一个协作进程的消息或信号，当一个进程没有得到来自于另一个进程的消息或信号时则需等待，直到消息或信号到达才被唤醒。</li><li>进程互斥关系是一种特殊的进程同步关系。在系统中多个进程因争用临界资源（Critical Resource）而互斥执行。</li></ul>              </div>            </details><h4 id="互斥设计"><a href="#互斥设计" class="headerlink" title="互斥设计"></a>互斥设计</h4><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/08/02/atJSHg.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/08/02/atJSHg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="互斥设计"></p>            </div><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://book.douban.com/subject/27096665/">现代操作系统</a></li><li><a href="https://en.wikipedia.org/wiki/Inter-process_communication#Approaches">Inter-process communication</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzUxODAzNDg4NQ==&mid=2247485318&idx=1&sn=0da0a684639106f548e9d4454fd49904&chksm=f98e432ccef9ca3ab4e10734fd011c898785f18d842ec3b148c7a8ee500790377858e0dbd8d6&scene=158#rd">进程间通信</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 进程通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统笔记-进/线程模型</title>
      <link href="2020/07/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%BF%9B-%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/"/>
      <url>2020/07/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%BF%9B-%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>模型是指对于某个实际问题或客观事物、规律进行抽象后的一种形式化表达方式。- MBA 智库百科 - <a href="https://wiki.mbalib.com/wiki/%E6%A8%A1%E5%9E%8B">模型</a></p></blockquote><h2 id="概念梳理"><a href="#概念梳理" class="headerlink" title="概念梳理"></a>概念梳理</h2><h3 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h3><ul><li>进程是具有独立功能的程序关于某个数据集合上的一次运行活动，是系统进行资源分配和调度的独立单位。</li><li>一个进程是某种类型活动的一个活动，它有程序、输入、输出以及状态。进程是对正在运行程序的一个抽象。单个处理器可以被若干进程共享，它使用某种调度算法决定何时停止一个进程的工作，并转而为另一个进程提供服务。一个程序可对应多个进程。</li><li>系统资源以进程为单位分配，如内存、文件、每个进程拥有独立的地址空间。</li></ul><span id="more"></span><h3 id="进程表"><a href="#进程表" class="headerlink" title="进程表"></a>进程表</h3><p>进程表（process table），也称进程控制块（PCB），是由操作系统维护的，每个进程占用其中一个表项。该表项包含了操作系统对进程进行描述和控制的全部信息，从而保证该进程换出后再次启动时，就像从未中断过一样。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722215936.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722215936.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="典型进程表表项的一些字段"></p>            </div><details green><summary> segment </summary>              <div class='content'>              <p>段定义( segment ) 是用来区分或者划分范围区域的意思。汇编语言的 segment 伪指令表示段定义的起始，ends 伪指令表示段定义的结束。段定义是一段连续的内存空间。</p><ul><li>ref：<a href="https://juejin.im/post/5de5eab4f265da05de588224">程序员需要了解的硬核知识之汇编语言(全)</a></li></ul>              </div>            </details><h3 id="进程控制原语"><a href="#进程控制原语" class="headerlink" title="进程控制原语"></a>进程控制原语</h3><details red open><summary> 原语 </summary>              <div class='content'>              <p>原语：完成某种特定功能的一段程序，具有不可分割性或不可中断性。即原语的执行必须是连续的，在执行过程中不允许被中断。也就是满足<strong>原子性</strong>。</p><p>原子性操作，一组相关操作要么全部执行不可中断，要么就不执行。</p>              </div>            </details><ul><li>进程创建原语</li><li>进程撤消原语</li><li>阻塞原语</li><li>唤醒原语</li><li>挂起原语</li><li>激活原语</li><li>改变进程优先级</li></ul><h3 id="上下文切换"><a href="#上下文切换" class="headerlink" title="上下文切换"></a>上下文切换</h3><p>从一个进程切换到另一个进程需要一定的时间进行管理处理，包括保存寄存器的值和内存映射，更新不同的表格和列表、清除和重新调入内存高速缓存等。</p><p>进程间切换（process switch）又称上下文切换（context switch），它是一个存储和重建 CPU 状态的机制，要交换 CPU 上的进程时，必需先行存储当前进程的状态，然后再将进程状态读回 CPU 中。进程不运行时，将寄存器的值保存在进程控制块PCB中；当操作系统要运行一个新的进程时，会将PCB中的相关值送到对应的寄存器中。</p><h3 id="地址空间"><a href="#地址空间" class="headerlink" title="地址空间"></a>地址空间</h3><p>地址空间是内存中可供程序或进程使用的有效地址范围。也就是说，它是程序或进程可以访问的内存。存储器可以是物理的，也可以是虚拟的，用于执行指令和存储数据。</p><h3 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h3><p>线程，是进程中的一个运行实体，是 CPU 调度的基本单位。线程的下文环境是程序计数器等寄存器。线程拥有自己独立的栈和共享的堆。</p><h4 id="线程引入解决的问题"><a href="#线程引入解决的问题" class="headerlink" title="线程引入解决的问题"></a>线程引入解决的问题</h4><ul><li>降低上下文切换开销，线程的创建、撤销花费时间少于进程</li><li>多线程充分利用多核 CPU 的计算能力「内核线程」，在线程粒度进行阻塞而不是进程</li><li>降低通信难度，同一进程内的线程共享内存和文件</li></ul><h4 id="进程和线程各自持有的资源"><a href="#进程和线程各自持有的资源" class="headerlink" title="进程和线程各自持有的资源"></a>进程和线程各自持有的资源</h4><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722014253.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722014253.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="进程和线程各自持有的资源"></p>            </div><h2 id="多道程序设计中的进程模型"><a href="#多道程序设计中的进程模型" class="headerlink" title="多道程序设计中的进程模型"></a>多道程序设计中的进程模型</h2><blockquote><p>多道程序设计：允许多个程序同时进入内存并运行，其目的是为了提高系统效率。</p></blockquote><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722234520.jpg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200722234520.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="多道程序设计中的进程模型"></p>            </div><p>图例「来自《现代操作系统》」中多道程序设计计算机的内存中有 4 道程序，这 4 道程序被抽象为各自拥有自己控制流程的进程（每道程序都拥有自己的逻辑计数器）。图 c ，在任何一给定瞬间仅有一个进程真正在运行，进程运行时会将自己的逻辑程序计数器装入实际的物理程序计数器中，进程结束或暂停执行时，物理程序计数器将被保存在内存中该进程的逻辑程序计数器中。</p><h2 id="常见线程模型"><a href="#常见线程模型" class="headerlink" title="常见线程模型"></a>常见线程模型</h2><details red open><summary> 用户线程和内核线程之分 </summary>              <div class='content'>              <ul><li>用户线程，是完全建立在用户空间的线程库，用户线程的创建、调度、同步和销毁全由库函数在用户空间完成，不需要内核的帮助。因此这种线程是极其低消耗和高效的。但同一进程下创建的用户线程对 CPU 的竞争是以进程的维度参与的，这会导致该进程下的用户线程只能分时复用所属进程被分配的 CPU 时间片，所以无法很好的利用 CPU 多核运算的优势。一般情况下说的线程指的是用户线程。</li><li>内核线程，由操作系统进行管理和调度，能够直接操作计算机的底层资源，线程切换时 CPU 需要切换到内核态。内核级线程可以很好利用多核 CPU 的并行计算额优势，开发人员可以通过系统调用的方式使用内核线程。</li></ul>              </div>            </details><ul><li>用户空间管理线程，整个线程包放在用户空间，内核对线程包一无所知，内核管理的还是进程<ul><li>每个线程有用自己的线程表，线程在一个运行时系统上执行（运行时系统时一个管理线程的过程的集合，常用过程有 pthread_create、pthread_yield等）</li><li>优点：<ul><li>保存线程状态的过程和调度程序都只是本地过程，效率比进行内核调用高</li><li>线程切换不需要内核特权，线程调度非常快捷，调度算法可由应用程序特定</li></ul></li><li>缺点<ul><li>大多数系统调用都是阻塞的，我们需要避免被阻塞线程影响其他线程，此时阻塞系统调用如何实现？</li><li>内核只将处理器分配给进程，同一进程中的两个线程不能同时运行于两个处理器上</li></ul></li></ul></li></ul><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723152508.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723152508.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="用户空间管理线程"></p>            </div><ul><li>在内核空间管理线程<ul><li>内核空间使用线程表记录所有的线程，线程的更新、线程创建、销毁通过系统调用实现</li><li>线程阻塞时，内核可选择运行处于就绪态的线程（同一个进程中的线程或其它进程中的线程）</li><li>问题：<ul><li>多线程进程创建新的进程时会遇到到底是拥有与原进程相同数量的线程还是一个线程的问题</li><li>如果线程的创建、终止操作较为频繁，系统调用的开销还是不可忽视的</li></ul></li></ul></li></ul><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723165451.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723165451.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在内核空间实现线程"></p>            </div><h3 id="线程模型"><a href="#线程模型" class="headerlink" title="线程模型"></a>线程模型</h3><p>混合模型，即内核线程与用户线程间多路复用。</p><h3 id="一个进程对应一个内核线程"><a href="#一个进程对应一个内核线程" class="headerlink" title="一个进程对应一个内核线程"></a>一个进程对应一个内核线程</h3><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723170434.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723170434.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="一个进程对应一个内核线程"></p>            </div><p>此模型下（用户级线程模型），线程的创建、切换和同步等工作较为轻量与高效，依赖于编程语言实现。但同进程内的多线程无法很好的利用多核 CPU 优势，只能通过分时复用方式轮换执行。当进程内的任意线程阻塞，比如线程 A 请求 I/O 操作被阻塞，很可能导致整个进程范围内的阻塞，这是因为进程对应的内核线程因进程内的线程被阻塞而被剥夺 CPU 执行时间，导致整个进程丢失在 CPU 执行指令的机会。</p><h3 id="进程中的每个线程都对应一个内核线程"><a href="#进程中的每个线程都对应一个内核线程" class="headerlink" title="进程中的每个线程都对应一个内核线程"></a>进程中的每个线程都对应一个内核线程</h3><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723171449.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723171449.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="进程中的每个线程都对应一个内核线程"></p>            </div><p>此模型下（内核级线程模型），线程的调度和管理由操作系统内核负责，每次上下文切换都会从用户态切换到内核态，会产生不小的资源消耗，用户空间创建的线程数量受限于操作系统内核可创建内核线程的数量。但此模型下，多线程可充分利用多核 CPU 的并行计算能力，因为每个线程可以独立地被操作系统调度分配到 CPU 上执行指令，某个线程的阻塞不会影响到进程内其他线程工作的执行。</p><h3 id="两级线程模型"><a href="#两级线程模型" class="headerlink" title="两级线程模型"></a>两级线程模型</h3><p>此模型为用户级线程模型与内核级线程模型的混合，实现多个用户级线程与多个内核级线程的多路复用。此模型下，一个进程对应多个内核线程，有进程内的调度器决定进程内的线程如何与申请的内核线程对应。</p><div class="gallery ">              <p><img src="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723173158.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/picgo-pic/img/20200723173158.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="两级线程模型"></p>            </div><p>此线程模型可有效降低线程创建和管理的资源消耗，同时提供良好的并行能力。用户线程的调度和管理又进程的调度器负责，内核线程的调度和管理由操作系统负责。但此模型的线程的上下文信息的保存和恢复，栈空间的大小管理给开发人员带来的较大的技术挑战。</p><h3 id="Go-中的-MPG-线程模型"><a href="#Go-中的-MPG-线程模型" class="headerlink" title="Go 中的 MPG 线程模型"></a>Go 中的 MPG 线程模型</h3><p>GO 语言的 MPG 线程模型基于两级线程模型进行了改造，提高了线程调度的灵活度。如图：</p><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/07/23/UOLwvt.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/07/23/UOLwvt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="MPG 线程模型"></p>            </div><details red open><summary> MPG 解释 </summary>              <div class='content'>              <ul><li>M（Machine）：一个 Machine 对应一个内核级线程，在 M 的生命周期内，它只会与一个内核线程进行绑定。</li><li>P（Processor）：一个 Processor 表示执行 Go 代码片段所需的上下文环境，在运行时一个 M 只能绑定一个 P，M 和 P 的组合为 G 提供运行环境。在单个 Go 语言进程中，P 的最大数量决定了程序的并发规模。</li><li>G（Goroutine）：Go 语言代码片段的封装（通常为一个方法，函数是 Go 的一等公民），一个待执行的任务，Go 协程。</li></ul><blockquote><p>协程（coroutine），一种用户态轻量级线程，不同于之前所说的线程，协程实现的是<strong>非抢占式</strong>调度（即由当前协程切换到其他协程由当前协程决定），协程是语言级别的。「协作式调度」</p></blockquote><ul><li>协程优缺点：<a href="https://www.jianshu.com/p/2782f8c49b2a">coroutine协程详解</a></li><li><a href="https://gocn.vip/topics/9884?locale=zh-CN">Go 1.14 基于信号的抢占式调度实现原理</a></li></ul>              </div>            </details><p>在实际运行过程中，M 和 P 的组合为 G 提供有效的运行环境，而多个可执行 G 将会顺序排成一个队列挂在某个 P 上面，等待调度和执行。<strong>M 和 P 会适时的组合和断开</strong>，以保证执行 G 队列能够得到及时运行。如下图：</p><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/07/23/UOOXFg.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/07/23/UOOXFg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Goroutine 阻塞"></p>            </div><p>上图右半部分，当 M 对应的内核线程被唤醒时，M 会尝试为 G0 捕获一个 P 上下文，可能是从空闲的 P 列表中获取，如果获取不成功，M 会把 G0 放入调度器的可执行 G 队列中，等待其他 P 的查找。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://book.douban.com/subject/27096665/">现代操作系统</a></li><li><a href="https://gocn.vip/topics/9884?locale=zh-CN">go1.14 基于信号的抢占式调度实现原理</a></li><li><a href="https://cloud.tencent.com/developer/article/1339562">Linux下的进程类别（内核线程、轻量级进程和用户进程）</a></li><li><a href="https://liuyehcf.github.io/2017/09/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/">操作系统原理-进程线程模型「进程状态转换模型」</a></li><li><a href="https://book.douban.com/subject/26244729/">Go 并发编程实战</a></li><li><a href="https://www.jianshu.com/p/2782f8c49b2a">coroutine协程详解</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
          <category> 进/线程 </category>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 进程 </tag>
            
            <tag> 线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Hooks 那些事儿</title>
      <link href="2020/07/08/React-Hooks-%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
      <url>2020/07/08/React-Hooks-%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>翻了波之前写的文章还有笔记，发现关于前端的文章并不多（好歹也划水做过点前端开发）。巧了，最近没什么好话题可写，做下 React Hooks 学习笔记吧。</p><h2 id="Effect-Hook"><a href="#Effect-Hook" class="headerlink" title="Effect Hook"></a>Effect Hook</h2><p>不得不说 Hook 的出现降低了我们在 React 中处理副作用（side effect）的心智负担，通过 useEffect 就可以很好的完成之前需要使用几个生命周期函数配合才能完成的事。</p><h3 id="Effect-Hook-死循环请求问题"><a href="#Effect-Hook-死循环请求问题" class="headerlink" title="Effect Hook 死循环请求问题"></a>Effect Hook 死循环请求问题</h3><p>由于 Effect Hook 不熟「官方文档没读透」，最近使用 useEffect 出现了异步请求发送了无限次的问题，翻🚗了。我有个组件大概是这么写的：</p><span id="more"></span><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;umi-request&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;./logo.svg&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState([]);</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    request(<span class="string">&#x27;https://jsonplaceholder.typicode.com/todos/&#x27;</span>, &#123;</span><br><span class="line">     <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;fetch data&#x27;</span>);</span><br><span class="line">      setData(response);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;report error: &quot;</span>, error);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">header</span> <span class="attr">className</span>=<span class="string">&quot;App-header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;logo&#125;</span> <span class="attr">className</span>=<span class="string">&quot;App-logo&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">          &#123;data.map(item =&gt; &#123;</span></span><br><span class="line"><span class="xml">            return (</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">            );</span></span><br><span class="line"><span class="xml">          &#125;)&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure><p>效果如下：</p><iframe src="https://codesandbox.io/embed/nice-sea-zo2c2?fontsize=14&hidenavigation=1&theme=dark" width="100%" height="500" frameborder="0" loading="lazy" allowfullscreen></iframe><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/07/08/UZXngK.gif" class="lazyload" data-srcset="https://s1.ax1x.com/2020/07/08/UZXngK.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="效果"></p>            </div><p><a href="https://zo2c2.csb.app/">https://zo2c2.csb.app/</a>，可以很方便的从调试控制台看到，异步请求一直在发，陷入了死循环之中。这是为什么？因为 useEffect 会在组件 Mounting 和 Updating 阶段执行。每次 request 请求成功，我们都会设置一次组件的 state -&gt; data，所以组件会更新，useEffect 会再次执行，循环往复，造成了无限重复请求问题。那么，如何解决这个问题？之前我忽略了 useEffect 第二个参数的存在，使用 useEffect 的第二个参数可以解决这个问题。一般情况下，我们希望组件只在 mounting 阶段异步获取数据，所以，我们可以这么设置 useEffect 的第二个参数，让它具有和 componentDidMount 生命周期函数类似的行为（组件第一次 mount 后执行）：</p><details red open><summary> React 组件生命周期 </summary>              <div class='content'>              <p><img src="https://s1.ax1x.com/2020/07/08/UZ5T6s.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/07/08/UZ5T6s.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="lifecycle"></p><p>来源：<a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/</a></p>              </div>            </details><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  request(<span class="string">&#x27;https://jsonplaceholder.typicode.com/todos/&#x27;</span>, &#123;</span><br><span class="line">   <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;fetch data&#x27;</span>);</span><br><span class="line marked">    setData(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;report error: &quot;</span>, error);</span><br><span class="line">  &#125;)</span><br><span class="line marked">&#125;, []);</span><br></pre></td></tr></table></figure><p>我们传递了一个空数组作为 useEffect 的第二个参数，这样就能避免在组件 Updating 阶段执行 useEffect。这个数组成为<strong>依赖数组</strong>。依赖数组为空，表明 useEffect 不会因为某个变量的变化而再次执行。在组件需要根据某个变量变化进行渲染的时候，可以将此变量放到依赖数组中，一旦这个依赖的变量变动，useEffect 就会重新执行。</p><h3 id="让组件卸载后做点事"><a href="#让组件卸载后做点事" class="headerlink" title="让组件卸载后做点事"></a>让组件卸载后做点事</h3><p>在 class 组件中，我们可以将组件卸载后要做的事放在 componentWillUnmount 中。引入 Hook 后，在 function 组件中，我们可以把组件卸载要做的事放在 useEffect 中，让它返回一个 callback 即可，如下：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">&#123; visible &#125;</span>) </span>&#123;</span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="string">&quot;组件已挂载&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;  <span class="comment">// return 一个 callback</span></span><br><span class="line">      alert(<span class="string">&quot;组件已被卸载！！&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> visible ? <span class="string">&quot;true&quot;</span> : <span class="string">&quot;false&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [visible, changeVisible] = useState(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;visible &amp;&amp; <span class="tag">&lt;<span class="name">Child</span> <span class="attr">visible</span>=<span class="string">&#123;visible&#125;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="xml">          changeVisible(!visible);</span></span><br><span class="line"><span class="xml">        &#125;&#125;</span></span><br><span class="line"><span class="xml">      &gt;</span></span><br><span class="line"><span class="xml">        &#123;visible ? &quot;卸载组件&quot; : &quot;挂载组件&quot;&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><iframe src="https://codesandbox.io/embed/condescending-minsky-jnzcc?fontsize=14&hidenavigation=1&theme=dark" width="100%" height="500" frameborder="0" loading="lazy" allowfullscreen></iframe><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/07/09/UmgGaF.gif" class="lazyload" data-srcset="https://s1.ax1x.com/2020/07/09/UmgGaF.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="effect 卸载组件做点事儿"></p>            </div><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://juejin.im/post/5c9827745188250ff85afe50">精读 useEffect 完全指南</a></li><li><a href="https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/">useEffect 完整指南</a></li><li><a href="https://zhuanlan.zhihu.com/p/65773322">useEffect 使用指南</a></li><li><a href="https://www.robinwieruch.de/react-hooks-fetch-data">How to fetch data with React Hooks?</a></li><li><a href="https://www.zoo.team/article/react-hooks">看完这篇，你也能把 React Hooks 玩出花</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用docker-compose编排前后端分离应用</title>
      <link href="2020/06/28/%E4%BD%BF%E7%94%A8docker-compose%E7%BC%96%E6%8E%92%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BA%94%E7%94%A8/"/>
      <url>2020/06/28/%E4%BD%BF%E7%94%A8docker-compose%E7%BC%96%E6%8E%92%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>几个月过去了，是时候把当初的 <a href="https://github.com/yeshan333/Flask-React-ToDoList#%E6%9B%B4%E6%96%B0%E8%AE%A1%E5%88%92">🚩</a> 干掉了。</p><p>顺便提高下 docker 的熟练度，得闲看下原理🚩（假期看过，没总结…）。</p><p>重装了波系统（Windows 2004 版本），这个版本下，Docker Desktop 是以 WSL2 为 backend 的，不用 Hyper -V 了，舒服了很多。</p><p>细品了下（又摸鱼搞 DevOps），跑这个前后端分离项目需要到的容器还挺多，4 个左右（后端 REST 服务、数据库服务、前端服务），前端服务上了两个容器『貌似没必要』，一个用来过渡，一个跑挂着 SPA 的 Nginx。</p><p>这次祭出了 Docker Compose，毕竟容器有点“小多”，单单用命令费劲。</p><span id="more"></span><h2 id="Demo-实战"><a href="#Demo-实战" class="headerlink" title="Demo 实战"></a>Demo 实战</h2><ul><li>Demo 地址：<a href="https://github.com/yeshan333/Flask-React-ToDoList">https://github.com/yeshan333/Flask-React-ToDoList</a></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/yeshan333/Flask-React-ToDoList</span><br><span class="line"><span class="built_in">cd</span> Flask-React-ToDoList</span><br><span class="line">git checkout docker</span><br></pre></td></tr></table></figure><h3 id="1、先给后端服务写个-Dockerfile"><a href="#1、先给后端服务写个-Dockerfile" class="headerlink" title="1、先给后端服务写个 Dockerfile"></a>1、先给后端服务写个 Dockerfile</h3><p>这个项目的后端服务是用 Flask 写的，Dockerfile 如下所示：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.8</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer = <span class="string">&quot;yeshan &lt;yeshan1329441308@gmail.com&gt;&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Keeps Python from generating .pyc files in the container</span></span><br><span class="line"><span class="keyword">ENV</span> PYTHONDONTWRITEBYTECODE <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Turns off buffering for easier container logging</span></span><br><span class="line"><span class="keyword">ENV</span> PYTHONUNBUFFERED <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install pip requirements</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> requirements.txt .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> python -m pip install -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> . /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># production web server</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;gunicorn&quot;</span>, <span class="string">&quot;--bind&quot;</span>, <span class="string">&quot;0.0.0.0:5000&quot;</span>, <span class="string">&quot;app:app&quot;</span>]</span></span><br><span class="line"><span class="comment"># CMD [&quot;flask&quot;, &quot;run&quot;, &quot;--host&quot;, &quot;0.0.0.0&quot;, &quot;--port&quot;, &quot;5000&quot;]</span></span><br></pre></td></tr></table></figure><p>生产环境下，Flask 自带的服务器不够骚，所以这里上 gunicorn。</p><h3 id="2、再给前端-React-SPA-写个-Dockerfile"><a href="#2、再给前端-React-SPA-写个-Dockerfile" class="headerlink" title="2、再给前端 React-SPA 写个 Dockerfile"></a>2、再给前端 React-SPA 写个 Dockerfile</h3><p>前端使用 React 编写「想起初学那时候抽组件那叫一个痛苦」，Dockerfile 如下</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">12.18</span>-alpine as frontend-react</span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer = <span class="string">&quot;yeshan &lt;yeshan1329441308@gmail.com&gt;&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> NODE_ENV production</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /usr/src/app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> [<span class="string">&quot;package.json&quot;</span>, <span class="string">&quot;package-lock.json*&quot;</span>, <span class="string">&quot;npm-shrinkwrap.json*&quot;</span>, <span class="string">&quot;./&quot;</span>]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install &amp;&amp; npm install -g serve</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm run build</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;serve&quot;</span>, <span class="string">&quot;-l&quot;</span>, <span class="string">&quot;tcp://0.0.0.0:5000&quot;</span>, <span class="string">&quot;-s&quot;</span>, <span class="string">&quot;build&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>原来想的是直接使用 react-script 自带的 HTTP 服务器的，前端应用也在容器跑，但是这个 HTTP 服务器不够骚，为了生产环境，还是上 Nginx 了。为了调试，使用 serve 套一下构建好的页面。</p><h3 id="3、编写-docker-compose-yml-对容器进行编排"><a href="#3、编写-docker-compose-yml-对容器进行编排" class="headerlink" title="3、编写 docker-compose.yml 对容器进行编排"></a>3、编写 docker-compose.yml 对容器进行编排</h3><p>接下来的编排文件才是大头，调试了半天『🤣连接 MongoDB😂』。这个 URI 连接字符串试了多种操作，比如：<code>connection = MongoClient(&quot;mongodb://mongo:27017/&quot;)</code>、<code>connection = MongoClient(&quot;mongo:27017&quot;)</code>，最后还是看文档解决的，这…，文档还是香的。</p><p>原来 compose v2 以上，使用 compose 进行编排时，会默认建立一个网络（bridge 类型），连接各个容器，<code>主机名和容器名相同</code>，后面指定了下<code>container_name: flask_backend</code>、<code>container_name: mongo_database</code>才在 flask_backend 容器 <code>ping</code> 通 MongoDB 服务。</p><p>文档原文如下：</p><blockquote><p>By default Compose sets up a single network for your app. Each container for a service joins the default network and is both reachable by other containers on that network, and discoverable by them at a hostname identical to the container name.<a href="https://docs.docker.com/compose/networking/">🔗</a></p></blockquote><p>OK，看下这个小 demo 的编排文件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">backend:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">flask_backend</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">backend</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./backend</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">database</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">database:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mongo_database</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">data:/data/db</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">frontend:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">frontend-react</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./frontend</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">static:/usr/src/app/build</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:5000&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">webserver-nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">static:/usr/share/nginx/html</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">&quot;/bin/bash -c &quot;</span><span class="string">nginx</span> <span class="string">-g</span> <span class="string">&#x27;daemon off;&#x27;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">volumes:</span></span><br><span class="line"><span class="string">  data:</span></span><br><span class="line"><span class="string">  static:</span></span><br></pre></td></tr></table></figure><p>可以明显的看到，之前为前端 SPA 创建的容器只是为了做下过渡「通过 static volumn 进行过渡」。最终的应用还是挂在 Nginx 上的。通过 volume 做下持久存储。</p><p>最后，跑下试试，看看效果如何。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化数据库</span></span><br><span class="line">docker <span class="built_in">exec</span> -i  flask_backend flask create-database</span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/06/28/NRJe8x.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/28/NRJe8x.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="开始编排容器"></p><p><img src="https://s1.ax1x.com/2020/06/28/NRJxdH.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/28/NRJxdH.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="创建的网络与卷"></p><p><img src="https://s1.ax1x.com/2020/06/28/NRJaM8.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/28/NRJaM8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="效果"></p>            </div><p>收工，下一步就是做下服务抽离，部署到云原生的操作系统上-Kubernetes！🚩</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://docs.docker.com/compose/compose-file/#compose-documentation">Compose file version 3 reference</a></li><li><a href="https://docs.docker.com/compose/networking/">Networking in Compose</a></li><li><a href="https://code.visualstudio.com/docs/containers/quickstart-python">Python in a container</a></li><li><a href="https://yeasy.gitbook.io/docker_practice/">docker-practice</a></li><li><a href="https://www.npmjs.com/package/serve">npm serve</a></li><li><a href="https://zhuanlan.zhihu.com/p/69536325">使用 Docker 部署 NodeJS + MongoDB 项目</a></li><li><a href="https://segmentfault.com/a/1190000010415158">Docker Nginx 部署 React</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> DevOps </tag>
            
            <tag> 服务编排 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给 GitHub commit 加个小绿标</title>
      <link href="2020/06/26/%E7%BB%99%20GitHub%20commit%20%E5%8A%A0%E4%B8%AA%E5%B0%8F%E7%BB%BF%E6%A0%87/"/>
      <url>2020/06/26/%E7%BB%99%20GitHub%20commit%20%E5%8A%A0%E4%B8%AA%E5%B0%8F%E7%BB%BF%E6%A0%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>最近一波重装系统啥都没了，最常用的 Git 配置肯定得安排回来的。记得之前给 git 的 commit 加了个签名，回想下为什么要给 commit 做下签名？因为它能让 GitHub 的 commit 历史更帅？看下加签名之前是怎么样的：</p><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/06/26/NstacQ.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NstacQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="对commit进行签名前"></p>            </div><span id="more"></span><p>再看下对 commit 签名后是怎么样的：</p><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/06/26/Nstg9U.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/Nstg9U.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="对commit进行签名后"></p>            </div><p>这么一对比，是更帅了！但我好像不是因为这的才做的。我是为了更好的去混<strong>开源项目</strong>做的，这个绿标能更好的证明我的身份！！！（假装我很专业，2333~）。使用过 Git 的同学应该都晓得，我们的提交作者信息是可以自己设置的（这意味着我们可以使用他人身份信息），如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config user.name <span class="string">&quot;tester&quot;</span></span><br><span class="line">$ git config user.email <span class="string">&quot;gg@qq.com&quot;</span></span><br></pre></td></tr></table></figure><div class="gallery ">              <p><img src="https://s1.ax1x.com/2020/06/26/NsOPv6.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsOPv6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="冒用作者信息"></p>            </div><p>我们可以看到，是可以 push 到 GitHub 的[没有小绿标而已]。这看起来就不太好，得让 GitHub 证明下自己得身份才行，从官方文档可以看到， GitHub 提供了一种使用 GPG 的方式可以让我们的 commit “戴”上小绿标。</p><p>忘了当初是怎么操作的了，在 Windows 下操作貌似还挺麻烦的，趁此捋一下过程，趁机水篇文章。</p><blockquote><p>GNU Privacy Guard（GnuPG或GPG）是一个密码学软件，用于加密、签名通信内容及管理非对称密码学的密钥。</p></blockquote><h2 id="生成-GPG-密钥对"><a href="#生成-GPG-密钥对" class="headerlink" title="生成 GPG 密钥对"></a>生成 GPG 密钥对</h2><p>第一步肯定就是通过 GPG 生成密钥对了。这时候需要到一个 GnuPG 软件，OK，去下载：<a href="https://www.gnupg.org/index.html">🔐GnuPG</a>。其实 Git fot windows 自带一个 gpg 命令行程序，但是命令行用多了，还是上 GUI 愉快点吧，我们选择使用带 GUI 的 <a href="https://gpg4win.org/get-gpg4win.html">Gpg4win🔗</a>。</p><p><img src="https://s1.ax1x.com/2020/06/26/Ns63HU.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/Ns63HU.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Gpg4win下载"></p><p>我们通过全家桶软件之 Kleopatra 新建立一对密钥，名字为 GitHub 用户名，邮箱为 GitHub 的注册邮箱（使用 4096 bits的密钥）：</p><p><img src="https://s1.ax1x.com/2020/06/26/NscXJH.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NscXJH.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Kleopatra新建密钥对"></p><p><img src="https://s1.ax1x.com/2020/06/26/NsgnO0.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsgnO0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="4096 bits密钥"></p><p>设置 passphrase （通行口令）来保护我们的密钥对，每次签名都会用它到。（也可以不设置，不用口令验证就可以直接使用密钥）</p><p><img src="https://s1.ax1x.com/2020/06/26/Ns2R29.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/Ns2R29.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="设置passphrase"></p><p>好了，密钥对生成完毕。下一步，就是把把公钥放到 GitHub 上，让 GitHub 对我们的提交进行验证，判断是否该给 commit “戴”上小绿标。[获取公钥：鼠标右键-&gt;细节-&gt;导出]、[GitHub 添加公钥：Settings-&gt;SSH and GPG keys]。</p><p><img src="https://s1.ax1x.com/2020/06/26/NsW1k8.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsW1k8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="拿到公钥"></p><p><img src="https://s1.ax1x.com/2020/06/26/NsWbjA.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsWbjA.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="GitHub上添加公钥"></p><p>下一步就是开启 Git 提交签名。</p><h2 id="启用-Git-提交签名"><a href="#启用-Git-提交签名" class="headerlink" title="启用 Git 提交签名"></a>启用 Git 提交签名</h2><p>首先，我们需要让 Git 知道 gpg 的可执行程序在哪里？gpg 的可执行程序位于<a href="https://gpg4win.org/get-gpg4win.html">Gpg4win🔗</a>同级目录下的<code>GnuPG/bin</code>中（GnuPG 是 Gpg4win 组件之一），我们需要进行如下配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global gpg.program &lt;path_to_gpg&gt;</span><br></pre></td></tr></table></figure><p>我的设置如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">where</span> gpg</span><br><span class="line">E:\Git\usr\bin\gpg.exe  <span class="comment"># 这个是 Git for windows 自带的</span></span><br><span class="line">E:\GnuPG\bin\gpg.exe    <span class="comment"># 这个才是我们要用的</span></span><br><span class="line">$ git config --global gpg.program <span class="string">&quot;E:\GnuPG\bin\gpg.exe&quot;</span></span><br></pre></td></tr></table></figure><p>然后每次<code>git commit</code>时，加上<code>-S</code>即可启用签名。</p><p><img src="https://s1.ax1x.com/2020/06/26/NsbMvT.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsbMvT.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="加个-S参数启用签名"></p><p>每次都要多打个参数多麻烦，我们通过如下配置让 Git 默认启用 GPG 签名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global commit.gpgsign <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>最后我们<code>git push</code>一下看看有没有效果。<a href="https://github.com/yeshan333/anonymous-git-commit/commits/master">https://github.com/yeshan333/anonymous-git-commit/commits/master</a></p><p><img src="https://s1.ax1x.com/2020/06/26/NsqndH.png" class="lazyload" data-srcset="https://s1.ax1x.com/2020/06/26/NsqndH.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="效果预览"></p><p>没问题，收工了。我的 Git 全局配置如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~/.gitconfig</span><br><span class="line">[user]</span><br><span class="line">        name = yeshan333</span><br><span class="line">        email = 1329441308@qq.com</span><br><span class="line">[gpg]</span><br><span class="line">        program = E:\\GnuPG\\bin\\gpg.exe</span><br><span class="line">[commit]</span><br><span class="line">        gpgsign = <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://zh.wikipedia.org/wiki/GnuPG">GunPG</a></li><li><a href="https://help.github.com/en/github/authenticating-to-github/signing-commits">GitHub - Signing commits</a></li><li><a href="https://frostming.com/2019/11-25/git-commit-sign">给你的 Git commit 加上绿勾 - 一个简单但很多人没注意的细节</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GPG </tag>
            
            <tag> 加密 </tag>
            
            <tag> 隐私 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将 Web 应用丢给守护进程</title>
      <link href="2020/06/21/%E5%B0%86Web%E5%BA%94%E7%94%A8%E4%B8%A2%E7%BB%99%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/"/>
      <url>2020/06/21/%E5%B0%86Web%E5%BA%94%E7%94%A8%E4%B8%A2%E7%BB%99%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>最近老是要把 Web App/Service 部署在个人的服务器上进行测试，发现自己不怎么熟悉「前提：不上 docker ，逃~」，特写此文章来纪念下🤔👀（之前部署的  Web App/Service 都是丢给 <a href="https://www.heroku.com/">Heroku</a>、<a href="https://www.netlify.com/">Netlify</a>、GitHub 这样的 PaaS 平台运行，写个配置文件「action、yaml、toml」就完事了。自己整的玩意儿丢在自己服务器上跑的并不算多，今天费点劲，了解点基础设施。根据冰山模型，了解下 FaaS 能更好的了解 <a href="https://shansan.top/knowledge-base/#/backend?id=iaas%e3%80%81paas%e3%80%81saas">PaaS</a>）。</p><span id="more"></span><h2 id="冰山的底部-基础"><a href="#冰山的底部-基础" class="headerlink" title="冰山的底部-基础"></a>冰山的底部-基础</h2><p>在把 Web 应用丢给守护（daemon）进程前，应该了解部分基础概念。</p><blockquote><p>守护进程是在后台运行不受终端控制的进程（如输入、输出等）。</p></blockquote><p>插入个场景，我们之前在开发环境下，是如何运行 Web 服务的？对于 Spring Boot，我们可以在终端使用 <code>mvn spring-boot:run</code> 在前台跑 Web 服务；对于 React 前端应用，我们可以使用 <code>npm script</code> 即 <code>npm start</code> 启动前端 HTTP 服务器进行 view 层预览。问题来了，这样操作，服务进程是跑在前台的（所谓的前台任务/进程），当我们退出操作终端或者手动终止时，这些服务也就不能用了，而且前台任务独占了一个终端，使得我们不能再在此终端执行其他命令。在生产环境下，我们要让服务持久运行，这种情况明显不是我们想看到的，那么，如何解决这个问题？</p><blockquote><p>所谓的前台任务是我们可以直接看得到的。</p></blockquote><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621153114.gif" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621153114.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="前台进程/任务"></p><p>在了解如何解决问题前，我觉得有必要了解下为什么前台任务会随着 session 的退出而退出（收到了 SIGHUP）。Linux 系统对此的设计如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、用户准备退出 session</span><br><span class="line">2、系统向该 session 发出SIGHUP信号</span><br><span class="line">3、session 将SIGHUP信号发给所有子进程</span><br><span class="line">4、子进程收到SIGHUP信号后，自动退出</span><br></pre></td></tr></table></figure><details cyan open><summary> SIGHUP 是什么 </summary>              <div class='content'>              <p>SIGHUP（signal hang up） 信号在用户终端连接(正常或非正常)结束时发出, 通常是在终端的控制进程结束时, 通知同一 session 内的各个作业, 这时它们与控制终端不再关联. 系统对 SIGHUP 信号的默认处理是终止收到该信号的进程。</p><ul><li>查看维基百科：<a href="https://zh.wikipedia.org/wiki/Unix%E4%BF%A1%E5%8F%B7">Unix 信号</a></li></ul>              </div>            </details><details green><summary> 什么是进程组 </summary>              <div class='content'>              <p>进程组是一系列相互关联的进程集合，系统中的每一个进程必须从属于某一个进程组；每个进程组中都会有一个唯一的 ID(process group id)，简称 PGID；PGID 一般等同于进程组的创建进程的 Process ID，而这个进程一般也会被称为进程组先导(process group leader)，同一进程组中除了进程组先导外的其他进程都是其子进程；</p><p>进程组的存在，方便了系统对多个相关进程执行某些统一的操作，例如，我们可以一次性发送一个信号量给同一进程组中的所有进程。</p>              </div>            </details><details green><summary> 什么是 session </summary>              <div class='content'>              <p>会话（session）是一个若干进程组的集合，同样的，系统中每一个进程组也都必须从属于某一个会话；一个会话只拥有最多一个控制终端（也可以没有），该终端为会话中所有进程组中的进程所共用。一个会话中前台进程组只会有一个，只有其中的进程才可以和控制终端进行交互；除了前台进程组外的进程组，都是后台进程组；和进程组先导类似，会话中也有会话先导(session leader)的概念，用来表示建立起到控制终端连接的进程。在拥有控制终端的会话中，session leader 也被称为控制进程(controlling process)，一般来说控制进程也就是登入系统的 shell 进程(login shell)；</p>              </div>            </details><p>OK，回到我们的问题，如何让任务持久运行、不影响其他操作。这时，后台进程就该登场了，将任务丢在后台执行。一个任务要丢给守护进程的第一步就是要将他变为后台进程。变为后台进程后，一个进程是否就成为了守护进程呢？或者说，用户退出 session 以后，后台进程是否还会继续执行？答案是未必。看完后面就明白了。</p><h2 id="冰山的上层-应用"><a href="#冰山的上层-应用" class="headerlink" title="冰山的上层-应用"></a>冰山的上层-应用</h2><p>Linux 提供了很多种方法让我们将前台进程变为后台进程，挑几种介绍下。</p><h3 id="将前台进程变为后台进程的几种方式"><a href="#将前台进程变为后台进程的几种方式" class="headerlink" title="将前台进程变为后台进程的几种方式"></a>将前台进程变为后台进程的几种方式</h3><h4 id="位与运算符-amp"><a href="#位与运算符-amp" class="headerlink" title="位与运算符-&amp;"></a>位与运算符-&amp;</h4><p>通过在命令的尾部加个符号<code>&amp;</code>即可将进程启动为后台进程，后台进程的特点如下：</p><details red open><summary> 后台进程特点 </summary>              <div class='content'>              <p>1、继承当前 session （对话）的标准输出（stdout）和标准错误（stderr）。因此，后台任务的所有输出依然会同步地在命令行下显示。</p><p>2、不再继承当前 session 的标准输入（stdin）。你无法向这个任务输入指令了。如果它试图读取标准输入，就会暂停执行（halt）。这个特点使得我们可以执行其他命令。</p>              </div>            </details><p>我们可以运行一个 <a href="https://fastapi.tiangolo.com/">FastAPI</a> 编写的 Web 服务观察下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uvicorn main:app --reload &amp;</span><br></pre></td></tr></table></figure><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621161927.gif" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621161927.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="集成了session的标准输出"></p><p>可以很明显的看到，后台进程继承了当前 session （对话）的标准输出（stdout）。我们知道进程收到 SIGHUP 信号会被终止，那么后台进程是否会收到 SIGHUP 信号挂掉？掏出阿里云服务器实验下。</p><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621165541.gif" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621165541.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="有IO交互的后台进程"></p><p>这。。。后台进程在我们退出 session 后挂掉了！！！，这是为啥？那是因为后台进程与标准 I/O 有交互（这个服务打日志了），后台进程的的标准 I/O 继承自当前 session，就算加个 <code>&amp;</code> 符号也没有改变这一特点。我们想要的是服务在后台持久运行，怎么解决？</p><p>Linux 提供了一个 <code>nohup</code> 命令可以帮我们解决这个问题。</p><details green><summary> FastAPI Web 服务代码 </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>(<span class="params">BaseModel</span>):</span></span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    age: <span class="built_in">int</span></span><br><span class="line">    country: <span class="built_in">str</span></span><br><span class="line">    offer_call: <span class="built_in">bool</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">root</span>():</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&#x27;/person/&#123;your_name&#125;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_people_info</span>(<span class="params">your_name: <span class="built_in">str</span>, q: <span class="built_in">int</span> = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;your name&quot;</span>: your_name, <span class="string">&quot;query&quot;</span>: q&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.put(<span class="params"><span class="string">&#x27;/person/&#123;your_name&#125;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_people_info</span>(<span class="params">your_name: <span class="built_in">str</span>, person: People</span>):</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;people name&quot;</span>: your_name, <span class="string">&quot;locate&quot;</span>: person.age&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="阻断-SIGHUP-信号的-nohup"><a href="#阻断-SIGHUP-信号的-nohup" class="headerlink" title="阻断 SIGHUP 信号的 nohup"></a>阻断 SIGHUP 信号的 nohup</h4><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621171128.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621171128.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="nohup命令的使用"></p><p>好了，就算结束了 session 此 Web 服务仍在运行。<code>nohup</code> 命令实际上将子进程与它所在的 session 分离了。OK，进程由后台进程变为守护进程了（有那味了，还不算真正的守护进程）。</p><blockquote><p>守护进程在 session 关闭时不会受影响。守护进程的会话组和当前目录，文件描述符都是独立的。后台运行只是终端进行了一次fork，让程序在后台执行，这些都没改变。</p></blockquote><details red open><summary> nohup 做的那些事 </summary>              <div class='content'>              <ul><li>阻止SIGHUP信号发到这个进程（PID：14229）。</li><li>关闭标准输入。该进程不再能够接收任何输入，即使运行在前台。</li><li>重定向标准输出和标准错误到文件nohup.out。</li></ul>              </div>            </details><h4 id="守护进程管理工具-systemd"><a href="#守护进程管理工具-systemd" class="headerlink" title="守护进程管理工具-systemd"></a>守护进程管理工具-systemd</h4><p>Systemd（System Daemon） 并不是一个命令，而是一组命令，涉及到系统管理的方方面面。这里不做介绍，直接结合场景来玩耍。教程可看：<a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html">Systemd 入门教程：命令篇</a>。</p><p>是时候掏出 <a href="https://gitee.com/yeshan333/body">Spring-Boot</a> 应用了（mvn clean package 构建好 jar 包）。先为这个应用写个 Systemd 的配置文件<code>spring-boot-app.service</code>，如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Spring Boot RESTful APIs Services</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/local/java/jdk1.8.0_221/bin/java -jar /home/www/body/target/bodymanagement-0.0.1-SNAPSHOT.jar</span><br><span class="line">Restart=always</span><br><span class="line">User=root</span><br><span class="line">Group=root</span><br><span class="line">Environment=PATH=/usr/local/java/jdk1.8.0_221/bin/java</span><br><span class="line">WorkingDirectory=/home/www/body/</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>然后执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将配置文件拷贝到 systemd 中</span></span><br><span class="line">cp spring-boot-app.service /etc/systemd/system</span><br><span class="line"><span class="comment"># 重载配置文件</span></span><br><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">$ sudo systemctl start spring-boot-app.service</span><br></pre></td></tr></table></figure><p>访问：<a href="http://47.92.4.141:8080/api/user/findLatestInf">http://47.92.4.141:8080/api/user/findLatestInf</a>，即可看到网页显示<code>[]</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">enable</span> spring-boot-app.service  <span class="comment"># 设置开机启动</span></span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/spring-boot-app.service to /etc/systemd/system/spring-boot-app.service.</span><br></pre></td></tr></table></figure><p>使用<code>systemctl status spring-boot-app.service</code>可以查看服务状态，使用<code>journalctl -u spring-boot-app</code>可以查看服务状态。</p><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621184905.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200621184905.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="查看服务状态"></p><p>更多常用命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看某个 Unit 的日志</span></span><br><span class="line">$ sudo journalctl -u nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个 Unit 状态</span></span><br><span class="line">$ sudo systemctl status mongod</span><br><span class="line"></span><br><span class="line"><span class="comment"># 让某个 Unit 开机时启动</span></span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> mongod</span><br><span class="line"></span><br><span class="line"><span class="comment"># 立即启动一个服务</span></span><br><span class="line">$ sudo systemctl start apache.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 立即停止一个服务</span></span><br><span class="line">$ sudo systemctl stop apache.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启一个服务</span></span><br><span class="line">$ sudo systemctl restart apache.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死一个服务的所有子进程</span></span><br><span class="line">$ sudo systemctl <span class="built_in">kill</span> apache.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载一个服务的配置文件, 一旦配置文件修改就需要使用</span></span><br><span class="line">$ sudo systemctl reload apache.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个服务的配置文件</span></span><br><span class="line">$ systemctl cat sshd.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载所有配置文件</span></span><br><span class="line">$ sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://blog.csdn.net/z_ryan/article/details/80952498">网络编程的三个重要信号（SIGHUP ，SIGPIPE，SIGURG）</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/02/linux-daemon.html">Linux 守护进程的启动方法</a></li><li><a href="https://www.zhihu.com/question/38609004">什么是守护进程</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/03/node-systemd-tutorial.html">Node 应用的 Systemd 的启动</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 服务器进程管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>(译)通过 Git 和 Angular 了解语义化提交信息</title>
      <link href="2020/06/04/%E8%AF%91-%E9%80%9A%E8%BF%87-Git-%E5%92%8C-Angular-%E4%BA%86%E8%A7%A3%E8%AF%AD%E4%B9%89%E5%8C%96%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF/"/>
      <url>2020/06/04/%E8%AF%91-%E9%80%9A%E8%BF%87-Git-%E5%92%8C-Angular-%E4%BA%86%E8%A7%A3%E8%AF%AD%E4%B9%89%E5%8C%96%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>受传统提交规范和 Angular 约定的启发，让我们来解释语义化提交术语，并演示提交信息的实际示例。</p><p>许多项目决定以某种约定方式来标准化它们的提交信息。这种做法并不是新出现的，但在最近几年中越来越多地得到了应用。而且很可能您已经在某些项目中遇到过这样的提交消息。</p><span id="more"></span><p>最早出现的规范之一来自与 AngularJS 项目。这个项目团队创建了一个详细的<a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#">文档</a>，其中指定了他们应该提交的目标和方式。这些提交约定非常流行，有些您可能通过 <a href="http://karma-runner.github.io/4.0/dev/git-commit-msg.html">Karma</a> 指南遇到过。但是，还有一些不同的约定，像 <a href="https://contribute.jquery.org/commits-and-pull-requests/#commit-guidelines">jQuery</a>, <a href="https://github.com/jshint/jshint/blob/master/CONTRIBUTING.md#commit-message-guidelines">JSHint</a>, <a href="https://github.com/emberjs/ember.js/blob/master/CONTRIBUTING.md#commit-tagging">Ember</a>, <a href="https://github.com/angular/angular/blob/master/CONTRIBUTING.md#-commit-message-guidelines">Angular</a>(一个受AngularJS 提交规范启发的增强版约定)，甚至<a href="https://github.com/conventional-changelog/conventional-changelog/tree/master/packages">更多</a>:</p><p><img src="https://d33wubrfki0l68.cloudfront.net/eb16595d0c6862c0c013a36c339317a4d82bdce7/9195b/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/conventions-diagram.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/eb16595d0c6862c0c013a36c339317a4d82bdce7/9195b/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/conventions-diagram.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Commit convention variations"></p><p>可以清楚地看到上面各种各样的提交约定，这无疑构成了一个标准化官方规范的正当理由。<a href="https://www.conventionalcommits.org/zh-hans/v1.0.0-beta.4/">约定式提交</a>就是这样一种规范，它在实践中简化了 Angular 约定，并简化指出了提交消息规范的要点。</p><p>在本文中，我们将介绍“语义化提交”背后的概念，并使用 Git 和 Angular 的提交约定来演示具体的例子。声明一下，我们使用它们只是为了澄清概念——意味着版本控制工具和规范的选择取决于您。</p><p>那我们就开始吧！👨🏻‍🏫</p><h1 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h1><p>让我们从定义开始:</p><blockquote><p>语义化提交是<strong>遵循着特定约定</strong>并具有人类和机器可读含义的提交消息</p></blockquote><p>这意味着，它只是提交消息的指导方针，因此:</p><ul><li>提交消息是语义化的：因为它们被划分为有意义的类型，标识了提交(commit)的意图</li><li>提交消息是约定俗成的：对于开发者和工具，它们有着统一的结构和良好的类型标识</li></ul><p>此外，当我们通常需要执行以下操作时，语义化提交可能会派上用场：</p><ol><li>允许维护人员和贡献者轻松地浏览项目历史并理解提交的意图，同时通过提交消息类型忽略不重要的更改</li><li>强制提交信息的结构，鼓励有针对特定目的的小型提交</li><li>直接提交信息的主体，不必话大段话去解说</li><li>根据提交信息类型自动更新包版本号(Bump the package version)</li><li>自动生成日志(CHANGELOGs)和 release 说明</li></ol><p>最后，语义化提交致力于实现更好的可读性和自动化，以及速度的提高。</p><p>话虽如此，我们中的一些人可能不接受这些消息约定，认为它们是可读的或提供信息的，这显然是有意义的。所以如果我们也不需要这些附带的好处，那在项目中执行这样的规范显然是没有意义的。</p><p>好了，是时候了解我们如何实际遵循这些约定了。</p><p>免责声明：从这一刻起，我们将引用 Angular 提交信息约定及其好处。</p><h2 id="提交信息的格式"><a href="#提交信息的格式" class="headerlink" title="提交信息的格式"></a>提交信息的格式</h2><p>Angular 规范要求根据以下结构来构造提交消息(Commit Message):</p><p><img src="https://d33wubrfki0l68.cloudfront.net/ab6c349cef44ee6b617234b4f2574b978ef2fa3e/42749/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commit-message-format-by-angular.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/ab6c349cef44ee6b617234b4f2574b978ef2fa3e/42749/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commit-message-format-by-angular.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="The commit message format according to Angular conventions"></p><p>上图向我们说明了提交消息由三个部分组成 —— header、body 和 footer 。</p><h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p>Header 是<strong>强制</strong>要求的一行，它简单地描述了更改的目的(最多100个字符)。<br>更好的是，它本身由三部分组成:</p><ol><li>类型(Type)：标识更改类型的短前缀</li><li>范围(Scope)：可选项，表明 Commit 影响的范围</li><li>主体(Subject)：表示对实际更改的简明描述</li></ol><p>实际上，就 Git 而言，它就是提交消息的首行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;fix(core): remove deprecated and defunct wtf* apis&quot;</span><br></pre></td></tr></table></figure><p>我们插入单行消息，并用 <code>:</code> 分隔。当 <code>fix</code>和 <code>core</code>（受影响的包）分别是类型和范围时，我们将左分区假设称为“前缀”。另一方面，右分区显然构成了主体(Subject)。</p><p>简而言之，上述消息含义是：<em>“本次更改通过移除不推荐使用(deprecated)和不存在的 wtf * api 修复了来自Core软件包的错误”</em>。</p><h3 id="Body"><a href="#Body" class="headerlink" title="Body"></a>Body</h3><p>主体(Body)是<strong>可选</strong>行，用于介绍本次更改背后的动机或仅描述一些更详细的信息。</p><p>让我们以上述的例子为例，并添加一个主体：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;fix(core): remove deprecated and defunct wtf* apis&quot; -m &quot;These apis have been deprecated in v8, so they should stick around till v10, but since they are defunct we are removing them early so that they don&#x27;t take up payload size.&quot;</span><br></pre></td></tr></table></figure><p>现在，我们在消息上附加了几句话，详细说明了此提交(Commit)目的。</p><p>请注意以下几点：</p><ul><li>我们使用了多个<code>-m</code>来连接段落而不是简单的行</li><li>头部和主体应该用空白行分隔（根据这些段落，这显然是正确的）</li></ul><p><strong>注意</strong>：尽管我们可以使用其他方式将消息分成几行，但为了简单起见，我们将在下一个示例中继续使用多个 <code>-m</code>（展示了一个与shell无关的解决方案）。</p><h3 id="Footer"><a href="#Footer" class="headerlink" title="Footer"></a>Footer</h3><p>尾部(Footer)是<strong>可选</strong>行，其中提到了由于更改而产生的影响，例如：宣布重大更改、链接关闭已解决的问题(issues)、提及贡献者等等。</p><p>这是上述带有尾部(footer)的提交消息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;fix(core): remove deprecated and defunct wtf* apis&quot; -m &quot;These apis have been deprecated in v8, so they should stick around till v10, but since they are defunct we are removing them early so that they don&#x27;t take up payload size.&quot; -m &quot;PR Close #33949&quot;</span><br></pre></td></tr></table></figure><p>在本例中，我们只是简单地添加了对相关拉请求(pull request)的引用，而没有添加其他内容。</p><p>最后，让我们查看完整的提交日志：</p><img src="https://d33wubrfki0l68.cloudfront.net/f477a323548298d5e4d42bc7be6f8a62aad62250/27eec/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/final-commit-message.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/f477a323548298d5e4d42bc7be6f8a62aad62250/27eec/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/final-commit-message.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Showing the commit log in one piece"><p>正如您可能会推断的，此<a href="https://github.com/angular/angular/commit/cf420194ed91076afb66d9179245b9dbaabc4fd4">提交</a>实际上是 Angular 存储库中存在的。</p><h2 id="常见类型"><a href="#常见类型" class="headerlink" title="常见类型"></a>常见类型</h2><p>除了定义提交消息格式外，Angular 的提交消息约定还指定了一个有用的类型列表，其中包含了各种各样的更改。</p><p>在开始之前，我们应该区分如下两种类型：</p><ul><li>开发(Development)：一种维护类型，它对变更进行分类，面向开发人员，这些变更实际上并不影响产品代码，而是影响内部的开发环境和工作流程(workflows)</li><li>生产(Production)：一种增强类型，用于对仅影响产品代码的最终用户(end users)进行更改分类</li></ul><p>现在，让我们介绍和解释这些类型。</p><p><strong>注意</strong>：以下示例直接取自Angular存储库的提交日志。</p><h3 id="👷构建"><a href="#👷构建" class="headerlink" title="👷构建"></a>👷构建</h3><p>构建类型 <code>build</code>(以前称为<code>chore</code>)用于识别与构建系统相关的<strong>开发</strong>更改(涉及脚本、配置或工具)和包依赖项(dependencies)。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/241c157655b2a391d15b49f46d5eca5e3568a6e4/402a5/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-build-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/241c157655b2a391d15b49f46d5eca5e3568a6e4/402a5/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-build-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `build` type"><h3 id="💚ci"><a href="#💚ci" class="headerlink" title="💚ci"></a>💚ci</h3><p><code>ci </code>类型用于识别与持续集成和部署系统相关的开发更改——包括脚本、配置或工具。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/2d7b17c202f31f63a6eec7e46df2d18ea7868d6a/e8324/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-ci-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/2d7b17c202f31f63a6eec7e46df2d18ea7868d6a/e8324/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-ci-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `ci` type"><h3 id="📝文档docs"><a href="#📝文档docs" class="headerlink" title="📝文档docs"></a>📝文档docs</h3><p>文档类型用于识别与项目相关的文档更改——无论是针对最终用户的外部更改(对于库)还是针对开发人员的内部更改。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/bc74f1e6bd91dd88c6d622ce8804f77be4718836/1d37a/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-docs-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/bc74f1e6bd91dd88c6d622ce8804f77be4718836/1d37a/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-docs-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `docs` type"><h3 id="✨特性"><a href="#✨特性" class="headerlink" title="✨特性"></a>✨特性</h3><p>该<code>feat</code>类型用于标识生产环境相关的新的向后兼容能力(backward-compatible)或功能的更改。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/942e86121f5c88e50462b05d80dd6e372dce96b3/c26af/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-feat-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/942e86121f5c88e50462b05d80dd6e372dce96b3/c26af/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-feat-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `feat` type"><h3 id="🐛修复"><a href="#🐛修复" class="headerlink" title="🐛修复"></a>🐛修复</h3><p><code>fix</code>类型用于标识生产环境相关向后兼容(backward-compatible)的 bug 修复(bug fixes)</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/69f22fa96e84fc5c1a09bf3055d8447224c9a9fc/ca58b/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-fix-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/69f22fa96e84fc5c1a09bf3055d8447224c9a9fc/ca58b/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-fix-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `fix` type"><h3 id="⚡️性能"><a href="#⚡️性能" class="headerlink" title="⚡️性能"></a>⚡️性能</h3><p><code>perf</code>类型用于标识生产环境相关向后兼容的<strong>性能</strong>(performance)改进相关的产品更改。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/661b70093cf0b94cae4129bc44257ea239caa3db/e060d/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-perf-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/661b70093cf0b94cae4129bc44257ea239caa3db/e060d/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-perf-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `perf` type"><h3 id="♻️重构"><a href="#♻️重构" class="headerlink" title="♻️重构"></a>♻️重构</h3><p><code>refactor</code>类型用于识别与修改代码库相关的开发更改，这些更改既没有添加功能，也没有修复 bug —— 例如删除冗余代码、简化代码、重命名变量等等。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/b9d8ae7afa8a026445a2ac28b92a90595115e523/5b26d/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-refactor-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/b9d8ae7afa8a026445a2ac28b92a90595115e523/5b26d/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-refactor-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `refactor` type"><h3 id="🎨风格"><a href="#🎨风格" class="headerlink" title="🎨风格"></a>🎨风格</h3><p><code>style</code>类型用于标识代码样式变动相关的开发更改，而不考虑其含义——例如缩进、分号、引号、结尾逗号等等。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/ad8400fbbbeb00a2809c4d0805adee32026254c2/8f851/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-style-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/ad8400fbbbeb00a2809c4d0805adee32026254c2/8f851/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-style-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `style` type"><h3 id="✅测试"><a href="#✅测试" class="headerlink" title="✅测试"></a>✅测试</h3><p><code>test</code>类型用于标识与测试相关的开发更改——例如重构现有测试或添加新测试。</p><p>例子：</p><img src="https://d33wubrfki0l68.cloudfront.net/db341477c4a017c37929c5fe80ffec77d37bcc10/cac60/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-test-type.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/db341477c4a017c37929c5fe80ffec77d37bcc10/cac60/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/examples-of-test-type.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Examples of commit messages with `test` type"><h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><p>现在我们已经熟悉了这些约定，让我们看看从中收获的两种好处。</p><h3 id="浏览历史变更记录"><a href="#浏览历史变更记录" class="headerlink" title="浏览历史变更记录"></a>浏览历史变更记录</h3><p>Git 为我们提供了浏览存储库提交历史的能力，所以我们就可以知道实际发生了什么，谁做了贡献等等。</p><p>让我们看看这些约定是如何简化我们对这些记录的浏览:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --oneline --grep &quot;^feat\|^fix\|^perf&quot;</span><br></pre></td></tr></table></figure><p>我们使用提交消息类型来过滤，因此只显示生产更改(所有以 <code>feat</code>、<code>fix</code> 或 <code>perf</code>开头的消息)。</p><p>另一个例子:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log --oneline --grep &quot;^feat&quot; | wc -l</span><br></pre></td></tr></table></figure><p>我们只打印 <code>feat</code> 更改的总数。</p><p>上述的关键是提交消息格式非常结构化，这使得我们在扫描或过滤提交历史记录时能够有效地依赖于此格式。</p><p>即，更加迅速!💪🏻</p><h3 id="自动发布"><a href="#自动发布" class="headerlink" title="自动发布"></a>自动发布</h3><p>提交消息格式对于自动化发布过程的步骤也很有用。</p><p>事实上，这可能是因为像<a href="https://github.com/conventional-changelog/standard-version">Standard Version</a>和<a href="https://github.com/semantic-release/semantic-release">Semantic Versioning</a>这样的工具严格遵循语义化的版本规范和特定的信息提交约定(分别是传统的提交约定和 Angular 约定)。它们之间的主要区别在于 <a href="https://github.com/conventional-changelog/standard-version#how-is-standard-version-different-from-semantic-release">approach</a>，但是让我们关注语义化发布(Semantic Release)。</p><p>因此，基于提交信息(特别是类型)——语义化发布(Semantic Release)能够给我们提供以下能力:</p><ul><li>转到下一个语义化包版本(发生重大变更时-补丁发布、监控到新特性和性能的优化)</li><li>创建一个包含生产环境相关发布信息的 CHANGELOG 文件</li><li>为新的发布版本创建一个 Git tag</li><li>将release artifact发布(Publish)到 npm 注册中心</li></ul><p>酷吧?</p><p>例如，Ionic 的<a href="https://github.com/ionic-team/angular-toolkit">angular-toolkit</a>项目，集成了语义化发布来自动化发布过程(在此遵循 Angular 的提交约定):</p><img src="https://d33wubrfki0l68.cloudfront.net/ac174adb87bdd863ccd14b588b25d444504fefb8/d1d92/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/example-of-release-note.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/ac174adb87bdd863ccd14b588b25d444504fefb8/d1d92/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/example-of-release-note.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="An example of a generated release version"><p>正如我们所注意到的，发布的版本是基于 tag 和注释生成的——但重点是，这是<strong>自动</strong>完成的。🤖</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p>为了充分利用语义化提交(semantic commit)，让我们来看一些东西。</p><h3 id="使用Emojis"><a href="#使用Emojis" class="headerlink" title="使用Emojis"></a>使用Emojis</h3><p>将表情符号附加到提交消息可能会进一步提高可读性，这样我们就可以在浏览提交历史时非常快速和容易地识别它们。💯</p><p>请参阅以下链接:</p><ul><li><a href="https://gitmoji.carloscuesta.me/">gitmoji</a></li><li><a href="https://github.com/dannyfritz/commit-message-emoji">Commit Message Emoji 👋</a></li></ul><h3 id="CLI工具"><a href="#CLI工具" class="headerlink" title="CLI工具"></a>CLI工具</h3><p><a href="https://github.com/commitizen/cz-cli">Commitizen</a> 是一个通过命令行强制格式化提交信息的工具:</p><img src="https://d33wubrfki0l68.cloudfront.net/de5e032567b4cccae05bafd47636c4b20f84868d/61d9f/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commitizen-example.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/de5e032567b4cccae05bafd47636c4b20f84868d/61d9f/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commitizen-example.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Semantic commit message using the command line"><h3 id="检查器-Linter"><a href="#检查器-Linter" class="headerlink" title="检查器(Linter)"></a>检查器(Linter)</h3><p><a href="https://github.com/conventional-changelog/commitlint">commitlint</a> 是一个保证提交消息格式符合约定的工具:</p><img src="https://d33wubrfki0l68.cloudfront.net/e71e415ceec4372fb6130d6f5501291362abb1be/1c7f0/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commitlint-example.png" class="lazyload" data-srcset="https://d33wubrfki0l68.cloudfront.net/e71e415ceec4372fb6130d6f5501291362abb1be/1c7f0/images/posts/2019-11-01-understanding-semantic-commit-messages-using-git-and-angular/commitlint-example.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Linting the commit messages"><h3 id="VSCode扩展"><a href="#VSCode扩展" class="headerlink" title="VSCode扩展"></a>VSCode扩展</h3><p>如果你想使用一个可定制的<a href="https://github.com/nitayneeman/vscode-git-semantic-commit">VScode扩展</a>，那么下面的内容可能会让你感兴趣:</p><img src="https://github.com/nitayneeman/vscode-git-semantic-commit/blob/master/images/examples/preview.gif?raw=true" class="lazyload" data-srcset="https://github.com/nitayneeman/vscode-git-semantic-commit/blob/master/images/examples/preview.gif?raw=true" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Semantic commit message using the Command Palette"><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我们今天介绍了“语义化提交”这个术语，并通过遵循 Angular 提交消息约定的具体例子，解释了这种消息的结构。</p><p>概括要点:</p><ul><li>语义化提交是对开发人员和工具都有重要意义的提交信息方式，它们遵循特定的约定</li><li>语义化提交(以及基于它的工具)有助于提高可读性、速度和自动化</li><li>Conventional Commits 是一个详细描述语义提交的规范，遵循轻量级约定</li><li>Angular 的指导原则详细描述了遵循项目约定的语义化提交，包括:<ul><li>包含 header、body 和 footer 的信息格式</li><li>与开发和生产相关的提交更改的类型</li></ul></li><li>我们可以利用信息约定轻松浏览提交历史</li><li>我们可以从这些规范收获自动化发布流程(release process)的好处</li></ul><p>最后，不管您是否决定采用这些约定,您可能会偶尔遇到它们，所以请记住上面的几点。😉</p><blockquote><ul><li>原文地址：<a href="https://nitayneeman.com/posts/understanding-semantic-commit-messages-using-git-and-angular/#motivation">Understanding Semantic Commit Messages Using Git and Angular</a></li><li>原文作者：<a href="https://github.com/nitayneeman">Nitay Neeman</a></li><li>译文首发于：<a href="https://seven-innovation-base.github.io/Git-IN-ACTION-docs/">Seven innovation base/Git-IN-ACTION-docs</a></li><li>译者：<a href="https://github.com/MrGo123">MrGo123</a></li><li>校对者：<a href="https://github.com/yeshan333">yeshan333</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> 工程化 </tag>
            
            <tag> 译文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>了解一波经典的 I/O 模型</title>
      <link href="2020/05/19/%E4%BA%86%E8%A7%A3%E4%B8%80%E6%B3%A2%E7%BB%8F%E5%85%B8%E7%9A%84-IO-%E6%A8%A1%E5%9E%8B/"/>
      <url>2020/05/19/%E4%BA%86%E8%A7%A3%E4%B8%80%E6%B3%A2%E7%BB%8F%E5%85%B8%E7%9A%84-IO-%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>最近读了波网络 I/O 相关的文章，做下总结、摘录。（未完）</p><h2 id="经典-I-O-模型"><a href="#经典-I-O-模型" class="headerlink" title="经典 I/O 模型"></a>经典 I/O 模型</h2><ul><li><div class='checkbox red checked'><input type="checkbox" checked="checked"/>            <p>阻塞式 I/O（blocking I/O）</p>            </div></li><li><div class='checkbox red checked'><input type="checkbox" checked="checked"/>            <p>非阻塞式 I/O（non-blocking I/O）</p>            </div></li><li><div class='checkbox red'><input type="checkbox" />            <p>I/O 多路复用（I/O multiplexing）</p>            </div></li><li><div class='checkbox cyan'><input type="checkbox" />            <p>信号驱动式 I/O（signal driven I/O）</p>            </div></li><li><div class='checkbox cyan'><input type="checkbox" />            <p>异步 I/O（asynchronous I/O）</p>            </div></li></ul><h3 id="阻塞式-I-O-模型"><a href="#阻塞式-I-O-模型" class="headerlink" title="阻塞式 I/O 模型"></a>阻塞式 I/O 模型</h3><p>对于阻塞式 I/O，以套接字（Socket）的输入操作为例。</p><ul><li>1、首先应用进程发起 I/O 系统调用后，应用进程阻塞，转到内核空间处理。</li><li>2、之后，内核开始等待数据，等待数据到达之后，将内核中的数据拷贝到用户的缓冲区中，整个 I/O 处理完毕后返回进程。最后应用进程解除阻塞状态，处理数据。</li></ul><span id="more"></span><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519164453.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519164453.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="阻塞式示例"></p><p>上图以 UDP 的 Socket 调用为例，进程调用 recvfrom 后，系统调用直到数据报到达且被复制到用户空间中或发生错误才返回。进程从调用开始到它返回的整段时间内是被阻塞的。recvfrom 成功返回后，应用进程开始处理数据报。</p><blockquote><p>默认情形，Linux/Unix 的所有 Socket 是阻塞的。</p></blockquote><p>附：基于 UDP 协议的 Socket 程序函数调用过程图</p><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519164642.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519164642.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="基于 UDP 协议的 Socket 程序函数调用过程图"></p><blockquote><p>一般情况下，服务端需要管理多个客户端连接（处理并发连接），而 recvfrom 只能监视单个 Socket。上图的阻塞式 I/O 模型表示的是一对一沟通的情形，使用多线程/进程 + 阻塞式 I/O 我们可以管理多个 Socket ，实现一对多服务。</p></blockquote><h3 id="非阻塞式-I-O-模型"><a href="#非阻塞式-I-O-模型" class="headerlink" title="非阻塞式 I/O 模型"></a>非阻塞式 I/O 模型</h3><p>在类 Unix 系统下，可以把一个 Socket 设置成非阻塞的。这意味着内核在数据报没有准备好时不会阻塞应用进程（睡眠态），而是返回一个错误。</p><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519170609.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519170609.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="非阻塞式 I/O 模型示例图"></p><p>上图以 UDP 的 Socket 调用为例，进程反复调用 recvfrom（polling，轮询），无数据返回 EWOULDBLOCK 错误，直至数据报准备好。</p><p>问题：<strong>单进程处理数据报，不同于阻塞I/O，由于需要反复 polling，非阻塞 I/O 会耗费大量的 CPU 资源，进程阻塞不耗费 CPU 资源</strong>。如果耍上了多进程，那耗费，是不可承受的。</p><p>关于阻塞的原理，这篇文章有简单介绍<a href="https://zhuanlan.zhihu.com/p/63179839">✔🔗</a>。</p><h3 id="I-O-多路复用模型"><a href="#I-O-多路复用模型" class="headerlink" title="I/O 多路复用模型"></a>I/O 多路复用模型</h3><p>什么是多路复用？多路指的是多个通道，一般就是多个网络连接的 I/O；复用指的是多个通道复用在一个复用器上。</p><p>引入多路复用机制的一个目的是为了处理多个网络连接 I/O。</p><blockquote><p>I/O多路复用方法的演进历程：select 模型-&gt; poll 模型-&gt; epoll 模型</p></blockquote><h4 id="select-模型"><a href="#select-模型" class="headerlink" title="select 模型"></a>select 模型</h4><p><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519214552.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200519214552.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="select多路复用示例"></p><p>上图所示的整个用户进程一般一直是被阻塞的（blocking），即被 select（复用器） 所阻塞，多个 Socket 被注册在 select 中。进程阻塞于 select 调用，等待数据报套接字变为可读，一但 select 返回套接字可读，系统调用 recvfrom 把所读数据报复制到应用进程缓冲区。</p><div class="note blue"><p>问题来了？为了处理多个网络连接 I/O，我们也可以通过多线程/进程的方式实现，多路复用的优势何在？这里的多路复用模型似乎比阻塞式 I/O 模型更为复杂，但它最大的优势在于用户可以在一个进程/线程内同时处理多个 socket 的 IO 请求。用户可以注册多个 socket，然后不断地调用 select 读取被激活的 socket，即可达到在同一个线程内同时处理多个 IO 请求的目的。（select 可接受的 socket 描述符数会有一定限制）</p></div><div class="note red"><p>我们知道，操作系统多个进程/线程的开销维护还是蛮大的。对于高并发场景，如果一台机器要维护 1 万个连接（C10K问题），使用多线程/进程的方式处理，操作系统是无法承受的。如果维持 1 亿用户在线需要 10 万台服务器，成本那是相当的高。</p></div><div class="note yellow"><p>$ 服务端单机最大 TCP 连接数=客户端 IP 数×客户端端口数 $，对于 IPv4，客户端的 IP 数最多为 2 的 32 次方，客户端的端口数最多为 2 的 16 次方。这只是理论上限，每个 TCP 连接的建立会受制于操作系统内存等因素的影响。</p></div><h4 id="epoll-模型"><a href="#epoll-模型" class="headerlink" title="epoll 模型"></a>epoll 模型</h4><p>新模型的出现肯定是为了解决旧模型的问题，那么 select 模型有什么问题？每次 Socket 所在的文件描述符集合中有 Socket 发生变化的时候，select 都需要通过轮询的方式去检查，而 epoll 引入了 CallBack（回调）机制，当某个文件描述符发送变化的时候，主动通知。随着监听的 Socket 数据增加的时候，效率相比于 select 的轮询快多了。</p><p>了解 epoll 的本质 -&gt; <a href="https://zhuanlan.zhihu.com/p/64138532">如果这篇文章说不清epoll的本质，那就过来掐死我吧！ （2）</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://book.douban.com/subject/4859464/">《UNIX网络编程 卷1：套接字联网API》</a></li><li><a href="https://time.geekbang.org/column/article/9293">趣谈网络协议</a></li><li><a href="https://time.geekbang.org/column/article/204696">RPC实战与核心原理</a></li><li><a href="https://zhuanlan.zhihu.com/p/63179839">如果这篇文章说不清epoll的本质，那就过来掐死我吧！</a></li><li><a href="https://zhuanlan.zhihu.com/p/54580385">5种网络IO模型（有图，很清楚）</a></li><li><a href="https://book.douban.com/subject/25773187/">《Nginx高性能Web服务器详解》</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> I/O模型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>『笔记』可扩展架构设计之消息队列</title>
      <link href="2020/04/06/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B9%8B%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
      <url>2020/04/06/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B9%8B%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>众所周知，开发低耦合系统是软件开发的终极目标之一。低耦合的系统更加容易扩展，低耦合的模块更加容易复用，更易于维护和管理。我们知道，消息队列的主要功能就是收发消息，但是它的作用不仅仅只是解决应用之间的通信问题这么简单。消息队列作为常用的中间件，经常被用来对系统解耦，对模块解耦。增强系统的可扩展性和模块的可复用性。</p><p>除了对用于对系统、模块解耦，消息队列还有以下几种通途：</p><ul><li>服务异步处理</li><li>流量控制</li><li>作为发布 / 订阅系统实现一个微服务级系统间的观察者模式</li><li>连接流计算任务和数据</li><li>用于将消息广播给大量接收者</li></ul><p>事物的存在总会有对立的一面，引入消息队列可能会带来延迟问题、产生数据不一致的问题、增加系统复杂度的问题等等。</p><span id="more"></span><h2 id="EDA-架构之生产者与消费者模式"><a href="#EDA-架构之生产者与消费者模式" class="headerlink" title="EDA 架构之生产者与消费者模式"></a>EDA 架构之生产者与消费者模式</h2><blockquote><p>事件驱动架构(Event Driven Architecture, EDA)</p></blockquote><h3 id="EDA-架构原理"><a href="#EDA-架构原理" class="headerlink" title="EDA 架构原理"></a>EDA 架构原理</h3><p>事件驱动架构由事件发起者和事件使用者组成。事件的发起者检测或感知事件，并以消息的形式来表示事件。它并不知道事件的使用者或事件引起的结果。</p><p>检测到事件后，系统会通过事件通道从事件发起者传输给事件使用者，而事件处理平台则会在该通道中以异步方式处理事件。事件发生时，需要通知事件使用者。他们可能会处理事件，也可能只是受事件的影响。</p><p>事件处理平台将对事件做出正确响应，并将活动下发给相应的事件使用者。通过这种下发活动，我们就可以看到事件的结果。</p><p>检测到事件后，系统会通过事件通道从事件发起者传输给事件使用者，而事件处理平台则会在该通道中以异步方式处理事件。事件发生时，需要通知事件使用者。他们可能会处理事件，也可能只是受事件的影响。</p><p>事件处理平台将对事件做出正确响应，并将活动下发给相应的事件使用者。通过这种下发活动，我们就可以看到事件的结果。</p><h3 id="生产者-消费者模型"><a href="#生产者-消费者模型" class="headerlink" title="生产者-消费者模型"></a>生产者-消费者模型</h3><p>操作系统中常见的 EDA 架构就是生产者-消费者模型。消息队列常用来作为生产者和消费者之间的缓冲带，平衡生产者和消费者的处理能同时对服务进行解耦。有了这层缓冲带，生产者和消费者可能都不知道对方的存在。</p><p><fancybox><img src="https://i.loli.net/2020/04/06/rCAbFk9RO7jIply.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/06/rCAbFk9RO7jIply.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="生产者与消费者模式"></fancybox></p><p>以下为生产者-消费者模型的简单实现，(内存消息队列)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span>(<span class="params">Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, queue</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            productA = randint(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">            productB = randint(<span class="number">90</span>, <span class="number">100</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Produce A「number」: &#123;&#125;, Produce B「number」: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(productA, productB))</span><br><span class="line">            self.queue.put((productA, productB))</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span>(<span class="params">Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, queue</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># block=True, if queue is empty, block(阻塞)</span></span><br><span class="line">            products_tuple = self.queue.get(block=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Consume products: <span class="subst">&#123;products_tuple[<span class="number">0</span>]&#125;</span> &amp; <span class="subst">&#123;products_tuple[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">            time.sleep(randint(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    queue = Queue()</span><br><span class="line">    producer = Producer(queue)</span><br><span class="line">    consumer = Consumer(queue)</span><br><span class="line"></span><br><span class="line">    producer.start()</span><br><span class="line">    consumer.start()</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Produce A「number」: 8, Produce B「number」: 95</span></span><br><span class="line"><span class="string">Consume products: 8 &amp; 95</span></span><br><span class="line"><span class="string">Produce A「number」: 4, Produce B「number」: 92</span></span><br><span class="line"><span class="string">Consume products: 4 &amp; 92</span></span><br><span class="line"><span class="string">Produce A「number」: 9, Produce B「number」: 90</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="基于ZeroMQ-PubSub模式的观察者模式实例"><a href="#基于ZeroMQ-PubSub模式的观察者模式实例" class="headerlink" title="基于ZeroMQ PubSub模式的观察者模式实例"></a>基于ZeroMQ PubSub模式的观察者模式实例</h3><p><fancybox><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200522171643.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200522171643.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="ZeroMQ"></fancybox></p><p><fancybox><img src="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200522171357.png" class="lazyload" data-srcset="https://mypic-1258313760.cos.ap-guangzhou.myqcloud.com/img/20200522171357.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="PubSub模式"></fancybox></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># publisher1.py</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> zmq</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">publisher1</span>():</span></span><br><span class="line">    context = zmq.Context()</span><br><span class="line">    socket = context.socket(zmq.PUB)</span><br><span class="line">    socket.bind(<span class="string">&quot;tcp://*:5555&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">99</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            socket.send_string(<span class="string">&#x27;publisher1 pushes event %d&#x27;</span> % count)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;push event %d&#x27;</span> % count)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    publisher1()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># publisher2.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> zmq</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">publisher2</span>():</span></span><br><span class="line">    context = zmq.Context()</span><br><span class="line">    socket = context.socket(zmq.PUB)</span><br><span class="line">    socket.bind(<span class="string">&quot;tcp://*:5556&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            socket.send_string(<span class="string">&#x27;publisher2 pushes event %d&#x27;</span> % count)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;push event %d&#x27;</span> % count)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    publisher2()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># subscriber1.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zmq</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">subscriber1</span>():</span></span><br><span class="line">    context = zmq.Context()</span><br><span class="line">    socket = context.socket(zmq.SUB)</span><br><span class="line">    socket.connect(<span class="string">&#x27;tcp://127.0.0.1:5555&#x27;</span>)</span><br><span class="line">    socket.connect(<span class="string">&#x27;tcp://127.0.0.1:5556&#x27;</span>)</span><br><span class="line">    socket.setsockopt_string(zmq.SUBSCRIBE, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        message = socket.recv()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;message: %s&#x27;</span> % message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    subscriber1()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># subscriber2.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zmq</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">subscriber2</span>():</span></span><br><span class="line">    context = zmq.Context()</span><br><span class="line">    socket = context.socket(zmq.SUB)</span><br><span class="line">    socket.connect(<span class="string">&#x27;tcp://127.0.0.1:5555&#x27;</span>)</span><br><span class="line">    socket.connect(<span class="string">&#x27;tcp://127.0.0.1:5556&#x27;</span>)</span><br><span class="line">    socket.setsockopt_string(zmq.SUBSCRIBE, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        message = socket.recv()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;message: %s&#x27;</span> % message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    subscriber2()</span><br></pre></td></tr></table></figure><h2 id="秒杀系统的架构设计与消息队列"><a href="#秒杀系统的架构设计与消息队列" class="headerlink" title="秒杀系统的架构设计与消息队列"></a>秒杀系统的架构设计与消息队列</h2><p>某秒杀系统的主要处理步骤如下：</p><ul><li>风险控制</li><li>库存锁定</li><li>生成订单</li><li>短信通知</li><li>更新统计数据</li></ul><h3 id="使用消息队列进行异步处理"><a href="#使用消息队列进行异步处理" class="headerlink" title="使用消息队列进行异步处理"></a>使用消息队列进行异步处理</h3><p>由于秒杀成功的关键取决于风险控制、库存锁定这两步骤，所以 server 端处理了这两步之后可以给 client 端返回结果了，后续的步骤可放入消息队列中异步执行。不一定要在<strong>秒杀请求</strong>中完成。集中资源处理关键步骤（同步），碎片时间（全部秒杀请求处理结束）处理次要步骤（异步）。</p><p><fancybox><img src="https://i.loli.net/2020/04/06/2gitIYUMlOoK8S5.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/06/2gitIYUMlOoK8S5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></fancybox></p><h3 id="使用消息队列进行流量控制-削峰"><a href="#使用消息队列进行流量控制-削峰" class="headerlink" title="使用消息队列进行流量控制(削峰)"></a>使用消息队列进行流量控制(削峰)</h3><p>秒杀开始后，将超过 server 端处理上限（短时间内）的秒杀请求放入消息队列中，后续有能力处理时再对消息队列中消费请求进行处理。对于超时的请求可以直接丢弃（秒杀失败）。</p><p><fancybox><img src="https://i.loli.net/2020/04/06/24zoWGpgLlJkC6U.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/06/24zoWGpgLlJkC6U.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></fancybox></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://book.douban.com/subject/25723064/">大型网站技术架构</a></li><li><a href="https://www.redhat.com/zh/topics/integration/what-is-event-driven-architecture">什么是事件驱动架构</a></li><li><a href="https://time.geekbang.org/column/article/109572">为什么需要消息队列-极客时间</a></li><li><a href="https://zeromq.org/">ZeroMQ</a></li><li><a href="https://github.com/zeromq/pyzmq">pyzmq</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Architecture </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 架构设计 </tag>
            
            <tag> 消息队列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单例模式如何保证实例的唯一性</title>
      <link href="2020/04/04/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%94%AF%E4%B8%80%E6%80%A7/"/>
      <url>2020/04/04/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%94%AF%E4%B8%80%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>最近面试发现自己不懂的东西还是很多的，写一波文章来巩固和挖掘欠缺的知识点以及加深对已有知识点原理的理解。</p></blockquote><p><fancybox><img src="https://i.loli.net/2020/04/04/aq3S2RgwfWEuB7K.jpg" class="lazyload" data-srcset="https://i.loli.net/2020/04/04/aq3S2RgwfWEuB7K.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="无知.jpg"></fancybox></p><span id="more"></span><h2 id="什么是单例模式"><a href="#什么是单例模式" class="headerlink" title="什么是单例模式"></a>什么是单例模式</h2><ul><li>指一个类只有一个实例，且该类能自行创建这个实例的一种创建型设计模式。</li><li>使用目的：确保在整个系统中只能出现类的一个实例，即一个类只有一个对象。对于频繁使用的对象，“忽略”创建时的开销。</li><li>特点：<ul><li>单例类只有一个实例对象；</li><li>该单例对象必须由单例类自行创建；</li><li>单例类对外提供一个访问该单例的全局访问点；</li></ul></li></ul><h2 id="如何保证实例的唯一性"><a href="#如何保证实例的唯一性" class="headerlink" title="如何保证实例的唯一性"></a>如何保证实例的唯一性</h2><p>那么，如何保证实例的唯一性？</p><h3 id="Java-的解决方案之一"><a href="#Java-的解决方案之一" class="headerlink" title="Java 的解决方案之一"></a>Java 的解决方案之一</h3><p>对于 Java 来说，要确保类的构造方法是私有的，使用 static final 的私有成员变量存放这个唯一实例。我们还要提供一个获取实例的接口（由于我们要通过类名获取实例，所以接口方法是 static 的）。实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton instance=<span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>我们知道，对于 static 的变量，类所有的实例都可以共享这个变量，我们可以直接通过类名来访问它。再使用 final 修饰这个变量，使得它不能再被改变。</p></blockquote><p><a href="https://juejin.im/post/5b50b0dd6fb9a04f932ff53f#heading-4">戳此处深入了解 →</a></p><h3 id="Python-的解决方案之一"><a href="#Python-的解决方案之一" class="headerlink" title="Python 的解决方案之一"></a>Python 的解决方案之一</h3><p>以下为 Python 使用装饰器实现的单例模式。这里将不可变的<strong>类地址</strong>存放在了 dict 中，值为那个唯一的实例。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Singleton</span>(<span class="params">cls</span>):</span></span><br><span class="line">    _instance = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getInstance</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> _instance:</span><br><span class="line">            _instance[cls] = cls()</span><br><span class="line">        <span class="keyword">return</span> _instance[cls]</span><br><span class="line">    <span class="keyword">return</span> getInstance</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test_singleton</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    class1 = test_singleton()</span><br><span class="line">    class2 = test_singleton()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;class1 id: &#123;&#125;, class2 id: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>( <span class="built_in">id</span>(class1), <span class="built_in">id</span>(class2)))</span><br><span class="line">    <span class="built_in">print</span>(class1 == class2)</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># class1 id: 1814844368152, class2 id: 1814844368152</span></span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://stackoverflow.com/questions/6760685/creating-a-singleton-in-python">Creating a singleton in Python</a></li><li><a href="http://c.biancheng.net/view/1338.html">单例模式（单例设计模式）详解</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 mypy 做 type check</title>
      <link href="2020/03/06/%E4%BD%BF%E7%94%A8-mypy-%E5%81%9Atype-check/"/>
      <url>2020/03/06/%E4%BD%BF%E7%94%A8-mypy-%E5%81%9Atype-check/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>完残！😂，最近看之前写的 Python 代码老得琢磨这比变量的类型是啥（<del>Python 无类型系统xxx</del>），不愧是我写的！</p><p>看段之前写的实现迭代器模式的代码：</p><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 抽象迭代器类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Iterator</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 抽象聚集类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aggregate</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iterator</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookShelf</span>(<span class="params">Aggregate</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._books = []</span><br><span class="line">        self._last = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getBookAt</span>(<span class="params">self, index</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._books[index]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">appendBook</span>(<span class="params">self, book</span>):</span></span><br><span class="line">        self._books.append(book)</span><br><span class="line">        self._last = self._last + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLength</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._last</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iterator</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> BookShelfIterator(self)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookShelfIterator</span>(<span class="params">Iterator</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, bookShelf</span>):</span></span><br><span class="line">        self._bookShelf = bookShelf</span><br><span class="line">        self._index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self._index &lt; self._bookShelf.getLength():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        book = self._bookShelf.getBookAt(self._index)</span><br><span class="line">        self._index = self._index + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> book</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    bookShelf = BookShelf()</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;A&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;B&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;C&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;D&quot;</span>))</span><br><span class="line"></span><br><span class="line">    it = bookShelf.iterator()</span><br><span class="line">    <span class="keyword">while</span> it.hasNext():</span><br><span class="line">        book = it.<span class="built_in">next</span>()</span><br><span class="line">        <span class="built_in">print</span>(book.getName())</span><br></pre></td></tr></table></figure><p>有一丢丢难读（不通读的话，会乱猜某变量类型），回想之前在 PyCon China 2019 的大会资聊曾看到过类型检查相关的演讲主题，回顾下演讲视频。水一波，写篇文章了解下 Python 标准(<a href="https://www.python.org/dev/peps/pep-3107/">PEP 3107</a> &amp; <a href="https://www.python.org/dev/peps/pep-0484/">PEP 484</a> )支持的 mypy。</p><blockquote><p>类型系统：编译期的类型推导检查规则，类型系统属于一种轻量级的形式化方法（一种数学方法）</p></blockquote><h2 id="使用-mypy"><a href="#使用-mypy" class="headerlink" title="使用-mypy"></a>使用-mypy</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装 mypy</span></span><br><span class="line">pip install mypy</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用 mypy 做类型检查</span></span><br><span class="line">mypy module_name.py</span><br></pre></td></tr></table></figure><p>以下使用方式适用于 Python 3.6 及以上的版本。<strong>值得注意</strong>：mypy 默认的推导类型不可为 None</p><h3 id="变量的类型注释"><a href="#变量的类型注释" class="headerlink" title="变量的类型注释"></a>变量的类型注释</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">integer: <span class="built_in">int</span> = <span class="number">1</span></span><br><span class="line">string: <span class="built_in">str</span> = <span class="string">&quot;ShanSan&quot;</span></span><br><span class="line">err_str: <span class="built_in">str</span> = <span class="number">1</span>  <span class="comment"># error: Incompatible types in assignment</span></span><br><span class="line">child: <span class="built_in">bool</span> = <span class="literal">True</span></span><br><span class="line"><span class="comment"># mypy 默认的推导类型不可为 None</span></span><br><span class="line">none: <span class="built_in">int</span> - <span class="literal">None</span>  <span class="comment"># error: Invalid type comment or annotation</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(integer, string)</span><br></pre></td></tr></table></figure><h3 id="内建类型"><a href="#内建类型" class="headerlink" title="内建类型"></a>内建类型</h3><p>关于更多 mypy 的类型系统内建的类型可参考：<a href="https://mypy.readthedocs.io/en/stable/builtin_types.html">https://mypy.readthedocs.io/en/stable/builtin_types.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">Tuple</span>, <span class="type">Optional</span>, Iterable, <span class="type">Union</span></span><br><span class="line"><span class="comment"># 对于映射(Map)数据结构，需要指定 key 和 value 的类型</span></span><br><span class="line">x: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">float</span>] = &#123;<span class="string">&#x27;field&#x27;</span>: <span class="number">2.0</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tuple 需要指定所有元素的类型</span></span><br><span class="line">x: <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">str</span>, <span class="built_in">float</span>] = (<span class="number">3</span>, <span class="string">&quot;yes&quot;</span>, <span class="number">7.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># error: Incompatible types in assignment (expression has type &quot;Tuple[int, str, float, int]&quot;, variable has type &quot;Tuple[int, str, float]&quot;)</span></span><br><span class="line">y: <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">str</span>, <span class="built_in">float</span>] = (<span class="number">3</span>, <span class="string">&quot;yes&quot;</span>, <span class="number">7.5</span>, <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">op: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>  <span class="comment"># 可为 str 或 None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 泛用可迭代对象</span></span><br><span class="line">l: Iterable = [<span class="number">1</span>]</span><br><span class="line">t: Iterable = (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">d: Iterable = &#123;<span class="number">1</span>: <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可为 str 或 int</span></span><br><span class="line">str_int1: <span class="type">Union</span>[<span class="built_in">str</span>, <span class="built_in">int</span>] = <span class="number">1</span></span><br><span class="line">str_int2: <span class="type">Union</span>[<span class="built_in">str</span>, <span class="built_in">int</span>] = <span class="string">&quot;ss&quot;</span></span><br><span class="line">str_int3: <span class="type">Union</span>[<span class="built_in">str</span>, <span class="built_in">int</span>] = <span class="literal">None</span>  <span class="comment"># error</span></span><br></pre></td></tr></table></figure><h3 id="函数注解"><a href="#函数注解" class="headerlink" title="函数注解"></a>函数注解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> NoReturn</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span>() -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span>() -&gt; NoReturn:</span>  <span class="comment"># 无返回值</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plus</span>(<span class="params">num1: <span class="built_in">int</span>, num2: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 带默认值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plus_default</span>(<span class="params">num1: <span class="built_in">int</span>, num2: <span class="built_in">int</span> = <span class="number">3</span></span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 容器的参数类型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">container_param</span>(<span class="params">names: <span class="type">List</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">        <span class="built_in">print</span>(name)</span><br></pre></td></tr></table></figure><h3 id="类成员注解"><a href="#类成员注解" class="headerlink" title="类成员注解"></a>类成员注解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line">    attr: <span class="built_in">int</span></span><br><span class="line">    <span class="comment"># 带默认值的实例变量</span></span><br><span class="line">    charge_percent: <span class="built_in">int</span> = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 没有任何返回值应该注解为 None</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 忽略对 self 类型的注解</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_method</span>(<span class="params">self, num: <span class="built_in">int</span>, str1: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="keyword">return</span> num * str1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 支持自定义类型的注解</span></span><br><span class="line">x: MyClass = MyClass()</span><br></pre></td></tr></table></figure><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>OK， 差不多了，对之前的迭代器模式的代码改造一波</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, Iterable</span><br><span class="line"></span><br><span class="line"><span class="comment"># 抽象迭代器类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Iterator</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 抽象聚集类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aggregate</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iterator</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookShelf</span>(<span class="params">Aggregate</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self._books: <span class="type">List</span>[Book] = []</span><br><span class="line">        self._last: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getBookAt</span>(<span class="params">self, index: <span class="built_in">int</span></span>) -&gt; Book:</span></span><br><span class="line">        <span class="keyword">return</span> self._books[index]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">appendBook</span>(<span class="params">self, book: Book</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self._books.append(book)</span><br><span class="line">        self._last = self._last + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLength</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._last</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iterator</span>(<span class="params">self</span>) -&gt; BookShelfIterator:</span></span><br><span class="line">        <span class="keyword">return</span> BookShelfIterator(self)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookShelfIterator</span>(<span class="params">Iterator</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, bookShelf</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self._bookShelf: BookShelf = bookShelf</span><br><span class="line">        self._index: <span class="built_in">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span>(<span class="params">self</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self._index &lt; self._bookShelf.getLength():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>) -&gt; Book:</span></span><br><span class="line">        book: Book = self._bookShelf.getBookAt(self._index)</span><br><span class="line">        self._index = self._index + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> book</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        self._name: <span class="built_in">str</span> = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    bookShelf: BookShelf = BookShelf()</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;A&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;B&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;C&quot;</span>))</span><br><span class="line">    bookShelf.appendBook(Book(<span class="string">&quot;D&quot;</span>))</span><br><span class="line"></span><br><span class="line">    it: Iterator = bookShelf.iterator()</span><br><span class="line">    <span class="keyword">while</span> it.hasNext():</span><br><span class="line">        book: Book = it.<span class="built_in">next</span>()</span><br><span class="line">        <span class="built_in">print</span>(book.getName())</span><br></pre></td></tr></table></figure><p>emmm, 舒服了一丢丢/(ㄒoㄒ)/~~</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://github.com/python/mypy">https://github.com/python/mypy</a></li><li><a href="https://shimo.im/docs/dpq9q6hJttwVcqHy/read">PyCon China 2019 成都分会场-刘知杭-静态类型的 Python</a>, <a href="https://www.bilibili.com/video/av75148536?p=5">video🔗</a></li><li><a href="https://shimo.im/docs/HRdRxCDXtKy9TPVh/read">PyCon China 2019 北京分会场-依云-类型检查拯救粗心开发者</a>, <a href="https://www.bilibili.com/video/av75279850?p=9">video🔗</a></li><li><a href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html">Type hints cheat sheet (Python 3)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 静态类型检查 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>洞悉技术的本质-Git内部原理探索</title>
      <link href="2020/02/03/Git%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E6%8E%A2%E7%B4%A2/"/>
      <url>2020/02/03/Git%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E6%8E%A2%E7%B4%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>洞悉技术的本质，可以让我们在层出不穷的框架面前仍能泰然处之。用了那么久的 Git，不懂点内部原理，那可不行！懂点原理可以让我们遇到问题的时候能够更好更快的理清解决问题的思路。</p><p>要真正读懂本文可能需要以下基础：</p><ul><li>有 Git 使用经验</li><li>对 Git 的三个分区有所了解</li><li>熟悉常用的 Linux 命令</li><li>对经典哈希算法有一定的了解，比如<a href="https://zh.wikipedia.org/zh/SHA-1">SHA-1</a>、SHA-256、MD5等</li></ul><p>在开始之前，让我们先抛出几个问题，然后一一解决、回答它们</p><ul><li>.git版本库里的文件/目录是干什么的?</li><li>Git是如何存储文件信息的？</li><li>当我们执行git add、git commit时，Git背后做了什么？</li><li>Git分支的本质是什么?</li></ul><span id="more"></span><h1 id="Git分区"><a href="#Git分区" class="headerlink" title="Git分区"></a>Git分区</h1><p>在真正开始之前，让我们先回顾下Git的三个分区（Workspace、Index / Stage、git repository）</p><ul><li>工作区（Workspace）：此处进行代码文件的编辑</li><li>索引或称暂存区（Index / Stage）：存储文件状态信息，进行commit前会对此时的文件状态作快照（Snapshot）</li><li>Git版本库（git repository）：由Git Object持久记录每一次commit的快照和链式结构的commit变更历史</li></ul><p>先看下从《Got Git》和网络上搬来的Git分区工作原理图和待remote的工作流再次感性回顾下之前使用Git自己时怎么操作的</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20200202210748.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20200202210748.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="工作区、版本库、暂存区工作原理图"></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20200202210624.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20200202210624.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="带Remote的工作流"></p><p>相信看了这些，会对Git有新的认知，让我们正式开始🎉！</p><h1 id="git版本库里的文件-目录是干什么的"><a href="#git版本库里的文件-目录是干什么的" class="headerlink" title=".git版本库里的文件/目录是干什么的"></a>.git版本库里的文件/目录是干什么的</h1><p>让我们通过一个从GitHub clone下来的一个实际项目的版本库来看下这些文件/目录，<a href="https://github.com/yeshan333/Explore-Git">clone下来的repository</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/yeshan333/Explore-Git</span><br><span class="line"></span><br><span class="line">$ ls -F1</span><br><span class="line">config</span><br><span class="line">description</span><br><span class="line">HEAD</span><br><span class="line">hooks/</span><br><span class="line">index</span><br><span class="line">info/</span><br><span class="line">logs/</span><br><span class="line">objects/</span><br><span class="line">packed-refs</span><br><span class="line">refs/</span><br></pre></td></tr></table></figure><p><strong>挑几个重要文件/目录的做下解释</strong></p><ul><li>HEAD文件：用于存放当前所在分支的引用，这个引用是个符号引用（symbolic reference）</li><li>index文件：二进制文件，它就是暂存区（Stage Area）。它是一个目录树，记录了文件的时间戳、文件长度、SHA-1等</li><li>refs目录：基本所有的引用（references）文件都存放在这里，引用文件中的内容为SHA-1值，一般是commit object的SHA-1值</li><li>objects目录：用于存放数据的所有 Git Object均存放在这个目录下，每个 Git Object 对应一个目录，object对应的SHA-1值的前 2 位为目录名，后 38 位为文件名</li></ul><p>抱着一些初步的认知，我们继续解决后面几个问题，加深对.git版本库内文件的理解</p><h1 id="Git是如何存储文件信息的"><a href="#Git是如何存储文件信息的" class="headerlink" title="Git是如何存储文件信息的"></a>Git是如何存储文件信息的</h1><p>要知道Git如何存储信息，我们需要了解一下常见的Git对象，Git就是通过这些对象存储文件信息的。Git Object是Git存储文件信息的最小单元，如下为几种常见的Git Object以及它们的作用，它们一般是不可变的（immutable），这些对象使用40位的SHA-1值进行标识。</p><ul><li><a href="https://en.wikipedia.org/wiki/Binary_large_object">blob</a>：用于存储文件内容，Git保存文件的时候不会保存文件名</li><li>tree object：当前目录结构的一个快照（Snapshot），它存储了一条或多条树记录（tree entries），每条记录含有一个指向数据对象（blob）或子树对象（子树木对象可理解为子目录）的SHA-1指针以及相应的文件模式、类型、文件名，用于表示内容之间的目录层次关系</li><li>commit object：存储<strong>顶层tree object</strong>的SHA-1值、作者/提交者信息+时间戳以及提交注释，如果有父commit object，还会保存有这个commit object对应的SHA-1值。对于merge commit可能会有多个父commit object</li><li>tag object：用于标记commit object。关于<a href="https://git-scm.com/book/en/v2/Git-Internals-Git-References">tag object</a></li></ul><p>让我们通过一个实际的版本库了解下这些对象，使用<a href="https://git-scm.com/docs/git-log#Documentation/git-log.txt---prettyltformatgt"><code>git log</code></a>查看这个版本库详尽的历史提交记录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --pretty=raw</span><br><span class="line">commit ee8a0dbc0c6fe89e6ff39b16c77543e8e2c6475b</span><br><span class="line">tree fb12b3e52ce18ce281bfc2b11a5e4350c2d10358</span><br><span class="line">parent 7b94dcbe89c9534913854284b4af727a9a5dfc84</span><br><span class="line">author yeshan333 &lt;1329441308@qq.com&gt; 1580629391 +0800</span><br><span class="line">committer yeshan333 &lt;1329441308@qq.com&gt; 1580629391 +0800</span><br><span class="line"></span><br><span class="line">    final commit</span><br><span class="line"></span><br><span class="line">commit 7b94dcbe89c9534913854284b4af727a9a5dfc84</span><br><span class="line">tree 8feb4afbab18e8d386413224a9e74f871c15a5ca</span><br><span class="line">author yeshan333 &lt;1329441308@qq.com&gt; 1580629170 +0800</span><br><span class="line">committer GitHub &lt;noreply@github.com&gt; 1580629170 +0800</span><br><span class="line"></span><br><span class="line">    Initial commit</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Git提供了一把非常好用的瑞士军刀🔪给我们剖析这些对象，它是就是<code>cat-file</code>，通过<code>-t</code>参数可以查看object的类型，通过<code>-p</code>参数我们可以查看object存储的具体内容。查看信息时，我们需要使用到object对应的SHA-1值，可不必写完，从头开始的前几位不冲突即可。</strong><a href="https://git-scm.com/docs/git-cat-file">git cat-file</a></p><p>让我们通过它查看下SHA-1值<code>ee8a0dbc0c6fe89e6ff39b16c77543e8e2c6475b</code>对应的commit object的类型以及存放的内容。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git cat-file -t ee8a</span><br><span class="line">commit</span><br><span class="line"></span><br><span class="line">$ git cat-file -p ee8a</span><br><span class="line">tree fb12b3e52ce18ce281bfc2b11a5e4350c2d10358</span><br><span class="line">parent 7b94dcbe89c9534913854284b4af727a9a5dfc84</span><br><span class="line">author yeshan333 &lt;1329441308@qq.com&gt; 1580629391 +0800</span><br><span class="line">committer yeshan333 &lt;1329441308@qq.com&gt; 1580629391 +0800</span><br><span class="line"></span><br><span class="line">final commit</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>让我们再查看下这个commit object（ee8a）存储的tree object（fb12）的信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git cat-file -p fb12</span><br><span class="line">100644 blob 6116a7dd8f752dabff8730a46b46846b2d0a696b    README.md</span><br><span class="line">040000 tree 41ed97c2adb97658107069582b6a27e474b4cc64    <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">$ git cat-file -t fb12</span><br><span class="line">tree</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们知道tree object存储了一条或多条树记录（tree entries），每条记录含有一个指向数据对象（blob）或子树对象（子树木对象可理解为子目录）的SHA-1指针以及相应的文件模式、类型、文件名。100644即为对应的文件模式，100644表示普通文本文件，040000表示目录文件。<a href="https://cloud.tencent.com/developer/ask/82974/answers/created">关于文件模式的一点疑问</a></p><p>让我们再看下tree object（fb12）存储的SHA-1指针（6116）对应的blob（6116）存放的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git cat-file -p 6116</span><br><span class="line"><span class="comment"># Explore-Git</span></span><br><span class="line">$ git cat-file -t 6116</span><br><span class="line">blob</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Nice，很好的对应了之前对blob、tree object、commit object的描述。关于文件的大部分信息都存放在这些object中。</p><h1 id="当我们执行git-add、git-commit时，Git背后做了什么"><a href="#当我们执行git-add、git-commit时，Git背后做了什么" class="headerlink" title="当我们执行git add、git commit时，Git背后做了什么"></a>当我们执行git add、git commit时，Git背后做了什么</h1><p>解答这个问题，我们需要通过实践去一步步感受Git背后的操作。我们创建一个简单的例子感受下，我们需要时刻关注.git/objects这个目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir demo</span><br><span class="line">$ <span class="built_in">cd</span> demo</span><br><span class="line">$ git init <span class="comment"># 初始化Git仓库</span></span><br><span class="line">$ find .git/objects -<span class="built_in">type</span> f <span class="comment"># 没有文件</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;test&quot;</span> &gt; test.txt</span><br><span class="line">$ mkdir hi</span><br><span class="line">$ <span class="built_in">cd</span> hi</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;Hello&quot;</span> &gt; hello.txt</span><br><span class="line">$ <span class="built_in">cd</span> ..</span><br><span class="line">$ find .git/objects -<span class="built_in">type</span> f</span><br><span class="line">$ <span class="comment"># 什么都没有</span></span><br></pre></td></tr></table></figure><p>这里我们创建先了两个文件，test.txt、hello.txt，其中hello.txt文件放到了hi目录中，然后我们查看了.git/objects目录，没有文件。接下来就是重头戏了，我们要将当前目录的文件/目录（Linux一切皆文件）添加到暂存区（stage/index）。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br><span class="line">$ find .git/objects -<span class="built_in">type</span> f</span><br><span class="line">.git/objects/9d/aeafb9864cf43055ae93beb0afd6c7d144bfa4</span><br><span class="line">.git/objects/e9/65047ad7c57865823c7d992b1d046ea66edf78</span><br></pre></td></tr></table></figure><p>我们可以看到，执行了<code>git add</code>之后生成了两个文件，让我们通过<code>git cat-file</code>看看这两个文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git cat-file -t 9dae</span><br><span class="line">blob</span><br><span class="line">$ git cat-file -p 9dae</span><br><span class="line"><span class="built_in">test</span> <span class="comment"># test.txt文件中的内容</span></span><br><span class="line">$ git cat-file -t e965</span><br><span class="line">blob</span><br><span class="line">$ git cat-file -p e965</span><br><span class="line">Hello <span class="comment"># hi/hello.txt文件中的内容</span></span><br></pre></td></tr></table></figure><p>哦，Git为我们生成了两个object，两个blob，存放的是test.txt、hello.txt的内容，让我们commit一下看看Git又做了什么</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ find .git/objects -<span class="built_in">type</span> f</span><br><span class="line">.git/objects/27/1c49aa4a2c8eb1b2ef503c19378aa6810fca1e</span><br><span class="line">.git/objects/2e/8ebea76975c98806e73c0b7aea6c40c58d427c</span><br><span class="line">.git/objects/8c/3c7fbcd903744b20fd7567a1fcefa99133b5bc</span><br><span class="line">.git/objects/9d/aeafb9864cf43055ae93beb0afd6c7d144bfa4</span><br><span class="line">.git/objects/e9/65047ad7c57865823c7d992b1d046ea66edf78</span><br><span class="line">$ git cat-file -t 271c</span><br><span class="line">commit</span><br><span class="line">$ git cat-file -t 2e8e</span><br><span class="line">tree</span><br><span class="line">$ git cat-file -t 8c3c</span><br><span class="line">tree</span><br><span class="line">$</span><br><span class="line">$ git cat-file -p 271c</span><br><span class="line">tree 2e8ebea76975c98806e73c0b7aea6c40c58d427c</span><br><span class="line">author root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580651827 +0800</span><br><span class="line">committer root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580651827 +0800</span><br><span class="line"></span><br><span class="line">Hello Git</span><br><span class="line">$ git cat-file -p 8c3c</span><br><span class="line">100644 blob e965047ad7c57865823c7d992b1d046ea66edf78    hello.txt</span><br><span class="line">$ git cat-file -p 2e8e</span><br><span class="line">040000 tree 8c3c7fbcd903744b20fd7567a1fcefa99133b5bc    hi</span><br><span class="line">100644 blob 9daeafb9864cf43055ae93beb0afd6c7d144bfa4    test.txt</span><br></pre></td></tr></table></figure><p>哦，commit后Git为我们新创建了3个object，分别是根树对象tree object（2e8e）、子树对象tree object（8c3c）、commit object（271c）。现在一共有5个Git Object。这些object存放的内容符合我们在解答<strong>Git是如何存储文件信息的</strong>时对它们的表述。Git在add、commit后有条不紊的把它们组织了起来。tql👍</p><p>让我们看下此次提交的日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --pretty=raw</span><br><span class="line">commit 271c49aa4a2c8eb1b2ef503c19378aa6810fca1e</span><br><span class="line">tree 2e8ebea76975c98806e73c0b7aea6c40c58d427c</span><br><span class="line">author root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580651827 +0800</span><br><span class="line">committer root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580651827 +0800</span><br><span class="line"></span><br><span class="line">    Hello Git</span><br></pre></td></tr></table></figure><p>问题来了，Git是如何组织这些object的❓令人兴奋的是Git在提供给我们这些顶层API去愉快使用的同时还提供了一些较为底层的API让我们能够更深入的了解它。接下来我们将通过部分底层的API来重现本次commit log的创建过程。主要用到的底层API如下：</p><ul><li><a href="https://git-scm.com/docs/git-hash-object#Documentation/git-hash-object.txt--w">git hash-object</a>：生成blob</li><li><a href="https://git-scm.com/docs/git-update-index">git update-index</a>：对暂存区进行操作</li><li><a href="https://git-scm.com/docs/git-write-tree">git write-tree</a>：根据当前暂存区（index）状态创建一个tree object</li><li><a href="https://git-scm.com/docs/git-read-tree">git read-tree</a>：将tree object读入暂存区</li><li><a href="https://git-scm.com/docs/git-commit-tree#_synopsis">git commit-tree</a>：创建commit object</li></ul><p><strong>重现步骤如下：</strong></p><p>1、先初始化版本库，再为内容分别为<code>test</code>的test.txt、<code>Hello</code>的hello.txt创建两个blob，blob不存储文件名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir <span class="built_in">test</span></span><br><span class="line">$ <span class="built_in">cd</span> <span class="built_in">test</span></span><br><span class="line">git init</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;test&#x27;</span> | git hash-object -w --stdin</span><br><span class="line">9daeafb9864cf43055ae93beb0afd6c7d144bfa4</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;Hello&#x27;</span> | git hash-object -w --stdin</span><br><span class="line">e965047ad7c57865823c7d992b1d046ea66edf78</span><br></pre></td></tr></table></figure><p>2、使用<code>git update-index -add</code>将blob（e965）加入暂存区，使用<code>--cacheinfo</code>参数指定文件模式、SHA-1值、文件名（hello.txt）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  git update-index --add --cacheinfo 100644 e965047ad7c57865823c7d992b1d046ea66edf78 hello.txt</span><br></pre></td></tr></table></figure><p>3、使用<code>git write-tree</code>将当前暂存区状态写入一个tree object（8c3c）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git write-tree</span><br><span class="line">8c3c7fbcd903744b20fd7567a1fcefa99133b5bc</span><br></pre></td></tr></table></figure><p>4、将hello.txt移出暂存区，将blob（9dae）加入暂存区（即将test.txt加入暂存区）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git update-index --remove hello.txt</span><br><span class="line">$ git update-index --add --cacheinfo 100644 9daeafb9864cf43055ae93beb0afd6c7d144bfa4 test.txt</span><br></pre></td></tr></table></figure><p>5、使用<code>git read-tree</code>将已有tree object作为<strong>子树对象</strong>加入暂存区，通过<code>--prefix</code>设置名称为hi</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git read-tree --prefix=hi 8c3c7fbcd903744b20fd7567a1fcefa99133b5bc</span><br></pre></td></tr></table></figure><p>6、记录下当前暂存区状态到tree object</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git write-tree</span><br><span class="line">2e8ebea76975c98806e73c0b7aea6c40c58d427c</span><br></pre></td></tr></table></figure><p>7、使用<code>git commit-tree</code>根据tree object的SHA-1值创建commit object</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;Hello Git&#x27;</span> | git commit-tree 2e8e</span><br><span class="line">2616a5b40ead79df23736f61b346080423f438fe</span><br></pre></td></tr></table></figure><p>8、查看commit log，没多大毛病，收工🎉</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --pretty=raw 2616</span><br><span class="line">commit 2616a5b40ead79df23736f61b346080423f438fe</span><br><span class="line">tree 2e8ebea76975c98806e73c0b7aea6c40c58d427c</span><br><span class="line">author root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580660050 +0800</span><br><span class="line">committer root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580660050 +0800</span><br><span class="line"></span><br><span class="line">    Hello Git</span><br><span class="line"></span><br><span class="line">$ git cat-file -p 2616</span><br><span class="line">tree 2e8ebea76975c98806e73c0b7aea6c40c58d427c</span><br><span class="line">author root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580660050 +0800</span><br><span class="line">committer root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt; 1580660050 +0800</span><br><span class="line"></span><br><span class="line">Hello Git</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>相信到了这里，已经对Git在我们<code>git add</code>、<code>git commit</code>时做了什么有了一定的了解。如果想了解Git Object对应的SHA-1值如何生成和如何复现并串联多个commit object形成一个提交历史链，可查看《Pro Git》的第十章第二小节或参看后面的参考资料。</p><h1 id="Git分支的本质是什么"><a href="#Git分支的本质是什么" class="headerlink" title="Git分支的本质是什么"></a>Git分支的本质是什么</h1><p><strong>Git分支的本质是指向某一系列提交之首的指针或引用。</strong>Git使用引用的一个好处就是我们不需要花心思去记那些Git Object长长的SHA-1值。引用是存放SHA-1值的文件，它们位于<code>.git/refs</code>目录中。Git提供了一个API让我们更新引用-<code>update-ref</code>，示例如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ git update-ref refs/heads/master 2616 <span class="comment"># 2616为之前浮现commit log创建的commit object的SHA-1值</span></span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 2616a5b40ead79df23736f61b346080423f438fe (HEAD -&gt; master)</span><br><span class="line">Author: root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt;</span><br><span class="line">Date:   Mon Feb 3 00:14:10 2020 +0800</span><br><span class="line"></span><br><span class="line">    Hello Git</span><br><span class="line">$ git <span class="built_in">log</span> master</span><br><span class="line">commit 2616a5b40ead79df23736f61b346080423f438fe (HEAD -&gt; master)</span><br><span class="line">Author: root &lt;root@DESKTOP-CQ9JEC7.localdomain&gt;</span><br><span class="line">Date:   Mon Feb 3 00:14:10 2020 +0800</span><br><span class="line"></span><br><span class="line">    Hello Git</span><br><span class="line">$ cat .git/refs/heads/master</span><br><span class="line">2616a5b40ead79df23736f61b346080423f438fe</span><br></pre></td></tr></table></figure><h2 id="HEAD引用"><a href="#HEAD引用" class="headerlink" title="HEAD引用"></a>HEAD引用</h2><p>在介绍HEAD文件的时候我们说过它存放的是当前所在分支的引用，而且这个引用是个<strong>符号引用</strong>（symbolic reference）。那么什么是符号引用？<strong>它是一个指向其它引用的指针</strong>。我们可以查看之前clone下来的<a href="https://github.com/yeshan333/Explore-Git">Explore-Git</a>的HEAD文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat .git/HEAD</span><br><span class="line">ref: refs/heads/master</span><br></pre></td></tr></table></figure><p>当我们checkout到某个分支时，HEAD文件内容如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git branch yeshan</span><br><span class="line">$ git checkout yeshan</span><br><span class="line">Switched to branch <span class="string">&#x27;yeshan&#x27;</span></span><br><span class="line"></span><br><span class="line">$ cat .git/HEAD</span><br><span class="line">ref: refs/heads/yeshan</span><br></pre></td></tr></table></figure><p>至此，抛出的问题已解答完毕。</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><p><a href="https://developer.aliyun.com/article/720615?spm=a2c6h.12873639.0.0.176712eeP7J5d0&tdsourcetag=s_pctim_aiomsg">Go Git：面向未来的代码平台</a>，了解版本控制系统的发展和Git现存的问题，版本控制系统未来的走向</p></li><li><p><a href="https://github.com/gotgit/gotgit">《Git权威指南》</a> - <a href="http://www.worldhello.net/gotgit/02-git-solo/030-head-master-commit-refs.html">Git对象探秘</a></p></li><li><p><a href="https://mp.weixin.qq.com/s/UQKrAR3zsdTRz8nFiLk2uQ">这才是真正的Git——Git内部原理揭秘！</a></p></li><li><p><a href="https://git-scm.com/book/en/v2/Appendix-C%3A-Git-Commands-Basic-Snapshotting">《Pro Git》- Basic Snapshotting</a></p></li><li><p><a href="http://gitbook.liuhui998.com/1_2.html">Git对象模型</a></p></li><li><p><a href="https://github.com/tank0317/git-learning/issues/5">你知道 Git 是如何做版本控制的吗</a></p></li><li><p><a href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">图解Git</a></p></li><li><p><a href="https://developer.github.com/v3/git/blobs/">GitHub Developer REST API Git Blobs</a></p></li><li><p><a href="https://cloud.tencent.com/developer/ask/82974/answers/created">如何读取git-ls-tree输出的模式字段</a></p></li><li><p><a href="https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html">常用Git命令清单</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React+Flask打造前后端分离项目开发环境</title>
      <link href="2020/01/13/React-Flask%E6%89%93%E9%80%A0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
      <url>2020/01/13/React-Flask%E6%89%93%E9%80%A0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote><p>新的一年，开始水第一篇技术文。碰巧最近React玩得多，撸一篇文章纪念一下开发环境的搭建。🤔</p></blockquote><ul><li>开篇两问：<ul><li>什么是React？：React，用于构建用户界面的 JavaScript 库（官网复制粘贴，真香，不用怎么写template了，舒服</li><li>什么是Flask？：一个使用Python编写的轻量级Web应用框架。用来写<a href="https://jimmysong.io/kubernetes-handbook/cloud-native/cloud-native-definition.html">云原生应用</a>很香！</li></ul></li></ul><p>先看下最终的项目结构，如下：<a href="https://github.com/yeshan333/React-Flask--Development-Environment">《项目源码》</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">├── app.py</span><br><span class="line">├── env</span><br><span class="line">|  ├── Include</span><br><span class="line">|  ├── Lib</span><br><span class="line">|  ├── LICENSE.txt</span><br><span class="line">|  ├── Scripts</span><br><span class="line">|  └── tcl</span><br><span class="line">├── frontend</span><br><span class="line">|  ├── build</span><br><span class="line">|  ├── node_modules</span><br><span class="line">|  ├── package-lock.json</span><br><span class="line">|  ├── package.json</span><br><span class="line">|  ├── public</span><br><span class="line">|  ├── README.md</span><br><span class="line">|  └── src</span><br><span class="line">├── static</span><br><span class="line">|  └── js</span><br><span class="line">└── templates</span><br><span class="line">   └── index.html</span><br></pre></td></tr></table></figure><span id="more"></span><blockquote><p>开发环境：Windows+Flask+React+Git Bash+vscode</p></blockquote><h1 id="Backend-Flask"><a href="#Backend-Flask" class="headerlink" title="Backend-Flask"></a>Backend-Flask</h1><blockquote><p>个人比较喜欢用CLI，So，项目开发依赖使用<code>virtualenv+pip</code>管理，<a href="https://github.com/pypa/pipenv">pipenv</a>也还行，虽然lock package有点久。听说比较新的<a href="https://github.com/python-poetry/poetry">poetry</a>很香？</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、安装virtualenv</span></span><br><span class="line">pip install virtualenv</span><br><span class="line"><span class="comment"># 2、为项目（Flask_React）创建虚拟环境-&gt;env</span></span><br><span class="line">virtualenv env</span><br><span class="line"><span class="comment"># 3、激活虚拟环境env</span></span><br><span class="line"><span class="built_in">source</span> env/Scripts/activate</span><br><span class="line"><span class="comment"># 4、安装项目依赖</span></span><br><span class="line">pip install -r requirments.txt</span><br><span class="line"><span class="comment"># 5、创建好templates和static目录，用于存放React打包好的渲染模板和静态文件</span></span><br><span class="line">mkdir templates</span><br><span class="line">mkdir static</span><br></pre></td></tr></table></figure><p>后端服务的基础环境搭建好了，随手写个路由，看下能不能用先</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;h1&gt;Hello React+Flask!&lt;/h1&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;127.0.0.1&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/03/9b18cb0cd65b8249a0e9069d4845e6d27744af.png" class="lazyload" data-srcset="https://img.vim-cn.com/03/9b18cb0cd65b8249a0e9069d4845e6d27744af.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="效果.png"></p><h1 id="Frontend-React"><a href="#Frontend-React" class="headerlink" title="Frontend-React"></a>Frontend-React</h1><blockquote><p>前端React应用的开发环境使用官方提供的脚手架<a href="https://zh-hans.reactjs.org/docs/create-a-new-react-app.html#create-react-app">create-react-app</a>搭建。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、安装脚手架</span></span><br><span class="line">npm install -g create-react-app</span><br><span class="line"><span class="comment"># 2、为Flask_React项目创建React App-&gt;frontend</span></span><br><span class="line">create-react-app frontend <span class="comment"># 这里有点小久，喝杯咖啡☕摸下鱼</span></span><br></pre></td></tr></table></figure><p>OK，前端开发环境搭建好了，清理掉src目录下的所有文件，自己写个组件，如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> frontend/src</span><br><span class="line">rm -rf *</span><br><span class="line">touch index.js</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;center-align&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    盒装一流弊<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;waves-effect waves-light btn&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">className</span>=<span class="string">&quot;material-icons right&quot;</span>&gt;</span>cloud<span class="tag">&lt;/<span class="name">i</span>&gt;</span>您说的都对</span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure><p>OK，预览下效果，顺便调试（没啥可调试的/(ㄒoㄒ)/~~）。<code>npm start</code>。效果如下：</p><p><img src="https://img.vim-cn.com/e5/a82817a8d6d3d240674cef5c65e955b929aba1.png" class="lazyload" data-srcset="https://img.vim-cn.com/e5/a82817a8d6d3d240674cef5c65e955b929aba1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="React App预览效果.png"></p><p>没多大问题的话，是时候打包写好的React App给后端服务了。</p><h1 id="Done"><a href="#Done" class="headerlink" title="Done"></a>Done</h1><p>很舒服的是<a href="https://create-react-app.dev/docs/deployment">create-react-app</a>封装好了 Babel 和 webpack，我们可以直接使用<code>npm run build</code>打包写好的App到frontend/build目录中。然后手动将生成的文件分别挪到Flask的<a href="https://exploreflask.com/en/latest/templates.html">templates</a>和<a href="https://exploreflask.com/en/latest/static.html">static</a>目录中即可。<strong>等等？手动</strong>，能不能使用CLI，dang然阔以。</p><p>npm 允许我们在package.json文件里面，使用scripts字段自定义脚本命令。更舒服的是<code>npm script</code>提供了<code>pre</code>和<code>post</code>钩子。我们可以给<code>build</code>脚本命令提供两个钩子<code>prebuild</code>和<code>postbuild</code>。编辑后的<code>package.json</code>文件的Script命令如下如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;react-scripts start&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;prebuild&quot;</span>: <span class="string">&quot;rm -rf ..\\templates\\index.html &amp;&amp; rm -rf ..\\static&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;react-scripts build&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;postbuild&quot;</span>: <span class="string">&quot;mv build\\index.html ..\\templates\\ &amp;&amp;  mv build\\static ..\\static&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;react-scripts test&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;eject&quot;</span>: <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>这时候，我们执行<code>npm run build</code>命令时，会自动按照下面的顺序执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ..\\templates\\index.html &amp;&amp; rm -rf ..\\static</span><br><span class="line">react-scripts build</span><br><span class="line">mv build\\index.html ..\\templates\\ &amp;&amp;  mv build\\static ..\\static</span><br></pre></td></tr></table></figure><p>OK，我们试试。如下：</p><p><img src="https://img.vim-cn.com/a1/be51d238380ead4e8c6d6b6fba6eb0bbe55c5e.gif" class="lazyload" data-srcset="https://img.vim-cn.com/a1/be51d238380ead4e8c6d6b6fba6eb0bbe55c5e.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示范.gif"></p><p>Nice，没毛病。🎉🎉🎉。改下<code>app.py</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)  <span class="comment"># 渲染打包好的React App的页面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;127.0.0.1&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/06/aa0b2dc80df8c8bfc021e57a93981fe07acc02.png" class="lazyload" data-srcset="https://img.vim-cn.com/06/aa0b2dc80df8c8bfc021e57a93981fe07acc02.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="效果.png"></p><p><strong>冇问题啊！收工！！！</strong></p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><a href="https://zh-hans.reactjs.org/docs/create-a-new-react-app.html#create-react-app">React Docs</a></li><li><a href="https://create-react-app.dev/docs/documentation-intro">Create React App</a></li><li><a href="https://docs.npmjs.com/misc/scripts">npm-scripts</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html">npm scripts 使用指南</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019年总结</title>
      <link href="2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"/>
      <url>2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://img.vim-cn.com/d9/3a50eba326ba56d498de021a40b120dcfdd255.png" class="lazyload" data-srcset="https://img.vim-cn.com/d9/3a50eba326ba56d498de021a40b120dcfdd255.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="banner"></p><span id="more"></span><h2 id="前言扯🥚"><a href="#前言扯🥚" class="headerlink" title="前言扯🥚"></a>前言扯🥚</h2><p>终于考完试了（昨天下午终结了最后一科-“万恶”的复变函数🎈🎉），可以摩擦下年终总结了，花点时间想下2019年我干了什么🎁。<del>完了写不下去了（此时中午12点59分30秒。</del></p><h2 id="忆往昔-xxx-2019"><a href="#忆往昔-xxx-2019" class="headerlink" title="忆往昔-xxx~2019"></a>忆往昔-xxx~2019</h2><p>这一年过得无比的充实，个人感觉高中的时候都没对自己这么狠过，我怕是上了个假的大学（忽然想起高三临近高考那段时间，别人在复习，而我却趴在桌面上在睡觉&lt;被“农药”毒害，趴了整个高三，挺对不起老师的，惭愧😥）。</p><p><strong>以下开始略微总结下今年的操作、收获与遗憾。</strong></p><h3 id="阅读方面"><a href="#阅读方面" class="headerlink" title="阅读方面"></a>阅读方面</h3><p>这一年看了很多的书，有技术方面的也有非技术方面的都有，我佛了，大三上一整个学期就没打过游戏，我都佩服我自己，ε=ε=ε=┏(゜ロ゜;)┛，略微罗列下：</p><ul><li>没看完的，看了大部分，但是没再继续看<ul><li>《Python密码学编程》</li><li>《Python从入门到实践》</li><li>《C++ Primer Plus》</li><li>《Python基础教程（第3版）》</li><li>《算法图解》</li><li>《啊哈！算法》</li><li>《HTTP权威指南》</li><li>《Flask Web开发：基于Python的Web应用开发实战》</li><li>《Flask 入门教程》</li><li>《Docker Deep Dive》</li><li>《Linux 就该这么学》</li><li>《How To Think Like A Computer Scientist》</li></ul></li><li>可以说是看完了的<ul><li>《Web全栈工程师的自我修养》</li><li>《Don’t Make Me Think》</li><li>《Growth: 全栈增长工程师指南》</li><li>《我的职业是前端工程师》</li><li>《RePractise》</li></ul></li><li>……</li></ul><p>上图，emmm…我正在看的，希望开学前能看完大部分，又能“吹水”了，都是💪力量啊！</p><p><img src="https://img.vim-cn.com/b9/96f74118397ece2626f6624e78999cce196d33.png" class="lazyload" data-srcset="https://img.vim-cn.com/b9/96f74118397ece2626f6624e78999cce196d33.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="书单"></p><p><del>小声bb，我入手了套《周易》</del>，看了那么多还是菜（太卑微了，总有那么种好高骛远的感觉！！！<del>斑驳</del></p><h3 id="技术实践与交流"><a href="#技术实践与交流" class="headerlink" title="技术实践与交流"></a>技术实践与交流</h3><p>这一年，我喜欢上了开源社区，我的第一个<a href="https://github.com/greyli/helloflask/issues/164">issue</a>。很幸运能够偷偷的在图灵读者群QQ当个混子，知道了<a href="https://github.com/Zheaoli">Manjusaka</a>（璈叔<del>，一直在听大佬出<a href="https://zhuanlan.zhihu.com/p/63557057">《捕蛇者说》</a>播客，收获满满），通过大佬又知道了<a href="http://cn.pycon.org/">PyCon China</a>。今年Python30周年，<a href="https://github.com/PyConChina">PyCon China 2019</a>大佬云集，太香了，路费太贵没能去成，没能线下见诸位大佬（太苦bi了</del>/(ㄒoㄒ)/~~，还好有PPT和视频放出来，现在仍在反复的看一些感兴趣的Topic的Slide和视频，又get✅到了学习的新姿势。</p><p>这一年我做的都是一些小玩意，太卑微了，不敢列出来。不得不说GitHub真香，一些开源项目拿来即可用，可以快速集成到自己弄得东西上（此处吐槽😒文档写的不好或者连文档都没有的，看的太难受了）。虽然整的都是一些花里胡哨的小东西，至少我看到了自己在成长，不亏，此处上我的GitHub小绿点：</p><p><img src="https://img.vim-cn.com/4b/203608268ca031e7bb73c3ac82a3820255ee35.png" class="lazyload" data-srcset="https://img.vim-cn.com/4b/203608268ca031e7bb73c3ac82a3820255ee35.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>再看下大佬的，我透，我就是didi，我整的还贼水。</p><p><img src="https://img.vim-cn.com/27/02088de73d4945fe23127816fe4fe7bb19d444.png" class="lazyload" data-srcset="https://img.vim-cn.com/27/02088de73d4945fe23127816fe4fe7bb19d444.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="大佬的GitHub"></p><p>GitHub还有一点特别香，通过follow各领域的大佬，我能了解到一些“骚”技术（emmm。。。，有些东西我还用上了，不愧是终极程序员社交网站。此处艾特一位友链小伙伴<a href="https://www.itrhx.com/">TRHX🔗</a>，嘿嘿嘿，你star的大部分项目我都拿来耍过几下。</p><blockquote><p>emmm，很幸运的认识了友链里诸位大佬，无聊的时候经常去lu你们的文章，收获还是蛮多的。</p></blockquote><p><img src="https://img.vim-cn.com/87/5971c1bc68655ae307882d3aedb784acf45c5e.png" class="lazyload" data-srcset="https://img.vim-cn.com/87/5971c1bc68655ae307882d3aedb784acf45c5e.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="感谢"></p><h2 id="缺憾与期待"><a href="#缺憾与期待" class="headerlink" title="缺憾与期待"></a>缺憾与期待</h2><h3 id="这一年有点难"><a href="#这一年有点难" class="headerlink" title="这一年有点难"></a>这一年有点难</h3><ul><li><p>自学太痛苦了（线下找不到倾诉的伙伴，院里找不到“真正”有共同兴趣、爱好、热情的伙伴，大部分人只是说说而已，行动上的弱者），真希望有个dalao带带我（枯了</p></li><li><p>我吐，一年多没跳舞了，我居然抛弃了我曾经热爱的<a href="https://baike.baidu.com/item/Breaking/216670?fr=aladdin">Breaking</a>，虽然仍在看一些街舞文化相关的节目和比赛-&gt;<a href="https://baike.baidu.com/item/%E8%BF%99%EF%BC%81%E5%B0%B1%E6%98%AF%E8%A1%97%E8%88%9E/22293892?fromtitle=%E8%BF%99%E5%B0%B1%E6%98%AF%E8%A1%97%E8%88%9E&fromid=22473357&fr=aladdin">《这！就是街舞》</a>、<a href="https://www.redbull.com/int-en/event-series/bc-one">《Red Bull BC One》</a>，但我已经不再是个纯粹的B-Boy了</p></li><li><p>感觉自己没能真正的融入开源社区，并未参与多人优质开源项目的开发</p></li><li><p>撸了一下董老师的<a href="https://annual2019.pycourses.com/#0">《爱澎湃2019年度Python榜单》</a>，发现我知道的东西还是太少，看来我对Python的热爱没有那么纯粹，信息的来源不太行</p></li><li><p>看了下<a href="https://githubreport.mdnice.com/?username=yeshan333">我的GitHub年度报告</a>，看来得好好养生了</p></li></ul><p><img src="https://img.vim-cn.com/5e/dcd4262b56fd261731276c77124cde6e843e82.jpg" class="lazyload" data-srcset="https://img.vim-cn.com/5e/dcd4262b56fd261731276c77124cde6e843e82.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="期待"><a href="#期待" class="headerlink" title="期待"></a>期待</h3><ul><li>新的一年，我又立下了一丢丢flag🚩，不知道下学期结束前能不能操作完(☆▽☆)</li></ul><p><img src="https://img.vim-cn.com/8b/017ad48a5f5b33dc9dfe164a97280c52fcb20c.png" class="lazyload" data-srcset="https://img.vim-cn.com/8b/017ad48a5f5b33dc9dfe164a97280c52fcb20c.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="To-DO lists"></p><ul><li><p>稳住，别浪，Hello World -&gt; Cloud Native, Meta Year</p></li><li><p>期待下一年能撸一个优秀的技术开源项目或者去为优秀的开源项目贡献代码</p></li><li><p>期待自己所待的科协在未来有真正强有力的积累，能发挥出“马太效应”</p></li><li><p>我似乎还没真正想明白我想要什么，不给力啊！</p></li><li><p>新一年对自己的要求：不只是要做思想上的强者，更要做行动上的强者；多思考、多折腾、多更新。很喜欢的一句话：<strong>I hear and I forget. I see and I remember. I do and I understand.</strong></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>愿和平永驻人间</title>
      <link href="2019/12/13/%E6%84%BF%E5%92%8C%E5%B9%B3%E6%B0%B8%E9%A9%BB%E4%BA%BA%E9%97%B4/"/>
      <url>2019/12/13/%E6%84%BF%E5%92%8C%E5%B9%B3%E6%B0%B8%E9%A9%BB%E4%BA%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><img src="https://img.vim-cn.com/48/c4ac563eaa0515caea6bef70698c8265f76016.png" class="lazyload" data-srcset="https://img.vim-cn.com/48/c4ac563eaa0515caea6bef70698c8265f76016.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" width="80%">]]></content>
      
      
      <categories>
          
          <category> memory </category>
          
      </categories>
      
      
        <tags>
            
            <tag> memory </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>❤Thanksgiving❤</title>
      <link href="2019/11/28/heart/"/>
      <url>2019/11/28/heart/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://img.vim-cn.com/5c/2ba4e2431c8f59fa8fdcf10f0348f6ff7f0d5b.png" class="lazyload" data-srcset="https://img.vim-cn.com/5c/2ba4e2431c8f59fa8fdcf10f0348f6ff7f0d5b.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="感恩节"></p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Serialization and Deserialization</title>
      <link href="2019/11/25/Serialization-and-Deserialization/"/>
      <url>2019/11/25/Serialization-and-Deserialization/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="序列化与反序列化"><a href="#序列化与反序列化" class="headerlink" title="序列化与反序列化"></a>序列化与反序列化</h1><blockquote><p>Serialization：Data Structure/Object –&gt; Binary String<br>Deserialization：Binary String –&gt; Data Structure/Object<br>Goals：Cross-platform Communication、Persistent Storage and More</p></blockquote><h1 id="Python中对象的序列化与反序列化"><a href="#Python中对象的序列化与反序列化" class="headerlink" title="Python中对象的序列化与反序列化"></a>Python中对象的序列化与反序列化</h1><h2 id="pickle-module"><a href="#pickle-module" class="headerlink" title="pickle module"></a>pickle module</h2><blockquote><p>pickle 仅可用于 Python，pickle所使用的数据流格式仅可用于 Python<br>pickle 模块可以将复杂对象转换为字节流，也可以将字节流转换为具有相同内部结构的对象。<br>可被pickling和unpickling的对象：<a href="https://docs.python.org/zh-cn/3/library/pickle.html#what-can-be-pickled-and-unpickled">https://docs.python.org/zh-cn/3/library/pickle.html#what-can-be-pickled-and-unpickled</a></p></blockquote><p>pickle提供了优秀的方法方便我们对对象进行pickling（封存）和unpickling（解封）</p><span id="more"></span><h3 id="使用dumps和loads方法进行序列化和反序列化"><a href="#使用dumps和loads方法进行序列化和反序列化" class="headerlink" title="使用dumps和loads方法进行序列化和反序列化"></a>使用dumps和loads方法进行序列化和反序列化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pickle</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person = <span class="built_in">dict</span>(name=<span class="string">&#x27;shan&#x27;</span>, age=<span class="number">20</span>, sex=<span class="string">&quot;man&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pickle.dumps(person)  <span class="comment"># dumps方法会将obj序列化为bytes返回</span></span><br><span class="line"><span class="string">b&#x27;\x80\x03&#125;q\x00(X\x04\x00\x00\x00nameq\x01X\x04\x00\x00\x00shanq\x02X\x03\x00\x00\x00ageq\x03K\x14X\x03\x00\x00\x00sexq\x04X\x03\x00\x00\x00manq\x05u.</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; with open(&quot;dump.txt&quot;,&quot;wb&quot;) as f:</span></span><br><span class="line"><span class="string">...     pickle.dump(person, f)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; f = open(&quot;dump.txt&quot;,&quot;rb&quot;)</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; d = pickle.load(f)</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; f.close()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; d</span></span><br><span class="line"><span class="string">&#123;&#x27;</span>name<span class="string">&#x27;: &#x27;</span>shan<span class="string">&#x27;, &#x27;</span>age<span class="string">&#x27;: 20, &#x27;</span>sex<span class="string">&#x27;: &#x27;</span>man<span class="string">&#x27;&#125;</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; pickle.loads(pickle.dumps(d))</span></span><br><span class="line"><span class="string">&#123;&#x27;</span>name<span class="string">&#x27;: &#x27;</span>shan<span class="string">&#x27;, &#x27;</span>age<span class="string">&#x27;: 20, &#x27;</span>sex<span class="string">&#x27;: &#x27;</span>man<span class="string">&#x27;&#125;</span></span><br></pre></td></tr></table></figure><ul><li><a href="https://docs.python.org/zh-cn/3/library/pickle.html#pickle.dump">https://docs.python.org/zh-cn/3/library/pickle.html#pickle.dump</a></li><li>bytes对象是由单个字节组成的不可变序列</li><li>使用<code>dump</code>方法可将序列化的对象写入file obj</li><li>load用于还原封存生成的bytes_object，loads方法用于还原从文件中读取的封存对象</li></ul><h2 id="json-module"><a href="#json-module" class="headerlink" title="json module"></a>json module</h2><blockquote><p>相比于pickle，json只能表示内置类型的子集，不能表示自定义的类<br>json格式的文件的易读性更好<br>Python json模块提供的API与pickle模块很相似</p></blockquote><h3 id="使用dumps和loads进行序列化和反序列化"><a href="#使用dumps和loads进行序列化和反序列化" class="headerlink" title="使用dumps和loads进行序列化和反序列化"></a>使用dumps和loads进行序列化和反序列化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person = <span class="built_in">dict</span>(name=<span class="string">&#x27;shan&#x27;</span>, age=<span class="number">20</span>, sex=<span class="string">&quot;man&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json.dumps(person)</span><br><span class="line"><span class="string">&#x27;&#123;&quot;name&quot;: &quot;shan&quot;, &quot;age&quot;: 20, &quot;sex&quot;: &quot;man&quot;&#125;&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json_str = json.dumps(person)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json.loads(json_str)</span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;shan&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>, <span class="string">&#x27;sex&#x27;</span>: <span class="string">&#x27;man&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><ul><li>dumps方法会将obj转换为标准格式的JSON str并返回</li><li>loads方法可将包含JSON文档的str、bytes或者bytearray反序列化为Python对象</li></ul><h3 id="自定义对象的序列化与反序列化"><a href="#自定义对象的序列化与反序列化" class="headerlink" title="自定义对象的序列化与反序列化"></a>自定义对象的序列化与反序列化</h3><blockquote><p>对于自定义对象的序列化和反序列化操作需要我们实现专门的encoder和decoder<br>需要用到dumps方法的default参数和loads方法的object_hook参数<br><a href="https://docs.python.org/3/library/json.html#json.loads">https://docs.python.org/3/library/json.html#json.loads</a><br><a href="https://docs.python.org/3/library/json.html#json.loads">https://docs.python.org/3/library/json.html#json.loads</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age, score</span>):</span></span><br><span class="line"><span class="meta">... </span>        self.name = name</span><br><span class="line"><span class="meta">... </span>        self.age = age</span><br><span class="line"><span class="meta">... </span>        self.score = score</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">student2dict</span>(<span class="params">std</span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> &#123;</span><br><span class="line"><span class="meta">... </span>        <span class="string">&#x27;name&#x27;</span>: std.name,</span><br><span class="line"><span class="meta">... </span>        <span class="string">&#x27;age&#x27;</span>: std.age,</span><br><span class="line"><span class="meta">... </span>        <span class="string">&#x27;score&#x27;</span>: std.score</span><br><span class="line"><span class="meta">... </span>    &#125;</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">dict2student</span>(<span class="params">d</span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> Student(d[<span class="string">&#x27;name&#x27;</span>], d[<span class="string">&#x27;age&#x27;</span>], d[<span class="string">&#x27;score&#x27;</span>])</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student(<span class="string">&#x27;Bob&#x27;</span>, <span class="number">20</span>, <span class="number">88</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(json.dumps(s, default=student2dict))</span><br><span class="line">&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">20</span>, <span class="string">&quot;score&quot;</span>: <span class="number">88</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json_str = json.dumps(s, default=student2dict)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(json.loads(json_str, object_hook=dict2student))</span><br><span class="line">&lt;__main__.Student <span class="built_in">object</span> at <span class="number">0x000001B101675198</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json.loads(json_str, object_hook=dict2student)</span><br><span class="line">&lt;__main__.Student <span class="built_in">object</span> at <span class="number">0x000001B101675128</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>old = json.loads(json_str, object_hook=dict2student)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>old.name</span><br><span class="line"><span class="string">&#x27;Bob&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="third-party-module：marshmallow"><a href="#third-party-module：marshmallow" class="headerlink" title="third-party module：marshmallow"></a>third-party module：marshmallow</h2><blockquote><p>marshmallow is an ORM/ODM/framework-agnostic library for converting complex datatypes, such as objects, to and from native Python datatypes.</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> marshmallow</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> marshmallow <span class="keyword">import</span> Schema, fields</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>@dataclass</span><br><span class="line"><span class="meta">... </span><span class="class"><span class="keyword">class</span> <span class="title">Album</span>:</span></span><br><span class="line"><span class="meta">... </span>    title: <span class="built_in">str</span></span><br><span class="line"><span class="meta">... </span>    release_date: dt.date</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">AlbumSchema</span>(<span class="params">Schema</span>):</span></span><br><span class="line"><span class="meta">... </span>    title = fields.Str()</span><br><span class="line"><span class="meta">... </span>    release_date = fields.Date()</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>album = Album(<span class="string">&quot;Seven Innovation Base&quot;</span>, dt.date(<span class="number">2019</span>, <span class="number">11</span>, <span class="number">23</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>schema = AlbumSchema()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = schema.dump(album)  <span class="comment"># obj -&gt; dict</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data</span><br><span class="line">&#123;<span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;Seven Innovation Base&#x27;</span>, <span class="string">&#x27;release_date&#x27;</span>: <span class="string">&#x27;2019-11-23&#x27;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data_str = schema.dumps(album)  <span class="comment"># obj -&gt; str</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data_str</span><br><span class="line"><span class="string">&#x27;&#123;&quot;title&quot;: &quot;Seven Innovation Base&quot;, &quot;release_date&quot;: &quot;2019-11-23&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>使用 marshmallow 可以很方便的对自定义对象进行序列化和反序列化</li><li>对object进行在序列化之前，需要为object创建一个schema,schema中的字段名必须与自定义的object中的成员一致</li><li>dumps method：obj -&gt; str, dump method：obj -&gt; dict</li><li>反序列化的 dict -&gt; obj 需要使用decorator：<code>post_load</code>自己实现</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> marshmallow <span class="keyword">import</span> Schema, fields, post_load</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, email</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.email = email</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;User(name=&#123;self.name!r&#125;)&gt;&quot;</span>.<span class="built_in">format</span>(self=self)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSchema</span>(<span class="params">Schema</span>):</span></span><br><span class="line">    name = fields.Str()</span><br><span class="line">    email = fields.Email()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @post_load</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_user</span>(<span class="params">self, data, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">return</span> User(**data)</span><br><span class="line"></span><br><span class="line">user_data = &#123;</span><br><span class="line">    <span class="string">&quot;email&quot;</span>: <span class="string">&quot;ken@yahoo.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Ken&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">schema = UserSchema()</span><br><span class="line">result = schema.load(user_data)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出结果：&lt;User(name=&#x27;Ken&#x27;)&gt;</span></span><br></pre></td></tr></table></figure><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><a href="https://www.infoq.cn/article/serialization-and-deserialization">序列化与反序列化</a></li><li><a href="https://docs.python.org/zh-cn/3/library/pickle.html">pickle module</a></li><li><a href="https://docs.python.org/zh-cn/3/library/json.html#module-json">json module</a></li><li><a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#bytes">bytes</a></li><li><a href="https://blog.igevin.info/posts/restful-api-get-started-to-write/">RESTful API编写指南</a></li><li><a href="https://blog.igevin.info/posts/flask-rest-serialize-deserialize/">Flask RESTful API开发之序列化与反序列化</a></li><li><a href="https://marshmallow.readthedocs.io/en/stable/quickstart.html">marshmallow</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Json </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>map-filter-reduce</title>
      <link href="2019/11/14/map-filter-reduce/"/>
      <url>2019/11/14/map-filter-reduce/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>听说函数式编程很⑥，咱也不知道，咱也不晓得，还没实际用过。emmm。。。。，先mark下Python中和函数式编程有关的部分功能先，又开始水了，立个flag🚩：慢慢完善</p></blockquote><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>先看下Python官方文档的说法</p><blockquote><p>map(function, iterable, …)，返回一个将 function 应用于 iterable 中每一项并输出其结果的迭代器。 如果传入了额外的 iterable 参数，function 必须接受相同个数的实参并被应用于从所有可迭代对象中并行获取的项。</p></blockquote><p>见识一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">cook</span>(<span class="params">something</span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> something == <span class="string">&quot;cow&quot;</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">&quot;hamburger&quot;</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">elif</span> something == <span class="string">&quot;tomato&quot;</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">&quot;chips&quot;</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">elif</span> something == <span class="string">&quot;chicken&quot;</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">&quot;ddrumstick&quot;</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">elif</span> something == <span class="string">&quot;corn&quot;</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">&quot;popcorn&quot;</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">map</span>(cook, [<span class="string">&quot;cow&quot;</span>, <span class="string">&quot;tomato&quot;</span>, <span class="string">&quot;chicken&quot;</span>, <span class="string">&quot;corn&quot;</span>]))</span><br><span class="line">[<span class="string">&#x27;hamburger&#x27;</span>, <span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;ddrumstick&#x27;</span>, <span class="string">&#x27;popcorn&#x27;</span>]</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p>也看下官方文档的说法</p><blockquote><p>filter(function, iterable),用 iterable 中函数 function 返回真的那些元素，构建一个新的迭代器。iterable 可以是一个序列，一个支持迭代的容器，或一个迭代器。如果 function 是 None ，则会假设它是一个身份函数，即 iterable 中所有返回假的元素会被移除。</p></blockquote><p>也见识下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">isVegetarian</span>(<span class="params">food</span>):</span></span><br><span class="line"><span class="meta">... </span>    check = [<span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;popcorn&#x27;</span>]</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> food <span class="keyword">in</span> check:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">filter</span>(isVegetarian, [<span class="string">&#x27;hamburger&#x27;</span>, <span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;ddrumstick&#x27;</span>, <span class="string">&#x27;popcorn&#x27;</span>]))</span><br><span class="line">[<span class="string">&#x27;chips&#x27;</span>, <span class="string">&#x27;popcorn&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><p>再看下官方文档</p><blockquote><p>Apply function of two arguments cumulatively to the items of iterable, from left to right, so as to &gt;<strong>reduce the iterable to a single value</strong>.</p></blockquote><p>见识下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(<span class="keyword">lambda</span> x, y: x+y, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"><span class="number">15</span></span><br></pre></td></tr></table></figure><h2 id="一图胜千言"><a href="#一图胜千言" class="headerlink" title="一图胜千言"></a>一图胜千言</h2><blockquote><p>曾看到过一张把filter、map、reduce描述得很透彻得图，真滴六🐂</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191114233050.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191114233050.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><ul><li><a href="http://www.globalnerdy.com/2016/06/26/demonstrating-map-filter-and-reduce-in-swift-using-food-emoji/?tdsourcetag=s_pctim_aiomsg">Demonstrating map, filter, and reduce in Swift using food emoji</a></li><li><a href="https://docs.python.org/zh-cn/3.7/howto/functional.html">函数式编程指引</a></li><li><a href="https://docs.python.org/zh-cn/3/library/functools.html?highlight=reduce#functools.reduce">functools.reduce</a></li><li><a href="https://docs.python.org/zh-cn/3/library/functions.html#map">map</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 函数式编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 函数式编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git clone后如何checkout到remote branch</title>
      <link href="2019/10/27/clone%E5%90%8E%E5%A6%82%E4%BD%95checkout%E5%88%B0remote-branch/"/>
      <url>2019/10/27/clone%E5%90%8E%E5%A6%82%E4%BD%95checkout%E5%88%B0remote-branch/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="what-why"><a href="#what-why" class="headerlink" title="what/why"></a>what/why</h2><p>通常情况使用<code>git clone github_repository_address</code>下载下来的仓库使用<code>git branch</code>查看当前所有分支时只能看到master分支，但是想要切换到其他分支进行工作怎么办❓</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027014941.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027014941.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>其实使用git clone下载的repository没那么简单😥，clone得到的是仓库所有的数据，不仅仅是复制在Github repository所能看到的master分支下的所有文件，<strong>clone下来的是仓库下的每一个文件和每一个文件的版本（也就是说所有的分支都被搞下来了咯）</strong>，那为啥看不到，其实remote branch被隐藏了，需要使用<code>git branch -a</code>才能看到。</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015046.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015046.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="how"><a href="#how" class="headerlink" title="how"></a>how</h2><p>emmm…，现在看到了，那么怎么切换到remote branch呢？（我太难了🙃），又到了查文档的时候了，一波操作过后了解到git checkout是有restore working tree files的功能的，可以用来restore remote branch，比如使用以下命令在本地创建个新分支track远程分支：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b &lt;branch&gt; --track &lt;remote&gt;/&lt;branch&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例子，本地为远程分支CkaiGrac-PYMO创建的新分支名为yeshan，push时需要注意</span></span><br><span class="line">git checkout -b yeshan --track origin/CkaiGrac-PYMO</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015123.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015123.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>tips：使用<code>git checkout -t &lt;remote/branch&gt;</code>默认会在本地建立一个和远程分支名字一样的分支</p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015200.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191027015200.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><ul><li><a href="https://git-scm.com/docs/git-branch">git-branch: https://git-scm.com/docs/git-branch</a></li><li><a href="https://git-scm.com/docs/git-checkout">git-checkout: https://git-scm.com/docs/git-checkout</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Microsoft Edge Beta将网页变成应用</title>
      <link href="2019/10/11/%E4%BD%BF%E7%94%A8Microsoft-Edge-Beta%E5%B0%86%E7%BD%91%E9%A1%B5%E5%8F%98%E6%88%90%E5%BA%94%E7%94%A8/"/>
      <url>2019/10/11/%E4%BD%BF%E7%94%A8Microsoft-Edge-Beta%E5%B0%86%E7%BD%91%E9%A1%B5%E5%8F%98%E6%88%90%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>今天无聊的我打开了装了很久都没用的Microsoft Edge Beta，一波乱戳，惊讶的发现<a href="https://www.microsoftedgeinsider.com/zh-cn/">Microsoft Edge Beta</a>居然有将网页打包为应用的功能😂</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222459.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222459.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222513.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222513.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222538.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191011222538.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><strong>B站也有PC”客户端”了，真香😂</strong></p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单感受下Python内置数据类型常用操作的性能</title>
      <link href="2019/10/02/%E7%AE%80%E5%8D%95%E4%BA%86%E8%A7%A3%E4%B8%8BPython%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%9A%84%E6%80%A7%E8%83%BD/"/>
      <url>2019/10/02/%E7%AE%80%E5%8D%95%E4%BA%86%E8%A7%A3%E4%B8%8BPython%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%9A%84%E6%80%A7%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="生成一个列表的几种方式的性能对比"><a href="#生成一个列表的几种方式的性能对比" class="headerlink" title="生成一个列表的几种方式的性能对比"></a>生成一个列表的几种方式的性能对比</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表常用操作性能测试</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代 + &#x27;+&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span>():</span></span><br><span class="line">    l = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        l = l + [i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代 + append</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span>():</span></span><br><span class="line">    l = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        l.append(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表生成式</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test3</span>():</span></span><br><span class="line">    l = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># list构造函数 + range</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test4</span>():</span></span><br><span class="line">    l = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1000</span>))</span><br><span class="line"></span><br><span class="line">t1 = Timer(<span class="string">&quot;test1()&quot;</span>, <span class="string">&quot;from __main__ import test1&quot;</span>)</span><br><span class="line"><span class="comment"># print(&quot;concat %f seconds&quot; % t1.timeit(number=1000))</span></span><br><span class="line"></span><br><span class="line">t2 = Timer(<span class="string">&quot;test2()&quot;</span>, <span class="string">&quot;from __main__ import test2&quot;</span>)</span><br><span class="line"><span class="comment"># print(&quot;concat %f seconds&quot; % t2.timeit(number=1000))</span></span><br><span class="line"></span><br><span class="line">t3 = Timer(<span class="string">&quot;test3()&quot;</span>, <span class="string">&quot;from __main__ import test3&quot;</span>)</span><br><span class="line"><span class="comment"># print(&quot;concat %f seconds&quot; % t3.timeit(number=1000))</span></span><br><span class="line"></span><br><span class="line">t4 = Timer(<span class="string">&quot;test4()&quot;</span>, <span class="string">&quot;from __main__ import test4&quot;</span>)</span><br><span class="line"><span class="comment"># print(&quot;concat %f seconds&quot; % t4.timeit(number=1000))</span></span><br><span class="line"></span><br><span class="line">result = [t1.timeit(<span class="number">1000</span>), t2.timeit(<span class="number">1000</span>), t3.timeit(<span class="number">1000</span>), t4.timeit(<span class="number">1000</span>)]</span><br><span class="line">method = [<span class="string">&quot;for+ &#x27;+&#x27;&quot;</span>, <span class="string">&quot;for + append&quot;</span>, <span class="string">&quot;list comprehension&quot;</span>, <span class="string">&quot;list + range&quot;</span>]</span><br><span class="line"></span><br><span class="line">plt.bar(method, result, color=<span class="string">&#x27;rgby&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plt.legend(&#x27;concat time&#x27;)</span></span><br><span class="line"><span class="comment"># print(zip(method, result))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(method, result):</span><br><span class="line">    plt.text(x, y, <span class="string">&quot;%fs&quot;</span> % y)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002194307.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002194307.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Cost time"></p><span id="more"></span><h1 id="list和dict的检索效率对比"><a href="#list和dict的检索效率对比" class="headerlink" title="list和dict的检索效率对比"></a>list和dict的检索效率对比</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">lst_result = []</span><br><span class="line">d_result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">1000001</span>,<span class="number">20000</span>):</span><br><span class="line">    t = Timer(<span class="string">&quot;random.randrange(%d) in x&quot;</span> % i, <span class="string">&quot;from __main__ import random,x&quot;</span>)</span><br><span class="line"></span><br><span class="line">    x = <span class="built_in">list</span>(<span class="built_in">range</span>(i))</span><br><span class="line">    lst_time = t.timeit(number=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    x = &#123;j:<span class="literal">None</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i)&#125;</span><br><span class="line">    d_time = t.timeit(number=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    lst_result.append(lst_time)</span><br><span class="line">    d_result.append(d_time)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%d,%10.3f,%10.3f&quot;</span> % (i, lst_time, d_time))</span><br><span class="line"></span><br><span class="line">test = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>,<span class="number">1000001</span>,<span class="number">20000</span>)]</span><br><span class="line"></span><br><span class="line">plt.plot(test, lst_result, <span class="string">&#x27;ro&#x27;</span>)</span><br><span class="line">plt.plot(test, d_result, <span class="string">&#x27;bo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend([<span class="string">&#x27;List&#x27;</span>,<span class="string">&#x27;Dictionary&#x27;</span>])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002202553.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002202553.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="result plot"></p><h1 id="del-list-index-与del-dict-key-性能对比"><a href="#del-list-index-与del-dict-key-性能对比" class="headerlink" title="del list[index]与del dict[key] 性能对比"></a>del list[index]与del dict[key] 性能对比</h1><blockquote><p>average time complexity：$ O(n)\ \ vs\ \ O(1) $</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">size = <span class="number">20000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l_result = []</span><br><span class="line">d_result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">    test_list = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size)]</span><br><span class="line">    list_t = Timer(<span class="string">&quot;del test_list[%d]&quot;</span> % i,<span class="string">&quot;from __main__ import test_list&quot;</span>)</span><br><span class="line">    list_result = list_t.timeit(number=<span class="number">1</span>)</span><br><span class="line">    l_result.append(list_result)</span><br><span class="line"></span><br><span class="line">    test_dict = &#123;j:<span class="literal">None</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(size)&#125;</span><br><span class="line">    dict_t = Timer(<span class="string">&quot;del test_dict[%d]&quot;</span> % i,<span class="string">&quot;from __main__ import test_dict&quot;</span>)</span><br><span class="line">    dict_result = dict_t.timeit(number=<span class="number">1</span>)</span><br><span class="line">    d_result.append(dict_result)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(&quot;%d,%f,%f&quot; % (i, list_result, dict_result))</span></span><br><span class="line"></span><br><span class="line">plt.plot(<span class="built_in">range</span>(size), l_result)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(size), d_result)</span><br><span class="line"></span><br><span class="line">plt.legend([<span class="string">&#x27;del list[index]&#x27;</span>, <span class="string">&#x27;del dict[key]&#x27;</span>])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002211901.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20191002211901.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="result"></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><p><a href="https://www.matplotlib.org.cn/index.html">matplotlib中文文档</a></p></li><li><p><a href="https://wiki.python.org/moin/TimeComplexity">TimeComplexity<Python Wiki></a></p></li><li><p><a href="https://www.icourse163.org/course/PKU-1206307812">北大数据结构与算法公开课</a></p></li><li><p><a href="https://docs.python.org/zh-cn/3/library/timeit.html">Python timeit</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python环境管理与项目依赖管理</title>
      <link href="2019/09/02/Python%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/"/>
      <url>2019/09/02/Python%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>个人简单记录下</p></blockquote><h1 id="virtualenv-pip"><a href="#virtualenv-pip" class="headerlink" title="virtualenv + pip"></a>virtualenv + pip</h1><blockquote><p>virtualenv是一个用于创建”隔离的ython运行环境”的工具，<a href="https://virtualenv.pypa.io/en/latest/">Docs</a><br>pip是Python的包管理工具，<a href="https://pip.pypa.io/en/stable/">Docs</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装virtualenv</span></span><br><span class="line">pip install virtualenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------------- #</span></span><br><span class="line"><span class="comment"># 虚拟环境的创建与使用</span></span><br><span class="line"><span class="comment"># 1、在当前工程目录下使用virtualenv创建一套独立的Python运行环境</span></span><br><span class="line">virtualenv venv  <span class="comment"># 环境名为venv（自由定义）</span></span><br><span class="line"><span class="comment"># 2、cd 到创建好的虚拟环境的Scripts目录，执行如下命令可激活或者退出虚拟环境</span></span><br><span class="line">activate    <span class="comment"># 激活，激活后命令提示符会变成当前工程目录Python环境名</span></span><br><span class="line">deactivate  <span class="comment"># 退出</span></span><br><span class="line"><span class="comment"># 3、激活虚拟环境后可使用pip为当前项目安装依赖，example：</span></span><br><span class="line">pip install numpy</span><br><span class="line"><span class="comment"># 4、使用pip freeze &gt; requirements.txt 可导出项目依赖到requirements.txt中</span></span><br><span class="line"><span class="comment"># 为项目创建一个新的、干净的环境时，可使用 pip install -r requiremen.txt 为项目安装依赖</span></span><br></pre></td></tr></table></figure><span id="more"></span><h1 id="Pipenv"><a href="#Pipenv" class="headerlink" title="Pipenv"></a>Pipenv</h1><blockquote><p>Pipenv集包管理和虚拟环境管理于一身，使用Pipfile和Pipfile.lock管理项目依赖（Pipfile中保存着各个依赖包的版本信息，Pipfile.lock保存着依赖包的锁信息）。<a href="https://docs.pipenv.org/en/latest/">Docs</a></p></blockquote><p><a href="https://rootnroll.com/d/pipenv/">Pipenv playground</a></p><p><a href="https://blog.windrunner.me/python/pip.html#pipfile-%E4%B8%8E-pipfilelock">Pipfile and Pipfile.lock</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">pip install pipenv</span><br><span class="line"><span class="comment"># ------------------ #</span></span><br><span class="line"><span class="comment"># Pipenv的使用</span></span><br><span class="line"><span class="comment"># 1、为当前工程创建虚拟环境</span></span><br><span class="line">pipenv install  <span class="comment"># 这里会生成Pipfile和Pipfile.lock文件</span></span><br><span class="line"><span class="comment"># 2、虚拟环境的激活</span></span><br><span class="line">pipenv shell    <span class="comment"># 激活虚拟环境</span></span><br><span class="line"><span class="comment"># 3、安装依赖</span></span><br><span class="line">pipenv install [package_name]</span><br><span class="line"><span class="comment"># 4、在虚拟环境中运行Python脚本</span></span><br><span class="line">pipenv run xxx.py</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/d0/174c52397492e29396bd3b35be1b842c560a5f.png" class="lazyload" data-srcset="https://img.vim-cn.com/d0/174c52397492e29396bd3b35be1b842c560a5f.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="help"></p><h1 id="Poetry"><a href="#Poetry" class="headerlink" title="Poetry"></a>Poetry</h1><blockquote><p>Poetry是新一代的用来处理依赖项的安装、构建和打包成Python包的工具（2018年2月28日发布0.1.0版本），Poetry使用pyproject.toml管理项目依赖。<a href="https://poetry.eustace.io/docs/">Docs</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Poetry的安装</span></span><br><span class="line">pip install poetry</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------------- #</span></span><br><span class="line"><span class="comment"># poetry的使用</span></span><br><span class="line"><span class="comment"># 1、快速创建一个Python项目</span></span><br><span class="line">poetry new [project_name]</span><br><span class="line"><span class="comment"># 2、以交互式的方式为当前项目创建pyproject.toml文件</span></span><br><span class="line">poetry init</span><br><span class="line"><span class="comment"># 3、为当前项目添加依赖</span></span><br><span class="line">poetry add [package_name]</span><br><span class="line"><span class="comment"># 4、构建源码并对当前项目进行wheels archive（打包成Python包）</span></span><br><span class="line">poetry build</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/19/0c0b38a2733929e1d9f5e29ed870b5f0ce7ac3.png" class="lazyload" data-srcset="https://img.vim-cn.com/19/0c0b38a2733929e1d9f5e29ed870b5f0ce7ac3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="help"></p><h1 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h1><p><a href="https://www.python.org/dev/peps/pep-0427/">关于Wheel打包格式《PEP427》</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 环境管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker学习笔记</title>
      <link href="2019/08/08/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2019/08/08/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p><a href="https://labs.play-with-docker.com/">Play With Docker一个免费使用的基于web界面的Docker环境</a></p></blockquote><h1 id="常用docker命令"><a href="#常用docker命令" class="headerlink" title="常用docker命令"></a>常用docker命令</h1><p><strong>可使用<code>docker COMMAND --help</code>查看命令的用法</strong></p><h2 id="Docker镜像相关"><a href="#Docker镜像相关" class="headerlink" title="Docker镜像相关"></a>Docker镜像相关</h2><ul><li>1、<code>docker image pull</code>：用于下载镜像，镜像从远程镜像仓库服务的仓库中下载，默认从Docker Hub的仓库中拉取</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式：docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span></span><br><span class="line"><span class="comment"># 说明：如果给出tag，一般拉取latest，name一般为username/repository,digest为镜像摘要可不给出</span></span><br><span class="line">docker image pull ubuntu:latest</span><br><span class="line"><span class="comment"># 这个拉取标签为latest的ubuntu官方镜像，latest: Pulling from library/ubuntu，latest不一定是最新镜像</span></span><br></pre></td></tr></table></figure><span id="more"></span><ul><li><p>2、<code>docker image ls</code>：列出本地Docker主机上存储的镜像</p></li><li><p>3、<code>docker image inspect</code>：查看镜像的细节，包括镜像层数据和元数据</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker image inspect [OPTIONS] IMAGE [IMAGE...]</span></span><br><span class="line"><span class="comment"># inspect后一般跟repository name或image id</span></span><br></pre></td></tr></table></figure><ul><li><p>4、<code>docker image rm</code>：用于删除镜像。如果镜像存在关联的容器，并且容器处于运行(Up)或停止(Exit)状态时，不允许删除该镜像。rm后可跟repository或image id</p></li><li><p>5、<code>dicker image search</code>：从Docker Hub查找镜像</p></li><li><p>6、<code>docker image build</code>：根据Dockerfile构建镜像</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如：使用当前目录的 Dockerfile 创建镜像，标签为 runoob/ubuntu:v1。</span></span><br><span class="line">docker build -t yeshan333/ubuntu:latest .</span><br></pre></td></tr></table></figure><ul><li>7、<code>docker image history</code>：用于查看镜像构建的相关信息</li></ul><h2 id="Docker容器相关"><a href="#Docker容器相关" class="headerlink" title="Docker容器相关"></a>Docker容器相关</h2><ul><li>1、<code>docker container run</code>：用于启动新容器</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式：docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span></span><br><span class="line"><span class="comment"># 常用options：</span></span><br><span class="line"><span class="comment"># -d: 后台运行容器，并返回容器ID；</span></span><br><span class="line"><span class="comment"># -i: 以交互模式运行容器，通常与 -t 同时使用；</span></span><br><span class="line"><span class="comment"># -t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span></span><br><span class="line"><span class="comment"># -P: 随机端口映射，容器内部端口随机映射到主机的高端口</span></span><br><span class="line"><span class="comment"># -p: 指定端口映射，格式为：主机(宿主)端口:容器端口</span></span><br><span class="line"><span class="comment"># --name=&quot;container-name&quot;: 为容器指定一个名称；</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">docker container run -it ubuntu:latest /bin/bash</span><br><span class="line"><span class="comment"># 说明：-it使容器具备交互性并与终端连接，命令最后表明运行容器中的Bash Shell程序</span></span><br></pre></td></tr></table></figure><ul><li><p>2、<code>docker container ls</code>：列出所有运行状态的容器可用<code>docker p</code>s代替，如果加个**-a*附加参数，会列出所有容器（包括处于停止状态的容器）</p></li><li><p>3、<code>docker container stop</code>：停止运行中的容器，并将其状态设置为Exited(0)，stop后跟container name或container id</p></li><li><p>4、<code>docker container rm</code>：用于删除停止运行的容器，rm后跟container name或container id，使用-f参数可强制删除运行中的容器</p></li><li><p>5、<code>docker container exec</code>：用于连接一个处于运行状态的容器</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">docker container <span class="built_in">exec</span> -t &lt;container-name or container-id&gt; bash</span><br><span class="line"><span class="comment"># 该命令会将docker主机中的shell连接到一个运行中的容器，在容器内部启动一个新的bash shell进程</span></span><br></pre></td></tr></table></figure><ul><li><p>6、<code>docker container start</code>：用于重启处于停止(Exited)状态的容器，start后跟container name或container id</p></li><li><p>7、<code>docker container inspect</code>：查看容器的配置信息和运行时信息，inspect后跟container name或container id</p></li><li><p>8、快捷键<code>Ctrl+PQ</code>用于断开docker主机的shell终端与容器终端的连接，并在退出后保证容器在后台运行</p></li></ul><h1 id="应用容器化"><a href="#应用容器化" class="headerlink" title="应用容器化"></a>应用容器化</h1><blockquote><p>(Containerizing|Dockerizing)即将应用整合到容器中并且运行的过程</p></blockquote><h2 id="应用容器化的一般步骤"><a href="#应用容器化的一般步骤" class="headerlink" title="应用容器化的一般步骤"></a>应用容器化的一般步骤</h2><ul><li>1、编写应用代码</li><li>2、创建Dockerfile，其中包括当前应用的描述、依赖以及如何运行这个应用</li><li>3、对Dockerfile执行docker image build命令</li><li>4、等待Docker将应用程序构建到Docker镜像中</li></ul><blockquote><p>Once your app is containerized (made into a Docker image), you’re ready to ship it and run it as a container.《Docker Deep Dive》</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190808213453.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190808213453.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="docker deep dive"></p><h2 id="使用Dockerfile定制镜像"><a href="#使用Dockerfile定制镜像" class="headerlink" title="使用Dockerfile定制镜像"></a>使用Dockerfile定制镜像</h2><ul><li><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Dockerfile最佳实践</a></li><li><a href="https://docker_practice.gitee.io/image/build.html">使用Dockerfile定制镜像</a></li></ul><blockquote><p>Dockerfile中以#开头的都是注释行，除注释之外，每一行都是一条指令<br>指令的的一般格式：INSTRUCTION argument，INSTRUCTION一般都为大写</p></blockquote><p>示例Dockerfile：<a href="https://github.com/yeshan333/psweb">https://github.com/yeshan333/psweb</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">FROM alpine</span><br><span class="line"></span><br><span class="line">LABEL maintainer=&quot;nigelpoulton@hotmail.com&quot;</span><br><span class="line"></span><br><span class="line"># Install Node and NPM</span><br><span class="line">RUN apk add --update nodejs nodejs-npm</span><br><span class="line"></span><br><span class="line"># Copy app to /src</span><br><span class="line">COPY . /src</span><br><span class="line"></span><br><span class="line">WORKDIR /src</span><br><span class="line"></span><br><span class="line"># Install dependencies</span><br><span class="line">RUN  npm install</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;node&quot;, &quot;./app.js&quot;]</span><br></pre></td></tr></table></figure><ul><li>说明：<ul><li>每个Dockerfile文件文件的第一行一般都是<code>FROM</code>指令。<strong>FROM指定的镜像会作为当前镜像的一个基础镜像层，当前应用的剩余内容会作为新的镜像层添加到基础镜像层之上。</strong>，FROM建议引用官方镜像</li><li>LABEL指定当前镜像维护者，给镜像使用者一个沟通渠道</li><li><code>RUN apk add --update nodejs nodejs-npm</code>将当前应用的依赖安装到镜像中，RUN指令会新建一个镜像层存储这些内容</li><li><code>COPY . /src</code>会将应用相关文件从构建上下文复制到当前镜像中，这会新建一个镜像层</li><li><code>WORKDIR /src</code>会为Dockerfile中未执行的指令设置工作目录</li><li><code>RUN  npm install</code>在当前工作目录中为应用安装依赖，这会新建一个镜像层</li><li><code>EXPOSE 8080</code>对外提供一个web服务端口</li><li><code>ENTRYPOINT [&quot;node&quot;, &quot;./app.js&quot;]</code>指定了当前镜像的入口程序，container运行时就会运行</li></ul></li></ul><h3 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h3><p>使用docker image build根据Dockerfile制作镜像，示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># -t用于指定制作好的镜像的名字及标签，通常 name:tag 或者 name</span><br><span class="line"># 最后的 . 表示使用当前目录作为构建上下文</span><br><span class="line">docker image build -t web:latest .</span><br></pre></td></tr></table></figure><p><strong>使用<code>docker image history web:latest</code>可以查看构建镜像过程中执行了哪些指令</strong></p><h3 id="推送镜像到Docker-Hub"><a href="#推送镜像到Docker-Hub" class="headerlink" title="推送镜像到Docker Hub"></a>推送镜像到Docker Hub</h3><ul><li>推送镜像前建议使用以下命令给镜像打新标签<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># new-tag建议以自己的 DockerHub ID/new-tag 的格式命名，方便推送到自己的repo</span><br><span class="line">docker image tag &lt;current-tag&gt; &lt;new-tag&gt;</span><br></pre></td></tr></table></figure></li><li>使用<code>docker image push &lt;tag-name&gt;</code>推送镜像，推送前需要<code>docker login</code>,<strong>记得测试打包好的应用再推送！！！</strong></li></ul><h3 id="Dockerfile常用指令"><a href="#Dockerfile常用指令" class="headerlink" title="Dockerfile常用指令"></a>Dockerfile常用指令</h3><table><thead><tr><th align="center">指令</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">FROM</td><td align="center">指定要构建的镜像的基础镜像，一般为Dockerfile文件第一行</td></tr><tr><td align="center">RUN</td><td align="center">用于在镜像中执行命令，会新建一个镜像层</td></tr><tr><td align="center">COPY</td><td align="center">一般用于将应用代码copy到镜像中，这会新建一个镜像层</td></tr><tr><td align="center">WORKDIR</td><td align="center">用于设置Dockerfile中未执行的指令的工作目录</td></tr><tr><td align="center">ENTRYPOINT</td><td align="center">指定镜像以容器方式启动后默认运行的程序， ENTRYPOINT 的命令不会被docker run指定要执行的命令覆盖</td></tr><tr><td align="center">CMD</td><td align="center">指定容器启动时执行的命令，一个 Dockerfile 中只能有一个 CMD 指令，如果写了多个，那么只有最后一个会执行。CMD 和 ENTRYPOINT 同时存在时，CMD 中的内容会变成 ENTRYPOINT 中指令命令的默认参数，该参数可以被 docker run 时设置的命令覆盖</td></tr><tr><td align="center">ENV</td><td align="center">设置镜像中的环境变量</td></tr><tr><td align="center">EXPOSE</td><td align="center">记录应用所使用的网络端口</td></tr></tbody></table><p>更多：</p><ul><li><a href="https://docker_practice.gitee.io/image/dockerfile/">Dockerfile指令详解</a></li><li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference</a></li></ul><p align="middle"><a src="https://labs.play-with-docker.com/"><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190808232118.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190808232118.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></a></p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>几个不错的Jupyter Notebook云端展示平台</title>
      <link href="2019/08/07/%E5%87%A0%E4%B8%AA%E4%B8%8D%E9%94%99%E7%9A%84Jupyter%20Notebook%E4%BA%91%E7%AB%AF%E5%B1%95%E7%A4%BA%E5%B9%B3%E5%8F%B0/"/>
      <url>2019/08/07/%E5%87%A0%E4%B8%AA%E4%B8%8D%E9%94%99%E7%9A%84Jupyter%20Notebook%E4%BA%91%E7%AB%AF%E5%B1%95%E7%A4%BA%E5%B9%B3%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="jupyter-nbviewer"><a href="#jupyter-nbviewer" class="headerlink" title="jupyter nbviewer"></a>jupyter nbviewer</h1><p><a href="https://nbviewer.jupyter.org/">URL:https://nbviewer.jupyter.org/</a></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807100641.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807100641.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>结合Github的示例用法：<a href="https://nbviewer.jupyter.org/github/">https://nbviewer.jupyter.org/github/</a> + &lt;<code>用户名</code>或者<code>用户名/存放ipynb文件的仓库</code>或者<code>Gist ID</code>&gt;</p><p>例如：<a href="https://nbviewer.jupyter.org/github/yeshan333/JupyterNotebook-Show-sample">https://nbviewer.jupyter.org/github/yeshan333/JupyterNotebook-Show-sample</a></p><span id="more"></span><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807101034.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807101034.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807101015.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807101015.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>还行~~~</p><h1 id="binder"><a href="#binder" class="headerlink" title="binder"></a>binder</h1><p><a href="https://mybinder.org/">URL:https://mybinder.org</a></p><p>使用文档：<a href="https://mybinder.readthedocs.io/en/latest/index.html#">https://mybinder.readthedocs.io/en/latest/index.html#</a></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807102351.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807102351.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>结合Github的示例用法：<a href="https://mybinder.org/v2/gh/">https://mybinder.org/v2/gh/</a> + &lt;用户名/仓库名&gt; + /分支名 + ?filepath= + ipynb文件名</p><p>例如：<a href="https://mybinder.org/v2/gh/yeshan333/JupyterNotebook-Show-sample/master?filepath=demo.ipynb">https://mybinder.org/v2/gh/yeshan333/JupyterNotebook-Show-sample/master?filepath=demo.ipynb</a></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807103106.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807103106.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><strong>很nice啊，在线交互式环境，在线跑代码，就是渲染有点小慢</strong></p><h1 id="google-colab"><a href="#google-colab" class="headerlink" title="google colab"></a>google colab</h1><p><a href="https://colab.research.google.com/notebooks/welcome.ipynb">官方介绍:https://colab.research.google.com/notebooks/welcome.ipynb</a>，需要科学上网</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=62772711&cid=109062819&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807103836.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807103836.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>结合Github的示例用法：<a href="https://colab.research.google.com/github/">https://colab.research.google.com/github/</a> + 用户名/ + 存放ipynb文件的仓库名/ + blob/ + 分支名 + 要展示的ipynb文件路径</p><p>示例：<a href="https://colab.research.google.com/github/yeshan333/JupyterNotebook-Show-sample/blob/master/demo.ipynb">https://colab.research.google.com/github/yeshan333/JupyterNotebook-Show-sample/blob/master/demo.ipynb</a></p><p><img src="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807105348.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/ssmath/mypic/img/20190807105348.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>也是个在线的交互式环境，很nice了</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Jupyter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pdb &amp;&amp; cProfile</title>
      <link href="2019/07/28/pdb-profile/"/>
      <url>2019/07/28/pdb-profile/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="pdb"><a href="#pdb" class="headerlink" title="pdb"></a>pdb</h1><blockquote><p><a href="https://docs.python.org/zh-cn/3.7/library/pdb.html#module-pdb">https://docs.python.org/zh-cn/3.7/library/pdb.html#module-pdb</a></p></blockquote><h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><ul><li>1、在命令行下直接运行调试</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pdb test.py</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/a2/72fea3f756ee8ece77496b3dcec3c7e4d2cd4c.png" class="lazyload" data-srcset="https://img.vim-cn.com/a2/72fea3f756ee8ece77496b3dcec3c7e4d2cd4c.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><ul><li>2、在需要被调试的代码中添加<code>import pdb</code>、<code>pdb.set_trace()</code>再运行代码进行调试</li></ul><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;enter func()&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line"><span class="keyword">import</span> pdb</span><br><span class="line">pdb.set_trace() <span class="comment"># 运行到此处启动pdb</span></span><br><span class="line">func()</span><br><span class="line">c = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(a + b + c)</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/a3/4e2ecf7fbd04144c27887217a532fc913ecb3a.png" class="lazyload" data-srcset="https://img.vim-cn.com/a3/4e2ecf7fbd04144c27887217a532fc913ecb3a.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><table><thead><tr><th align="center">简写</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">p &lt;变量名&gt;</td><td align="center">输出变量的值</td></tr><tr><td align="center">l</td><td align="center">列出源码，当前位置前后11行</td></tr><tr><td align="center">n</td><td align="center">执行吓一条语句</td></tr><tr><td align="center">s</td><td align="center">执行下一条语句，如果是函数，则会进入函数内，显示–call–，执行函数内第一条语句，执行完函数内语句后跳出显示–return–</td></tr><tr><td align="center">b</td><td align="center">列出当前所有断点</td></tr><tr><td align="center">b lineno</td><td align="center">在某行添加断点</td></tr><tr><td align="center">cl</td><td align="center">清除断点</td></tr><tr><td align="center">q</td><td align="center">退出调试pdb</td></tr><tr><td align="center">help</td><td align="center">帮助</td></tr></tbody></table><p><img src="https://img.vim-cn.com/91/21b5a0146465f972c69a42214d99164b11d3cb.png" class="lazyload" data-srcset="https://img.vim-cn.com/91/21b5a0146465f972c69a42214d99164b11d3cb.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><h1 id="cProfile-性能分析"><a href="#cProfile-性能分析" class="headerlink" title="cProfile-性能分析"></a>cProfile-性能分析</h1><blockquote><p><a href="https://docs.python.org/zh-cn/3.7/library/profile.html">https://docs.python.org/zh-cn/3.7/library/profile.html</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">memoize</span>(<span class="params">f</span>):</span></span><br><span class="line">    memo = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> memo:</span><br><span class="line">            memo[x] = f(x)</span><br><span class="line">        <span class="keyword">return</span> memo[x]</span><br><span class="line">    <span class="keyword">return</span> helper</span><br><span class="line"></span><br><span class="line"><span class="meta">@memoize</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> fib(n-<span class="number">1</span>) + fib(n-<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib_seq</span>(<span class="params">n</span>):</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        res.extend(fib_seq(n-<span class="number">1</span>))</span><br><span class="line">    res.append(fib(n))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">fib_seq(<span class="number">30</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m cProfile test.py</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/ed/1e64c45bda5d78d390323282cd6cd52b9ca7e1.png" class="lazyload" data-srcset="https://img.vim-cn.com/ed/1e64c45bda5d78d390323282cd6cd52b9ca7e1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><ul><li>ncalls：相应代码/函数被调用的次数</li><li>tottime：相应代码/函数执行所需时间（不包括它调用的其他代码/函数的时间）</li><li>tottime percall：tottime/ncalls的结果</li><li>cumtime：对应代码/函数执行所需时间，包含它调用的其他代码/函数的时间</li><li>cumtime percall：cumtime和ncall相除的平均结果</li></ul><p><img src="https://img.vim-cn.com/80/3c30f54c3a5e9e187e8c550ccbf1bb741ba790.png" class="lazyload" data-srcset="https://img.vim-cn.com/80/3c30f54c3a5e9e187e8c550ccbf1bb741ba790.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python-自定义上下文管理器</title>
      <link href="2019/07/26/Python-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/"/>
      <url>2019/07/26/Python-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="上下文管理器"><a href="#上下文管理器" class="headerlink" title="上下文管理器"></a>上下文管理器</h1><ul><li>上下文管理器可以帮助我们自动分配和释放资源</li><li>上下文管理器需要配合<strong>with语句</strong>使用</li></ul><p>比如进行文件操作的时候我们可能会忘记操作后关闭文件（file close），使用<code>with open(filename, mode) as f</code>不需要我们手动关闭文件，不管处理文件中是否有异常出现，都能保证with语句执行完毕后关闭文件，有效防止资源泄露，安全多了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># with 语句的一般格式</span></span><br><span class="line"><span class="keyword">with</span> context_expression [<span class="keyword">as</span> target(s)]:</span><br><span class="line">    <span class="keyword">with</span>-body</span><br></pre></td></tr></table></figure><p><strong>在执行with-body会调用上下文管理器的__enter__方法，执行完with-body之后再调用上下文管理器的__exit__方法</strong></p><span id="more"></span><h1 id="基与类的上下文管理器"><a href="#基与类的上下文管理器" class="headerlink" title="基与类的上下文管理器"></a>基与类的上下文管理器</h1><ul><li>基与类的上下文管理器需要我们实现对象的<code>__enter()__</code>和<code>__exit()__</code>方法</li><li>我们需要在<code>__enter()__</code>中管理资源对象，在<code>__exit__()</code>中释放资源</li><li><strong>enter</strong> 方法在 with 语句体执行前调用，with 语句将该方法的返回值赋给 as 字句中的变量，如果有 as 字句的话</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟 Python 的打开文件、关闭文件操作</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Filemanager</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, mode</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;calling __init__ method&#x27;</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.mode = mode</span><br><span class="line">        self.file = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;caling __enter__ method&#x27;</span>)</span><br><span class="line">        self.file = <span class="built_in">open</span>(self.name, self.mode)</span><br><span class="line">        <span class="keyword">return</span> self.file</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;caling __exit__ method&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> self.file:</span><br><span class="line">            self.file.close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Filemanager为上下文管理器</span></span><br><span class="line"><span class="comment"># with Filemanager(&#x27;test.txt&#x27;, &#x27;w&#x27;) as f 是上下文表达式，f为资源对象</span></span><br><span class="line"><span class="keyword">with</span> Filemanager(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ready to write to file&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">&#x27;Hello World&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/a0/ab04491fd66278800b3203d25393bf07ff993f.png" class="lazyload" data-srcset="https://img.vim-cn.com/a0/ab04491fd66278800b3203d25393bf07ff993f.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><ul><li>运行结果解析：<ul><li>1、with 语句调用__init__方法，初始化对象</li><li>2、with 语句先暂存了Filemanager的__exit__方法</li><li>3、然后调用__enter__方法，输出caling <strong>enter</strong> method，返回资源对象（这里是文件句柄）给f</li><li>4、输出ready to write to file，将Hello World写入文件</li><li>5、最后调用__exit__方法，输出caling <strong>exit</strong> method，关闭之前打开的文件流</li></ul></li></ul><p><strong>注意</strong>：__exit__方法中的参数exc_type、exc_val、exc_tb分别表示exception type、exception value、traceback。进行资源回收时如果有异常抛出，那么异常的信息就会包含再这三个变量中，让我们可以再__exit__中处理这些异常。例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;__init__ called&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;__enter__ called&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span>(<span class="params">self, exc_type, exc_value, exc_tb</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;__exit__ called&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> exc_type:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;exc_type: <span class="subst">&#123;exc_type&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;exc_value: <span class="subst">&#123;exc_value&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;exc_traceback: <span class="subst">&#123;exc_tb&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;exception handled&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Foo() <span class="keyword">as</span> obj:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;exception raised&#x27;</span>).with_traceback(<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">输出结果：</span><br><span class="line">---------------------------------------</span><br><span class="line">1、__exit__返回 True</span><br><span class="line">__init__ called</span><br><span class="line">__enter__ called</span><br><span class="line">__exit__ called</span><br><span class="line">exc_type: &lt;class &#x27;Exception&#x27;&gt;</span><br><span class="line">exc_value: exception raised</span><br><span class="line">exc_traceback: &lt;traceback object at 0x00000234AA532F08&gt;</span><br><span class="line">exception handled</span><br><span class="line">---------------------------------------</span><br><span class="line">2、__exit__返回 False</span><br><span class="line">__init__ called</span><br><span class="line">__enter__ called</span><br><span class="line">__exit__ called</span><br><span class="line">exc_type: &lt;class &#x27;Exception&#x27;&gt;</span><br><span class="line">exc_value: exception raised</span><br><span class="line">exc_traceback: &lt;traceback object at 0x00000120D0324F88&gt;</span><br><span class="line">exception handled</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;e:\Blog\shansan\source\_posts\context.py&quot;, line 19, in &lt;module&gt;</span><br><span class="line">    raise Exception(&#x27;exception raised&#x27;).with_traceback(None)</span><br><span class="line">Exception: exception raised</span><br><span class="line">---------------------------------------</span><br></pre></td></tr></table></figure><p><strong>发生异常时，__exit__方法返回 True 表示不处理异常，否则会在退出该方法后重新抛出异常以由 with 语句之外的代码逻辑进行处理。</strong></p><h1 id="基与生成器的上下文管理器"><a href="#基与生成器的上下文管理器" class="headerlink" title="基与生成器的上下文管理器"></a>基与生成器的上下文管理器</h1><ul><li>基于生成器的上下文管理器的实现需要使用<code>@contextmanage</code>装饰器</li><li>我们需要在finally block 中释放资源</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_manager</span>(<span class="params">name, mode</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = <span class="built_in">open</span>(name, mode)</span><br><span class="line">        <span class="keyword">yield</span> f</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> file_manager(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-pythonwith/">浅谈Python的with语句</a></li><li><a href="http://wiki.jikexueyuan.com/project/explore-python/Advanced-Features/context.html">上下文管理器-极客学院</a></li><li><a href="http://wiki.jikexueyuan.com/project/interpy-zh/context_managers/README.html">http://wiki.jikexueyuan.com/project/interpy-zh/context_managers/README.html</a></li><li><a href="https://juejin.im/post/5c87b165f265da2dac4589cc">深入理解 Python 中的上下文管理器</a></li><li><a href="https://time.geekbang.org/column/article/106821">Python核心技术与实战-极客时间</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 上下文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python协程-asyncio、async/await</title>
      <link href="2019/07/19/Python%E5%8D%8F%E7%A8%8B%EF%BC%88Coroutine%EF%BC%89/"/>
      <url>2019/07/19/Python%E5%8D%8F%E7%A8%8B%EF%BC%88Coroutine%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>看到吐血 <em>(´ཀ`」 ∠)</em></p></blockquote><ul><li>协程(Coroutine)本质上是一个函数，特点是在代码块中可以将执行权交给其他协程</li><li>众所周知，子程序（函数）都是层级调用的，如果在A中调用了B，那么B执行完毕返回后A才能执行完毕。<strong>协程与子程序有点类似，但是它在执行过程中可以中断，转而执行其他的协程，在适当的时候再回来继续执行。</strong></li><li>协程与多线程相比的最大优势在于：协程是一个线程中执行，没有线程切换的开销；协程由用户决定在哪里交出控制权</li><li>这里用到的是asyncio库(Python 3.7)，这个库包含了大部分实现协程的魔法工具<ul><li>使用 async 修饰词声明异步函数</li><li>使用 await 语句执行可等待对象（Coroutine、Task、Future）</li><li>使用 asyncio.create_task 创建任务，将异步函数（协程）作为参数传入，等待<a href="https://docs.python.org/3/library/asyncio-eventloop.html">event loop</a>执行</li><li>使用 asyncio.run 函数运行协程程序，协程函数作为参数传入</li></ul></li></ul><span id="more"></span><h1 id="解析协程运行时"><a href="#解析协程运行时" class="headerlink" title="解析协程运行时"></a>解析协程运行时</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">a</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎使用 a ！&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎回到 a ！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">b</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎来到 b ！&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎回到 b ！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    task1 = asyncio.create_task(a())</span><br><span class="line">    task2 = asyncio.create_task(b())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;准备开始&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> task1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;task1 结束&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> task2</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;task2 结束&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.perf_counter()</span><br><span class="line"></span><br><span class="line">    asyncio.run(main())</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;花费 &#123;&#125; s&#x27;</span>.<span class="built_in">format</span>(time.perf_counter() - start))</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/e4/2864cd5a7adf8d63775b3069bf77fc25294742.png" class="lazyload" data-srcset="https://img.vim-cn.com/e4/2864cd5a7adf8d63775b3069bf77fc25294742.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><ul><li>解释：<ul><li>1、asyncio.run(main())，程序进入main()函数，开启事件循环</li><li>2、创建任务task1、task2并进入事件循环等待运行</li><li>3、输出准备开始</li><li>4、执行await task1，用户选择从当前主任务中切出，<strong>事件调度器开始调度 a</strong></li><li>5、a 开始运行，输出欢迎使用a！，<strong>运行到await asyncio.sleep(1)，从当前任务切出，事件调度器开始调度 b</strong></li><li>6、b 开始运行，输出欢迎来到b！，<strong>运行到await asyncio.sleep(2)，从当前任务切出</strong></li><li>7、以上事件运行时间非常短（毫秒），<strong>事件调度器开始暂停调度</strong></li><li>8、<strong>一秒钟后，a的sleep完成，事件调度器将控制权重新交给a</strong>，输出欢迎回到a！，task1完成任务，退出事件循环</li><li>9、await task1完成，事件调度器将控制权还给主任务，输出task1结束，然后在await task2处继续等待</li><li>10、<strong>两秒钟后，b的sleep完成，事件调度器将控制权重新传给 b</strong>，输出欢迎回到 b！，task2完成任务，从事件循环中退出</li><li>11、事件调度器将控制权交还给主任务，主任务输出task2结束，至此协程任务全部结束，事件循环结束。</li></ul></li></ul><p><strong>上面的代码也可以这样写，将15到21行换成一行<code>await asyncio.gather(a(), b())</code>也能实现类似的效果</strong>，await asyncio.gather 会并发运行传入的可等待对象（Coroutine、Task、Future）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">a</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎使用 a ！&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎回到 a ！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">b</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎来到 b ！&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;欢迎回到 b ！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(a(), b())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.perf_counter()</span><br><span class="line"></span><br><span class="line">    asyncio.run(main())</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;花费 &#123;&#125; s&#x27;</span>.<span class="built_in">format</span>(time.perf_counter() - start))</span><br></pre></td></tr></table></figure><h1 id="异步接口同步实现"><a href="#异步接口同步实现" class="headerlink" title="异步接口同步实现"></a>异步接口同步实现</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">- 简单爬虫模拟</span></span><br><span class="line"><span class="string">- 这里用异步接口写了个同步代码</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">crawl_page</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;crawling &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(url))</span><br><span class="line">    sleep_time = <span class="built_in">int</span>(url.split(<span class="string">&#x27;_&#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(sleep_time)  <span class="comment"># 休眠</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;OK &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(url))</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">urls</span>):</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        <span class="keyword">await</span> crawl_page(url)  <span class="comment"># await会将程序阻塞在这里，进入被调用的协程函数，执行完毕后再继续</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="comment"># pip install nest-asyncio</span></span><br><span class="line">asyncio.run(main([<span class="string">&#x27;url_1&#x27;</span>, <span class="string">&#x27;url_2&#x27;</span>])) <span class="comment"># 协程接口</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Cost &#123;&#125; s&quot;</span>.<span class="built_in">format</span>(time.perf_counter() - start))</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/63/f34d5279d27f6419a9879c1629d043996b9b00.png" class="lazyload" data-srcset="https://img.vim-cn.com/63/f34d5279d27f6419a9879c1629d043996b9b00.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="使用Task实现异步"><a href="#使用Task实现异步" class="headerlink" title="使用Task实现异步"></a>使用Task实现异步</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 异步实现</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">crawl_page</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;crawling &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(url))</span><br><span class="line">    sleep_time = <span class="built_in">int</span>(url.split(<span class="string">&#x27;_&#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(sleep_time)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;OK &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(url))</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">urls</span>):</span></span><br><span class="line">    tasks = [asyncio.create_task(crawl_page(url)) <span class="keyword">for</span> url <span class="keyword">in</span> urls]</span><br><span class="line">    <span class="keyword">for</span> task <span class="keyword">in</span> tasks:</span><br><span class="line">        <span class="keyword">await</span> task</span><br><span class="line">    <span class="comment"># 14、15行也可以换成这一行await asyncio.gather(*tasks)</span></span><br><span class="line">    <span class="comment"># *tasks 解包列表，将列表变成了函数的参数，与之对应的是，** dict 将字典变成了函数的参数</span></span><br><span class="line"></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"></span><br><span class="line">asyncio.run(main([<span class="string">&#x27;url_1&#x27;</span>, <span class="string">&#x27;url_2&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Cost &#123;&#125; s&quot;</span>.<span class="built_in">format</span>(time.perf_counter() - start))</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/f4/64fc768078c4633df92c2a4b3b3dca468c4626.png" class="lazyload" data-srcset="https://img.vim-cn.com/f4/64fc768078c4633df92c2a4b3b3dca468c4626.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="生产者消费者模型的协程版本"><a href="#生产者消费者模型的协程版本" class="headerlink" title="生产者消费者模型的协程版本"></a>生产者消费者模型的协程版本</h1><p><a href="https://zh.wikipedia.org/wiki/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98"><img src="https://img.vim-cn.com/7f/3d047c4b22bdb566c53b8ca5608244bfdb4e4b.png" class="lazyload" data-srcset="https://img.vim-cn.com/7f/3d047c4b22bdb566c53b8ca5608244bfdb4e4b.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 极客时间：Python核心技术与实战</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">consumer</span>(<span class="params">queue, <span class="built_in">id</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;消费者&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        val = <span class="keyword">await</span> queue.get()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; get a val : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>, val))</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">producer</span>(<span class="params">queue, <span class="built_in">id</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;生产者&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        val = random.randint(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">await</span> queue.put(val)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; put a val: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>, val))</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    queue = asyncio.Queue()</span><br><span class="line"></span><br><span class="line">    consumer_1 = asyncio.create_task(consumer(queue, <span class="string">&#x27;consumer_1&#x27;</span>))</span><br><span class="line">    consumer_2 = asyncio.create_task(consumer(queue, <span class="string">&#x27;consumer_2&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    producer_1 = asyncio.create_task(producer(queue, <span class="string">&#x27;producer_1&#x27;</span>))</span><br><span class="line">    producer_2 = asyncio.create_task(producer(queue, <span class="string">&#x27;producer_2&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># cancel掉执行之间过长的consumer_1、consumer_2,while True</span></span><br><span class="line">    consumer_1.cancel()</span><br><span class="line">    consumer_2.cancel()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># return_exceptions 设为True，不让异常throw到执行层，影响后续任务的执行</span></span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(consumer_1, consumer_2, producer_1, producer_2, return_exceptions=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.perf_counter()</span><br><span class="line"></span><br><span class="line">    asyncio.run(main())</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cost &#123;&#125; s&quot;</span>.<span class="built_in">format</span>(time.perf_counter() - start))</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/e6/944a0aa74ab8bab93396ab19c163c71f264ec1.gif" class="lazyload" data-srcset="https://img.vim-cn.com/e6/944a0aa74ab8bab93396ab19c163c71f264ec1.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 输出结果</span><br><span class="line">producer_1 put a val: 7</span><br><span class="line">producer_2 put a val: 4</span><br><span class="line">consumer_1 get a val : 7</span><br><span class="line">consumer_2 get a val : 4</span><br><span class="line">producer_1 put a val: 6</span><br><span class="line">producer_2 put a val: 1</span><br><span class="line">consumer_2 get a val : 6</span><br><span class="line">consumer_1 get a val : 1</span><br><span class="line">producer_1 put a val: 8</span><br><span class="line">producer_2 put a val: 1</span><br><span class="line">consumer_1 get a val : 8</span><br><span class="line">consumer_2 get a val : 1</span><br><span class="line">producer_1 put a val: 6</span><br><span class="line">producer_2 put a val: 4</span><br><span class="line">consumer_2 get a val : 6</span><br><span class="line">consumer_1 get a val : 4</span><br><span class="line">producer_1 put a val: 7</span><br><span class="line">producer_2 put a val: 8</span><br><span class="line">consumer_1 get a val : 7</span><br><span class="line">consumer_2 get a val : 8</span><br><span class="line">Cost 10.0093015 s</span><br></pre></td></tr></table></figure><p>拓展阅读：<a href="https://cloud.tencent.com/developer/article/1153746">Python的生产者消费者模型，看这篇就够了</a></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><p><a href="https://docs.python.org/3/library/asyncio.html#module-asyncio">https://docs.python.org/3/library/asyncio.html#module-asyncio</a></p></li><li><p><a href="https://www.dongwm.com/post/142/">深入理解asyncio（一）</a></p></li><li><p><a href="https://time.geekbang.org/column/article/101855">揭密Python协程</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 协程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>breaking一如既往的帅</title>
      <link href="2019/07/12/breaking%E4%B8%80%E5%A6%82%E6%97%A2%E5%BE%80%E7%9A%84%E5%B8%85/"/>
      <url>2019/07/12/breaking%E4%B8%80%E5%A6%82%E6%97%A2%E5%BE%80%E7%9A%84%E5%B8%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=57840142&cid=100946886&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div><p>** 看到了就爱上了，(๑•̀ㅂ•́)و✧Cloud的style move真的帅~~~（虽然很久没玩breaking了。。。。。(ノへ￣、)）**</p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Latex基本语法简记</title>
      <link href="2019/06/18/latex%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E7%AE%80%E8%AE%B0/"/>
      <url>2019/06/18/latex%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E7%AE%80%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>备注：当前博客使用的 latex 渲染引擎有点问题，本篇文章更好的阅读体验：<a href="https://blog.csdn.net/qq_41022329/article/details/92798759">https://blog.csdn.net/qq_41022329/article/details/92798759</a></p></blockquote><h1 id="公式插入方式"><a href="#公式插入方式" class="headerlink" title="公式插入方式"></a>公式插入方式</h1><ol><li>行内公式可用<code>\(...\)</code>或<code>$...$</code></li></ol><ul><li>例如<code>$ f(x)=x^2 $</code>,显示为$ f(x)=x^2 $</li></ul><ol start="2"><li>独立公式（单独另起一行,公式会居中），使用<code>$$...$$</code>或<code>\[...\]</code></li></ol><ul><li>例如：<code>$$ \int&#123;f(x)dx&#125; $$</code>或 <code>$$ \int_a^b&#123;f(x)dx&#125; $$</code>，显示为:</li></ul><p>$$ \int{f(x)dx} $$</p><p>$$ \int_a^b{f(x)dx} $$</p><span id="more"></span><h1 id="大括号的使用"><a href="#大括号的使用" class="headerlink" title="大括号的使用"></a>大括号的使用</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line">$$ f(x)=\left\&#123;</span><br><span class="line">\begin&#123;aligned&#125;</span><br><span class="line">x &amp; = &amp; \cos(t) \\</span><br><span class="line">y &amp; = &amp; \sin(t) \\</span><br><span class="line">z &amp; = &amp; \frac xy</span><br><span class="line">\end&#123;aligned&#125;</span><br><span class="line">\right.</span><br><span class="line">$$</span><br><span class="line">方法二：</span><br><span class="line">$$ F^&#123;HLLC&#125;=\left\&#123;</span><br><span class="line">\begin&#123;array&#125;&#123;rcl&#125;</span><br><span class="line">F_L       &amp;      &amp; &#123;0      &lt;      S_L&#125;\\</span><br><span class="line">F^*_L     &amp;      &amp; &#123;S_L \leq 0 &lt; S_M&#125;\\</span><br><span class="line">F^*_R     &amp;      &amp; &#123;S_M \leq 0 &lt; S_R&#125;\\</span><br><span class="line">F_R       &amp;      &amp; &#123;S_R \leq 0&#125;</span><br><span class="line">\end&#123;array&#125; \right. $$</span><br><span class="line">方法三:</span><br><span class="line">$$f(x)=</span><br><span class="line">\begin&#123;cases&#125;</span><br><span class="line">0&amp; \text&#123;x=0&#125;\\</span><br><span class="line">1&amp; \text&#123;x!=0&#125;</span><br><span class="line">\end&#123;cases&#125;$$</span><br></pre></td></tr></table></figure><p>方法一：</p><p>$$ f(x)=\left{<br>\begin{aligned}<br>x &amp; = &amp; \cos(t) \<br>y &amp; = &amp; \sin(t) \<br>z &amp; = &amp; \frac xy<br>\end{aligned}<br>\right.<br>$$</p><p>方法二：</p><p>$$ F^{HLLC}=\left{<br>\begin{array}{rcl}<br>F_L       &amp;      &amp; {0      &lt;      S_L}\<br>F^*_L     &amp;      &amp; {S_L \leq 0 &lt; S_M}\<br>F^*_R     &amp;      &amp; {S_M \leq 0 &lt; S_R}\<br>F_R       &amp;      &amp; {S_R \leq 0}<br>\end{array} \right. $$</p><p>方法三:</p><p>$$f(x)=<br>\begin{cases}<br>0&amp; \text{x=0}\<br>1&amp; \text{x!=0}<br>\end{cases}$$</p><h1 id="符号表"><a href="#符号表" class="headerlink" title="符号表"></a>符号表</h1><p>要输出字符　空格　#　$　%　&amp;　_　{　}　，用命令：<code>\空格　#　\$　\%　\&amp;　_　&#123;　&#125;</code></p><h2 id="运算符表"><a href="#运算符表" class="headerlink" title="运算符表"></a>运算符表</h2><h3 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\pm</td><td align="center">$\pm$</td><td align="center">\times</td><td align="center">$\times$</td></tr><tr><td align="center">\div</td><td align="center">$\div$</td><td align="center">\mid</td><td align="center">$\mid$</td></tr><tr><td align="center">\nmid</td><td align="center">$\nmid$</td><td align="center">\cdot</td><td align="center">$\cdot$</td></tr><tr><td align="center">\circ</td><td align="center">$\circ$</td><td align="center">\ast</td><td align="center">$\ast$</td></tr><tr><td align="center">\bigodot</td><td align="center">$\bigodot$</td><td align="center">\bigotimes</td><td align="center">$\bigotimes$</td></tr><tr><td align="center">\bigoplus</td><td align="center">$\bigoplus$</td><td align="center">\leq</td><td align="center">$\leq$</td></tr><tr><td align="center">\geq</td><td align="center">$\geq$</td><td align="center">\neq</td><td align="center">$\neq$</td></tr><tr><td align="center">\approx</td><td align="center">$\approx$</td><td align="center">\equiv</td><td align="center">$\equiv$</td></tr><tr><td align="center">\sum</td><td align="center">$\sum$</td><td align="center">\prod</td><td align="center">$\prod$</td></tr></tbody></table><h3 id="集合运算符"><a href="#集合运算符" class="headerlink" title="集合运算符"></a>集合运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\emptyset</td><td align="center">$\emptyset$</td><td align="center">\in</td><td align="center">$\in$</td></tr><tr><td align="center">\notin</td><td align="center">$\notin$</td><td align="center">\subset</td><td align="center">$\subset$</td></tr><tr><td align="center">\supset</td><td align="center">$\supset$</td><td align="center">\subseteq</td><td align="center">$\subseteq$</td></tr><tr><td align="center">\supseteq</td><td align="center">$\supseteq$</td><td align="center">\bigcap</td><td align="center">$\bigcap$</td></tr><tr><td align="center">\bigcup</td><td align="center">$\bigcup$</td><td align="center">\bigvee</td><td align="center">$\bigvee$</td></tr><tr><td align="center">\bigwedge</td><td align="center">$\bigwedge$</td><td align="center">\biguplus</td><td align="center">$\biguplus$</td></tr><tr><td align="center">\bigsqcup</td><td align="center">$\bigsqcup$</td><td align="center">&ensp;</td><td align="center">&ensp;</td></tr></tbody></table><h3 id="对数运算符"><a href="#对数运算符" class="headerlink" title="对数运算符"></a>对数运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\log</td><td align="center">$\log$</td><td align="center">\lg</td><td align="center">$\lg$</td><td align="center">\ln</td><td align="center">$\ln$</td></tr></tbody></table><h3 id="三角运算符"><a href="#三角运算符" class="headerlink" title="三角运算符"></a>三角运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\bot</td><td align="center">$\bot$</td><td align="center">\angle</td><td align="center">$\angle$</td><td align="center">30^\circ</td><td align="center">$30^\circ$</td></tr><tr><td align="center">\sin</td><td align="center">$\sin$</td><td align="center">\cos</td><td align="center">$\cos$</td><td align="center">\tan</td><td align="center">$\tan$</td></tr><tr><td align="center">\cot</td><td align="center">$\cot$</td><td align="center">\sec</td><td align="center">$\sec$</td><td align="center">\csc</td><td align="center">$\csc$</td></tr></tbody></table><h3 id="微积分运算符"><a href="#微积分运算符" class="headerlink" title="微积分运算符"></a>微积分运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\prime</td><td align="center">$\prime$</td><td align="center">\int</td><td align="center">$\int$</td><td align="center">\iint</td><td align="center">$\iint$</td></tr><tr><td align="center">\iiint</td><td align="center">$\iiint$</td><td align="center">\oint</td><td align="center">$\oint$</td><td align="center">\lim</td><td align="center">$\lim$</td></tr><tr><td align="center">\infty</td><td align="center">$\infty$</td><td align="center">\nabla</td><td align="center">$\nabla$</td><td align="center">&ensp;</td><td align="center">&ensp;</td></tr></tbody></table><h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\because</td><td align="center">$\because$</td><td align="center">\therefore</td><td align="center">$\therefore$</td><td align="center">\forall</td><td align="center">$\forall$</td></tr><tr><td align="center">\exists</td><td align="center">$\exists$</td><td align="center">\not=</td><td align="center">$\not=$</td><td align="center">\not&gt;</td><td align="center">$\not&gt;$</td></tr><tr><td align="center">\not&lt;</td><td align="center">$\not&lt;$</td><td align="center">\not\subset</td><td align="center">$\not\subset$</td><td align="center">&ensp;</td><td align="center">&ensp;</td></tr></tbody></table><h2 id="其它符号"><a href="#其它符号" class="headerlink" title="其它符号"></a>其它符号</h2><h3 id="戴帽和连线符号"><a href="#戴帽和连线符号" class="headerlink" title="戴帽和连线符号"></a>戴帽和连线符号</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\hat{y}</td><td align="center">$\hat{y}$</td><td align="center">\check{y}</td><td align="center">$\check{y}$</td><td align="center">\breve</td><td align="center">$\breve{y}$</td></tr><tr><td align="center">\overline{a+b+c+d}</td><td align="center">$\overline{a+b+c+d}$</td><td align="center">\underline{a+b+c+d}</td><td align="center">$\underline{a+b+c+d}$</td><td align="center">\overbrace{a+\underbrace{b+c}_{1.0}+d}^{2.0}</td><td align="center">$\overbrace{a+\underbrace{b+c}_{1.0}+d}^{2.0}$</td></tr></tbody></table><h3 id="箭头符号"><a href="#箭头符号" class="headerlink" title="箭头符号"></a>箭头符号</h3><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\uparrow</td><td align="center">$\uparrow$</td><td align="center">\downarrow</td><td align="center">$\downarrow$</td><td align="center">\Uparrow</td><td align="center">$\Uparrow$</td></tr><tr><td align="center">\Downarrow</td><td align="center">$\Downarrow$</td><td align="center">\rightarrow</td><td align="center">$\rightarrow$</td><td align="center">\leftarrow</td><td align="center">$\leftarrow$</td></tr><tr><td align="center">\Rightarrow</td><td align="center">$\Rightarrow$</td><td align="center">\Leftarrow</td><td align="center">$\Leftarrow$</td><td align="center">\longrightarrow</td><td align="center">$\longrightarrow$</td></tr><tr><td align="center">\Longrightarrow</td><td align="center">$\Longrightarrow$</td><td align="center">\longleftarrow</td><td align="center">$\longleftarrow$</td><td align="center">\Longleftarrow</td><td align="center">$\Longleftarrow$</td></tr></tbody></table><h1 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h1><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><ul><li>起始标记<code>\begin&#123;matrix&#125;</code>,结束标记<code>\end&#123;matrix&#125;</code></li><li>每一行末标记<code>\\</code>进行换行，行间元素以<code>&amp;</code>分隔用于对齐。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$\begin&#123;matrix&#125;</span><br><span class="line">1&amp;0&amp;0\\</span><br><span class="line">0&amp;1&amp;0\\</span><br><span class="line">0&amp;0&amp;1\\</span><br><span class="line">\end&#123;matrix&#125;$$</span><br></pre></td></tr></table></figure><p>$$\begin{matrix}<br>1&amp;0&amp;0\<br>0&amp;1&amp;0\<br>0&amp;0&amp;1\<br>\end{matrix}$$</p><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><ul><li>可用下列词替换<code>matrix</code>设置矩阵边框<ul><li>pmatrix、bmatrix、Bmatrix：小括号、中括号、大括号边框</li><li>vmatrix、Vmatrix：单竖线、双竖线边框</li></ul></li><li>省略元素<ul><li>横省略号：<code>\cdots</code></li><li>竖省略号：<code>\vdots</code></li><li>斜省略号：<code>\ddots</code></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$$\begin&#123;Bmatrix&#125;</span><br><span class="line">&#123;a_&#123;11&#125;&#125;&amp;&#123;a_&#123;12&#125;&#125;&amp;&#123;\cdots&#125;&amp;&#123;a_&#123;1n&#125;&#125;\\</span><br><span class="line">&#123;a_&#123;21&#125;&#125;&amp;&#123;a_&#123;22&#125;&#125;&amp;&#123;\cdots&#125;&amp;&#123;a_&#123;2n&#125;&#125;\\</span><br><span class="line">&#123;\vdots&#125;&amp;&#123;\vdots&#125;&amp;&#123;\ddots&#125;&amp;&#123;\vdots&#125;\\</span><br><span class="line">&#123;a_&#123;m1&#125;&#125;&amp;&#123;a_&#123;m2&#125;&#125;&amp;&#123;\cdots&#125;&amp;&#123;a_&#123;mn&#125;&#125;\\</span><br><span class="line">\end&#123;Bmatrix&#125;$$</span><br></pre></td></tr></table></figure><p>$$\begin{Bmatrix}<br>{a_{11}}&amp;{a_{12}}&amp;{\cdots}&amp;{a_{1n}}\<br>{a_{21}}&amp;{a_{22}}&amp;{\cdots}&amp;{a_{2n}}\<br>{\vdots}&amp;{\vdots}&amp;{\ddots}&amp;{\vdots}\<br>{a_{m1}}&amp;{a_{m2}}&amp;{\cdots}&amp;{a_{mn}}\<br>\end{Bmatrix}$$</p><h1 id="希腊字母表"><a href="#希腊字母表" class="headerlink" title="希腊字母表"></a>希腊字母表</h1><table><thead><tr><th align="center">命令</th><th align="center">显示</th><th align="center">命令</th><th align="center">显示</th></tr></thead><tbody><tr><td align="center">\alpha</td><td align="center">$\alpha$</td><td align="center">\beta</td><td align="center">$\beta$</td></tr><tr><td align="center">\gamma</td><td align="center">$\gamma$</td><td align="center">\delta</td><td align="center">$\delta$</td></tr><tr><td align="center">\epsilon</td><td align="center">$\epsilon$</td><td align="center">\zeta</td><td align="center">$\zeta$</td></tr><tr><td align="center">\eta</td><td align="center">$\eta$</td><td align="center">\theta</td><td align="center">$\theta$</td></tr><tr><td align="center">\iota</td><td align="center">$\iota$</td><td align="center">\kappa</td><td align="center">$\kappa$</td></tr><tr><td align="center">\lambda</td><td align="center">$\lambda$</td><td align="center">\mu</td><td align="center">$\mu$</td></tr><tr><td align="center">\nu</td><td align="center">$\nu$</td><td align="center">\xi</td><td align="center">$\xi$</td></tr><tr><td align="center">\pi</td><td align="center">$\pi$</td><td align="center">\rho</td><td align="center">$\rho$</td></tr><tr><td align="center">\sigma</td><td align="center">$\sigma$</td><td align="center">\tau</td><td align="center">$\tau$</td></tr><tr><td align="center">\upsilon</td><td align="center">$\upsilon$</td><td align="center">\phi</td><td align="center">$\phi$</td></tr><tr><td align="center">\chi</td><td align="center">$\chi$</td><td align="center">\psi</td><td align="center">$\psi$</td></tr><tr><td align="center">\omega</td><td align="center">$\omega$</td><td align="center">&ensp;</td><td align="center">&ensp;</td></tr></tbody></table><ul><li>如果需要大写的希腊字母，将命令首字母大写即可<ul><li>例如：<code>\Gamma</code>,显示$ \Gamma $</li></ul></li><li>如果要将字母斜体显示，使用<code>\var</code>前缀即可<ul><li>例如：<code>\varGamma</code>，显示$ \varGamma $</li></ul></li></ul><h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><ul><li>分组：<ul><li>使用<code>&#123;&#125;</code>将具有相同等级的内容扩入其中，成组处理。</li><li>比如：<code>\10^10</code>呈现为$10^10$，<code>10^&#123;10&#125;</code>呈现为$10^{10}$。</li></ul></li><li>空格：<ul><li>单个空格：<code>a\ b</code>，$a\ b$</li><li>四个空格：<code>a\quad b</code>,$a\quad b$</li></ul></li><li>上标<code>^</code>，下标<code>_</code></li><li>尖括号<code>\langle\rangle</code>：$\langle\rangle$</li><li>使用<code>\left</code>或<code>\right</code>使符号大小与临近的公式符号相适应，对比如下：<ul><li><code>(\frac&#123;x&#125;&#123;y&#125;)</code>：$(\frac{x}{y})$</li><li><code>\left(\frac&#123;x&#125;&#123;y&#125;\right)</code>：$\left(\frac{x}{y}\right)$</li></ul></li><li>分式：<ul><li><code>\frac&#123;1&#125;&#123;3&#125;</code>：$\frac{1}{3}$</li><li><code>1 \over 3</code>：$1 \over 3$</li></ul></li><li>开根<code>\sqrt[n]&#123;3&#125;</code>：$\sqrt[n]{3}$</li><li>省略号：<ul><li><code>\ldots</code>：与文本底线对齐的省略号</li><li><code>\cdots</code>：与文本中线对齐的省略号</li><li><code>$f(x_1,x_2,\ldots,x_n) = x_1^2 + x_2^2 + \cdots + x_n^2$</code>：$f(x_1,x_2,\ldots,x_n) = x_1^2 + x_2^2 + \cdots + x_n^2$</li></ul></li></ul><h2 id="综合运用示范"><a href="#综合运用示范" class="headerlink" title="综合运用示范"></a>综合运用示范</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% 极限运算</span><br><span class="line">$$\lim\limits_&#123;n \rightarrow +\infty&#125; \frac&#123;1&#125;&#123;n(n+1)&#125;$$</span><br><span class="line">$$\lim_&#123;n \rightarrow +\infty&#125; \frac&#123;1&#125;&#123;n(n+1)&#125;$$</span><br></pre></td></tr></table></figure><p>$$\lim\limits_{n \rightarrow +\infty} \frac{1}{n(n+1)}$$</p><p>$$\lim_{n \rightarrow +\infty} \frac{1}{n(n+1)}$$</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$$ \left[J_\alpha(x) = \sum_&#123;m=0&#125;^\infty \frac&#123;(-1)^m&#125;&#123;m! \Gamma (m + \alpha + 1)&#125; &#123;\left(&#123; \frac&#123;x&#125;&#123;2&#125; &#125;\right)&#125;^&#123;2m + \alpha&#125;\right] $$</span><br></pre></td></tr></table></figure><p>$$ \left[J_\alpha(x) = \sum_{m=0}^\infty \frac{(-1)^m}{m! \Gamma (m + \alpha + 1)} {\left({ \frac{x}{2} }\right)}^{2m + \alpha}\right] $$</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://www.zybuluo.com/knight/note/96093">MathJax使用LaTeX语法编写数学公式教程</a></li><li><a href="https://qianwenma.cn/2018/05/17/mathjax-yu-fa-can-kao/#">MathJax 语法参考</a></li><li><a href="https://blog.csdn.net/ethmery/article/details/50670297">基本数学公式语法(of MathJax)</a></li><li><a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference">MathJax basic tutorial and quick reference</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Latex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MATLAB基操复习</title>
      <link href="2019/06/17/MATLAB%E5%9F%BA%E6%93%8D%E5%A4%8D%E4%B9%A0/"/>
      <url>2019/06/17/MATLAB%E5%9F%BA%E6%93%8D%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="MATLAB基本操作"><a href="#MATLAB基本操作" class="headerlink" title="MATLAB基本操作"></a>MATLAB基本操作</h1><p><strong>1. 对象定义</strong><br>使用sym定义单个对象、使用syms定义多个对象</p><p><strong>2. 使用<code>limit</code>求极限</strong></p><p>$$ \lim_{v \rightarrow a} f(x) $$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit(f,v,a) <span class="comment">% 使用limit(f,v,a,&#x27;left&#x27;)可求左极限</span></span><br></pre></td></tr></table></figure><p><strong>3. 导数</strong><br>使用<code>diff(f,v,n)</code>对$ f(v)=v^{t-1} $求 $ n $ 阶导 $ \frac{d^nf}{d^nv} $，n缺省时，默认为1，diff(f)默认求一阶导数。</p><p><strong>4. 定积分和不定积分</strong><br>使用<code>int(f,v)</code>求f对变量v的不定积分，使用<code>int(f,v,a,b)</code>求f对变量v的定积分,a、b为积分上下标。$ \int{f(v)dv} $、$ \int^{a}_{b}{f(v)dv} $。</p><span id="more"></span><p><strong>5. matlab函数文件定义形式</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[输出形参列表]</span> = 函数名（输入形参列表）</span></span><br><span class="line">    函数体</span><br></pre></td></tr></table></figure><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spir_len</span> = <span class="title">spirallength</span><span class="params">(d, n, lcolor)</span></span></span><br><span class="line"><span class="comment">% SPIRALLENGTH plot a circle of radius as r in the provided color and calculate its area</span></span><br><span class="line"><span class="comment">% 输入参数：</span></span><br><span class="line"><span class="comment">%   d: 螺旋的旋距</span></span><br><span class="line"><span class="comment">%   n: 螺旋的圈数</span></span><br><span class="line"><span class="comment">%   lcolor：画图线的颜色</span></span><br><span class="line"><span class="comment">% 输出参数：</span></span><br><span class="line"><span class="comment">%   spir_len：螺旋的周长</span></span><br><span class="line"><span class="comment">% 调用说明：</span></span><br><span class="line"><span class="comment">%   spirallength(d,n):以参数d,n画螺旋线，螺旋线默认为蓝色</span></span><br><span class="line"><span class="comment">%   spirallength(d,n,lcolor):以参数d,n,lcolor画螺旋线</span></span><br><span class="line"><span class="comment">%   spir_len = spirallength(d,n):计算螺旋线的周长，并以蓝色填充螺旋线</span></span><br><span class="line"><span class="comment">%   spir_len = spirallength(d,n,lcolor):计算螺旋线的周长，并以lcolor颜色填充螺旋线</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 版本号V1.0，编写于1999年9月9号，修改于1999年9月10号，作者：亚索</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> nargin &gt; <span class="number">3</span></span><br><span class="line">    error(<span class="string">&#x27;输入变量过多！&#x27;</span>);</span><br><span class="line"><span class="keyword">elseif</span> nargin == <span class="number">2</span></span><br><span class="line">    lcolor = <span class="string">&#x27;b&#x27;</span>; <span class="comment">% 默认情况下为蓝色</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">j</span> = <span class="built_in">sqrt</span>(<span class="number">-1</span>);</span><br><span class="line">phi = <span class="number">0</span> : <span class="built_in">pi</span>/<span class="number">1000</span> : n*<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">amp = <span class="number">0</span> : d/<span class="number">2000</span> : n*d;</span><br><span class="line">spir = amp .* <span class="built_in">exp</span>(<span class="built_in">j</span>*phi);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> nargout == <span class="number">1</span></span><br><span class="line">    spir_len = sum(<span class="built_in">abs</span>(diff(spir)));</span><br><span class="line">    fill(<span class="built_in">real</span>(spir), <span class="built_in">imag</span>(spir), lcolor);</span><br><span class="line"><span class="keyword">elseif</span> nargout == <span class="number">0</span></span><br><span class="line">    <span class="built_in">plot</span>(spir, lcolor);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    error(<span class="string">&#x27;输出变量过多！&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">axis(<span class="string">&#x27;square&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>6. matlab程序设计语句</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% for循环</span></span><br><span class="line"><span class="keyword">for</span> 循环变量=初值:步长:终值</span><br><span class="line">    循环体</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% while循环</span></span><br><span class="line"><span class="keyword">while</span> 条件</span><br><span class="line">    循环体</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% if语句</span></span><br><span class="line"><span class="keyword">if</span> 条件</span><br><span class="line">    语句组<span class="number">1</span></span><br><span class="line"><span class="keyword">elseif</span></span><br><span class="line">    语句组<span class="number">2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    语句组<span class="number">3</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% switch语句</span></span><br><span class="line"><span class="keyword">switch</span> 表达式</span><br><span class="line">   <span class="keyword">case</span>  表达式<span class="number">1</span></span><br><span class="line">         语句组<span class="number">1</span></span><br><span class="line">   <span class="keyword">case</span>  表达式<span class="number">2</span></span><br><span class="line">         语句组<span class="number">2</span></span><br><span class="line">      ... ...</span><br><span class="line">   <span class="keyword">case</span>   表达式m</span><br><span class="line">          语句组m</span><br><span class="line">   <span class="keyword">otherwise</span></span><br><span class="line">          语句组</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% try语句</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">   语句组<span class="number">1</span>                <span class="comment">%语句组1若正确则跳出该结构</span></span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">   语句组<span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p><strong>7. 矩阵操作</strong></p><table><thead><tr><th align="center">操作</th><th align="left">作用</th></tr></thead><tbody><tr><td align="center">size(A)</td><td align="left">求矩阵A的行数和列数</td></tr><tr><td align="center">length(x)</td><td align="left">返回向量x的长度</td></tr><tr><td align="center">A’</td><td align="left">A的转置</td></tr><tr><td align="center">A(:,n)</td><td align="left">取矩阵A第n列数，A(n,:)取第n行</td></tr><tr><td align="center">det(A)</td><td align="left">求矩阵A的行列式</td></tr><tr><td align="center">inv(A)</td><td align="left">求A的逆</td></tr><tr><td align="center">rank(A)</td><td align="left">求A的秩</td></tr><tr><td align="center">trace(A)</td><td align="left">求A的迹</td></tr><tr><td align="center">max(A)、min(A)</td><td align="left">求A的各列最大、最小元素</td></tr><tr><td align="center">mean(A)</td><td align="left">求A各列的平均值</td></tr><tr><td align="center">sum(A)</td><td align="left">求A各列元素之和</td></tr></tbody></table><p><strong>8. matlab简单绘图</strong></p><p>&ensp;plot函数是MATLAB中最核心的二维绘图函数，有诸多语法格式，可实现多种功能。常用格式有：</p><ul><li>plot(x)：缺省自变量的绘图格式，x可为向量或矩阵。</li><li>plot(x, y)：基本格式，x和y可为向量或矩阵。</li><li>plot(x1, y1, x2, y2,…)：多条曲线绘图格式，在同一坐标系中绘制多个图形。</li><li>plot(x, y,‘s’)：开关格式，开关量字符串s设定了图形曲线的颜色、线型及标示符号（见下表）。</li></ul><p><img src="https://s2.ax1x.com/2019/06/17/VbQVgI.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/06/17/VbQVgI.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VbQVgI.png"></p><h1 id="无约束优化问题求解"><a href="#无约束优化问题求解" class="headerlink" title="无约束优化问题求解"></a>无约束优化问题求解</h1><h2 id="fminbnd、fminunc函数输出变量解释"><a href="#fminbnd、fminunc函数输出变量解释" class="headerlink" title="fminbnd、fminunc函数输出变量解释"></a>fminbnd、fminunc函数输出变量解释</h2><table><thead><tr><th align="center">变量</th><th align="left">描述</th></tr></thead><tbody><tr><td align="center">x</td><td align="left">由优化函数求得的值. 若exitflag&gt;0,则x为解; 否则,x不是最终解, 它只是迭代制止时优化过程的值</td></tr><tr><td align="center">fval</td><td align="left">解 x 处的目标函数值</td></tr><tr><td align="center">exitflag</td><td align="left">描述退出条件:exitflag&gt;0,表目标函数收敛于解x处；exitflag=0,表已达到函数评价或迭代的最大次数；exitflag&lt;0,表目标函数不收敛</td></tr><tr><td align="center">output</td><td align="left">包含优化结果信息的输出结构。Iterations:迭代次数；Algorithm:所采用的算法；FuncCount:函数评价次数</td></tr></tbody></table><h2 id="一元函数无约束优化问题-fminbnd"><a href="#一元函数无约束优化问题-fminbnd" class="headerlink" title="一元函数无约束优化问题-fminbnd"></a>一元函数无约束优化问题-fminbnd</h2><h3 id="常用格式"><a href="#常用格式" class="headerlink" title="常用格式"></a>常用格式</h3><p>$$ min f(x)， x_1&lt;x&lt;x_2 $$</p><p>（1）x= fminbnd (fun, x1, x2)<br>（2）x= fminbnd (fun, x1, x2 , options)<br>（3）[x , fval]= fminbnd（…）<br>（4）[x , fval , exitflag]= fminbnd（…）<br>（5）[x , fval , exitflag , output]= fminbnd（…）<br>函数fminbnd的算法基于黄金分割法和二次插值法，它要求目标函数必须是连续函数，并可能只给出局部最优解</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>求函数 $ f(x)=2e^{-x}sin(x) $ 在 $ 0&lt;x&lt;8 $ 时的最小值</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 如果求最大需要对f取反</span></span><br><span class="line">f = @(x) (<span class="number">2</span>*<span class="built_in">exp</span>(-x)*<span class="built_in">sin</span>(x));</span><br><span class="line">[x,fval] = fminbnd(f,<span class="number">0</span>,<span class="number">8</span>);</span><br><span class="line">x</span><br><span class="line">fval</span><br></pre></td></tr></table></figure><h2 id="多元函数无约束优化问题-fminunc"><a href="#多元函数无约束优化问题-fminunc" class="headerlink" title="多元函数无约束优化问题-fminunc"></a>多元函数无约束优化问题-fminunc</h2><h3 id="常用格式-1"><a href="#常用格式-1" class="headerlink" title="常用格式"></a>常用格式</h3><p>$$ min f(X)，这里X为n维变量 $$<br>fminunc常用格式为:<br>   （1）x= fminunc（fun, X0）；<br>   （2）x= fminunc（fun, X0，options）；<br>   （3）[x，fval]= fminunc（…）；<br>   （4）[x，fval，exitflag]= fminunc（…）；<br>   （5）[x，fval，exitflag，output]= fminunc（…）<br>其中 X0为初始值</p><h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><p>求函数$ f(x_1,x_2)=(4x_1^2+2x_2^2+4x_1x_2+2x_2^2+1)e^x $的最小值,$ X_0=[-1,1] $</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = @(x) (<span class="number">4</span>*x(<span class="number">1</span>)^<span class="number">2</span>+<span class="number">2</span>*x(<span class="number">2</span>)^<span class="number">2</span>+<span class="number">4</span>*x(<span class="number">1</span>)*x(<span class="number">2</span>)+<span class="number">2</span>*x(<span class="number">2</span>)+<span class="number">1</span>)*<span class="built_in">exp</span>(x(<span class="number">1</span>));</span><br><span class="line">x0 = [<span class="number">-1</span>,<span class="number">1</span>];</span><br><span class="line">[x,fval] = fminunc(f, x0);</span><br><span class="line">x</span><br><span class="line">fval</span><br></pre></td></tr></table></figure><h1 id="线性规划问题求解"><a href="#线性规划问题求解" class="headerlink" title="线性规划问题求解"></a>线性规划问题求解</h1><h2 id="使用linprog求解一般线性规划问题"><a href="#使用linprog求解一般线性规划问题" class="headerlink" title="使用linprog求解一般线性规划问题"></a>使用linprog求解一般线性规划问题</h2><p>常见问题（linprog默认求最小值）<br>$$ minz=cX $$</p><p>$$ s.t. \begin{cases}<br>AX\leq{b}\<br>Aeq\cdot{X}=beq\<br>VLB\leq{X}\leq{VUB}<br>\end{cases}$$</p><p>求解命令</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x,fval] = linprog(c,A,b,Aeq,beq,VLB,VUB)</span><br></pre></td></tr></table></figure><h2 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h2><p>$$ min z=13x_1+9x_2+10x_3+11x_4+12x_5+8x_6 $$</p><p>$$ s.t.\left{<br>\begin{aligned}<br>&amp; x_1+x_2=400\<br>&amp; x_2+x_5=600\<br>&amp; x_3+x_6=500\<br>&amp; 0.4x_1+1.1x_2+x_3\leq{800}\<br>&amp; 0.5x_4+1.2x_5+1.3x_6\leq{900}\<br>&amp; x_i\geq0,i=1,2,…,6<br>\end{aligned}<br>\right.<br>$$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">f = [<span class="number">13</span> <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">8</span>];</span><br><span class="line">A =  [<span class="number">0.4</span> <span class="number">1.1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">      <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0.5</span> <span class="number">1.2</span> <span class="number">1.3</span>];</span><br><span class="line">b = [<span class="number">800</span>; <span class="number">900</span>];</span><br><span class="line">Aeq=[<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">     <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line">     <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>];</span><br><span class="line">beq=[<span class="number">400</span> <span class="number">600</span> <span class="number">500</span>];</span><br><span class="line">vlb = <span class="built_in">zeros</span>(<span class="number">6</span>,<span class="number">1</span>);</span><br><span class="line">vub=[];</span><br><span class="line">[x,fval] = linprog(f,A,b,Aeq,beq,vlb,vub)</span><br></pre></td></tr></table></figure><h2 id="使用bintprog求解0-1规划问题"><a href="#使用bintprog求解0-1规划问题" class="headerlink" title="使用bintprog求解0-1规划问题"></a>使用bintprog求解0-1规划问题</h2><p><strong>matlab2014以上版本使用<code>intlinprog</code>求解0-1规划问题</strong></p><p>$$ minz=cX $$</p><p>$$ s.t. \begin{cases}<br>AX\leq{b}\<br>Aeq\cdot{X}=beq\<br>X为0-1变量<br>\end{cases}$$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 命令</span></span><br><span class="line">[x,fval] = bintprog(c,A,b,Aeq,beq)</span><br></pre></td></tr></table></figure><h3 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h3><p>$$ min z=3x_1+7x_2-x_3+x_4 $$<br>$$ s.t.<br>\begin{cases}<br>2x_1-x_2+x_3-x_4\geq{1}\<br>x_1-x_2+6x_3+4x_4\geq{8}\<br>5x_1+3x_2+x_4\geq{5}\<br>x_i=0或1（i=1,2,3,4）<br>\end{cases}<br>$$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">z = [<span class="number">3</span>;<span class="number">7</span>;<span class="number">-1</span>;<span class="number">1</span>];</span><br><span class="line">A = [<span class="number">-2</span> <span class="number">1</span> <span class="number">-1</span> <span class="number">1</span>;</span><br><span class="line">     <span class="number">-1</span> <span class="number">1</span> <span class="number">-6</span> <span class="number">-4</span>;</span><br><span class="line">     <span class="number">-5</span> <span class="number">-3</span> <span class="number">0</span> <span class="number">-1</span>];</span><br><span class="line">b = [<span class="number">-1</span>;<span class="number">-8</span>;<span class="number">-5</span>];</span><br><span class="line">Aeq = [];</span><br><span class="line">beq = [];</span><br><span class="line"></span><br><span class="line">[x,fval] = bintprog(z,A,b,Aeq,beq)</span><br></pre></td></tr></table></figure><h1 id="数据插值与拟合"><a href="#数据插值与拟合" class="headerlink" title="数据插值与拟合"></a>数据插值与拟合</h1><h2 id="数据插值，使用interpl进行一维插值"><a href="#数据插值，使用interpl进行一维插值" class="headerlink" title="数据插值，使用interpl进行一维插值"></a>数据插值，使用interpl进行一维插值</h2><p>matlab命令</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yi = interpl(X,Y,xi,method)</span><br></pre></td></tr></table></figure><p>该命令用指定的算法找出一个一元函数，然后以该函数给出xi处的值。其中x=[x1,x2,…,xn]’和 y=[y1,y2,…,yn]’两个向量分别为给定的一组自变量和函数值，用来表示已知样本点数据；<strong>xi为待求插值点处横坐标，可以是一个标量，也可以是一个向量</strong>，是向量时，必须单调；yi得到返回的对应纵坐标。</p><ul><li>method可以选取以下方法之一：<ul><li>‘nearest’：最近邻点插值，直接完成计算；</li><li>‘spline’：三次样条函数插值；</li><li>‘linear’：线性插值（缺省方式），直接完成计算；</li><li>‘cubic’：三次函数插值；</li></ul></li></ul><h3 id="例子-4"><a href="#例子-4" class="headerlink" title="例子"></a>例子</h3><p>作函数$ y=(x^2-3x+7)e^{-4x}sin(2x) $在[0,1]取间隔为0.1的点图，用插值进行实验</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>;</span><br><span class="line">y=(x.^<span class="number">2</span><span class="number">-3</span>*x+<span class="number">7</span>).*<span class="built_in">exp</span>(<span class="number">-4</span>*x).*<span class="built_in">sin</span>(<span class="number">2</span>*x);  <span class="comment">%产生原始数据</span></span><br><span class="line"></span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">plot</span>(x,y,x,y,<span class="string">&#x27;ro&#x27;</span>)    <span class="comment">%作图</span></span><br><span class="line">xx=<span class="number">0</span>:<span class="number">0.02</span>:<span class="number">1</span>;  <span class="comment">%待求插值点</span></span><br><span class="line">yy=interp1(x,y,xx,<span class="string">&#x27;spline&#x27;</span>);   <span class="comment">%此处可用nearest,cubic,spline分别试验</span></span><br><span class="line"></span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&#x27;ro&#x27;</span>,xx,yy,<span class="string">&#x27;b&#x27;</span>)    <span class="comment">%作图</span></span><br></pre></td></tr></table></figure><h2 id="曲线拟合"><a href="#曲线拟合" class="headerlink" title="曲线拟合"></a>曲线拟合</h2><h3 id="拟合函数polyfit"><a href="#拟合函数polyfit" class="headerlink" title="拟合函数polyfit"></a>拟合函数polyfit</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p=polyfit(x,y,n)</span><br><span class="line">[p,s]= polyfit(x,y,n)</span><br></pre></td></tr></table></figure><p>说明：x,y为数据点，n为多项式阶数，返回p为幂次从高到低的多项式系数向量p。p是n+1维参数向量p(1)，p(2)….那么拟合后对应的多项式即为：<br>$$ p(1)x^n+p(2)x^{n-1}+\cdot\cdot\cdot+p(n)x+p(n+1) $$</p><p>x必须是单调的。矩阵s用于生成预测值的误差估计</p><h3 id="多项式求值函数polyval"><a href="#多项式求值函数polyval" class="headerlink" title="多项式求值函数polyval"></a>多项式求值函数polyval</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y=polyval(p,x)</span><br><span class="line">[y,DELTA]=polyval(p,x,s)</span><br></pre></td></tr></table></figure><p>说明：y=polyval(p,x)为返回对应自变量x在给定系数p的多项式的值；<br>[y,DELTA]=polyval(p,x,s) 使用polyfit函数的选项输出s得出误差估计DELTA。它假设polyfit函数数据输入的误差是独立正态的，并且方差为常数。则DELTA将至少包含50%的预测值。</p><h3 id="例子-5"><a href="#例子-5" class="headerlink" title="例子"></a>例子</h3><p>求如下给定数据的拟合曲线<br>x=[0.5,1.0,1.5,2.0,2.5,3.0]，y=[1.75,2.45,3.81,4.80,7.00,8.60]</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x=[<span class="number">0.5</span>,<span class="number">1.0</span>,<span class="number">1.5</span>,<span class="number">2.0</span>,<span class="number">2.5</span>,<span class="number">3.0</span>];</span><br><span class="line">y=[<span class="number">1.75</span>,<span class="number">2.45</span>,<span class="number">3.81</span>,<span class="number">4.80</span>,<span class="number">7.00</span>,<span class="number">8.60</span>];</span><br><span class="line"><span class="built_in">plot</span>(x,y,‘*r’)  <span class="comment">%先观察数据点的大致形态</span></span><br><span class="line">p=polyfit(x,y,<span class="number">2</span>)  <span class="comment">%用二次多项式拟合</span></span><br><span class="line">x1=<span class="number">0.5</span>:<span class="number">0.05</span>:<span class="number">3.0</span>; <span class="comment">% 步长0.05</span></span><br><span class="line">y1=polyval(p,x1);</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">&#x27;*r&#x27;</span>,x1,y1,<span class="string">&#x27;-b&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MATLAB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搜索技巧</title>
      <link href="2019/06/08/%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"/>
      <url>2019/06/08/%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://img.vim-cn.com/53/05dc36e9f6a84026c3eeba794c9e7c473f57be.png" class="lazyload" data-srcset="https://img.vim-cn.com/53/05dc36e9f6a84026c3eeba794c9e7c473f57be.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/53/05dc36e9f6a84026c3eeba794c9e7c473f57be.png"></p><blockquote><p>搜索也是门学问啊，GFW之下，世道艰难。 (ノ~、)</p></blockquote><span id="more"></span><h1 id="百度高级搜索技巧"><a href="#百度高级搜索技巧" class="headerlink" title="百度高级搜索技巧"></a>百度高级搜索技巧</h1><h1 id="双引号精确匹配"><a href="#双引号精确匹配" class="headerlink" title="双引号精确匹配"></a>双引号精确匹配</h1><ul><li>格式：”搜索词”</li></ul><p><strong>在查询词两边加上双引号表示查询词不能被拆分。</strong></p><p><img src="https://img.vim-cn.com/bc/6db6bd53348e5e857d7c8880d4b271f6ac7255.png" class="lazyload" data-srcset="https://img.vim-cn.com/bc/6db6bd53348e5e857d7c8880d4b271f6ac7255.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/bc/6db6bd53348e5e857d7c8880d4b271f6ac7255.png"></p><h1 id="减号（-）不含特定查询"><a href="#减号（-）不含特定查询" class="headerlink" title="减号（-）不含特定查询"></a>减号（-）不含特定查询</h1><ul><li>格式：搜索词 -排除词</li></ul><p>** 减号后面紧跟的是需要排除的词，前面为要搜索的词（有个空格隔开） **</p><p><img src="https://img.vim-cn.com/03/4cef7028150512ceecbb155020f89af18eba86.png" class="lazyload" data-srcset="https://img.vim-cn.com/03/4cef7028150512ceecbb155020f89af18eba86.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/03/4cef7028150512ceecbb155020f89af18eba86.png"></p><h1 id="site，限制搜索范围在特定站点"><a href="#site，限制搜索范围在特定站点" class="headerlink" title="site，限制搜索范围在特定站点"></a>site，限制搜索范围在特定站点</h1><ul><li>格式：搜索词 site:站点域名</li></ul><p><strong><code>site:</code>后面紧跟站点域名， 不要带协议头。<code>site:</code>和域名之前没有空格。</strong></p><p><img src="https://img.vim-cn.com/d6/6a3c425c3301f838a20e3bf6c819f31d7bddbd.png" class="lazyload" data-srcset="https://img.vim-cn.com/d6/6a3c425c3301f838a20e3bf6c819f31d7bddbd.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/d6/6a3c425c3301f838a20e3bf6c819f31d7bddbd.png"></p><h1 id="inurl，搜索范围限定在url链接中"><a href="#inurl，搜索范围限定在url链接中" class="headerlink" title="inurl，搜索范围限定在url链接中"></a>inurl，搜索范围限定在url链接中</h1><ul><li>格式：搜索词 inurl:url中必须存在的词</li></ul><h1 id="intitle，搜索范围限定在网页标题"><a href="#intitle，搜索范围限定在网页标题" class="headerlink" title="intitle，搜索范围限定在网页标题"></a>intitle，搜索范围限定在网页标题</h1><ul><li>格式：搜索词 intitle:标题必须含有的词</li></ul><h1 id="filetype，搜索范围限定在指定文件格式中"><a href="#filetype，搜索范围限定在指定文件格式中" class="headerlink" title="filetype，搜索范围限定在指定文件格式中"></a>filetype，搜索范围限定在指定文件格式中</h1><ul><li>格式：搜索词 filetype:文件格式名</li></ul><p>-<br>源于百度:<a href="https://jingyan.baidu.com/article/d621e8dae7593c2864913f7b.html">https://jingyan.baidu.com/article/d621e8dae7593c2864913f7b.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python面向对象</title>
      <link href="2019/05/24/Python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
      <url>2019/05/24/Python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><ul><li>对象：一个自包含的实体，用一组可识别的特性和行为来标识</li><li>类：具有相同的属性和功能的对象的抽象的集合</li><li>实例：一个真实的对象，实例化就是创建对象的过程</li><li>多态：可对不同类型的对象执行相同的操作，而这些操作就像“被施了魔法”一样能够正常运行</li><li>封装：对外部隐藏有关对象工作原理的细节</li><li>继承：可基于通用类创建专用类</li></ul><h1 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h1><ul><li>多态可以让我们在不知道变量指向哪种对象时，也能够对其执行操作，且操作的行为将随对象所属的类型（类）而异。每当不知道对象是什么样就能对其执行操作，都是多态在起作用</li><li>多态以 继承 和 重写 父类方法 为前提</li><li>多态是调用方法的技巧，不会影响到类的内部设计</li><li>多态性即向不同的对象发送同一个消息，不同的对象在接收时会产生不同的行为（即方法）</li><li>听说Python天然就多态</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name,sex</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_title</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.sex == <span class="string">&quot;male&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;man&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> self.sex == <span class="string">&quot;female&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;woman&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span>(<span class="params">Person</span>):</span>                <span class="comment"># Child 继承 Person</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_title</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.sex == <span class="string">&quot;male&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;boy&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> self.sex == <span class="string">&quot;female&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;girl&quot;</span>)</span><br><span class="line"></span><br><span class="line">May = Child(<span class="string">&quot;May&quot;</span>,<span class="string">&quot;female&quot;</span>)</span><br><span class="line">Peter = Person(<span class="string">&quot;Peter&quot;</span>,<span class="string">&quot;male&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(May.name,May.sex,Peter.name,Peter.sex)</span><br><span class="line"><span class="comment"># 同一消息</span></span><br><span class="line">May.print_title()</span><br><span class="line">Peter.print_title()</span><br></pre></td></tr></table></figure><span id="more"></span><h1 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h1><ul><li><p>封装指的是向外部隐藏不必要的细节。与多态有点像，他们都是抽象的原则。<strong>多态让你无需知道对象所属的类（对象的类型）就能调用其方法。封装让你无需知道对象的构造就能够使用它。</strong></p></li><li><p>实现封装可以对类内的属性和方法的访问加以限制。就像C++类使用private、protected一样对类的成员访问进行限制一样</p></li><li><p>默认情况下，Python中的属性和方法都是公开的，可以在对象外部访问</p></li></ul><h2 id="私有变量"><a href="#私有变量" class="headerlink" title="私有变量"></a>私有变量</h2><ul><li>Python并没有真正的私有化支持，但可用下划线得到伪私有。</li><li>在Python定义私有变量只需在变量名或函数名前加上两个下划线<code>__</code>,例如<code>__name</code>。那种仅限在一个对象内部访问的“私有”变量在Python中并不存在</li><li>使用双下划线将方法或属性变为私有时，在内部，Python将以双下划线开头的名字都进行转换，即在开头加上一个下划线和类名。但这样的私有变量或方法还是可以访问的，访问形式如：实例名._类名__变量名、实例名._类名__方法名()</li><li>以单下划线开头的时保护成员变量，只有本类和子类成员实例能访问这些变量</li></ul><p><a href="https://imgchr.com/i/VPgYDA"><img src="https://s2.ax1x.com/2019/05/23/VPgYDA.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/23/VPgYDA.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VPgYDA.png"></a></p><h2 id="property装饰器、-slots-魔法"><a href="#property装饰器、-slots-魔法" class="headerlink" title="property装饰器、__slots__魔法"></a>property装饰器、__slots__魔法</h2><ul><li>我们可以使用property装饰器对属性进行封装、通过getter和setter方法进行属性的访问和修改</li><li>Python是一门动态语言，可以在程序运行时给对象绑定属性和方法，也可以对已经绑定的属性和方法进行解绑定，我们可以使用__slots__魔法限定对象可以绑定的属性</li></ul><p><img src="https://s2.ax1x.com/2019/05/31/V1PM1x.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/31/V1PM1x.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="V1PM1x.png"></p><p><img src="https://s2.ax1x.com/2019/05/31/V1PK91.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/31/V1PK91.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="V1PK91.png"></p><h1 id="继承-amp-amp-派生"><a href="#继承-amp-amp-派生" class="headerlink" title="继承&amp;&amp;派生"></a>继承&amp;&amp;派生</h1><ul><li><p>一个新类从已有类那里获得其已有特性，这种现象称为继承。从一个已有类（父类，Python叫超类）产生一个新的子类，称为类的派生。要指顶定超类，可在class语句中的类名后加上超类名，并将其用原括括起来</p></li><li><p>一个类可以继承多个类（多重继承）。但是，如果多个超类以不同的方式实现了同一个方法（即有多个同名的方法），必须在class语句中小心排列这些类，因为位于前面的类的方法将覆盖位于后面的类的方法</p></li><li><p>对子类的实例调用方法（或访问其属性）时，如果找不到该方法或者属性，将在父类中查找</p></li><li><p>在子类中可以重写超类的方法（包括构造函数），重写构造函数时，要确保在子类的构造函数中调用超类的构造函数，否则可能无法正确的初始化对象</p></li><li><p>Python中所有的方法实际上是virtual的</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我叫&#123;&#125;&quot;</span>.<span class="built_in">format</span>(name))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">Person</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,name</span>):</span></span><br><span class="line">        <span class="comment"># 使用super函数调用父类构造函数</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name) <span class="comment"># 也可以写成这样：Person.__init__(self,name)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是一个学生！&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/05/23/VPB0O0.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/23/VPB0O0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VPB0O0.png"></p><h1 id="抽象基类"><a href="#抽象基类" class="headerlink" title="抽象基类"></a>抽象基类</h1><ul><li>抽象基类是不能（至少是不应该）实例化的类，其职责是定义子类应该实现的一组抽象方法。Python可通过引入ABC模块实现抽象基类，使用<code>@abstractmethod</code>装饰器将方法标记为抽象的。例如：</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Basic</span>&#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">talk</span><span class="params">()</span> <span class="keyword">const</span> </span>= <span class="number">0</span>;<span class="comment">//纯虚函数</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Basic</span>(<span class="params">ABC</span>):</span></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">talk</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><ul><li>抽象类（即包含抽象方法的类）最重要的特征是不能实例化。如果派生出的类没有重写talk方法，那么派生出的类也是抽象的，不能实例化。</li></ul><h1 id="鸭子类型"><a href="#鸭子类型" class="headerlink" title="鸭子类型"></a><a href="https://baike.baidu.com/item/%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B/10845665?fr=aladdin">鸭子类型</a></h1><blockquote><p>“鸭子类型”的语言是这么推断的：一只鸟走起来像鸭子、游起泳来像鸭子、叫起来也像鸭子，那它就可以被当做鸭子。也就是说，它不关注对象的类型，而是关注对象具有的行为(方法)。<br>例如，在不使用鸭子类型的语言中，我们可以编写一个函数，它接受一个类型为鸭的对象，并调用它的走和叫方法。在使用鸭子类型的语言中，这样的一个函数可以接受一个任意类型的对象，并调用它的走和叫方法。如果这些需要被调用的方法不存在，那么将引发一个运行时错误。任何拥有这样的正确的走和叫方法的对象都可被函数接受的这种行为引出了以上表述，这种决定类型的方式因此得名</p></blockquote><p><strong>鸭子类型的关注点在对象的行为，而不在对象的类型</strong></p><p><img src="https://s2.ax1x.com/2019/05/24/VF9D3V.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/24/VF9D3V.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VF9D3V.png"></p><p>参考：<a href="https://zhuanlan.zhihu.com/p/59299729">https://zhuanlan.zhihu.com/p/59299729</a></p><h1 id="类方法、静态方法"><a href="#类方法、静态方法" class="headerlink" title="类方法、静态方法"></a>类方法、静态方法</h1><ul><li>类方法：使用@classmethod装饰器定义。<code>类方法将类本身作为对象进行操作</code>,类方法的第一个参数必须是当前类对象（一般命名为<code>cls</code>,用于传递类的属性和方法），实例对象和类对象都可以调用类方法。</li><li>静态方法：使用@staticmethod装饰器定义。没有self和cls参数。在方法中不能使用类或实例任何属性和方法。实例和对象都可以调用静态方法。</li></ul><p><img src="https://s2.ax1x.com/2019/05/31/V1PQc6.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/31/V1PQc6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="V1PQc6.png"></p><p><img src="https://s2.ax1x.com/2019/05/31/V1PmN9.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/31/V1PmN9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="V1PmN9.png"></p><p>参考：</p><ul><li><a href="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/Day09/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6.md">https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/Day09/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6.md</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jupyter Notebooks的简单了解</title>
      <link href="2019/05/22/Jupyter-Notebooks%E7%9A%84%E7%AE%80%E5%8D%95%E4%BA%86%E8%A7%A3/"/>
      <url>2019/05/22/Jupyter-Notebooks%E7%9A%84%E7%AE%80%E5%8D%95%E4%BA%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>玩Python这么久了，连Jupyter都不会，有点捞，今天补一补这方面的操作。。。。</p></blockquote><h1 id="Jupyter-Notebooks"><a href="#Jupyter-Notebooks" class="headerlink" title="Jupyter Notebooks"></a><a href="https://jupyter.org/">Jupyter Notebooks</a></h1><p>&ensp;&ensp;Jupyter Notebooks 是一款开源的网络应用，我们可以将其用于创建和共享代码与文档。其提供了一个环境，你无需离开这个环境，就可以在其中编写你的代码、运行代码、查看输出、可视化数据并查看结果。因此，这是一款可执行端到端的数据科学工作流程的便捷工具，其中包括数据清理、统计建模、构建和训练机器学习模型、可视化数据等等。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code>pip install ipython jupyter</code></pre><h2 id="上手上手"><a href="#上手上手" class="headerlink" title="上手上手"></a>上手上手</h2><p>在终端输入<code>jupyter notebook</code>启动Jupyter notebooks,它会在默认浏览器中打开，地址是<a href="http://localhost:8888/tree%E3%80%82">http://localhost:8888/tree。</a></p><p><img src="https://s2.ax1x.com/2019/05/22/VCCz7R.md.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/22/VCCz7R.md.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VCCz7R.md.png"></p><!-- more --><p><img src="https://s2.ax1x.com/2019/05/22/VCCxB9.md.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/22/VCCxB9.md.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VCCxB9.md.png"></p><p>新建个Python文件试试</p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/jupyter.gif" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/jupyter.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/jupyter.gif"></p><h1 id="Jupyter常用键盘快捷键"><a href="#Jupyter常用键盘快捷键" class="headerlink" title="Jupyter常用键盘快捷键"></a>Jupyter常用键盘快捷键</h1><p><strong>esc和enter用于切换Jupyter的键盘输入模式，esc切换为命令模式（blue），enter切换为编辑模式（green）</strong></p><ul><li><p>命令模式(常用)</p><ul><li>连续按两下D，删除当前活跃单元</li><li>按A在活跃单元上插入一个单元，按B在活跃单元下插入一个单元</li><li>按Z撤销被删除的单元</li><li>按Y将当前单元变为代码单元</li><li>按Shift+方向上下键选择多个单元，按Shift+M可以合并选择的单元</li><li>Ctrl+Shift+F用于打开命令面板</li><li>按H查看快捷键完整列表</li></ul></li><li><p>编辑模式（常用）</p><ul><li>Ctrl+S保存（防死机(๑•̀ㅂ•́)و✧）</li><li>Ctrl+Home回到单元起始位置</li><li>Ctrl+Enter运行整个单元块</li><li>Alt+Enter运行当前活跃单元块，并在当前活跃单元块下方创建新的单元块</li></ul></li></ul><p><img src="https://s2.ax1x.com/2019/05/22/VCPpA1.md.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/22/VCPpA1.md.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VCPpA1.md.png"></p><hr><p>emmm可以划水了。。。。</p><p>了解更多：</p><p><a href="https://zhuanlan.zhihu.com/p/37553863">始于Jupyter Notebooks：一份全面的初学者实用指南</a></p><p><a href="https://zhuanlan.zhihu.com/p/42468945">jupyter notebook使用技巧</a></p><p><a href="https://segmentfault.com/a/1190000013014274?tdsourcetag=s_pcqq_aiomsg">Jupyter介绍和使用 中文版</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python多进程&amp;&amp;多线程（初步）</title>
      <link href="2019/05/11/Python%E5%A4%9A%E8%BF%9B%E7%A8%8B-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>2019/05/11/Python%E5%A4%9A%E8%BF%9B%E7%A8%8B-%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="进程-amp-amp-线程"><a href="#进程-amp-amp-线程" class="headerlink" title="进程 &amp;&amp; 线程"></a>进程 &amp;&amp; 线程</h1><blockquote><p>进程：进程是操作系统中执行的一个程序，操作系统以进程为单位分配存储空间，每个进程都有自己的地址空间、数据栈以及其他用于跟踪进程执行的辅助数据，操作系统管理所有进程的执行，为它们合理的分配资源。进程可以通过fork或者wpawn的方式来创建新的进程执行其他任务，不过新的进程有自己独立的内存空间和数据栈，所以必须通过进程间的通信机制（IPC，Inter Process Communication）来实现数据共享，具体的方式包括管道、信号、套接字、共享内存等。</p></blockquote><blockquote><p>线程：进程的一个执行单元。线程在同一个进程中执行，共享程序的上下文。一个进程中的各个线程与主线程共享同一片数据空间，因而相比与独立的进程，线程间的信息共享和通信更为容易。线程一般是以并发的方式执行的。注意在单核CPU系统中，真正的并发是不可能的，所以新城的执行实际上是这样规划的：每个线程执行一小会，然后让步给其他线程的任务（再次排队等候更多的CPU执行时间）。在整个线程的执行过程中，每个线程执行它自己的特定的任务，在必要时和其他进程进行结果通信。</p></blockquote><h1 id="Python多进程（使用multiprocessing）"><a href="#Python多进程（使用multiprocessing）" class="headerlink" title="Python多进程（使用multiprocessing）"></a>Python多进程（使用multiprocessing）</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time, sleep</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_task</span>(<span class="params">name</span>):</span></span><br><span class="line">    sleep_time = randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">    sleep(sleep_time)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你叫了一声%s，它鸟你用了%d秒&quot;</span> % (name, sleep_time))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    start = time()</span><br><span class="line">    process_1 = Process(target=my_task, args=[<span class="string">&quot;yeshan&quot;</span>, ])</span><br><span class="line">    process_2 = Process(target=my_task, args=[<span class="string">&quot;foel&quot;</span>, ])</span><br><span class="line">    <span class="comment"># 启动进程</span></span><br><span class="line">    process_1.start()</span><br><span class="line">    process_2.start()</span><br><span class="line">    <span class="comment"># 等待进程执行结束</span></span><br><span class="line">    process_1.join()</span><br><span class="line">    process_2.join()</span><br><span class="line">    end = time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;一共花费了%f秒&quot;</span> % (end-start))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><span id="more"></span><p><img src="https://s2.ax1x.com/2019/05/14/EIcIMt.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/14/EIcIMt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="EIcIMt.png"></p><p>我们通过Process类创建了进程对象，通过<code>target</code>参数我们传入一个函数来表示进程启动后要执行的代码，后面的<code>args</code>是一个元组，它代表了传递给函数的参数。<br>Process对象的start方法用来启动进程，join方法表示等待进程执行结束。</p><h1 id="Python多线程（使用threading）"><a href="#Python多线程（使用threading）" class="headerlink" title="Python多线程（使用threading）"></a>Python多线程（使用threading）</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time, sleep</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;开始下载 %s ...&quot;</span> % filename)</span><br><span class="line">    download_time = randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">    sleep(download_time)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载完成！耗时 %d 秒&quot;</span> % download_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    start = time()</span><br><span class="line"></span><br><span class="line">    t1 = Thread(target=download, args=(<span class="string">&#x27;黑暗地宫&#x27;</span>,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line">    t2 = Thread(target=download, args=(<span class="string">&#x27;通天&#x27;</span>,))</span><br><span class="line">    t2.start()</span><br><span class="line"></span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line">    end = time()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载总共耗时 %.3f 秒&quot;</span> % (end-start))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/05/21/VSTFr4.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/21/VSTFr4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VSTFr4.png"></p><p>** 继承Thread类，实现自定义线程类 **</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time, sleep</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownLoadTask</span>(<span class="params">Thread</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, filename</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__() <span class="comment">#初始化父类的构造函数</span></span><br><span class="line">        self._filename = filename <span class="comment"># 私有的</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开始下载 %s ...&quot;</span> % self._filename)</span><br><span class="line">        download_time = randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">        sleep(download_time)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s下载完成！耗时 %d 秒&quot;</span> % (self._filename, download_time))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    strat = time()</span><br><span class="line"></span><br><span class="line">    t1 = DownLoadTask(<span class="string">&quot;从菜鸟到菜鸡&quot;</span>)</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line">    t2 = DownLoadTask(<span class="string">&quot;去哪里啊弟弟&quot;</span>)</span><br><span class="line">    t2.start()</span><br><span class="line"></span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line">    end = time()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载完成，总共耗费 %.3f 秒&quot;</span> % (end-strat))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/05/21/VSTiMF.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/05/21/VSTiMF.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="VSTiMF.png"></p><h2 id="线程间的通信"><a href="#线程间的通信" class="headerlink" title="线程间的通信"></a>线程间的通信</h2><blockquote><p>因为多个线程可以共享进程的内存空间，因此要实现多个线程间的通信相对简单，大家能想到的最直接的办法就是设置一个全局变量，多个线程共享这个全局变量即可。但是当多个线程共享同一个变量（我们通常称之为“资源”）的时候，很有可能产生不可控的结果从而导致程序失效甚至崩溃。如果一个资源被多个线程竞争使用，那么我们通常称之为“临界资源”，对“临界资源”的访问需要加上保护，否则资源会处于“混乱”的状态。在这种情况下，“锁”就可以派上用场了。我们可以通过“锁”来保护“临界资源”，只有获得“锁”的线程才能访问“临界资源”，而其他没有得到“锁”的线程只能被阻塞起来，直到获得“锁”的线程释放了“锁”，其他线程才有机会获得“锁”，进而访问被保护的“临界资源”。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, Lock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._balance = <span class="number">0</span></span><br><span class="line">        self._lock = Lock()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deposit</span>(<span class="params">self, money</span>):</span></span><br><span class="line">        <span class="comment"># 先获取锁才能获取后面的代码</span></span><br><span class="line">        self._lock.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 计算存款后的余额</span></span><br><span class="line">            new_balance = self._balance + money</span><br><span class="line">            <span class="comment"># 模拟受理存款业务需要0.01秒的时间</span></span><br><span class="line">            sleep(<span class="number">0.01</span>)</span><br><span class="line">            <span class="comment"># 修改账户余额</span></span><br><span class="line">            self._balance = new_balance</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self._lock.release()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">balance</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._balance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddMoneyThread</span>(<span class="params">Thread</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, account, money</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self._account = account</span><br><span class="line">        self._money = money</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._account.deposit(self._money)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    account = Account()</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="comment"># 创建100个存款的线程向同一个账户中存钱</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        t = AddMoneyThread(account, <span class="number">1</span>)</span><br><span class="line">        threads.append(t)</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="comment"># 等所有存款的线程都执行完毕</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;账户余额为: ￥%d元&#x27;</span> % account.balance)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>输出结果为100块，不用锁为2块</p><p>** Python内置装饰器 property **</p><p>*** property装饰器一般存在于类中，可以将一个函数定义成一个属性，属性的值就是该函数return的内容 ***</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="comment"># 把一个方法变成属性</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line">    <span class="comment"># setter把一个方法变成一个可控属性用于赋值</span></span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/21.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/21.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/21.png"></p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/22.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/22.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/22.png"></p><hr><p>参考：</p><p><a href="https://zhuanlan.zhihu.com/p/65968462?utm_source=qq&utm_medium=social&utm_oi=908413169096077312">一篇文章搞懂装饰器的用法</a></p><p><a href="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/Day13/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B.md">https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/Day13/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B.md</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTPie的使用</title>
      <link href="2019/04/23/HTTPie%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>2019/04/23/HTTPie%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>HTTPie（发音为aitch-tee-tee-pie）是一个命令行HTTP客户端。其目标是使与Web服务的CLI交互尽可能人性化。它提供了一个简单的http命令，允许使用简单自然的语法发送任意HTTP请求，并显示彩色输出。HTTPie可用于测试，调试以及通常与HTTP服务器交互。</p></blockquote><h1 id="HTTPie官方文档"><a href="#HTTPie官方文档" class="headerlink" title="HTTPie官方文档"></a>HTTPie官方文档</h1><ul><li><a href="https://httpie.org/doc">https://httpie.org/doc</a></li></ul><p>windows下安装</p><pre><code>pip install --upgrade httpie</code></pre><h1 id="HTTPie的简单使用"><a href="#HTTPie的简单使用" class="headerlink" title="HTTPie的简单使用"></a>HTTPie的简单使用</h1><h2 id="一个完整的请求语句的大概样子"><a href="#一个完整的请求语句的大概样子" class="headerlink" title="一个完整的请求语句的大概样子"></a>一个完整的请求语句的大概样子</h2><pre><code>http [选项(flags)] [方法] URL [查询字符串/数据字段/首部字段]</code></pre><h2 id="HTTPie数据语法"><a href="#HTTPie数据语法" class="headerlink" title="HTTPie数据语法"></a>HTTPie数据语法</h2><table><thead><tr><th align="center">类型</th><th align="center">符号</th><th align="center">示例</th></tr></thead><tbody><tr><td align="center">URL参数</td><td align="center">==</td><td align="center">param==value</td></tr><tr><td align="center">首部字段</td><td align="center">:</td><td align="center">Name:value</td></tr><tr><td align="center">数据字段</td><td align="center">=</td><td align="center">field=value</td></tr><tr><td align="center">原生JSON字段</td><td align="center">:=</td><td align="center">field:=json</td></tr><tr><td align="center">表单上传字段</td><td align="center">@</td><td align="center">field@dir/file</td></tr></tbody></table><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载文件</span></span><br><span class="line">$ http --download www.jb51.net/my_file.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交表单</span></span><br><span class="line">$ http -f POST www.jb51.net name=<span class="string">&#x27;Dan Nanni&#x27;</span> comment=<span class="string">&#x27;Hi there&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTPie的默认数据类型为JSON格式的</span></span><br><span class="line">$ http PUT example.org name=John email=john@example.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用代理</span></span><br><span class="line">$ http --proxy=http:http://10.10.1.10:3128 --proxy=https:https://10.10.1.10:1080 example.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定制请求头</span></span><br><span class="line">$ http www.test.com User-Agent:Xmodulo/1.0 Referer:http://www.imike.me MyParam:Foo</span><br></pre></td></tr></table></figure><h2 id="放着先。。。。。。。。。占个位"><a href="#放着先。。。。。。。。。占个位" class="headerlink" title="放着先。。。。。。。。。占个位"></a>放着先。。。。。。。。。占个位</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Git Branch Practice</title>
      <link href="2019/04/08/Git-Branch-Practice/"/>
      <url>2019/04/08/Git-Branch-Practice/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>最近在弄一个东西，基本的功能已经弄好了，现在想再扩展一起其他功能，但这样势必会改动原有代码，我又不想破坏原有的代码逻辑，方便以后查看。记得Git有个分支工作流可以很好的满足我的需求(๑•̀ㅂ•́)و✧。emmm，很久没发文了，record一下吧。(ノへ￣、)</p></blockquote><h1 id="使用到的命令"><a href="#使用到的命令" class="headerlink" title="使用到的命令"></a>使用到的命令</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git branch <span class="comment"># 显示所有本地分支</span></span><br><span class="line">$ git branch &lt;new branch&gt; <span class="comment"># 创建新分支</span></span><br><span class="line">$ git checkout &lt;branch&gt; <span class="comment"># 切换到指定分支</span></span><br><span class="line">$ git branch -d &lt;branch&gt; <span class="comment"># 删除本地分支</span></span><br><span class="line">$ git push --set-upstream origin &lt;branch&gt; <span class="comment"># 将本地分支与远程分支关联</span></span><br><span class="line">$ git push origin --delete &lt;branch&gt; <span class="comment"># 删除远程分支</span></span><br><span class="line"></span><br><span class="line">$ git tag -n <span class="comment"># 列出所有本地标签以及相关信息</span></span><br><span class="line">$ git tag &lt;tagname&gt; <span class="comment"># 基于最新提交创建标签</span></span><br><span class="line">&amp; git tag &lt;tagname&gt; -m <span class="string">&quot;备注信息&quot;</span> <span class="comment"># 基于最新提交创建含备注信息的标签</span></span><br><span class="line">$ git tag -d &lt;tagname&gt; <span class="comment"># 删除标签</span></span><br><span class="line">$ git push orign &lt;tagname&gt; <span class="comment"># 将指定信息推送到远程仓库</span></span><br><span class="line">$ git push --tags <span class="comment"># 推送所有标签到远程仓库</span></span><br></pre></td></tr></table></figure><h1 id="操作-操作"><a href="#操作-操作" class="headerlink" title="操作~操作"></a>操作~操作</h1><p><img src="https://img.vim-cn.com/00/950a7bad9cc5835194268fce6d40a444b7cfcc.png" class="lazyload" data-srcset="https://img.vim-cn.com/00/950a7bad9cc5835194268fce6d40a444b7cfcc.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/00/950a7bad9cc5835194268fce6d40a444b7cfcc.png"></p><p>emmm，顺便试试tag</p><p><img src="https://img.vim-cn.com/a4/26dbcd8ed54643c057193aa14d15ade7ef2358.png" class="lazyload" data-srcset="https://img.vim-cn.com/a4/26dbcd8ed54643c057193aa14d15ade7ef2358.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/a4/26dbcd8ed54643c057193aa14d15ade7ef2358.png"></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>吐槽</title>
      <link href="2019/03/22/%E5%90%90%E6%A7%BD/"/>
      <url>2019/03/22/%E5%90%90%E6%A7%BD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="better-and-better"><a href="#better-and-better" class="headerlink" title="better and better"></a>better and better</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>我与vim的亲密接触(ˉ▽￣～)</title>
      <link href="2019/03/20/%E6%88%91%E4%B8%8Evim%E7%9A%84%E4%BA%B2%E5%AF%86%E6%8E%A5%E8%A7%A6/"/>
      <url>2019/03/20/%E6%88%91%E4%B8%8Evim%E7%9A%84%E4%BA%B2%E5%AF%86%E6%8E%A5%E8%A7%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>emmm，闲来无事，打算了解下神奇vim（用来zhuangbi）。在终端操作很帅(ˉ▽￣～)~~！<br>什么是vim？？Vim是从 vi 发展出来的一个文本编辑器。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。</p></blockquote><h1 id="vi-vim的使用"><a href="#vi-vim的使用" class="headerlink" title="vi/vim的使用"></a>vi/vim的使用</h1><p>vi/vim有三种模式：</p><ul><li><strong>命令模式</strong>：控制光标移动，可对文本进行复制、粘贴、删除和查找等工作。刚启动时就是这个模式。</li><li><strong>输入模式</strong>：正常的文本录入。</li><li><strong>末行模式</strong>：保存或退出文档，以及设置编辑环境。又可成为底线命令模式。</li></ul><span id="more"></span><p><img src="https://img.shan333.cn/images/2019/03/20/vim-vi-workmodel.png" class="lazyload" data-srcset="https://img.shan333.cn/images/2019/03/20/vim-vi-workmodel.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="vim-vi-workmodel.png"></p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>命令模式常用命令：</p><table><thead><tr><th align="center">命令</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">dd</td><td align="center">删除（剪切）光标所在整行</td></tr><tr><td align="center">5dd</td><td align="center">删除（剪切）从光标处开始的5行</td></tr><tr><td align="center">yy</td><td align="center">复制光标所在的整行</td></tr><tr><td align="center">5yy</td><td align="center">复制从光标处开始的5行</td></tr><tr><td align="center">n</td><td align="center">显示搜索命令定位到的下一个字符串</td></tr><tr><td align="center">N</td><td align="center">显示搜索命令定位到的上一个字符串</td></tr><tr><td align="center">u</td><td align="center">撤销上一步的操作</td></tr><tr><td align="center">p</td><td align="center">将之前删除（dd）或复制（yy）过的数据粘贴到光标后面</td></tr></tbody></table><p>末行模式可用命令：</p><table><thead><tr><th align="center">命令</th><th align="center">作用</th></tr></thead><tbody><tr><td align="center">:w</td><td align="center">保存</td></tr><tr><td align="center">:q</td><td align="center">退出</td></tr><tr><td align="center">:q!</td><td align="center">强制退出（放弃对文档内容的修改）</td></tr><tr><td align="center">:wq!</td><td align="center">强制保存退出</td></tr><tr><td align="center">:set nu</td><td align="center">显示行号</td></tr><tr><td align="center">:set nonu</td><td align="center">不显示行号</td></tr><tr><td align="center">:命令</td><td align="center">执行该命令</td></tr><tr><td align="center">:整数</td><td align="center">跳转到该行</td></tr><tr><td align="center">:s/one/two</td><td align="center">将当前光标所在行的第一个one替换成two</td></tr><tr><td align="center">:s/one/two/p</td><td align="center">将当前光标所在行的所有one替换成two</td></tr><tr><td align="center">:%s/one/two/g</td><td align="center">将全文中的所有one替换成two</td></tr><tr><td align="center">?字符串</td><td align="center">在文本中从下到上搜索该字符串</td></tr><tr><td align="center">/字符串</td><td align="center">在文本中从上到下搜索该字符串</td></tr></tbody></table><h1 id="我与它的亲密接触。。。。。"><a href="#我与它的亲密接触。。。。。" class="headerlink" title="我与它的亲密接触。。。。。"></a>我与它的亲密接触。。。。。</h1><p><img src="https://img.shan333.cn/images/2019/03/20/_2019_03_21_00_34_28_680.gif" class="lazyload" data-srcset="https://img.shan333.cn/images/2019/03/20/_2019_03_21_00_34_28_680.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="_2019_03_21_00_34_28_680.gif"></p><h1 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h1><ul><li>vim官网：<a href="https://www.vim.org/">https://www.vim.org/</a></li><li>vim快捷键键位图：<a href="https://www.jianshu.com/p/8b986f572a61">https://www.jianshu.com/p/8b986f572a61</a></li></ul><p><img src="https://img.shan333.cn/images/2019/03/20/1294928-20171207102042159-1872416815.jpg" class="lazyload" data-srcset="https://img.shan333.cn/images/2019/03/20/1294928-20171207102042159-1872416815.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1294928-20171207102042159-1872416815.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLAlchemy建立数据库模型之间的关系</title>
      <link href="2019/03/20/SQLAlchemy%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/"/>
      <url>2019/03/20/SQLAlchemy%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="常见关系："><a href="#常见关系：" class="headerlink" title="常见关系："></a>常见关系：</h1><ul><li>一对多关系</li><li>多对一关系</li><li>多对多关系</li><li>一对一关系</li></ul><h1 id="一对多关系（一个作者，多篇文章）"><a href="#一对多关系（一个作者，多篇文章）" class="headerlink" title="一对多关系（一个作者，多篇文章）"></a>一对多关系（一个作者，多篇文章）</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 一对多关系，单作者-多文章，外键不可少</span></span><br><span class="line"><span class="comment">## 外键(ForeignKey)总在多的那边定义,关系(relationship)总在单的那边定义</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Author</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">70</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    phone = db.Column(db.String(<span class="number">20</span>))</span><br><span class="line">    <span class="comment"># articles为关系属性(一个集合，可以像列表一样操作，在关系的出发侧定义</span></span><br><span class="line">    <span class="comment">## relationship()函数的第一个参数为关系另一侧的模型名称(Article)</span></span><br><span class="line">    articles = db.relationship(<span class="string">&#x27;Article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">15</span>), index=<span class="literal">True</span>)</span><br><span class="line">    body = db.Column(db.Text)</span><br><span class="line">    <span class="comment"># 传入ForeignKey的参数形式为：&quot;表名.字段名&quot;</span></span><br><span class="line">    <span class="comment">## 模型类对应的表名由Flask-SQLAlchemy生成，默认为类名称的小写形式，多个单词通过下划线分隔</span></span><br><span class="line">    author_id = db.Column(db.Integer, db.ForeignKey(<span class="string">&#x27;author.id&#x27;</span>)) <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 外键字段(author_id)和关系属性(articles)的命名没有限制</span></span><br><span class="line"><span class="comment">## 建立关系可通过操作关系属性进行</span></span><br><span class="line">&gt;&gt;&gt;shansan = Author(name=<span class="string">&quot;shansan&quot;</span>)</span><br><span class="line">&gt;&gt;&gt;hello = Article(title=<span class="string">&quot;Hello world !&quot;</span>)</span><br><span class="line">&gt;&gt;&gt;boy = Article(title=<span class="string">&quot;Hello Boy !&quot;</span>)</span><br><span class="line">&gt;&gt;&gt;db.session.add(shansan) <span class="comment"># 将创建的数据库记录添加到会话中</span></span><br><span class="line">&gt;&gt;&gt;db.session.add(hello)</span><br><span class="line">&gt;&gt;&gt;db.session.add(boy)</span><br><span class="line">&gt;&gt;&gt;shansan.articles.append(hello) <span class="comment"># 操作关系属性</span></span><br><span class="line">&gt;&gt;&gt;shansan.articles.append(boy)</span><br><span class="line">&gt;&gt;&gt;db.session.commit()</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="基于一对多的双向关系（bidirectional-relationship）"><a href="#基于一对多的双向关系（bidirectional-relationship）" class="headerlink" title="基于一对多的双向关系（bidirectional relationship）"></a>基于一对多的双向关系（bidirectional relationship）</h2><p>在这里我们希望可以在Book类中存在这样一个属性：通过调用它可以获取对应的作者的记录，这类返回单个值的关系属性称为<strong>标量关系属性</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立双向关系时，关系两边都有关系函数</span></span><br><span class="line"><span class="comment"># 在关系函数中，我们使用back_populates参数连接对方，参数的值设置为关系另一侧的关系属性名</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Writer</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">64</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># back_populates的参数值为关系另一侧的关系属性名</span></span><br><span class="line">    books = db.relationship(<span class="string">&#x27;Book&#x27;</span>, back_populates=<span class="string">&#x27;writer&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;Writer %r&gt;&#x27;</span> % self.name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">50</span>), index=<span class="literal">True</span>)</span><br><span class="line">    writer_id = db.Column(db.Integer, db.ForeignKey(<span class="string">&#x27;writer.id&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    writer = db.relationship(<span class="string">&#x27;Writer&#x27;</span>, back_populates=<span class="string">&#x27;books&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;Book %r&gt;&#x27;</span> % self.name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置双向属性后，我们既可以通过集合属性操作关系，也可通过标量关系属性操作关系</span></span><br></pre></td></tr></table></figure><h1 id="多对一关系（多个市民都在同一个城市）"><a href="#多对一关系（多个市民都在同一个城市）" class="headerlink" title="多对一关系（多个市民都在同一个城市）"></a>多对一关系（多个市民都在同一个城市）</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 外键总在多的一侧定义</span></span><br><span class="line"><span class="comment">## 多对一关系中，外键和关系属性都在多的一侧定义</span></span><br><span class="line"><span class="comment">## 这里的关系属性是标量关系属性（返回单一数据）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Citizen</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    city_id = db.Column(db.Integer, db.ForeignKey(<span class="string">&#x27;city.id&#x27;</span>))</span><br><span class="line">    city = db.relationship(<span class="string">&#x27;City&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">City</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>), unique=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h1 id="一对一关系（国家和首都）"><a href="#一对一关系（国家和首都）" class="headerlink" title="一对一关系（国家和首都）"></a>一对一关系（国家和首都）</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 一对一关系，将关系函数的uselist参数设为False，使得集合关系属性无法使用列表语义操作</span></span><br><span class="line"><span class="comment">## 这里使用的是一对一双向关系</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Country</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    capital = db.relationship(<span class="string">&#x27;Capital&#x27;</span>, uselist=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Capital</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    country_id= db.Column(db.Integer, db.ForeignKey(<span class="string">&#x27;country.id&#x27;</span>))</span><br><span class="line">    country = db.relationship(<span class="string">&#x27;Country&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="多对多双向关系（老师和学生）"><a href="#多对多双向关系（老师和学生）" class="headerlink" title="多对多双向关系（老师和学生）"></a>多对多双向关系（老师和学生）</h1><ul><li>多对多关系的建立需要使用关联表（association table）。关联表不存储数据，只用来存储关系两侧模型的外键对应关系</li><li>定义关系两侧的关系函数时，需要添加一个<strong>secondary</strong>参数，值设为关联表的名称</li><li>关联表由使用db.Table类定义，传入的第一个参数为关联表的名称</li><li>我们在关联表中将多对多的关系分化成了两个一对多的关系</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 多对多关系，使用关联表（association table），关联表由db.Table定义</span></span><br><span class="line"><span class="comment">## 关系函数需要设置secondary参数，值为关系表名</span></span><br><span class="line"></span><br><span class="line">association_table = db.Table(<span class="string">&#x27;association_table&#x27;</span>,</span><br><span class="line">                             db.Column(<span class="string">&#x27;student_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;teacher.id&#x27;</span>)),</span><br><span class="line">                             db.Column(<span class="string">&#x27;teacher_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;student.id&#x27;</span>))</span><br><span class="line">                             )</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">70</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    grade = db.Column(db.String(<span class="number">20</span>))</span><br><span class="line">    teachers = db.relationship(<span class="string">&#x27;Teacher&#x27;</span>, secondary=association_table,back_populates=<span class="string">&#x27;students&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>(<span class="params">db.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">70</span>), unique=<span class="literal">True</span>)</span><br><span class="line">    office = db.Column(db.String(<span class="number">20</span>))</span><br><span class="line">    students = db.relationship(<span class="string">&#x27;Student&#x27;</span>, secondary=association_table, back_populates=<span class="string">&#x27;teachers&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="常用的SQLAlchemy关系函数参数和常用的SQLAlchemy关系记录加载方式（lazy参数可选值）"><a href="#常用的SQLAlchemy关系函数参数和常用的SQLAlchemy关系记录加载方式（lazy参数可选值）" class="headerlink" title="常用的SQLAlchemy关系函数参数和常用的SQLAlchemy关系记录加载方式（lazy参数可选值）"></a>常用的SQLAlchemy关系函数参数和常用的SQLAlchemy关系记录加载方式（lazy参数可选值）</h1><ul><li>使用关系函数定义的属性不是数据库字段，而是类似于特定的查询函数</li><li>当关系属性被调用时，关系函数会加载相应的记录</li></ul><p><img src="https://s2.ax1x.com/2019/03/20/AKnfCq.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/20/AKnfCq.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="AKnfCq.png"></p><p><img src="https://s2.ax1x.com/2019/03/20/AKn5vT.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/20/AKn5vT.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="AKn5vT.png"></p><h1 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h1><p><a href="http://www.sqlalchemy.org/">http://www.sqlalchemy.org/</a></p><p><a href="https://github.com/sqlalchemy/sqlalchemy">https://github.com/sqlalchemy/sqlalchemy</a></p><p><a href="https://github.com/mitsuhiko/flask-sqlalchemy">https://github.com/mitsuhiko/flask-sqlalchemy </a></p><hr>]]></content>
      
      
      <categories>
          
          <category> Flask </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flask的请求钩子与上下文简记</title>
      <link href="2019/03/16/Flask%E7%9A%84%E8%AF%B7%E6%B1%82%E9%92%A9%E5%AD%90%E4%B8%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%80%E8%AE%B0/"/>
      <url>2019/03/16/Flask%E7%9A%84%E8%AF%B7%E6%B1%82%E9%92%A9%E5%AD%90%E4%B8%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%80%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="请求钩子-Hook"><a href="#请求钩子-Hook" class="headerlink" title="请求钩子(Hook)"></a>请求钩子(Hook)</h1><blockquote><p>在客户端和服务器交互的过程中，有些准备工作或扫尾工作需要处理，比如：在请求开始时，建立数据库连接；在请求结束时，指定数据的交互格式。为了让&gt;每个视图函数避免编写重复功能的代码，Flask提供了通用设施的功能，即请求钩子。通过请求钩子，我们可以对请求进行预处理(preprocessing)和后处理&gt;(postprocessing)。</p></blockquote><p>Flask的请求钩子通过装饰器实现，每个钩子可以注册任意多个处理函数，默认的五种请求钩子如下:</p><table><thead><tr><th align="center">钩子</th><th align="left">说明</th></tr></thead><tbody><tr><td align="center">before_first_request</td><td align="left">注册一个函数，在处理请求前运行</td></tr><tr><td align="center">before_request</td><td align="left">注册一个函数，在处理每个请求前运行</td></tr><tr><td align="center">after_request</td><td align="left">注册一个函数，如果有未处理的一场抛出。会在每个请求结束后运行</td></tr><tr><td align="center">teardown_request</td><td align="left">注册一个函数，即使有未处理的异常抛出，会在每个请求介绍后执行。如果发生异常，会传入异常对象作为参数注册到函数中</td></tr><tr><td align="center">after_this_request</td><td align="left">在视图函数内注册一个函数，在这个请求结束后运行</td></tr></tbody></table><span id="more"></span><p>假如我们创建了三个视图函数A、B、C，其中视图C使用了after_this_request钩子，那么当请求A进入后，整个请求处理周期的请求处理函数调用流程如图:</p><p><img src="https://s2.ax1x.com/2019/03/15/AEdgN4.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/15/AEdgN4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="AEdgN4.png"></p><h1 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h1><blockquote><p>什么是上下文？上下文相当于一个容器，它保存了程序运行过程中的一些信息，它是当前环境的一个快照(snapshot)。<br>Flask中有两种上下文，程序上下文(application context)和请求上下文(request context)。<br>程序上下文中包含了程序运行所必须的信息；请求上下文里包含了请求的各种信息，比如请求的URL、HTTP方法等</p></blockquote><h2 id="上下文全局变量"><a href="#上下文全局变量" class="headerlink" title="上下文全局变量"></a>上下文全局变量</h2><p>我们知道，Flask将请求报文封装在request对象中。按照一般的思路，如果我们要在视图函数中使用它，就得把它作为参数传入视图函数，就像我们接收URL变量一样。但这样就会导致大量的重复，而且增加了的程序的负担。<br>不一般的是，我们可以从Flask导入一个全局的request变量，在视图函数中直接调用request的属性获取数据。这是为什么？因为Flask会在每个请求产生后后自动激活当前请求的上下文，激活请求上下文后，request被临时设置为全局可访问。在每个请求结束后，Flask就会销毁对应的请求上下文。</p><p>Flask提供的四个上下文全局变量如下：</p><table><thead><tr><th align="center">变量名</th><th align="center">上下文类别</th><th align="left">说明</th></tr></thead><tbody><tr><td align="center">current_app</td><td align="center">程序上下文</td><td align="left">指向处理请求的当前程序实例</td></tr><tr><td align="center">g</td><td align="center">程序上下文</td><td align="left">替代Python的全局变量用法，确保仅在当前请求可用，用于存储全局数据，每次请求都会重设</td></tr><tr><td align="center">request</td><td align="center">请求上下文</td><td align="left">封装客户端发出的请求报文数据</td></tr><tr><td align="center">session</td><td align="center">请求上下文</td><td align="left">用于记住请求之间的数据，通过签名的Cookie实现</td></tr></tbody></table><ul><li>不同的视图函数中，request对象都表示和视图函数对应的请求，也就是当前请求</li><li>程序存在多个程序实例的情况，使用current_app可获取对应的实例</li></ul><h2 id="上下文的激活"><a href="#上下文的激活" class="headerlink" title="上下文的激活"></a>上下文的激活</h2><p><strong>请求进入时，Flask会自动激活请求上下文，此时程序上下文也被自动激活。请求处理完毕后，请求上下文和程序上下文也会自动销毁。两者具有相同的生命周期。</strong></p><ul><li>Flask自动激活上下文的情况：<ul><li>使用<code>flask run</code>命令启动程序时</li><li>使用旧的<code>app.run()</code>方法启动程序时</li><li>执行使用<code>@app.cli.command()</code>装饰器注册的flask命令时</li><li>使用<code>flask shell</code>命令启动Python Shell时</li></ul></li></ul><ul><li>手动激活的方法:<ul><li>使用with语句，程序上下文对象可通过app.app_context()获取</li><li>使用push（）方法激活程序上下文</li><li>请求上下文可以通过test_request_context()方法临时创建</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from app import app</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from flask import current_app</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; with app.app_context():</span></span><br><span class="line">    ... current_app.name</span><br><span class="line">&#x27;app&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from app import app</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from flask import current_app</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; app_ctx = app.app_context()</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; app_ctx.push()</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; current_app.name</span></span><br><span class="line">&#x27;app&#x27;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; app_ctx.pop()</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from app import app</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; from flask import request</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; with app.test_request_context(<span class="string">&#x27;/hello&#x27;</span>):</span></span><br><span class="line">...     request.method</span><br><span class="line">&#x27;GET&#x27;</span><br></pre></td></tr></table></figure><p>参考：<a href="https://book.douban.com/subject/30310340/">https://book.douban.com/subject/30310340/</a></p>]]></content>
      
      
      <categories>
          
          <category> Flask </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将本地项目推送到GitHub远程仓库</title>
      <link href="2019/03/08/%E5%B0%86%E6%9C%AC%E5%9C%B0%E9%A1%B9%E7%9B%AE%E6%8E%A8%E9%80%81%E5%88%B0GitHub%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/"/>
      <url>2019/03/08/%E5%B0%86%E6%9C%AC%E5%9C%B0%E9%A1%B9%E7%9B%AE%E6%8E%A8%E9%80%81%E5%88%B0GitHub%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="如何将本地项目推送到Github"><a href="#如何将本地项目推送到Github" class="headerlink" title="如何将本地项目推送到Github"></a>如何将本地项目推送到Github</h1><blockquote><p>Tip：在本地要安装好Git，官网：<a href="https://git-scm.com/">https://git-scm.com/</a></p></blockquote><p><img src="https://s2.ax1x.com/2019/03/08/kzni4K.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzni4K.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzni4K.png"></p><blockquote><p>一个学习Git的好地方：<a href="https://try.github.io/">https://try.github.io/</a></p></blockquote><blockquote><p>在线闯关实战，边练边学的好地方：<a href="https://learngitbranching.js.org/">https://learngitbranching.js.org/</a></p></blockquote><h2 id="方法一：使用https推送"><a href="#方法一：使用https推送" class="headerlink" title="方法一：使用https推送"></a>方法一：使用https推送</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤</span></span><br><span class="line"><span class="comment"># 1.创建一个目录</span></span><br><span class="line">mkdir Test</span><br><span class="line"><span class="comment"># 2.将当前目录变为git管理仓库</span></span><br><span class="line">git init</span><br><span class="line"><span class="comment"># 3.将文件添加到版本库，这里将目录下的所有文件都添加进去了</span></span><br><span class="line">git add .</span><br><span class="line"><span class="comment"># 4.告诉git将文件提交到仓库</span></span><br><span class="line">git commit -m <span class="string">&quot;first-commit&quot;</span></span><br><span class="line"><span class="comment"># 5.将当前仓库与远程仓库关联</span></span><br><span class="line">git remote add origin 远程仓库的https地址 <span class="comment"># eg: git remote add https://github.com/ssmath/Test.git</span></span><br><span class="line"><span class="comment"># 6.将仓库内master分支的所有内容推送到远程仓库,这里会使用到Github的账号密码</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><span id="more"></span><p><img src="https://s2.ax1x.com/2019/03/08/kzusFP.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzusFP.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzusFP.png"></p><p><img src="https://s2.ax1x.com/2019/03/08/kzugSS.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzugSS.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzugSS.png"></p><h2 id="方法二：使用ssh推送"><a href="#方法二：使用ssh推送" class="headerlink" title="方法二：使用ssh推送"></a>方法二：使用ssh推送</h2><ol><li>生成ssh密钥</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your email address&quot;</span></span><br><span class="line"><span class="comment"># eg: ssh-keygen -t rsa -C &quot;1329441308@qq.com&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/03/08/kzKcA1.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzKcA1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzKcA1.png"></p><ol start="2"><li>找到生成的文件，复制id_rsa.pub文件中的内容，文件一般在用户目录下的.ssh目录中</li></ol><p><img src="https://s2.ax1x.com/2019/03/08/kzMw5t.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzMw5t.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://s2.ax1x.com/2019/03/08/kzMw5t.png"></p><ol start="3"><li>使用密钥与远程仓库配对，检验能否成功通讯</li></ol><p><img src="https://s2.ax1x.com/2019/03/08/kzMdUI.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzMdUI.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://s2.ax1x.com/2019/03/08/kzMdUI.png"></p><pre><code>ssh -T git@github.com  # 检验能否成功通讯</code></pre><p><img src="https://s2.ax1x.com/2019/03/08/kzMRVs.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzMRVs.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzMRVs.png"></p><ol start="4"><li>推送本地文件到github</li></ol><p><img src="https://s2.ax1x.com/2019/03/08/kzlilT.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/03/08/kzlilT.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kzlilT.png"></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode配置Pipenv工作环境</title>
      <link href="2019/03/03/vscode%E9%85%8D%E7%BD%AEPipenv%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83/"/>
      <url>2019/03/03/vscode%E9%85%8D%E7%BD%AEPipenv%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="让vscode使用Pipenv工作环境"><a href="#让vscode使用Pipenv工作环境" class="headerlink" title="让vscode使用Pipenv工作环境"></a>让vscode使用Pipenv工作环境</h1><h2 id="1、查看Pipenv的位置"><a href="#1、查看Pipenv的位置" class="headerlink" title="1、查看Pipenv的位置"></a>1、查看Pipenv的位置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 先激活Pipenv环境</span><br><span class="line">pipenv shell</span><br><span class="line"># 获取当前虚拟环境的位置</span><br><span class="line">pipenv --venv</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pe3ndazpj30ft01l746.jpg" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pe3ndazpj30ft01l746.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="2、打开setting-json配置文件"><a href="#2、打开setting-json配置文件" class="headerlink" title="2、打开setting.json配置文件"></a>2、打开setting.json配置文件</h2><ul><li><p>Ctrl+Shift+P，输入settings，选择Open Settings(JSon)</p></li><li><p>将之前得到的Pipenv环境路径添加进去</p><p>  “python.venvPath”: “C:\Users\Algorithm\.virtualenvs”</p></li></ul><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pdwtnoqtj30gu08rq3k.jpg" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pdwtnoqtj30gu08rq3k.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pdyyyuvqj30m405pjrh.jpg" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pdyyyuvqj30m405pjrh.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><h2 id="3、重启vscode"><a href="#3、重启vscode" class="headerlink" title="3、重启vscode"></a>3、重启vscode</h2><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pe1hhuo1j30sg0lc770.jpg" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/posts/0078bOVFgy1g0pe1hhuo1j30sg0lc770.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://segmentfault.com/a/1190000017558652">https://segmentfault.com/a/1190000017558652</a></p><p><a href="https://blog.csdn.net/weixin_34294649/article/details/87518937">https://blog.csdn.net/weixin_34294649/article/details/87518937</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Happy New Year !</title>
      <link href="2019/02/05/Happy-New-Year/"/>
      <url>2019/02/05/Happy-New-Year/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">C：printf(&quot;Happy New Year&quot;);</span><br><span class="line">C++ : cout&lt;&lt;&quot;Happy New Year&quot;;</span><br><span class="line">Objectivec: NSLog(@&quot;Happy New Year!&quot;);</span><br><span class="line">QBasic : Print &quot;Happy New Year&quot;</span><br><span class="line">Asp : Response.Write &quot;Happy New Year&quot;</span><br><span class="line">PHP : echo &quot;Happy New Year&quot;;</span><br><span class="line">Ruby: puts &quot;Happy New Year!&quot;</span><br><span class="line">JavaScript: alert(&quot;Happy New Year&quot;)</span><br><span class="line">VBScript:MsgBox &quot;Happy New Year&quot;</span><br><span class="line">JavaScript: document.write(&quot;Happy New Year&quot;)</span><br><span class="line">JavaScript: console.log(&#x27; Happy New Year&#x27;);</span><br><span class="line">xml &lt;TextView android:text=&quot;Happy New Year! &quot; /&gt;</span><br><span class="line">Delphi: ShowMessage(&#x27;Happy New Year！&#x27;);</span><br><span class="line">VB: Msg(&quot;Happy New Year！&quot;)</span><br><span class="line">VC: MessageBox(&quot;Happy New Year！&quot;);</span><br><span class="line">shell: echo Happy New Year</span><br><span class="line">perl: print &#x27;Happy New Year&#x27;</span><br><span class="line">java: System.out.println(&quot;Happy New Year&quot;);</span><br><span class="line">LISP:(format t &quot;Happy New Year!~%&quot;)</span><br><span class="line">powerBuilder:messagebox（&quot;Happy New Year&quot;)</span><br><span class="line">C#：System.Console.WriteLine(&quot;Happy New Year!&quot;)</span><br><span class="line">COBOL:DISPLAY &#x27;Happy New Year!&#x27;</span><br><span class="line">Python:print(&quot;Happy New Year！&quot;)</span><br><span class="line">aswing:JOptionPane.showMessageDialog(&quot;happy&quot;,&quot;Happy New Year！&quot;)</span><br><span class="line">flex:Alert.show(&quot;Happy New Year！&quot;);</span><br><span class="line">Clojure: (println &quot;Happy New Year&quot;)</span><br><span class="line">verilog/systemverilog/e $display(&quot;Happy New Year&quot;)</span><br><span class="line">as:trace(&quot;Happy New Year！&quot;);</span><br></pre></td></tr></table></figure><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=42909530&cid=75244190&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML&amp;&amp;CSS(划水~~~)</title>
      <link href="2019/01/22/HTML-CSS-%E5%88%92%E6%B0%B4/"/>
      <url>2019/01/22/HTML-CSS-%E5%88%92%E6%B0%B4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="HTML-超文本标记语言"><a href="#HTML-超文本标记语言" class="headerlink" title="HTML(超文本标记语言)"></a><a href="http://www.w3school.com.cn/html/index.asp">HTML</a>(超文本标记语言)</h1><p>HTML标签不区分大小写。</p><h2 id="HTML属性"><a href="#HTML属性" class="headerlink" title="HTML属性"></a>HTML属性</h2><ul><li>ID属性指定一个标识符，用于唯一标识页面元素，这些标识符主要供Javascript和CSS使用</li><li>class属性是一个全局属性，可用于建立元素编组。可以给多个元素指定相同的class属性，以便在CSS或Javascript中将这些元素作为一个编组来引用它们</li><li>style属性用于定义标签的样式。任何标签中都可以指定属性style。使用style属性可以为标签指定一个或多个样式规则，** 在style定义多条规则的方法是用分号将他们分开 **</li></ul><span id="more"></span><h2 id="HTML的列表"><a href="#HTML的列表" class="headerlink" title="HTML的列表"></a>HTML的列表</h2><p>列表标签的特征：</p><blockquote><ol><li>每个列表都有一个指定列表类型的外部元素。</li><li>每个列表项都有自己的标签。</li></ol></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">无序列表：<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">有序列表：<span class="tag">&lt;<span class="name">ol</span>&gt;</span><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">定义列表：<span class="tag">&lt;<span class="name">dl</span>&gt;</span><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">词汇列表的列表项为<span class="tag">&lt;<span class="name">dt</span>&gt;</span><span class="tag">&lt;<span class="name">dd</span>&gt;</span></span><br><span class="line">其他列表的列表项为<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="有序列表（ol）"><a href="#有序列表（ol）" class="headerlink" title="有序列表（ol）"></a>有序列表（ol）</h3><p>有序列表默认的编号为罗马数字，可以使用属性style指定列表的编号样式，使用CSS属性list-style-type进行修改</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">eg：</span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">style</span>=<span class="string">&quot;list-style-type: upper-roman&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>罗马假日<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>平凡的世界<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>封神榜<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>无间道<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><ol style="list-style-type: upper-roman">    <li>罗马假日</li>    <li>平凡的世界</li>    <li>封神榜</li>    <li>无间道</li></ol><p><strong><u>有序列表的编号样式</u></strong></p><table><thead><tr><th align="left">CSS属性list-style-type</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">decimal(默认)</td><td align="left">标准阿拉伯数字</td></tr><tr><td align="left">lower-alpha</td><td align="left">小写字母</td></tr><tr><td align="left">upper-alpha</td><td align="left">大写字母</td></tr><tr><td align="left">lower-roman</td><td align="left">小写罗马数字</td></tr><tr><td align="left">upper-roman</td><td align="left">大写罗马数字</td></tr></tbody></table><h3 id="无序列表（ul）"><a href="#无序列表（ul）" class="headerlink" title="无序列表（ul）"></a>无序列表（ul）</h3><p><strong><u>无序列表编号样式</u></strong></p><table><thead><tr><th align="left">CSS属性list-style-type</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">disc</td><td align="left">圆盘，默认样式</td></tr><tr><td align="left">square</td><td align="left">实心正方形</td></tr><tr><td align="left">circle</td><td align="left">空心圆</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eg：</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">style</span>=<span class="string">&quot;list-style-type: square&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>正方体<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>长方体<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>圆柱体<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><ul style="list-style-type: square">    <li>正方体</li>    <li>长方体</li>    <li>圆柱体</li></ul><h3 id="定义列表（dl）"><a href="#定义列表（dl）" class="headerlink" title="定义列表（dl）"></a>定义列表（dl）</h3><p>定义列表的每个列表项都包含两部分</p><ul><li>术语，标签为<code>&lt;dt&gt;</code></li><li>术语的定义，标签为<code>&lt;dt&gt;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>HTML<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>超文本标记语言，标准通用标记语言下的一个应用。是 网页制作必备的编程语言。<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>层叠样式表(英文全称：Cascading Style Sheets)是一种用来表现HTML（标准通用标记语言的一个应用）或XML（标准通用标记语言的一个子集）等文件样式的计算机语言。<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><dl>    <dt>HTML</dt>    <dd>超文本标记语言，标准通用标记语言下的一个应用。是 网页制作必备的编程语言。</dd>    <dt>CSS</dt>    <dd>层叠样式表(英文全称：Cascading Style Sheets)是一种用来表现HTML（标准通用标记语言的一个应用）或XML（标准通用标记语言的一个子集）等文件样式的计算机语言。</dd></dl><h2 id="链接和锚"><a href="#链接和锚" class="headerlink" title="链接和锚"></a>链接和锚</h2><h3 id="链接到另一个页面的特定位置"><a href="#链接到另一个页面的特定位置" class="headerlink" title="链接到另一个页面的特定位置"></a>链接到另一个页面的特定位置</h3><p>** 方法： 使用锚，即在链接的URL中指定要链接到的元素的ID **</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line"></span><br><span class="line">另一个页面2.html：</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">&quot;part4&quot;</span>&gt;</span>Part four<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">当前页面1.html：</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.html#part4&quot;</span>&gt;</span>go to part four<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="链接到当前页面的其他元素"><a href="#链接到当前页面的其他元素" class="headerlink" title="链接到当前页面的其他元素"></a>链接到当前页面的其他元素</h3><p>** 方法: 省略页面名就行，使用<code>#</code>号和<code>ID</code> **</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line">go to<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#section5&quot;</span>&gt;</span>the fifth setion<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="span标签"><a href="#span标签" class="headerlink" title="span标签"></a>span标签</h2><p>span标签和style属性结合使用时，可取代很多标签，效果很nice</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Here is some<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;text-decoration: underline&quot;</span>&gt;</span> underline text<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Here is some<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-style:oblique&quot;</span>&gt;</span> oblique text<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Here is some<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;text-decoration:line-through&quot;</span>&gt;</span>line-through text<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Here is some<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-weight:120&quot;</span>&gt;</span> bolder text<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Here is some<span style="text-decoration: underline"> underline text</span></p><p>Here is some<span style="font-style:oblique"> oblique text</span></p><p>Here is some<span style="text-decoration:line-through">line-through text</span></p><p>Here is some<span style="font-weight:120"> bolder text</span></p><h2 id="HTML表格"><a href="#HTML表格" class="headerlink" title="HTML表格"></a>HTML表格</h2><table><thead><tr><th align="left">标签</th><th align="left">用途</th></tr></thead><tbody><tr><td align="left">&lt;table&gt;&lt;/table&gt;</td><td align="left">定义表格</td></tr><tr><td align="left">&#60;caption&#62;&#60;/caption&#62;</td><td align="left">创建表题(可选)</td></tr><tr><td align="left">&#60;tr&#62;&#60;/tr&#62;</td><td align="left">定义一个表格行，其中可包含表头单元格或数据单元格</td></tr><tr><td align="left">&#60;th&#62;&#60;/th&#62;</td><td align="left">定义一个表头单元格。表头单元格得内容通常显示为粗体，且在水平和竖直方向上都居中</td></tr><tr><td align="left">&#60;td&#62;&#60;/td&#62;</td><td align="left">定义一个数据单元格。数据单元格得内容通常显示为常规字体，在水平方向上左对齐，而且在垂直方向上居中</td></tr><tr><td align="left">&#60;colgroup&#62;&#60;/colgroup&#62;</td><td align="left">将一列或多列编组</td></tr><tr><td align="left">&#60;col&#62;&#60;/col&#62;</td><td align="left">用于定义表格列属性</td></tr><tr><td align="left">&#60;thead&#62;&#60;/thead&#62;</td><td align="left">创建表示表头的行编组。一个表格只能有一个表头</td></tr><tr><td align="left">&#60;tfoot&#62;&#60;/tfoot&#62;</td><td align="left">创建表示表尾的行编组。一个表格只能有一个表尾，它必须在表体前定义</td></tr><tr><td align="left">&#60;tbody&#62;&#60;/tbody&#62;</td><td align="left">定义一个或多个表示表体的行编组。一个表格可包含多个表头部分</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Table<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">caption</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Science and Mathematic Class Schedules<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">colgroup</span> <span class="attr">style</span>=<span class="string">&quot;width: 20%; text-align: center; vertical-align: top; background-color: #fcf;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">colgroup</span> <span class="attr">span</span>=<span class="string">&quot;2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 40%; vertical-align: top; background-color: #ccf;&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- span属性指定了列编组包含的列数，默认为1 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span> <span class="attr">style</span>=<span class="string">&quot;background-color: red;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Class<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Room<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Time<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">style</span>=<span class="string">&quot;background-color: yellow;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Biology<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Science Wing, Room 102<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>8:00 AM to 9:45 AM<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Science<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Science Wing, Room 110<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>9:50 AM to 11:30 AM<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Physics<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Science Wing, Room 107<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>1:00 PM to 2:45 PM<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">style</span>=<span class="string">&quot;background-color: gray;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Geometry<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Mathematics Wing, Room 236<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>8:00 AM to 9:45 Am<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Algebra<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Mathematics Wing, Room 239<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>9:50 AM to 11:30 AM<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Trigonometry<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>Mathematics Wing, Room 245<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>1:00 PM to 2:45 PM<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- tfoot一般放在tbody之前 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tfoot</span> <span class="attr">style</span>=<span class="string">&quot;background-color: blue;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Class<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Room<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>Time<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/PWucSsn.png" class="lazyload" data-srcset="https://i.imgur.com/PWucSsn.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li>text-align：指定水平对齐方式，可能取值：left、center、right</li><li>vertical-align：指定垂直对齐方式，可能取值：top、middle、bottom</li></ul><h3 id="表格属性"><a href="#表格属性" class="headerlink" title="表格属性"></a>表格属性</h3><table><thead><tr><th align="left">属性</th><th align="left">适用元素</th><th align="left">用途</th></tr></thead><tbody><tr><td align="left">border</td><td align="left">table</td><td align="left">指定表格是否带边框，默认不带。这个属性指定了表格边框的宽度</td></tr><tr><td align="left">span</td><td align="left">col和colgroup</td><td align="left">指定列编组包含多少列，必须是大于0的整数</td></tr><tr><td align="left">colspan</td><td align="left">th或td</td><td align="left">指定单元格将向右延伸横跨多少列</td></tr><tr><td align="left">rowspan</td><td align="left">th或td</td><td align="left">指定单元格将向下延伸横跨多少行</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>colspan and rowspan<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;10&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">caption</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>跨行跨列表格<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 跨列 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>男<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>女<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 跨行 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">th</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>辣椒<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">td</span>&gt;</span>牛角椒<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>灯笼椒<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/KsbLpBt.png" class="lazyload" data-srcset="https://i.imgur.com/KsbLpBt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="HTML表单"><a href="#HTML表单" class="headerlink" title="HTML表单"></a>HTML表单</h2><table><thead><tr><th align="center">标签/属性</th><th align="left">用途</th></tr></thead><tbody><tr><td align="center">&#60;form&#62;</td><td align="left">创建HTML表单。一个文档可包含多个表单，但是不可嵌套</td></tr><tr><td align="center">action</td><td align="left">标签&#60;form&#62;的一个属性，使用URL路径指定负责处理表单数据的服务器脚本</td></tr><tr><td align="center">enctype</td><td align="left">&#60;form&#62;的一个属性，指定将表单数据发送给服务器前如何对其进行编码</td></tr><tr><td align="center">method</td><td align="left">&#60;form&#62;的一个属性，指定如何将表单数据发送给服务器</td></tr><tr><td align="center">&#60;input&#62;</td><td align="left">一个用于创建表单控件以收集用户输入的信息</td></tr><tr><td align="center">&#60;button&#62;</td><td align="left">创建一个可包含HTML内容的按钮</td></tr><tr><td align="center">&#60;textarea&#62;</td><td align="left">创建多行的文本输入字段</td></tr><tr><td align="center">&#60;select&#62;</td><td align="left">创建一个菜单或可滚动列表，列表项由&#60;option&#62;创建</td></tr><tr><td align="center">&#60;progress&#62;</td><td align="left">显示任务完成进度的进度条</td></tr><tr><td align="center">&#60;label&#62;</td><td align="left">创建与表单控件配套的标签</td></tr><tr><td align="center">&#60;fieldset&#62;</td><td align="left">将表单控件编组</td></tr><tr><td align="center">type</td><td align="left">标签&#60;input的一个属性&#62;，指定了表单控件的类型，可能取值：<br>text：创建一个单行文本输入字段<br>password：&ensp;创建一个可遮挡用户输入的单行文本输入字段<br>hidden：&ensp;创建一个隐藏的表单控件<br>checkbox：&ensp;创建一个复选框<br>search：&ensp;创建一个搜索关键字输入字段<br>file：&ensp;创建一个文件上传控件让用户能够选择要随表单数据一起上传到服务器的文件<br>color、date、datetime、email、url、reset等等</td></tr></tbody></table><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><table><thead><tr><th align="left">items</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">HTML语义标签</td><td align="left"><a href="http://www.w3school.com.cn/html/html5_semantic_elements.asp">http://www.w3school.com.cn/html/html5_semantic_elements.asp</a></td></tr><tr><td align="left">pre标签</td><td align="left"><a href="http://www.w3school.com.cn/tags/tag_pre.asp">http://www.w3school.com.cn/tags/tag_pre.asp</a></td></tr><tr><td align="left">HTML字符实体</td><td align="left"><a href="http://www.w3school.com.cn/html/html_entities.asp">http://www.w3school.com.cn/html/html_entities.asp</a></td></tr></tbody></table><hr/><h1 id="CSS-层叠样式表"><a href="#CSS-层叠样式表" class="headerlink" title="CSS(层叠样式表)"></a><a href="http://www.w3school.com.cn/css/css_jianjie.asp">CSS</a>(层叠样式表)</h1><p>样式表由一系列规则组成，大致结构如下</p><pre><code>selector &#123; property1: value1; property &#125;</code></pre><ul><li>每条规则都以选择器(selector)打头,后面是一系列有花括号括起来的属性(property)和值(value)。</li><li>每个选择器可以指定任意数量的属性,但属性之间必须用分号分隔。</li><li>在最后一个属性/值对后面,可以有分号,也可以没有。</li></ul><h2 id="选择器-selector"><a href="#选择器-selector" class="headerlink" title="选择器(selector)"></a>选择器(selector)</h2><blockquote><p>任何标签都可以用作CSS选择器，与这种选择器相关联的规则将应用于页面中所有指定的元素</p></blockquote><p>可使用单个选择器将样式应用于多种元素，元素间用逗号间隔，比如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>, <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面这个规则与上面那个等价</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="上下文选择器"><a href="#上下文选择器" class="headerlink" title="上下文选择器"></a>上下文选择器</h3><p>&ensp;&ensp;使用上下文选择器可以将样式应用于嵌套在指定元素内的元素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ol</span> <span class="selector-tag">em</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面那条规则应用于嵌套在有序列表中的em元素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cite</span> &#123; <span class="attribute">font-style</span>: inherit; <span class="attribute">font-weight</span>: <span class="number">200</span>;&#125;</span><br><span class="line"><span class="selector-tag">p</span> <span class="selector-tag">cite</span> &#123; <span class="attribute">font-style</span>: italic; <span class="attribute">font-weight</span>: <span class="number">500</span>;&#125;</span><br><span class="line"><span class="selector-tag">li</span> <span class="selector-tag">cite</span>&#123; <span class="attribute">font-style</span>: normal; <span class="attribute">font-weight</span>: bolder;&#125;</span><br></pre></td></tr></table></figure><p>第一条为应用于所有cite标签的规则<br>对于嵌套的cite标签，后两条规则说明了他们应该应用的样式</p><h3 id="类-amp-amp-ID-选择器"><a href="#类-amp-amp-ID-选择器" class="headerlink" title="类 &amp;&amp; ID 选择器"></a>类 &amp;&amp; ID 选择器</h3><ul><li>将选择器应用于类，使用<code>.</code>+<code>类名</code></li><li>将选择器应用于ID，使用<code>#</code>+<code>ID</code>，ID是独一无二的</li><li>给多个元素指定相同的样式可以使用类名，给单个元素指定样式可以使用ID</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用类型名 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shan&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- CSS --&gt;</span></span><br><span class="line">.shan &#123;</span><br><span class="line">    color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ------------------------------------ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用ID --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;footer&quot;</span>&gt;</span>Copyright 2019<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- CSS --&gt;</span></span><br><span class="line">#footer &#123;</span><br><span class="line">    font-size: small;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="子选择器"><a href="#子选择器" class="headerlink" title="子选择器"></a>子选择器</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &gt; <span class="selector-tag">span</span><span class="selector-class">.important</span> &#123; fot-weight: bold; &#125;</span><br></pre></td></tr></table></figure><p>这个选择器只与p标签，属于important类的span标签匹配,与下面的span标签不匹配</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a paragraph. <span class="tag">&lt;<span class="name">em</span>&gt;</span>This is an <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;important&quot;</span>&gt;</span>important<span class="tag">&lt;/<span class="name">span</span>&gt;</span> sentence.<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里的span为p的孙子</p><h3 id="伪类"><a href="#伪类" class="headerlink" title="伪类"></a>伪类</h3><p><a href="http://www.w3school.com.cn/css/css_pseudo_classes.asp">http://www.w3school.com.cn/css/css_pseudo_classes.asp</a></p><p>锚伪类</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span> &#123;<span class="attribute">color</span>: <span class="number">#FF0000</span>&#125;<span class="comment">/* 未访问的链接 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> &#123;<span class="attribute">color</span>: <span class="number">#00FF00</span>&#125;<span class="comment">/* 已访问的链接 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;<span class="attribute">color</span>: <span class="number">#FF00FF</span>&#125;<span class="comment">/* 鼠标移动到链接上 */</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;<span class="attribute">color</span>: <span class="number">#0000FF</span>&#125;<span class="comment">/* 选定的链接 */</span></span><br></pre></td></tr></table></figure><h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><blockquote><p><a href="http://www.w3school.com.cn/css/css_selector_descendant.asp">http://www.w3school.com.cn/css/css_selector_descendant.asp</a></p></blockquote><h2 id="CSS度量单位"><a href="#CSS度量单位" class="headerlink" title="CSS度量单位"></a>CSS度量单位</h2><blockquote><p><a href="http://www.w3school.com.cn/cssref/css_units.asp">http://www.w3school.com.cn/cssref/css_units.asp</a></p></blockquote><h2 id="CSS颜色"><a href="#CSS颜色" class="headerlink" title="CSS颜色"></a>CSS颜色</h2><blockquote><p><a href="http://www.w3school.com.cn/cssref/css_colors.asp">http://www.w3school.com.cn/cssref/css_colors.asp</a></p></blockquote><h2 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h2><p><img src="https://s2.ax1x.com/2019/01/22/kki3LT.gif" class="lazyload" data-srcset="https://s2.ax1x.com/2019/01/22/kki3LT.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="kki3LT.gif"></p><ul><li>element: 元素/内容</li><li>padding: 内边距</li><li>border: 边框</li><li>margin: 外边距</li></ul><h3 id="边框的属性"><a href="#边框的属性" class="headerlink" title="边框的属性"></a>边框的属性</h3><table><thead><tr><th align="left">属性</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">border-style</td><td align="left">指定显示的边框类型。可能取值包括：none、dotted、dashed、solid、double、groove、ridge、inset、outset、inherit。</td></tr><tr><td align="left">border-width</td><td align="left">指定边框的宽度，单位通常为像素(px)。</td></tr><tr><td align="left">border-color</td><td align="left">指定边框颜色。</td></tr></tbody></table><p>同时设置多个边框属性时，形式如下</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selector &#123; <span class="attribute">border</span>: style width color; &#125;</span><br></pre></td></tr></table></figure><p>eg:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &#123; <span class="attribute">border</span>: dashed <span class="number">3px</span> red; &#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/Bcl26OF.png" class="lazyload" data-srcset="https://i.imgur.com/Bcl26OF.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="内边距和外边距"><a href="#内边距和外边距" class="headerlink" title="内边距和外边距"></a>内边距和外边距</h3><ul><li>内边距(padding)是边框里面的空白区域</li><li>外边距(margin)是边框外面的空白区域</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-class">.outer</span> &#123; <span class="attribute">border</span>: <span class="number">2px</span> solid black; &#125;</span></span><br><span class="line"><span class="css">        <span class="selector-class">.inner</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">border</span>: <span class="number">2px</span> dotted black;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    工程狮</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span></span><br><span class="line">            攻城狮（谐音）工程师，来源于腾讯QQ手机管家于2012年3月1日16:53在发布了一条微博：<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">            声称腾讯公司一名保安经过一层层技术面试进入了腾讯研究院，成为一名攻城狮（工程师）。<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">            这种事儿看起来相信很多人的第一反应都是恶搞，不过不久，腾讯老大马化腾亲自出面，核实了这一事件的真实性，并且称这是个“很励志的故事”。<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/w4RwOST.png" class="lazyload" data-srcset="https://i.imgur.com/w4RwOST.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="内容-element-盒子"><a href="#内容-element-盒子" class="headerlink" title="内容(element)盒子"></a>内容(element)盒子</h3><ul><li>块式盒子</li><li>内嵌盒子</li></ul><p>块级元素前后都换行，而内嵌元素的尺寸取决于其包含的内容以及外边距、内边距和边框的设置。CSS提供了属性<code>display</code>来修改元素的默认行为，属性display的可能取值有三个:block、inline和none。</p><p><img src="https://i.imgur.com/QAAOmAT.png" class="lazyload" data-srcset="https://i.imgur.com/QAAOmAT.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>边框显示了在样式表中指定的盒子的尺寸。但文本太多的时候，盒子可能无法容纳，多出来的文本可能会跑到边框的下方。这时，可以通过CSS属性<code>overflow</code>告诉浏览器要如何做。overflow的可能取值包括:visible(默认)、hidden、scroll、auto和inherit。</p><p><img src="https://i.imgur.com/O07gEYV.png" class="lazyload" data-srcset="https://i.imgur.com/O07gEYV.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/sqVTUKQ.png" class="lazyload" data-srcset="https://i.imgur.com/sqVTUKQ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="浮动（修改块级元素的排列方式）"><a href="#浮动（修改块级元素的排列方式）" class="headerlink" title="浮动（修改块级元素的排列方式）"></a>浮动（修改块级元素的排列方式）</h3><ul><li>属性float，指出浮动位置，取值：right、left、none</li><li>属性clear，消除浮动的影响，取值：none、left、right、both</li></ul><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="html,result" data-user="yeshan333" data-slug-hash="BMaWem" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1em 0; padding: 1em;" data-pen-title="1">  <span>See the Pen <a href="https://codepen.io/yeshan333/pen/BMaWem/">  1</a> by Mr.Ye (<a href="https://codepen.io/yeshan333">@yeshan333</a>)  on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://static.codepen.io/assets/embed/ei.js"></script><p><img src="https://i.imgur.com/g69xTsU.png" class="lazyload" data-srcset="https://i.imgur.com/g69xTsU.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>&ensp;&ensp;浮动的p元素移到了页面右边，而第二个段落出现在它的左边。通过将属于right类的元素p的样式属性float设置为right，指出了页面其他元素应沿元素绕排。我们将第三个段落的clear属性设置为both，消除了前面浮动的影响。</p><p>如果想要将第二段浮动到第一段的下方，可设置第二段的属性float为right，属性clear设置为right。仅仅设置float属性时，两个段落会并排。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">3px</span> solid black;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">clear</span>: right;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">33%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/OjShnIP.png" class="lazyload" data-srcset="https://i.imgur.com/OjShnIP.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p>]]></content>
      
      
      <categories>
          
          <category> HTML </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你所拥有的知识并不取决于你记得多少，而在于它们能否在恰当的时候被回忆起来。</title>
      <link href="2019/01/16/%E4%BD%A0%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%9F%A5%E8%AF%86%E5%B9%B6%E4%B8%8D%E5%8F%96%E5%86%B3%E4%BA%8E%E4%BD%A0%E8%AE%B0%E5%BE%97%E5%A4%9A%E5%B0%91%EF%BC%8C%E8%80%8C%E5%9C%A8%E4%BA%8E%E5%AE%83%E4%BB%AC%E8%83%BD%E5%90%A6%E5%9C%A8%E6%81%B0%E5%BD%93%E7%9A%84%E6%97%B6%E5%80%99%E8%A2%AB%E5%9B%9E%E5%BF%86%E8%B5%B7%E6%9D%A5%E3%80%82/"/>
      <url>2019/01/16/%E4%BD%A0%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E7%9F%A5%E8%AF%86%E5%B9%B6%E4%B8%8D%E5%8F%96%E5%86%B3%E4%BA%8E%E4%BD%A0%E8%AE%B0%E5%BE%97%E5%A4%9A%E5%B0%91%EF%BC%8C%E8%80%8C%E5%9C%A8%E4%BA%8E%E5%AE%83%E4%BB%AC%E8%83%BD%E5%90%A6%E5%9C%A8%E6%81%B0%E5%BD%93%E7%9A%84%E6%97%B6%E5%80%99%E8%A2%AB%E5%9B%9E%E5%BF%86%E8%B5%B7%E6%9D%A5%E3%80%82/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id=""><a href="#" class="headerlink" title=""></a></h1><span id="more"></span><hr>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jinja2语法小记</title>
      <link href="2019/01/09/Jinja2%E8%AF%AD%E6%B3%95%E5%B0%8F%E8%AE%B0/"/>
      <url>2019/01/09/Jinja2%E8%AF%AD%E6%B3%95%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="jinja2模板语法小记"><a href="#jinja2模板语法小记" class="headerlink" title="jinja2模板语法小记"></a>jinja2模板语法小记</h1><blockquote><p><a href="http://docs.jinkan.org/docs/jinja2/templates.html">Jinja2模板中文文档</a></p></blockquote><h2 id="三种常见界定符"><a href="#三种常见界定符" class="headerlink" title="三种常见界定符"></a>三种常见界定符</h2><ol><li>表达式<br>{{ ... }}</li></ol><p>用于装载字符串、变量、函数调用等</p><ol start="2"><li>语句<br>{% ... %}</li></ol><p>用于装载控制语句，比如if判断、for循环等</p><ol start="3"><li>注释<br>{# ... #}</li></ol><p>用于装载一个注释，模板渲染的时候会被忽略掉</p><span id="more"></span><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><ol><li>在模板中，我们可以使用“**.**”获取变量的属性</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user = &#123;</span><br><span class="line"><span class="string">&#x27;username&#x27;</span> : <span class="string">&#x27;shansan&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;bio&#x27;</span>: <span class="string">&#x27;我佛了&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果user为传入模板中的字典变量，则我们可通过”<strong>.</strong>“获取它的键值。<br>eg：<em><strong>user.username</strong></em><br>user.username等价于user[‘username’]</p><ol start="2"><li>我们可以用<strong>set</strong>标签在模板中定义变量</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set navigation = [(&#x27;/&#x27;,&#x27;Home&#x27;),(&#x27;/about&#x27;,&#x27;关于我&#x27;)] %&#125;</span><br></pre></td></tr></table></figure><p>使用<strong>endset</strong>声明结束</p><h1 id="过滤器-filter"><a href="#过滤器-filter" class="headerlink" title="过滤器(filter)"></a>过滤器(filter)</h1><blockquote><p>过滤器(filter)是一些可以用来修改和过滤特殊变量值的函数。<br>过滤器和变量用一个竖线“**|**”（管道符号）隔开，需要参数的过滤器可以像函数一样使用括号传递</p></blockquote><p>eg: 对一个movies列表使用length过滤器获取其长度</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">movies|length</span><br></pre></td></tr></table></figure><blockquote><p>下面是Jinja2常用的内置过滤器</p></blockquote><table><thead><tr><th align="center">过滤器</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">default(value,default_value,boolean=False)</td><td align="center">设置默认值，默认值作为参数传入，别名为d</td></tr><tr><td align="center">escap(s)</td><td align="center">转义HTML文本，别名为e</td></tr><tr><td align="center">first(seq)</td><td align="center">返回序列的第一个元素</td></tr><tr><td align="center">last(seq)</td><td align="center">返回列表的最后一个元素</td></tr><tr><td align="center">length(object)</td><td align="center">返回变量的长度</td></tr><tr><td align="center">safe(value)</td><td align="center">将变量标记为安全，避免转义</td></tr><tr><td align="center">wordcount(s)</td><td align="center">计算单词数量</td></tr></tbody></table><p>过滤器函数的第一个参数表示被过滤的变量值(value)或字符串(s)，<strong>即竖线符号左侧的值</strong>其他参数可以使用括号传入</p><h1 id="测试器-Test"><a href="#测试器-Test" class="headerlink" title="测试器(Test)"></a>测试器(Test)</h1><blockquote><p>测试器主要用来判断一个值是否满足某种变量类型,返回布尔值（True or False）的特殊函数<br>语法为：<strong>if…is…</strong></p></blockquote><ul><li>is的左侧是测试器函数的第一个参数(value)</li><li>其他参数可以通过添加括号传入，也可以在右侧使用空格连接</li></ul><blockquote><p>Jinja2常用内置测试器</p></blockquote><table><thead><tr><th align="center">测试器</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">callable(object)</td><td align="center">判断对象是否可调用</td></tr><tr><td align="center">defined(value)</td><td align="center">判断变量是否已定义</td></tr><tr><td align="center">none(value)</td><td align="center">判断变量是否为None</td></tr><tr><td align="center">number(value)</td><td align="center">判断变量是否为数字</td></tr><tr><td align="center">string(value)</td><td align="center">判断变量是否为字符串</td></tr><tr><td align="center">sequence(value)</td><td align="center">判断变量是否为序列，比如字符串、列表、元组</td></tr><tr><td align="center">iterable(value)</td><td align="center">判断变量是否可迭代</td></tr><tr><td align="center">mapping(value)</td><td align="center">判断变量是否是匹配对象，比如字典</td></tr><tr><td align="center">smeas(value,other)</td><td align="center">判断变量与other是否指向相同的内存地址</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if foo is smeas(bar) %&#125;</span><br><span class="line">&#123;# 等价于 #&#125;</span><br><span class="line">&#123;% if foo is smeas bar %&#125;</span><br></pre></td></tr></table></figure><p>判断foo和bar所以指向的内存地址是否相同</p><h1 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h1><blockquote><p>在Jinja2中，语句使用**{% ... %}**标识<br>在语句结束的地方，必须添加结束标签</p></blockquote><ul><li>if语句使用endif</li><li>for语句使用endfor</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if user.name == &#x27;shansan&#x27; %&#125;</span><br><span class="line">    &lt;h1&gt;you are right!&lt;/h1&gt;</span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">    &lt;h1&gt;you are wrong!&lt;/h1&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for g in ga %&#125;</span><br><span class="line">    &lt;li&gt;&#123;&#123; g.name &#125;&#125; - &#123;&#123; g.year &#125;&#125;&lt;/li&gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><em><strong>不可使用break和continue控制循环的执行</strong></em></p><h1 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h1><h2 id="局部模板"><a href="#局部模板" class="headerlink" title="局部模板"></a>局部模板</h2><ul><li>当多个独立模板中使用到同一块HTML代码时，可以把这部分代码抽离出来，放到局部模板中</li><li>局部模板的命名一般以一个下划线开始</li><li>使用<strong>include</strong>标签插入一个局部模板</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include &#x27;_banner.html&#x27; %&#125;</span><br></pre></td></tr></table></figure><h2 id="宏"><a href="#宏" class="headerlink" title="宏"></a>宏</h2><ul><li>宏，类似于Python中的函数。使用宏可以封装一部分模板代码</li><li>一般把宏寄存在即存在名为macros.html或_macros.html文件中</li><li>使用macro和endmacro标签声明宏的开始和结束</li><li>在开始标签中定义宏的名称和接收的参数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% macro qux(amount=1) %&#125;</span><br><span class="line">    &#123;% if amount==1 %&#125;</span><br><span class="line">        I am qux.</span><br><span class="line">    &#123;% elif amount&gt;1 %&#125;</span><br><span class="line">        We are qux.</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endmacro %&#125;</span><br></pre></td></tr></table></figure><p>就像从Python模块中导入函数一样，我们可以使用import导入宏</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% from &#x27;macros.html&#x27; import qux %&#125;</span><br></pre></td></tr></table></figure><p>PS:<font color="red">默认情况下，使用include导入一个局部模板会传递上下文到局部模板中，但使用import却不会</font></p><h2 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h2><blockquote><p>模板继承允许我们构建一个包含站点共同元素的基本模板”骨架”，并定义子模版可以覆盖的块</p></blockquote><ol><li>基模板 base.html</li></ol><p>** 在基模板中定义的块（block），可以让子模版通过定义同名的块来执行继承操作 **</p><p><u>块的开始和结束分别使用block和endblock标签,不同的块允许嵌套</u><br><u>以下示例代码中使用head、title、styles、content、footer和scripts划分了不同的标签块</u></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">&#123;% block head %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;% block title %&#125;Template - HelloFlask&#123;% endblock %&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    &#123;% block styles %&#125;&#123;% endblock styles %&#125;</span><br><span class="line">&#123;% endblock head %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;index&#x27;) &#125;&#125;&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    &#123;% block content %&#125;&#123;% endblock content %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    &#123;% block footer %&#125;</span><br><span class="line">        &#123;% endblock footer %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">    &#123;% block scripts %&#125;&#123;% endblock scripts %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>子模版 index.html</li></ol><ul><li>当在子模版创建同名的块时，会使用字块的内容覆盖父块的内容</li><li>这里子模版的content块的内容覆盖了基模板content块的内容</li><li><font color=red>extends 标签必须是模板中的第一个 标签</font></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;base.html&#x27; %&#125;</span><br><span class="line">&#123;% from &#x27;macros.html&#x27; import qux %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">&#123;% set name=&#x27;baz&#x27; %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Template<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;watchlist&#x27;) &#125;&#125;&quot;</span>&gt;</span>Watchlist<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Filter: &#123;&#123; foo|musical &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Global: &#123;&#123; bar() &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Test: &#123;% if name == &#x27;baz&#x27; %&#125;I am baz.&#123;% endif %&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Macro: &#123;&#123; qux(amount=5) &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">&#123;% endblock content %&#125;</span><br></pre></td></tr></table></figure><p>*** 如需要向基模板中追加内容，可以使用Jinja2的super()函数 ***</p><p>如向基模板的styles块追加一行样式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block styles %&#125;</span><br><span class="line">&#123;&#123; super() &#125;&#125;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    html&#123;</span><br><span class="line">        color: red;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><hr><p>参考：</p><ul><li><p><a href="https://book.douban.com/subject/30310340/">https://book.douban.com/subject/30310340/</a></p></li><li><p><a href="https://www.cnblogs.com/yanzi-meng/p/8342798.html">https://www.cnblogs.com/yanzi-meng/p/8342798.html</a></p></li><li><p><a href="http://docs.jinkan.org/docs/jinja2/templates.html#id21">http://docs.jinkan.org/docs/jinja2/templates.html#id21</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Flask </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>泛型算法-1</title>
      <link href="2019/01/03/%E6%B3%9B%E5%9E%8B%E7%AE%97%E6%B3%95-1/"/>
      <url>2019/01/03/%E6%B3%9B%E5%9E%8B%E7%AE%97%E6%B3%95-1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="泛型算法-1"><a href="#泛型算法-1" class="headerlink" title="泛型算法-1"></a>泛型算法-1</h1><blockquote><p>泛型算法实现了一些经典算法的公共接口，如排序和搜索；称它们是“泛型的”，是因为它们可以用于不同类型的元素的和多种容器类型（不仅包括标准库类型，还包括内置的数组类型），以及其它类型的序列。</p></blockquote><p>** 大多数算法都定义在头文件algorithm中 **</p><p><font color="red">算法永远不会执行容器的操作</font></p><span id="more"></span><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*算法find*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- find将范围内中的所有元素与给定值进行比较，返回指向第一个等于给定值的迭代器</span></span><br><span class="line"><span class="comment">- 如果范围内无匹配元素，则find返回第二个参数来表示搜索失败</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find_value</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//find函数的返回值类型是迭代器类型</span></span><br><span class="line"><span class="comment">//在vector中查找值</span></span><br><span class="line"><span class="keyword">int</span> val = <span class="number">7</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> result = find(v.begin(),v.end(),val);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;*result&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在数组中查找值</span></span><br><span class="line"><span class="keyword">int</span> nums[<span class="number">10</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> search = find(begin(nums),end(nums),<span class="number">11</span>);<span class="comment">//值不存在，返回尾后迭代器</span></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;*search&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*算法count*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 返回给定值在序列中出现的次数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">value_count</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//count函数返回给定值在序列中出现的次数</span></span><br><span class="line"><span class="keyword">int</span> a[]=&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> c = count(a,a+<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;1出现的次数:&quot;</span>&lt;&lt;c&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*算法accumulate*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- accumulate将第三个参数作为求和起点</span></span><br><span class="line"><span class="comment">- 注意序列中的元素的类型必须与第三个参数匹配</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sum_num</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//accumulate函数用去求给定元素范围内元素的和</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> sum = accumulate(v.begin(),v.end(),<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v_compare&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( equal(v.begin(),v.end(),v_compare.begin()) )</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;yeah&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;sum&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*算法fill*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 用于确定两个序列中是否保存相同的值</span></span><br><span class="line"><span class="comment">- 第二个序列至少与第一个序列一样长</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_fill</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line">fill(v.begin(),v.end(),<span class="number">1</span>);<span class="comment">//不要对空容器使用此操作</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> a:v)</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;a&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">elimDups</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &amp;words)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; v)</span></span>;</span><br><span class="line">sort(words.begin(),words.end());</span><br><span class="line"><span class="comment">//使用sort算法按字典序重排序列</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//unique重排了输入范围，使得每个单词只出现一次，</span></span><br><span class="line"><span class="comment">//unique返回指向不重复区域之后一个位置的迭代器</span></span><br><span class="line"><span class="keyword">auto</span> end_unique = unique(words.begin(),words.end());</span><br><span class="line"><span class="comment">//删除重复元素</span></span><br><span class="line">words.erase(end_unique,words.end());</span><br><span class="line">print(words);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> a:v)</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;a&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定制操作，按照长度重新排vector</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isShorter</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1,<span class="keyword">const</span> <span class="built_in">string</span> &amp;s2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s1.size() &gt; s2.size();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//按长度进行排序</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">length_sort</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &amp;words)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sort(words.begin(),words.end(),isShorter);</span><br><span class="line">print(words);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用算法stable_sort来保持等长元素间的字典序</span></span><br><span class="line">    stable_sort(v.begin(),v.end(),isShorter);</span><br><span class="line">print(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="向算法传递函数"><a href="#向算法传递函数" class="headerlink" title="向算法传递函数"></a>向算法传递函数</h2><h3 id="算法谓词"><a href="#算法谓词" class="headerlink" title="算法谓词"></a>算法谓词</h3><ul><li>算法谓词即标准库算法传递的参数, 可以指定算法的操作，它是一个可以调用的表达式，其返回结果是一个能用作条件的值</li><li>接受谓词参数的算法对输入序列中的元素调用谓词。因此元素类型必须能转换成谓词的参数类型</li></ul><blockquote><p>标准库算法所使用的谓词分为两类：<br>1.一元谓词：它们只接受一个参数<br>2.二元谓词：它们接受两个参数</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定制操作，按照长度重新排vector</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isShorter</span><span class="params">(<span class="keyword">const</span> string &amp;s1,<span class="keyword">const</span> string &amp;s2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s1.<span class="built_in">size</span>() &gt; s2.<span class="built_in">size</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//按长度进行排序</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">length_sort</span><span class="params">(vector&lt;string&gt; &amp;words)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>(),isShorter);</span><br><span class="line"><span class="built_in">print</span>(words);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用算法stable_sort来保持等长元素间的字典序</span></span><br><span class="line">    <span class="built_in">stable_sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),isShorter);</span><br><span class="line"><span class="built_in">print</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里向算法stable_sort传递的第三个参数就是一个谓词</p><h2 id="lambda表达式（匿名函数）"><a href="#lambda表达式（匿名函数）" class="headerlink" title="lambda表达式（匿名函数）"></a>lambda表达式（匿名函数）</h2><blockquote><p>lambda表达式与其它函数的区别是：lambda表达式可定义在函数内部</p></blockquote><p>基本形式：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[capture lsit](parameter list)  -&gt;  <span class="keyword">return</span> type &#123;function body&#125;</span><br></pre></td></tr></table></figure><ul><li>capture list(捕获列表): 一个lambda所在函数中的定义的局部变量的列表（通常为空）</li><li>parameter list(参数列表)</li><li>return type(返回类型)</li><li>function body(函数体)</li></ul><p>** 我们可以忽略形参列表和返回类型，但是必须永远包含捕获列表和函数体 **</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">auto</span> f = []&#123;<span class="keyword">return</span> <span class="number">44</span>;&#125; ;</span><br><span class="line">cout&lt;&lt;<span class="built_in">f</span>()&lt;&lt;endl;<span class="comment">//打印44</span></span><br></pre></td></tr></table></figure><p>上面的向算法stable_sort传递的实参可以改写为,效果还是一样的</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stable_sort</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), [](<span class="keyword">const</span> string &amp;a,<span class="keyword">const</span> string s&amp;b)&#123;<span class="keyword">return</span> a.<span class="built_in">size</span>()&lt;b.<span class="built_in">size</span>()&#125;);</span><br></pre></td></tr></table></figure><h3 id="捕获列表的使用"><a href="#捕获列表的使用" class="headerlink" title="捕获列表的使用"></a>捕获列表的使用</h3><p>一个lambda可以出现在一个函数内部，使用其局部变量，但它只能使用那些指明的变量。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">biggies</span><span class="params">(vector&lt;string&gt; &amp;words,vector&lt;string&gt;::size_type sz)</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用sort算法按字典序重排序列 s</span></span><br><span class="line"><span class="built_in">sort</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">//unique重排了输入范围，使得每个单词只出现一次，</span></span><br><span class="line"><span class="comment">//unique返回指向不重复区域之后一个位置的迭代器</span></span><br><span class="line"><span class="keyword">auto</span> end_unique = <span class="built_in">unique</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">//删除重复元素</span></span><br><span class="line">words.<span class="built_in">erase</span>(end_unique,words.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">//按长度排序,长度相同的按字典序排</span></span><br><span class="line"><span class="built_in">stable_sort</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>(),</span><br><span class="line">[](<span class="keyword">const</span> string &amp;a,<span class="keyword">const</span> string &amp;b)&#123;<span class="keyword">return</span> a.<span class="built_in">size</span>() &lt; b.<span class="built_in">size</span>();&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//算法find_if返回一个迭代器，这个迭代器指向第一个满足size()&gt;=sz的元素</span></span><br><span class="line"><span class="comment">//这里用到了捕获列表，使用局部变量sz</span></span><br><span class="line"><span class="keyword">auto</span> wc = <span class="built_in">find_if</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>(),</span><br><span class="line">[sz](<span class="keyword">const</span> string &amp;a)&#123;<span class="keyword">return</span> a.<span class="built_in">size</span>()&gt;sz; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算满足size &gt;= sz 的元素的个数</span></span><br><span class="line"><span class="keyword">auto</span> count = words.<span class="built_in">end</span>() - wc;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the numbers of word longer than &quot;</span>&lt;&lt;sz&lt;&lt;<span class="string">&quot;: &quot;</span>&lt;&lt;count&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印长度大于等于给定值sz的单词</span></span><br><span class="line"><span class="comment">//算法for_earch接受一个可调用对象，并对输入序列中的每个元素调用此对象</span></span><br><span class="line">for_each(wc,words.<span class="built_in">end</span>(),[](<span class="keyword">const</span> string &amp;s)&#123; cout&lt;&lt;s&lt;&lt;<span class="string">&quot; &quot;</span>; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;string&gt; words;</span><br><span class="line">string str;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;str)</span><br><span class="line">    words.<span class="built_in">push_back</span>(str);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> a:words)</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">biggies</span>(words,<span class="number">6</span>);<span class="comment">//打印长度大于或等于给定值的单词</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/7Ldocia.png" class="lazyload" data-srcset="https://i.imgur.com/7Ldocia.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>** 捕获列表只用于局部非静态（static）变量，lambda可以直接使用局部static变量和在它所在函数之外声明的名字 **</p><h3 id="lambada捕获和返回"><a href="#lambada捕获和返回" class="headerlink" title="lambada捕获和返回"></a>lambada捕获和返回</h3><ul><li>变量的捕获方式有两种:值捕获、引用捕获</li><li>使用引用捕获变量时，必须确保被引用的对象在lambda执行的时候是存在的</li><li>lambda捕获的是局部变量，这些变量在函数结束后就不复存在了</li></ul><blockquote><p>我们可以从一个函数返回lambda，函数可以直接返回一个可调用对象，或者返回一个类对象，该类含有可调用对象的数据成员。如果函数返回一个lambda，则与函数不能返回一个局部变量类似，此lambda也不能包含引用捕获</p></blockquote><h4 id="使用-amp-、-进行隐式捕获"><a href="#使用-amp-、-进行隐式捕获" class="headerlink" title="使用***&amp;、=***进行隐式捕获"></a>使用***&amp;<em><strong>、</strong></em>=***进行隐式捕获</h4><p>我们可以让编译器根据lambda体中的代码来推断我们要使用哪些变量</p><ul><li>**&amp;**告诉编译器采用引用捕获方式</li><li>**=**告诉编译器采用值捕获方式</li></ul><p><font color="blue">混合使用显式捕获和隐式捕获时,显示捕获必须使用与隐式捕获不同的方式</font></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">biggies</span><span class="params">(vector&lt;string&gt; &amp;words, ostream &amp;os=cout, <span class="keyword">char</span> c=<span class="string">&#x27; &#x27;</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//os隐式捕获，c显式捕获</span></span><br><span class="line">    for_each(words.<span class="built_in">begin</span>(), words.<span class="built_in">end</span>(), [&amp;, c](<span class="keyword">const</span> string &amp;s)&#123; os&lt;&lt;s&lt;&lt;c;&#125; );</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//c隐式捕获，os显示捕获</span></span><br><span class="line">for_each(words.<span class="built_in">begin</span>(), words.<span class="built_in">end</span>(), [=, &amp;os](<span class="keyword">const</span> string &amp;s)&#123; os&lt;&lt;s&lt;&lt;c;&#125; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;string&gt; str;</span><br><span class="line">string temp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;temp)</span><br><span class="line">    str.<span class="built_in">push_back</span>(temp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">biggies</span>(str);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/blhDe01.png" class="lazyload" data-srcset="https://i.imgur.com/blhDe01.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h4 id="指定lambda的返回类型"><a href="#指定lambda的返回类型" class="headerlink" title="指定lambda的返回类型"></a>指定lambda的返回类型</h4><ul><li>要为一个lambda定义返回类型时，必须使用尾置返回类型</li><li>尾置返回类型跟在形参列表后面，并以一个<code>-&gt;</code>符号开头</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> f = [](<span class="keyword">int</span> i)-&gt;<span class="keyword">int</span>&#123; <span class="keyword">return</span> i+<span class="number">1</span>;&#125;;</span><br><span class="line">cout&lt;&lt;<span class="built_in">f</span>(<span class="number">3</span>)&lt;&lt;endl;<span class="comment">//输出结果为：4</span></span><br></pre></td></tr></table></figure><h4 id="可变lambada"><a href="#可变lambada" class="headerlink" title="可变lambada"></a>可变lambada</h4><p>使用关键字<code>mutable</code>改变一个被捕获变量的值</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">auto</span> f = [i]()<span class="keyword">mutable</span>&#123; <span class="keyword">return</span> ++i;&#125;;</span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line">cout&lt;&lt;<span class="built_in">f</span>();<span class="comment">//输出结果为2</span></span><br></pre></td></tr></table></figure><h4 id="lambda捕获列表"><a href="#lambda捕获列表" class="headerlink" title="lambda捕获列表"></a>lambda捕获列表</h4><table><thead><tr><th align="center">&ensp;</th><th align="left">说明</th></tr></thead><tbody><tr><td align="center">[]</td><td align="left">空捕获列表。lambda不能使用所在函数中的变量。一个lambda只有捕获变量后才能使用它们</td></tr><tr><td align="center">[names]</td><td align="left">names是一个逗号分隔的名字列表，这些名字都是lambda所在函数的局部变量。默认情况下，捕获列表中的变量都被拷贝</td></tr><tr><td align="center">[&amp;]</td><td align="left">隐式捕获列表，采用隐式捕获方式</td></tr><tr><td align="center">[=]</td><td align="left">隐式捕获列表，采用值捕获方式</td></tr><tr><td align="center">[&amp;, identifier_list]</td><td align="left">identifier_list是一个逗号分隔的列表，包含0个或多个来自所在函数的变量，这些变量采用值捕获方式。任何隐式捕获的变量都采用引用方式捕获</td></tr><tr><td align="center">[=, identifier_list]</td><td align="left">identifier_list是一个逗号分隔的列表，包含0个或多个来自所在函数的变量，这些变量采用引用捕获方式，且变量名字前必须使用&amp;。任何隐式捕获的变量都采用值方式捕获</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>装饰器--python</title>
      <link href="2019/01/03/%E8%A3%85%E9%A5%B0%E5%99%A8-python/"/>
      <url>2019/01/03/%E8%A3%85%E9%A5%B0%E5%99%A8-python/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="python装饰器回顾"><a href="#python装饰器回顾" class="headerlink" title="python装饰器回顾"></a>python装饰器回顾</h1><h2 id="返回函数"><a href="#返回函数" class="headerlink" title="返回函数"></a>返回函数</h2><p><img src="https://i.loli.net/2020/03/18/8MoeVXiUTxZzBEc.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/18/8MoeVXiUTxZzBEc.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="返回函数"></p><span id="more"></span><h2 id="什么是装饰器"><a href="#什么是装饰器" class="headerlink" title="什么是装饰器"></a>什么是装饰器</h2><blockquote><p>python装饰器就是用于拓展原来函数功能的一种函数，目的是在不改变原函数定义的情况下，给函数增加新的功能。<br>这个函数的特殊之处在于它的返回值也是一个函数，这个函数是内嵌“原”函数的函数</p></blockquote><p>在代码运行期间动态的增加功能<br>装饰器(decorator)是修改其它函数功能的函数,是返回函数的高阶函数</p><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">- 这是一个decorator</span></span><br><span class="line"><span class="string">- 使用一个函数作为参数</span></span><br><span class="line"><span class="string">- 它返回一个函数</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_new_decorator</span>(<span class="params">a_func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapTheFunction</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work before executing a_func()&quot;</span>)</span><br><span class="line">    a_func()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work after executing a_func()&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> wrapTheFunction</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">- 使用a_new_decorator装饰a_function_requiring_decoration</span><br><span class="line">- @a_new_decorator 等价于 a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@a_new_decorator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_function_requiring_decoration</span>():</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I am the function which needs some decoration remove my foul smell&quot;</span>)</span><br><span class="line"></span><br><span class="line">a_function_requiring_decoration()</span><br></pre></td></tr></table></figure><p>运行结果<br><img src="https://s2.ax1x.com/2019/01/02/FIyq7F.png" class="lazyload" data-srcset="https://s2.ax1x.com/2019/01/02/FIyq7F.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="red">@a_new_decorator 等价于 a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</font></p><p><strong>下面这段程序和上面那段等价</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_new_decorator</span>(<span class="params">a_func</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapTheFunction</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work before executing a_func()&quot;</span>)</span><br><span class="line"></span><br><span class="line">        a_func()</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am doing some boring work after executing a_func()&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapTheFunction</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_function_requiring_decoration</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am the function which needs some decoration to remove my foul smell&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#a_function_requiring_decoration()</span></span><br><span class="line"><span class="comment">#outputs: &quot;I am the function which needs some decoration to remove my foul smell&quot;</span></span><br><span class="line"></span><br><span class="line">a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</span><br><span class="line"><span class="comment">#now a_function_requiring_decoration is wrapped by wrapTheFunction()</span></span><br><span class="line"></span><br><span class="line">a_function_requiring_decoration()</span><br><span class="line"><span class="comment">#outputs:I am doing some boring work before executing a_func()</span></span><br><span class="line"><span class="comment">#        I am the function which needs some decoration to remove my foul smell</span></span><br><span class="line"><span class="comment">#        I am doing some boring work after executing a_func()</span></span><br></pre></td></tr></table></figure><h3 id="应用：日志打印"><a href="#应用：日志打印" class="headerlink" title="应用：日志打印"></a>应用：日志打印</h3><p><img src="https://i.loli.net/2020/03/18/3glkurdZaIXUVWS.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/18/3glkurdZaIXUVWS.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="日志打印"></p><p>在wrap函数内，首先打印日志，再调用原始函数*args表示任何多个无名参数，它是一个tuple；**kwargs表示关键字参数，它是一个dict</p><h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p>对于上面的demo</p><pre><code>&gt;&gt;&gt;print(a_function_requiring_decoration.__name__)#输出结果为wrapTheFunction</code></pre><p>明显不是我们想要的，我们函数的名字和注释文档被重写了<br>预期应该为<br>    a_function_requiring_decoration</p><p>使用functools.warps可以解决这个问题</p><p>上面的demo应该这样写</p><p><img src="https://i.loli.net/2020/03/18/GjVxNM2FoZn17DH.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/18/GjVxNM2FoZn17DH.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo改写"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="http://www.runoob.com/w3cnote/python-func-decorators.html">http://www.runoob.com/w3cnote/python-func-decorators.html</a></p></li><li><p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014318435599930270c0381a3b44db991cd6d858064ac0000">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014318435599930270c0381a3b44db991cd6d858064ac0000</a></p></li><li><p><a href="https://eastlakeside.gitbooks.io/interpy-zh/content/decorators/">https://eastlakeside.gitbooks.io/interpy-zh/content/decorators/</a></p></li><li><p><a href="https://www.cnblogs.com/yuzhanhong/p/9180212.html">https://www.cnblogs.com/yuzhanhong/p/9180212.html</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建参考汇总</title>
      <link href="2019/01/01/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%82%E8%80%83%E6%B1%87%E6%80%BB/"/>
      <url>2019/01/01/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%82%E8%80%83%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>以下是我搭建博客参考的一些教程</p></blockquote><h1 id="hexo博客搭建教程"><a href="#hexo博客搭建教程" class="headerlink" title="hexo博客搭建教程"></a>hexo博客搭建教程</h1><p><a href="https://blog.csdn.net/gdutxiaoxu/article/details/53576018">https://blog.csdn.net/gdutxiaoxu/article/details/53576018</a></p><p><a href="https://m.w3cschool.cn/hexo_blog/hexo_blog-tvpu244e.html">https://m.w3cschool.cn/hexo_blog/hexo_blog-tvpu244e.html</a></p><p><a href="https://www.cnblogs.com/jackyroc/p/7681938.html">https://www.cnblogs.com/jackyroc/p/7681938.html</a></p><p><a href="https://blog.csdn.net/u010820857/article/details/82027535">https://blog.csdn.net/u010820857/article/details/82027535</a></p><h1 id="Yilia主题配置"><a href="#Yilia主题配置" class="headerlink" title="Yilia主题配置"></a>Yilia主题配置</h1><p><a href="https://github.com/litten/hexo-theme-yilia">https://github.com/litten/hexo-theme-yilia</a></p><p><a href="https://www.jianshu.com/p/517263426abd">https://www.jianshu.com/p/517263426abd</a></p><h1 id="404公益页面"><a href="#404公益页面" class="headerlink" title="404公益页面"></a>404公益页面</h1><p><a href="http://www.qq.com/404/">http://www.qq.com/404/</a></p><p><a href="https://blog.csdn.net/liu1340308350/article/details/81744824">https://blog.csdn.net/liu1340308350/article/details/81744824</a></p><h1 id="使用valine评论"><a href="#使用valine评论" class="headerlink" title="使用valine评论"></a>使用valine评论</h1><p><a href="https://panjunwen.com/diy-a-comment-system/">https://panjunwen.com/diy-a-comment-system/</a></p><p><a href="https://www.xxwhite.com/2017/Valine.html">https://www.xxwhite.com/2017/Valine.html</a></p><h2 id="valine头像"><a href="#valine头像" class="headerlink" title="valine头像"></a>valine头像</h2><p><a href="https://en.gravatar.com/emails?auto-applied=1">https://en.gravatar.com/emails?auto-applied=1</a></p><h1 id="版权设置"><a href="#版权设置" class="headerlink" title="版权设置"></a>版权设置</h1><p><a href="https://blog.zscself.com/2017/01/25/ee4d9ecb/">https://blog.zscself.com/2017/01/25/ee4d9ecb/</a></p><p><a href="http://tc9011.com/2017/02/02/hexo%E6%96%87%E7%AB%A0%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%E5%8F%8A%E4%B8%80%E4%BA%9B%E7%89%B9%E6%95%88/">http://tc9011.com/2017/02/02/hexo%E6%96%87%E7%AB%A0%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%E5%8F%8A%E4%B8%80%E4%BA%9B%E7%89%B9%E6%95%88/</a></p><h1 id="访问量统计"><a href="#访问量统计" class="headerlink" title="访问量统计"></a>访问量统计</h1><p><a href="https://blog.csdn.net/qq_40910541/article/details/80659193">https://blog.csdn.net/qq_40910541/article/details/80659193</a></p><p><a href="https://blog.csdn.net/zxlvxj/article/details/77720934">https://blog.csdn.net/zxlvxj/article/details/77720934</a></p><p><a href="https://ruider.github.io/2018/06/11/%E6%B7%BB%E5%8A%A0hexo-yilia%E4%B8%BB%E9%A2%98%E7%9A%84%E8%AE%BF%E9%97%AE%E6%95%B0%E9%87%8F/">https://ruider.github.io/2018/06/11/%E6%B7%BB%E5%8A%A0hexo-yilia%E4%B8%BB%E9%A2%98%E7%9A%84%E8%AE%BF%E9%97%AE%E6%95%B0%E9%87%8F/</a></p><p><a href="http://easydo.work/2017/10/26/hexo-yilia-page-view.html">http://easydo.work/2017/10/26/hexo-yilia-page-view.html</a></p><h1 id="域名绑定"><a href="#域名绑定" class="headerlink" title="域名绑定"></a>域名绑定</h1><p><a href="https://blog.csdn.net/yucicheung/article/details/79560027">https://blog.csdn.net/yucicheung/article/details/79560027</a></p><p><a href="https://www.jianshu.com/p/d92ea8542673?utm_campaign=haruki&utm_content=note&utm_medium=reader_share&utm_source=qq">https://www.jianshu.com/p/d92ea8542673?utm_campaign=haruki&amp;utm_content=note&amp;utm_medium=reader_share&amp;utm_source=qq</a></p><h1 id="添加目录"><a href="#添加目录" class="headerlink" title="添加目录"></a>添加目录</h1><p><a href="https://blog.csdn.net/u013082989/article/details/70212008">https://blog.csdn.net/u013082989/article/details/70212008</a></p><p><a href="http://lawlite.me/2017/04/17/Hexo-yilia%E4%B8%BB%E9%A2%98%E5%AE%9E%E7%8E%B0%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95%E5%92%8C%E6%B7%BB%E5%8A%A0%E8%A7%86%E9%A2%91/">http://lawlite.me/2017/04/17/Hexo-yilia%E4%B8%BB%E9%A2%98%E5%AE%9E%E7%8E%B0%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95%E5%92%8C%E6%B7%BB%E5%8A%A0%E8%A7%86%E9%A2%91/</a></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019你好</title>
      <link href="2019/01/01/2019%E4%BD%A0%E5%A5%BD/"/>
      <url>2019/01/01/2019%E4%BD%A0%E5%A5%BD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><fancybox><img src="https://img.vim-cn.com/98/76b6778c92f439ecde44ca1ac3a26a035ef7f1.png" class="lazyload" data-srcset="https://img.vim-cn.com/98/76b6778c92f439ecde44ca1ac3a26a035ef7f1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="2019 new year"></fancybox></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>致敬2018</title>
      <link href="2018/12/31/%E8%87%B4%E6%95%AC2018/"/>
      <url>2018/12/31/%E8%87%B4%E6%95%AC2018/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>博客 2018 使用的图床(imgur)已挂掉，大部分 2018 年的文章配的图需要使用 proxy 才能看到</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Typecho搭建个人博客</title>
      <link href="2018/12/31/memory/"/>
      <url>2018/12/31/memory/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>**本页图片已挂，需跨越 G-F?W **</p><h1 id="搭建依托于我的个人服务器的博客"><a href="#搭建依托于我的个人服务器的博客" class="headerlink" title="搭建依托于我的个人服务器的博客"></a>搭建依托于我的个人服务器的博客</h1><p>emmm。。。 2018年12月24日0点10分，忽然觉得无聊，打开某云，手一贱租了台云服务器（233~~~~）。<br>嗯，既然都租了，那就再来个博客吧。</p><h1 id="基于typecho搭建的个人博客"><a href="#基于typecho搭建的个人博客" class="headerlink" title="基于typecho搭建的个人博客"></a>基于typecho搭建的个人博客</h1><h1 id="宝塔面板安装"><a href="#宝塔面板安装" class="headerlink" title="宝塔面板安装"></a>宝塔面板安装</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install.sh &amp;&amp; sh install.sh</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/7k0eFLi.png" class="lazyload" data-srcset="https://i.imgur.com/7k0eFLi.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p><img src="https://i.imgur.com/MLaYQzB.png" class="lazyload" data-srcset="https://i.imgur.com/MLaYQzB.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><h1 id="网站搭建"><a href="#网站搭建" class="headerlink" title="网站搭建"></a>网站搭建</h1><p>点击添加，创建网站</p><p><img src="https://i.imgur.com/rPTqZ0n.png" class="lazyload" data-srcset="https://i.imgur.com/rPTqZ0n.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p><img src="https://i.imgur.com/dcCn02Y.png" class="lazyload" data-srcset="https://i.imgur.com/dcCn02Y.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p>嗯，接下来访问自己域名（公网ip地址），看看是否创建成功</p><p><img src="https://i.imgur.com/iNutNVu.png" class="lazyload" data-srcset="https://i.imgur.com/iNutNVu.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p>接下来配置伪静态规则</p><p><img src="https://i.imgur.com/oDZ2Kti.png" class="lazyload" data-srcset="https://i.imgur.com/oDZ2Kti.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><h1 id="嗯，接下来搭建博客，这里使用宝塔后台无脑安装-不好意思，我太菜-还是用命令行操作吧"><a href="#嗯，接下来搭建博客，这里使用宝塔后台无脑安装-不好意思，我太菜-还是用命令行操作吧" class="headerlink" title="嗯，接下来搭建博客，这里使用宝塔后台无脑安装(不好意思，我太菜),还是用命令行操作吧"></a>嗯，接下来搭建博客，<del>这里使用宝塔后台无脑安装</del>(不好意思，我太菜),还是用命令行操作吧</h1><p><img src="https://i.imgur.com/M4TkXvL.png" class="lazyload" data-srcset="https://i.imgur.com/M4TkXvL.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p>记得填写常用邮箱、管理员名和密码</p><p><a href="http://typecho.org/download">http://typecho.org/download</a></p><p>嗯，接下来访问自己的域名就ok了</p><p><img src="https://i.imgur.com/60Pwc6P.png" class="lazyload" data-srcset="https://i.imgur.com/60Pwc6P.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p><p>emm，是不是少了什么，SSL证书没有，少了小绿锁</p><p>那就去申请吧</p><p><img src="https://i.imgur.com/VxD0APt.png" class="lazyload" data-srcset="https://i.imgur.com/VxD0APt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"><br>站点管理，设置</p><p>因为我的web服务器是nigix</p><p><img src="https://i.imgur.com/W2Ld2PJ.png" class="lazyload" data-srcset="https://i.imgur.com/W2Ld2PJ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性表的链式存储-单链表</title>
      <link href="2018/12/15/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8-%E5%8D%95%E9%93%BE%E8%A1%A8/"/>
      <url>2018/12/15/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8-%E5%8D%95%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="单链表操作"><a href="#单链表操作" class="headerlink" title="单链表操作"></a>单链表操作</h1><ul><li><input type="checkbox" checked disable> 单链表的创建（尾插法、头插法）</li><li><input type="checkbox" checked disable> 单链表的查找操作</li><li><input type="checkbox" checked disable> 单链表的删除操作</li><li><input type="checkbox" checked disable> 单链表的逆置操作(使用头插法)</li><li><input type="checkbox" checked disable> 单链表表长的计算</li><li><input type="checkbox" checked disable> 打印单链表</li></ul><span id="more"></span><h2 id="单链表的创建"><a href="#单链表的创建" class="headerlink" title="单链表的创建"></a>单链表的创建</h2><h3 id="头插法"><a href="#头插法" class="headerlink" title="头插法"></a>头插法</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">forward_list* <span class="title">creat_3</span><span class="params">()</span>    <span class="comment">//头插法</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *head,*s;</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">head = <span class="literal">NULL</span>;<span class="comment">//链表初始状态为空</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num) &amp;&amp; num)</span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line">s-&gt;data = num;</span><br><span class="line"></span><br><span class="line">s-&gt;next = head;</span><br><span class="line"></span><br><span class="line">head = s;<span class="comment">//将新结点插入到表头</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="尾插法（不含头结点）"><a href="#尾插法（不含头结点）" class="headerlink" title="尾插法（不含头结点）"></a>尾插法（不含头结点）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//尾插法建表</span></span><br><span class="line"><span class="function">forward_list* <span class="title">creat_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *head=<span class="literal">NULL</span>;<span class="comment">//头指针，初始状态为空</span></span><br><span class="line">forward_list *rear=<span class="literal">NULL</span>;<span class="comment">//尾指针，初始状态为空</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">forward_list *s;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num) == <span class="number">1</span> &amp;&amp; num)<span class="comment">//输入0结束</span></span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line"></span><br><span class="line">s-&gt;data = num;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">NULL</span>)<span class="comment">//将新节点加入空表</span></span><br><span class="line">        head = s;</span><br><span class="line">    <span class="keyword">else</span>            <span class="comment">//原表非空，将新节点链接到表尾之后</span></span><br><span class="line">        rear-&gt;next = s;</span><br><span class="line">rear = s;<span class="comment">//尾指针指向新的表尾</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(rear!= <span class="literal">NULL</span>)<span class="comment">//对于非空表，将尾结点的下一个结点置空</span></span><br><span class="line">    rear-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="尾插法（含头结点）"><a href="#尾插法（含头结点）" class="headerlink" title="尾插法（含头结点）"></a>尾插法（含头结点）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//尾插法建表,包含头结点</span></span><br><span class="line"><span class="function">forward_list* <span class="title">creat_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *s;</span><br><span class="line">forward_list *head, *rear;</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line">head = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line">rear = head;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num)==<span class="number">1</span> &amp;&amp; num)</span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line"></span><br><span class="line">s-&gt;data = num;</span><br><span class="line">    rear-&gt;next = s;</span><br><span class="line">rear = s;<span class="comment">//表指针指向新的表尾</span></span><br><span class="line">&#125;</span><br><span class="line">rear-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="单链表的查找操作"><a href="#单链表的查找操作" class="headerlink" title="单链表的查找操作"></a>单链表的查找操作</h2><h3 id="按值查找"><a href="#按值查找" class="headerlink" title="按值查找"></a>按值查找</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search_1</span><span class="params">(forward_list *s, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is exist !\n&quot;</span>,x);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is not fonud !\n&quot;</span>,x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="按值查找（包含头结点）"><a href="#按值查找（包含头结点）" class="headerlink" title="按值查找（包含头结点）"></a>按值查找（包含头结点）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search_2</span><span class="params">(forward_list *s, <span class="keyword">int</span> x)</span><span class="comment">//带头节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s-&gt;next;<span class="comment">//emmmm</span></span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is exist !\n&quot;</span>,x);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is not fonud !\n&quot;</span>,x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="单链表的删除操作"><a href="#单链表的删除操作" class="headerlink" title="单链表的删除操作"></a>单链表的删除操作</h2><h3 id="按给定结点的位置删除（带头结点）"><a href="#按给定结点的位置删除（带头结点）" class="headerlink" title="按给定结点的位置删除（带头结点）"></a>按给定结点的位置删除（带头结点）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_1</span><span class="params">(forward_list *head,<span class="keyword">int</span> i)</span>        <span class="comment">//删除第i个节点(单链表包含头节点)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">forward_list *p,*q;</span><br><span class="line">p=head;</span><br><span class="line">j=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>((p-&gt;next!=<span class="literal">NULL</span>)&amp;&amp;(j&lt;i<span class="number">-1</span>))</span><br><span class="line">&#123;</span><br><span class="line">p=p-&gt;next;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">q=p-&gt;next;</span><br><span class="line">p-&gt;next=p-&gt;next-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(q);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;illegal delete position,delete failed!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="按照指定值删除结点-不带头结点"><a href="#按照指定值删除结点-不带头结点" class="headerlink" title="按照指定值删除结点(不带头结点)"></a>按照指定值删除结点(不带头结点)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">forward_list_delete_1</span><span class="params">(forward_list *s,<span class="keyword">int</span> x)</span><span class="comment">//删除链表（不带头节点）中指定值的元素</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *p;</span><br><span class="line">    forward_list *temp;<span class="comment">//用来存放被删除元素的前一个结点</span></span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">if</span>(x == p-&gt;data)</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line"></span><br><span class="line">temp = p;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">            temp-&gt;next = p-&gt;next;</span><br><span class="line">            <span class="built_in">free</span>(p);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">temp = p;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n你要删除的元素 %d 不在表中\n&quot;</span>,x);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="单链表的逆置"><a href="#单链表的逆置" class="headerlink" title="单链表的逆置"></a>单链表的逆置</h2><h3 id="头插法逆置-带头结点"><a href="#头插法逆置-带头结点" class="headerlink" title="头插法逆置(带头结点)"></a>头插法逆置(带头结点)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_2</span><span class="params">(forward_list *head)</span><span class="comment">//头插法逆置,带头节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *p,*q;</span><br><span class="line">    p=head-&gt;next;</span><br><span class="line">    head-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        q=p;</span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">        q-&gt;next=head-&gt;next;</span><br><span class="line">        head-&gt;next=q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="计算单链表的表长"><a href="#计算单链表的表长" class="headerlink" title="计算单链表的表长"></a>计算单链表的表长</h2><p>*** 带头结点 ***</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_length_2</span><span class="params">(forward_list *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> count;</span><br><span class="line">forward_list *p=s-&gt;next;</span><br><span class="line"><span class="keyword">while</span>(p)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nlist length: %d\n&quot;</span>,count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>*** 不带头结点 ***</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_length_1</span><span class="params">(forward_list *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> count;</span><br><span class="line">forward_list *p=s;</span><br><span class="line"><span class="keyword">while</span>(p)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nlist length: %d\n&quot;</span>,count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="打印单链表"><a href="#打印单链表" class="headerlink" title="打印单链表"></a>打印单链表</h2><p>*** 带头结点 ***</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_forward_list_2</span><span class="params">(forward_list *s)</span><span class="comment">//打印含头节点的单链表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s-&gt;next;<span class="comment">//因为含有头节点，head-&gt;data的数据域的数据未知</span></span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%-3d&quot;</span>,p-&gt;data);</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>*** 不带头结点 ***</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_forward_list_1</span><span class="params">(forward_list *s)</span><span class="comment">//打印单链表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>,p-&gt;data);</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="试试"><a href="#试试" class="headerlink" title="试试"></a>试试</h1><h2 id="源程序"><a href="#源程序" class="headerlink" title="源程序"></a>源程序</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义单链表结点类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> data;                         <span class="comment">//结点数据域</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span>                <span class="comment">//结点指针域</span></span><br><span class="line"></span><br><span class="line">&#125;forward_list;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾插法建表</span></span><br><span class="line"><span class="function">forward_list* <span class="title">creat_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *head=<span class="literal">NULL</span>;<span class="comment">//头指针，初始状态为空</span></span><br><span class="line">forward_list *rear=<span class="literal">NULL</span>;<span class="comment">//尾指针，初始状态为空</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">forward_list *s;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num) == <span class="number">1</span> &amp;&amp; num)<span class="comment">//输入0结束</span></span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line"></span><br><span class="line">s-&gt;data = num;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">NULL</span>)<span class="comment">//将新节点加入空表</span></span><br><span class="line">        head = s;</span><br><span class="line">    <span class="keyword">else</span>            <span class="comment">//原表非空，将新节点链接到表尾之后</span></span><br><span class="line">        rear-&gt;next = s;</span><br><span class="line">rear = s;<span class="comment">//尾指针指向新的表尾</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(rear!= <span class="literal">NULL</span>)<span class="comment">//对于非空表，将尾结点的下一个结点置空</span></span><br><span class="line">    rear-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾插法建表,包含头结点</span></span><br><span class="line"><span class="function">forward_list* <span class="title">creat_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *s;</span><br><span class="line">forward_list *head, *rear;</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line">head = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line">rear = head;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num)==<span class="number">1</span> &amp;&amp; num)</span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line"></span><br><span class="line">s-&gt;data = num;</span><br><span class="line">    rear-&gt;next = s;</span><br><span class="line">rear = s;<span class="comment">//表指针指向新的表尾</span></span><br><span class="line">&#125;</span><br><span class="line">rear-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">forward_list* <span class="title">creat_3</span><span class="params">()</span>    <span class="comment">//头插法</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *head,*s;</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">head = <span class="literal">NULL</span>;<span class="comment">//链表初始状态为空</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num) &amp;&amp; num)</span><br><span class="line">&#123;</span><br><span class="line">s = (forward_list*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(forward_list));</span><br><span class="line">s-&gt;data = num;</span><br><span class="line"></span><br><span class="line">s-&gt;next = head;</span><br><span class="line"></span><br><span class="line">head = s;<span class="comment">//将新结点插入到表头</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search_1</span><span class="params">(forward_list *s, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is exist !\n&quot;</span>,x);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is not fonud !\n&quot;</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">search_2</span><span class="params">(forward_list *s, <span class="keyword">int</span> x)</span><span class="comment">//带头节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s-&gt;next;<span class="comment">//emmmm</span></span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is exist !\n&quot;</span>,x);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nthe value : %d is not fonud !\n&quot;</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_1</span><span class="params">(forward_list *head)</span><span class="comment">//头插法逆置单链表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">forward_list *temp;</span><br><span class="line"></span><br><span class="line">p = head;<span class="comment">//存好之前的单链表</span></span><br><span class="line"><span class="comment">//printf(&quot;\n%d\n&quot;,p-&gt;data);</span></span><br><span class="line">head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">while</span>(p)</span><br><span class="line">&#123;</span><br><span class="line">    temp = p;</span><br><span class="line">    <span class="comment">//printf(&quot;1&quot;);</span></span><br><span class="line">    p = p-&gt;next;</span><br><span class="line">    temp-&gt;next = head-&gt;next;</span><br><span class="line">head = temp;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n%d\n&quot;</span>,head-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_2</span><span class="params">(forward_list *head)</span><span class="comment">//头插法逆置,带头节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *p,*q;</span><br><span class="line">    p=head-&gt;next;</span><br><span class="line">    head-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        q=p;</span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">        q-&gt;next=head-&gt;next;</span><br><span class="line">        head-&gt;next=q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">forward_list_delete_1</span><span class="params">(forward_list *s,<span class="keyword">int</span> x)</span><span class="comment">//删除链表（不带头节点）中指定值的元素</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    forward_list *p;</span><br><span class="line">    forward_list *temp;<span class="comment">//用来存放被删除元素的前一个结点</span></span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">if</span>(x == p-&gt;data)</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line"></span><br><span class="line">temp = p;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;data == x)</span><br><span class="line">&#123;</span><br><span class="line">            temp-&gt;next = p-&gt;next;</span><br><span class="line">            <span class="built_in">free</span>(p);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">temp = p;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n你要删除的元素 %d 不在表中\n&quot;</span>,x);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_1</span><span class="params">(forward_list *head,<span class="keyword">int</span> i)</span>        <span class="comment">//删除第i个节点(单链表包含头节点)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">forward_list *p,*q;</span><br><span class="line">p=head;</span><br><span class="line">j=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>((p-&gt;next!=<span class="literal">NULL</span>)&amp;&amp;(j&lt;i<span class="number">-1</span>))</span><br><span class="line">&#123;</span><br><span class="line">p=p-&gt;next;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(p-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">q=p-&gt;next;</span><br><span class="line">p-&gt;next=p-&gt;next-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(q);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;illegal delete position,delete failed!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*//不对</span></span><br><span class="line"><span class="comment">void list_delete(forward_list *s, int i)//删除单链表(不带头节点)的第i个结点</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int count=1;</span></span><br><span class="line"><span class="comment">forward_list *p,*q;</span></span><br><span class="line"><span class="comment">p=s;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">//将p移动到被删除结点的前一个结点</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">while((p!=NULL)&amp;&amp;(count&lt;i-1))</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">p=p-&gt;next;</span></span><br><span class="line"><span class="comment">count++;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">if(i == count)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">q = p;</span></span><br><span class="line"><span class="comment">p = p-&gt;next;</span></span><br><span class="line"><span class="comment">free(q);</span></span><br><span class="line"><span class="comment">return ;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">   if(p-&gt;next!=NULL)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">q=p-&gt;next;</span></span><br><span class="line"><span class="comment">p-&gt;next=p-&gt;next-&gt;next;</span></span><br><span class="line"><span class="comment">free(q);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">else</span></span><br><span class="line"><span class="comment">printf(&quot;illegal delete position,delete failed!&quot;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_length_1</span><span class="params">(forward_list *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> count;</span><br><span class="line">forward_list *p=s;</span><br><span class="line"><span class="keyword">while</span>(p)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nlist length: %d\n&quot;</span>,count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_length_2</span><span class="params">(forward_list *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> count;</span><br><span class="line">forward_list *p=s-&gt;next;</span><br><span class="line"><span class="keyword">while</span>(p)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nlist length: %d\n&quot;</span>,count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_forward_list_1</span><span class="params">(forward_list *s)</span><span class="comment">//打印单链表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s;</span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%4d&quot;</span>,p-&gt;data);</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_forward_list_2</span><span class="params">(forward_list *s)</span><span class="comment">//打印含头节点的单链表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">forward_list *p;</span><br><span class="line">p = s-&gt;next;<span class="comment">//因为含有头节点，head-&gt;data的数据域的数据未知</span></span><br><span class="line"><span class="keyword">while</span>(p != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%-3d&quot;</span>,p-&gt;data);</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">/*不带头结点的单链表*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;使用不带头结点的单链表:\n&quot;</span>);</span><br><span class="line">forward_list *p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;尾插法建表:\n&quot;</span>);</span><br><span class="line">p = creat_1();<span class="comment">//尾插法建表</span></span><br><span class="line">print_forward_list_1(p);</span><br><span class="line">list_length_1(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找是否存在值为6的结点</span></span><br><span class="line">search_1(p,<span class="number">6</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n删了个5后，表变为\n&quot;</span>);</span><br><span class="line">forward_list_delete_1(p,<span class="number">5</span>);</span><br><span class="line">print_forward_list_1(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">//头插法建表</span></span><br><span class="line">forward_list *s;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n头插法建表:\n&quot;</span>);</span><br><span class="line">s = creat_3();</span><br><span class="line">print_forward_list_1(s);</span><br><span class="line">list_length_1(s);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*带头结点的单链表*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\n使用带头结点的单链表:\n&quot;</span>);</span><br><span class="line">forward_list *t;</span><br><span class="line">t = creat_2();</span><br><span class="line">print_forward_list_2(t);</span><br><span class="line"></span><br><span class="line">search_2(t,<span class="number">6</span>);</span><br><span class="line">list_length_2(t);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n逆置:\n&quot;</span>);</span><br><span class="line">reverse_2(t);</span><br><span class="line">print_forward_list_2(t);</span><br><span class="line">list_length_2(t);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://i.imgur.com/ZqNga3h.png" class="lazyload" data-srcset="https://i.imgur.com/ZqNga3h.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p>]]></content>
      
      
      <categories>
          
          <category> 数据结构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性表之顺序存储-顺序表</title>
      <link href="2018/12/14/%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8-%E9%A1%BA%E5%BA%8F%E8%A1%A8/"/>
      <url>2018/12/14/%E7%BA%BF%E6%80%A7%E8%A1%A8%E4%B9%8B%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8-%E9%A1%BA%E5%BA%8F%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="顺序表的操作"><a href="#顺序表的操作" class="headerlink" title="顺序表的操作"></a>顺序表的操作</h1><ul><li><input type="checkbox" checked disable> 向有序顺序表插入一个元素</li><li><input type="checkbox" checked disable> 顺序表的冒泡排序</li><li><input type="checkbox" checked disable> 顺序表的删除操作</li><li><input type="checkbox" checked disable> 顺序表中元素的查找</li><li><input type="checkbox" checked disable> 顺序表的逆置</li><li><input type="checkbox" checked disable> 删除顺序表中的相同元素</li><li><input type="checkbox" checked disable> 向顺序表的指定位置插入元素</li><li><input type="checkbox" checked disable> 打印顺序表</li></ul><span id="more"></span><h2 id="顺序表的存储结构"><a href="#顺序表的存储结构" class="headerlink" title="顺序表的存储结构"></a>顺序表的存储结构</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxsize 100        <span class="comment">//存储空间的分配量</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义顺序表数据类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> data[maxsize];</span><br><span class="line"><span class="keyword">int</span> last;              <span class="comment">//存放表中最后一个元素的下标</span></span><br><span class="line">&#125;sequenlist;</span><br></pre></td></tr></table></figure><h2 id="顺序表的冒泡排序"><a href="#顺序表的冒泡排序" class="headerlink" title="顺序表的冒泡排序"></a>顺序表的冒泡排序</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_bubble_sort</span><span class="params">(sequenlist *p)</span><span class="comment">//max to min</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt; p-&gt;last; i++)<span class="comment">//attention</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt; p-&gt;last-i; j++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;data[j] &lt; p-&gt;data[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            temp = p-&gt;data[j];</span><br><span class="line">p-&gt;data[j] = p-&gt;data[j+<span class="number">1</span>];</span><br><span class="line">p-&gt;data[j+<span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="顺序表的删除操作"><a href="#顺序表的删除操作" class="headerlink" title="顺序表的删除操作"></a>顺序表的删除操作</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">nt <span class="title">delete_1</span><span class="params">(sequenlist *s,<span class="keyword">int</span> del)</span> <span class="comment">//删除函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i &lt;= s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(del == s-&gt;data[i])</span><br><span class="line">&#123;</span><br><span class="line">temp = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=i; j&lt;s-&gt;last; j++)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;data[j] = s-&gt;data[j+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">s-&gt;last = s-&gt;last - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//删除第一个与del相同的元素，函数结束</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//要删的那个元素不在表中</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;the element you want to delete is not in the sequenlist!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="顺序表中元素的查找"><a href="#顺序表中元素的查找" class="headerlink" title="顺序表中元素的查找"></a>顺序表中元素的查找</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(sequenlist *s,<span class="keyword">int</span> key)</span>    <span class="comment">//查找函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;= s-&gt;last; i++)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(key == s-&gt;data[i])</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;exist !\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;not found !\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="顺序表的逆置"><a href="#顺序表的逆置" class="headerlink" title="顺序表的逆置"></a>顺序表的逆置</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(sequenlist *s)</span><span class="comment">//逆置函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">int</span> last_temp = s-&gt;last;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;= s-&gt;last/<span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = s-&gt;data[i];</span><br><span class="line">        s-&gt;data[i] = s-&gt;data[last_temp];</span><br><span class="line">s-&gt;data[last_temp] = temp;</span><br><span class="line">    last_temp--;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="删除顺序表中的相同元素"><a href="#删除顺序表中的相同元素" class="headerlink" title="删除顺序表中的相同元素"></a>删除顺序表中的相同元素</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_same</span><span class="params">(sequenlist *s)</span><span class="comment">//删除表中相同的元素</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;=s-&gt;last; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s-&gt;data[j] == s-&gt;data[i])<span class="comment">//元素相同</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=j; k&lt;s-&gt;last; k++)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;data[k] = s-&gt;data[k+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">s-&gt;last = s-&gt;last - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="向顺序表的指定位置插入元素"><a href="#向顺序表的指定位置插入元素" class="headerlink" title="向顺序表的指定位置插入元素"></a>向顺序表的指定位置插入元素</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(sequenlist *L,<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span> <span class="comment">//指定位置,插入</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">if</span>(((*L).last) &gt;= maxsize<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;the list is overflow!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i&lt;<span class="number">1</span>)||(i&gt;(*L).last+<span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;position is not correct!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=(*L).last;j&gt;=i<span class="number">-1</span>;j--)</span><br><span class="line">&#123;</span><br><span class="line">(*L).data[j+<span class="number">1</span>]=(*L).data[j];</span><br><span class="line">&#125;</span><br><span class="line">(*L).last=(*L).last+<span class="number">1</span>;</span><br><span class="line">(*L).data[i<span class="number">-1</span>]=x;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="向顺序表的指定位置插入元素-1"><a href="#向顺序表的指定位置插入元素-1" class="headerlink" title="向顺序表的指定位置插入元素"></a>向顺序表的指定位置插入元素</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(sequenlist *L,<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span> <span class="comment">//指定位置,插入</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">if</span>(((*L).last) &gt;= maxsize<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;the list is overflow!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i&lt;<span class="number">1</span>)||(i&gt;(*L).last+<span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;position is not correct!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=(*L).last;j&gt;=i<span class="number">-1</span>;j--)</span><br><span class="line">&#123;</span><br><span class="line">(*L).data[j+<span class="number">1</span>]=(*L).data[j];</span><br><span class="line">&#125;</span><br><span class="line">(*L).last=(*L).last+<span class="number">1</span>;</span><br><span class="line">(*L).data[i<span class="number">-1</span>]=x;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="打印顺序表"><a href="#打印顺序表" class="headerlink" title="打印顺序表"></a>打印顺序表</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_list</span><span class="params">(sequenlist *s)</span>   <span class="comment">//打印顺序表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%3d&quot;</span>,s-&gt;data[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="试着煲下汤"><a href="#试着煲下汤" class="headerlink" title="试着煲下汤"></a>试着煲下汤</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* author: shansan.top</span></span><br><span class="line"><span class="comment">* date: 2018/12/12</span></span><br><span class="line"><span class="comment">* version: 1.0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxsize 100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义顺序表数据类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> data[maxsize];</span><br><span class="line"><span class="keyword">int</span> last;</span><br><span class="line">&#125;sequenlist;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(sequenlist *s,<span class="keyword">int</span> key)</span>    <span class="comment">//查找函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;= s-&gt;last; i++)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(key == s-&gt;data[i])</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;exist !\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;not found !\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delete_1</span><span class="params">(sequenlist *s,<span class="keyword">int</span> del)</span> <span class="comment">//删除函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i &lt;= s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(del == s-&gt;data[i])</span><br><span class="line">&#123;</span><br><span class="line">temp = i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=i; j&lt;s-&gt;last; j++)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;data[j] = s-&gt;data[j+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">s-&gt;last = s-&gt;last - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//删除第一个与del相同的元素，函数结束</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//要删的那个元素不在表中</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;the element you want to delete is not in the sequenlist!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_list</span><span class="params">(sequenlist *s)</span>   <span class="comment">//打印顺序表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%3d&quot;</span>,s-&gt;data[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(sequenlist *s)</span><span class="comment">//逆置函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">int</span> last_temp = s-&gt;last;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;= s-&gt;last/<span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = s-&gt;data[i];</span><br><span class="line">        s-&gt;data[i] = s-&gt;data[last_temp];</span><br><span class="line">s-&gt;data[last_temp] = temp;</span><br><span class="line">    last_temp--;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">list_bubble_sort</span><span class="params">(sequenlist *p)</span><span class="comment">//max to min</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt; p-&gt;last; i++)<span class="comment">//attention</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt; p-&gt;last-i; j++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p-&gt;data[j] &lt; p-&gt;data[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            temp = p-&gt;data[j];</span><br><span class="line">p-&gt;data[j] = p-&gt;data[j+<span class="number">1</span>];</span><br><span class="line">p-&gt;data[j+<span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_in_order_list</span><span class="params">(sequenlist *s,<span class="keyword">int</span> value)</span><span class="comment">//有序表中插入元素</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//int temp = s-&gt;last+1;</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line"><span class="keyword">if</span>( value &lt;= s-&gt;data[i])</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;last = s-&gt;last + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(j=s-&gt;last; j&gt;i; j--)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;data[j] = s-&gt;data[j<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line">s-&gt;data[i] = value;</span><br><span class="line"><span class="keyword">return</span> ;<span class="comment">//结束函数</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf(&quot;i=%d&quot;,i);</span></span><br><span class="line"><span class="comment">//printf(&quot;s-&gt;last=%d\n&quot;,s-&gt;last);</span></span><br><span class="line"><span class="keyword">if</span>(i &gt; s-&gt;last<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;last = s-&gt;last + <span class="number">1</span>;</span><br><span class="line">s-&gt;data[s-&gt;last] = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(sequenlist *L,<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span> <span class="comment">//指定位置,插入</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">if</span>(((*L).last) &gt;= maxsize<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;the list is overflow!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i&lt;<span class="number">1</span>)||(i&gt;(*L).last+<span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;position is not correct!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=(*L).last;j&gt;=i<span class="number">-1</span>;j--)</span><br><span class="line">&#123;</span><br><span class="line">(*L).data[j+<span class="number">1</span>]=(*L).data[j];</span><br><span class="line">&#125;</span><br><span class="line">(*L).last=(*L).last+<span class="number">1</span>;</span><br><span class="line">(*L).data[i<span class="number">-1</span>]=x;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_same</span><span class="params">(sequenlist *s)</span><span class="comment">//删除表中相同的元素</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=s-&gt;last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;=s-&gt;last; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s-&gt;data[j] == s-&gt;data[i])<span class="comment">//元素相同</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=j; k&lt;s-&gt;last; k++)</span><br><span class="line">&#123;</span><br><span class="line">s-&gt;data[k] = s-&gt;data[k+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">s-&gt;last = s-&gt;last - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">sequenlist p=&#123;&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">8</span>&#125;,<span class="number">8</span>&#125;;</span><br><span class="line"><span class="comment">//这里有9个数，但数组下表是从0开始的，所以 p.last = 8</span></span><br><span class="line">print_list(&amp;p);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;please input a value which you want: &quot;</span>);</span><br><span class="line"><span class="keyword">int</span> value;<span class="comment">//C++语法可以临时定义一个变量,C语言不可以（需放在开头）。</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;value);</span><br><span class="line"><span class="comment">//search(&amp;p,10);</span></span><br><span class="line">search(&amp;p,value);</span><br><span class="line">print_list(&amp;p);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除表中的指定元素</span></span><br><span class="line">delete_1(&amp;p,<span class="number">8</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;after delete:\n&quot;</span>);</span><br><span class="line">print_list(&amp;p);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//逆置顺序表</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\nafter reverse:\n&quot;</span>);</span><br><span class="line">reverse(&amp;p);</span><br><span class="line">print_list(&amp;p);</span><br><span class="line"></span><br><span class="line"><span class="comment">//冒泡排序</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nafter sort:\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//list_bubble_sort(&amp;try_1);</span></span><br><span class="line">list_bubble_sort(&amp;p);</span><br><span class="line">print_list(&amp;p);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//往有序顺序表中插入一个元素</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">    sequenlist try_1 = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;,<span class="number">5</span>&#125;;</span><br><span class="line">    print_list(&amp;try_1);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;please input the value that you wan to insert into the sequenlist: &quot;</span>);</span><br><span class="line"><span class="keyword">int</span> data;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">insert_in_order_list(&amp;try_1,data);</span><br><span class="line"><span class="comment">//insert_in_order_list(&amp;try_1,9);</span></span><br><span class="line">print_list(&amp;try_1);</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除表中相同的元素</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">sequenlist try_2= &#123;&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">4</span>&#125;,<span class="number">7</span>&#125;;</span><br><span class="line">print_list(&amp;try_2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\ndelete the same element:\n&quot;</span>);</span><br><span class="line">delete_same(&amp;try_2);</span><br><span class="line">print_list(&amp;try_2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//另一种玩法</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nplease input the number of elements: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;please input %d values:\n&quot;</span>,n);</span><br><span class="line">sequenlist try_3;</span><br><span class="line">try_3.last = n<span class="number">-1</span>;<span class="comment">//注意，数组的小标从0开始</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;=try_3.last; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;try_3.data[i]);</span><br><span class="line">&#125;</span><br><span class="line">print_list(&amp;try_3);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//在指定位置插入</span></span><br><span class="line">insert(&amp;try_3,<span class="number">1</span>,<span class="number">22</span>);</span><br><span class="line">print_list(&amp;try_3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="程序运行结果"><a href="#程序运行结果" class="headerlink" title="程序运行结果"></a>程序运行结果</h2><p><img src="https://i.imgur.com/5kOE2oq.png" class="lazyload" data-srcset="https://i.imgur.com/5kOE2oq.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p>]]></content>
      
      
      <categories>
          
          <category> 数据结构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>勿忘国耻，吾辈自强！</title>
      <link href="2018/12/13/%E5%8B%BF%E5%BF%98%E5%9B%BD%E8%80%BB%EF%BC%8C%E5%90%BE%E8%BE%88%E8%87%AA%E5%BC%BA%EF%BC%81/"/>
      <url>2018/12/13/%E5%8B%BF%E5%BF%98%E5%9B%BD%E8%80%BB%EF%BC%8C%E5%90%BE%E8%BE%88%E8%87%AA%E5%BC%BA%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://img.vim-cn.com/11/4118901768164c5c4b2dd83d19b84701287c8a.jpg" class="lazyload" data-srcset="https://img.vim-cn.com/11/4118901768164c5c4b2dd83d19b84701287c8a.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> Memory </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Memory </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Biu一下GDB</title>
      <link href="2018/12/03/biu%E4%B8%80%E4%B8%8BGDB/"/>
      <url>2018/12/03/biu%E4%B8%80%E4%B8%8BGDB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="gcc常见编译选项"><a href="#gcc常见编译选项" class="headerlink" title="gcc常见编译选项"></a>gcc常见编译选项</h1><ul><li>** -c **:只激活预处理、编译和汇编，也就是生成obj文件</li><li>** -S **:只激活处理和编译，把文件编译成汇编代码</li><li>** -o **:定制目标名称，缺省的时候编译出来的可执行程序名为a.exe(windows)或a.out(linux)</li><li>** -Wall **:打开一些很有用的编译警告</li><li>** -std **:指定C标准，如-std=99，使用C99标准</li><li>** -g **:指示编译器，编译的时候添加调试信息</li><li>** -O0 -O1 -O2 -O3 **：编译器的优化选项的4个级别，-O0表示没有优化,-O1为缺省值，-O3优化级别最高</li></ul><span id="more"></span><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/%E5%BD%95%E5%88%B6_2018_12_03_20_11_09_554.gif" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/%E5%BD%95%E5%88%B6_2018_12_03_20_11_09_554.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">file_name: swap.c</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line">t = a;</span><br><span class="line">a = b;</span><br><span class="line">b = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">3</span>, b=<span class="number">4</span>;</span><br><span class="line">swap(a,b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>,a,b);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="GDB的使用"><a href="#GDB的使用" class="headerlink" title="GDB的使用"></a>GDB的使用</h1><blockquote><p><a href="https://www.bing.com/knows/search?q=gdb&mkt=zh-cn&FORM=BKACAI">什么是GDBhttps://www.bing.com/knows/search?q=gdb&amp;mkt=zh-cn&amp;FORM=BKACAI</a><br><a href="http://www.gnu.org/software/gdb/">http://www.gnu.org/software/gdb/</a></p></blockquote><blockquote><p>一般来说，GDB主要帮助你完成以下四个方面的内容<br>1、启动你的程序，可以按照你的自定义的要求随心所欲的运行程序<br>2、可以让被调试的程序在你所指定的调置的断点处停住。(断点可以是条件表达式)<br>3、当程序被停住时，可以检查此时你的程序中所发生的事<br>4、你可以改变你的程序，将一个BUG产生的影响修正，从而测试其他BUG</p></blockquote><h2 id="GDB常见命令"><a href="#GDB常见命令" class="headerlink" title="GDB常见命令"></a>GDB常见命令</h2><table><thead><tr><th align="center">简称</th><th align="center">全称</th><th align="left">备注</th></tr></thead><tbody><tr><td align="center">l</td><td align="center">list</td><td align="left">显示指定行号或者指定函数附近的源代码</td></tr><tr><td align="center">b</td><td align="center">break</td><td align="left">在指定行号或指定函数开头设置断点</td></tr><tr><td align="center">r</td><td align="center">run</td><td align="left">运行程序，直到程序结束或遇到断点</td></tr><tr><td align="center">c</td><td align="center">continue</td><td align="left">在程序中断后继续执行程序，直到程序结束或遇到断点停下。注意在程序开始执行前只能用r，而不能用c</td></tr><tr><td align="center">n</td><td align="center">next</td><td align="left">执行一条语句。如果有函数调用，则把它当做一个整体</td></tr><tr><td align="center">s</td><td align="center">step</td><td align="left">执行一条语句。如果有函数调用，则进入函数内部</td></tr><tr><td align="center">u</td><td align="center">until</td><td align="left">执行到指定行号或指定函数的开头</td></tr><tr><td align="center">p</td><td align="center">print</td><td align="left">显示变量或表达式的值</td></tr><tr><td align="center">disp</td><td align="center">display</td><td align="left">把一个表达式设置为display，当程序每次停下来时都会显示其值</td></tr><tr><td align="center">cl</td><td align="center">clear</td><td align="left">取消断点，和b格式相同，如果该位置有多个断点，将同时取消</td></tr><tr><td align="center">i</td><td align="center">info</td><td align="left">显示各种信息，如i b显示所有断点，i disp显示display，而i lo显示所有局部变量</td></tr><tr><td align="center">bt</td><td align="center">backtrace</td><td align="left">打印所有栈帧信息</td></tr></tbody></table><h2 id="调用栈（Call-Stack）"><a href="#调用栈（Call-Stack）" class="headerlink" title="调用栈（Call Stack）"></a>调用栈（Call Stack）</h2><p>调用栈描述的是函数之间的调用关系。调用栈由栈帧（Stack Frame）组成，每个栈帧对应着一个未运行完的函数。在GDB中可以用backtrace（简称bt）命令打印所有栈帧信息。若要用p命令打印一个非当前栈帧的局部变量，可以用frame命令选择另一个栈帧</p><h3 id="拿个程序来玩玩-swap-c文件"><a href="#拿个程序来玩玩-swap-c文件" class="headerlink" title="拿个程序来玩玩,swap.c文件"></a>拿个程序来玩玩,<em><strong>swap.c</strong></em>文件</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t;t = a;a = b;b = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">3</span>, b=<span class="number">4</span>;</span><br><span class="line">swap(a,b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>,a,b);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/001.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/001.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/002.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/002.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>*** 程序的目的是交换a和b的值，然而并没有交换交换成功 ***</p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/003.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/003.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>原因：</p><ul><li>函数的形参和在函数内部声明的变量都是该函数的局部变量。无法访问其他函数的局部变量。</li><li>局部变量的存储空间是临时分配的，函数执行完毕时，局部变量的空间将被释放，其中的值无法保留到下次使用。</li><li>如果要实现真正的交换，我们应该传入的是存储变量的地址，此时函数swap的形参类型应该为指针类型</li></ul><blockquote><p>PS:<br>C语言的变量都是放在内存中的，而内存中间的每一个字节都有一个称为地址(address)的编号。<br>每一个变量都占有一定数目的字节（可以用sizeof运算符获得），其中第一个字节的地址称为变量的地址。</p></blockquote><h3 id="o-≧▽≦-ツ┏━┓拿个递归程序来玩玩"><a href="#o-≧▽≦-ツ┏━┓拿个递归程序来玩玩" class="headerlink" title="o(*≧▽≦)ツ┏━┓拿个递归程序来玩玩"></a>o(*≧▽≦)ツ┏━┓拿个递归程序来玩玩</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> n == <span class="number">0</span> ? <span class="number">1</span> : f(n<span class="number">-1</span>)*n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,f(<span class="number">3</span>));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/004.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/004.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://raw.githubusercontent.com/yeshan333/blog_images/master/005.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/blog_images/master/005.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><blockquote><p>在C语言的函数中，调用自己和调用其他函数没有任何本质区别，都是建立新栈帧，传递参数并修改当前代码行。在函数执行体完毕后删除栈帧，处理返回值，并修改当前代码行数。</p></blockquote><blockquote><p>以上调用栈的一个比喻</p><blockquote><p>皇帝（拥有main函数的栈帧）：大臣，你给我算下f(3)<br>大臣（拥有f(3)的栈帧）：知府，你给我算下f(2)<br>知府（拥有f(2)的栈帧）：县令，你给我算下f(1)<br>县令（拥有f(1)的栈帧）：师爷，你给我算下f(0)<br>师爷（拥有f(0)的栈帧）：回老爷，f(0)=1<br>县令（心算f(1)=f(0)*1=1）：回知府大人，f(1)=1<br>知府（心算f(2)=f(1)*2=2）：回大人，f(2)=2<br>大臣（心算f(3)=f(2)*3=6）：回皇上，f(3)=6<br>皇上满意了</p></blockquote></blockquote><p>emmmmmm。。。。。。。。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>标准库容器</title>
      <link href="2018/12/01/%E6%A0%87%E5%87%86%E5%BA%93%E5%AE%B9%E5%99%A8/"/>
      <url>2018/12/01/%E6%A0%87%E5%87%86%E5%BA%93%E5%AE%B9%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://i.imgur.com/T0WbcwD.png" class="lazyload" data-srcset="https://i.imgur.com/T0WbcwD.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><blockquote><p>标准库容器是模板类型，用来保存给定类型的对象。一个容器就是一些特定类型对象的集合。</p></blockquote><h1 id="顺序容器"><a href="#顺序容器" class="headerlink" title="顺序容器"></a>顺序容器</h1><ul><li>顺序容器我们提供了控制元素存储和访问顺序的能力。这种顺序不依赖于元素的值，而是与元素加入容器时的位置对应。</li><li>一般来说，每个容器都定义在一个都文件中</li><li>顺序元素几乎可以保存任意类型的元素</li></ul><table><thead><tr><th align="center">顺序容器类型</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">vector</td><td align="center">可变大小数组。支持快速随机访问。在尾部之外的位置插入或删除元素可能很慢</td></tr><tr><td align="center">array</td><td align="center">固定大小数组，支持快速随机访问，不能添加或删除元素</td></tr><tr><td align="center">string</td><td align="center">与vector相似的容器，但专门用于保存字符。随机访问块。在尾部插入或删除快</td></tr><tr><td align="center">deque</td><td align="center">双端队列。支持快速随机访问。在头尾位置插入或删除速度很快</td></tr><tr><td align="center">list</td><td align="center">双向链表。只支持双向顺序访问，在list中任何位置进行插入或删除操作的速度都很快</td></tr><tr><td align="center">forward_list</td><td align="center">单向链表。只支持单向顺序访问，在链表的任何位置进行插入或删除操作的速度都很快</td></tr></tbody></table><p>forward_list、array是新C++标准增加的类型<br>与内置数组相比，array是一种更安全、更容易使用的数组类型。<br>array对象的大小不是固定的，因此，他支持插入和删除元素以及改变容器大小的操作</p><h2 id="容器类型成员"><a href="#容器类型成员" class="headerlink" title="容器类型成员"></a>容器类型成员</h2><p>每个容器都定义了多个类型</p><table><thead><tr><th align="center">类型别名</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">iterator</td><td align="center">容器的迭代器类型成员</td></tr><tr><td align="center">const_iterator</td><td align="center">可以读取元素，但不能修改元素的迭代器类型</td></tr><tr><td align="center">size_type</td><td align="center">无符号整数类型，足够保存此种容器类型最大可能容器的大小</td></tr><tr><td align="center">differrnce_type</td><td align="center">带符号整数类型，足够保存两个迭代器之间的距离</td></tr><tr><td align="center">value_type</td><td align="center">元素类型</td></tr><tr><td align="center">reference_type</td><td align="center">元素左值类型，与value_type&amp;含义相同</td></tr><tr><td align="center">const_reference</td><td align="center">元素的const左值类型，(即const value_type&amp;)</td></tr></tbody></table><p>** 通过类型别名，我们可以在不了解容器中元素类型的情况下使用它 **</p><p>为了使用这些类型，我们必须显示的使用其类型名<br>    vector<int>::iterator iter;//iter是通过vector<int>定义的迭代器类型</p><blockquote><p>容器的begin成员和end成员<br>begin成员生成一个指向容器中第一个元素位置的迭代器<br>end成员生成指向尾元素之后的位置的迭代器</p></blockquote><h2 id="容器定义和初始化"><a href="#容器定义和初始化" class="headerlink" title="容器定义和初始化"></a>容器定义和初始化</h2><ul><li>每个容器都定义了一个默认的构造函数。容器的默认的构造函数都会创建一个指定类型的空容器，他们都可以接受指定容器大小和元素初始值的参数</li><li>由于array是固定大小的数组。定义一个array时，除了制定元素类型外，还要指定容器的大小</li><li>创建一个容器为另一个容器的拷贝时，两个容器的类型以及元素的类型必须相同</li><li>当传递迭代器参数来拷贝一个范围时，不要求容器的类型必须相同，且新容器和原容器的元素类型也可以不同，只要能将要拷贝的元素的类型转换为要初始化的容器的元素类型即可</li></ul><table><thead><tr><th align="center">定义&amp;初始化方式</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">C a</td><td align="center">默认构造函数，如果C是一个array，则a中元素按默认方式初始化，否则a为空</td></tr><tr><td align="center">C a(b)<br>C a=b</td><td align="center">a初始化为b的拷贝。**a和b必须是相同的类型(它们必须是相同的容器类型，且保存的是相同的元素类型)**，对于array我们还要定义它的大小</td></tr><tr><td align="center">C a{b,c,d,e,f,…}<br>C a={b,c,d,e,f,…}</td><td align="center">a初始化为初始化列表中元素的拷贝。列表中的元素类型必须与a的元素类型相容。对于array来说，列表元素的数目必须小于或等于array的大小，任何遗漏的元素直接进行值初始化</td></tr><tr><td align="center">C a(b_iterator,c_iterator)</td><td align="center">a初始化为迭代器b_iterator和c_iterator指定范围中元素的拷贝，范围中元素的类型必须与a的元素类型相容</td></tr><tr><td align="center">C a(n)</td><td align="center">a包含n个元素，这些元素进行了值初始化，此构造函数explicit的，string和array不适用</td></tr><tr><td align="center">C a(n,value)</td><td align="center">a包含n个初始化为值value的元素</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;forward_list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">list&lt;string&gt; <span class="title">svec</span><span class="params">(<span class="number">10</span>,<span class="string">&quot;shan&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:svec)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;i&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//vector&lt;string&gt; vec = svec;//#错误，容器类型不匹配</span></span><br><span class="line"></span><br><span class="line"><span class="function">forward_list&lt;string&gt; <span class="title">fvec</span><span class="params">(svec.begin(),svec.end())</span></span>;<span class="comment">//使用迭代器范围进行拷贝初始化</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:fvec)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;temp&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="标准库array的使用"><a href="#标准库array的使用" class="headerlink" title="标准库array的使用"></a>标准库array的使用</h3><ul><li>定义一个array时，我们要指定元素的类型，还要指定容器的大小</li><li>由于大小是array类型的一部分，array不支持不同容器类型的构造函数</li><li>对array进行列表初始化的时候，初始值的数目必须等于或小于array的大小</li><li>array要求初始值的类型必须要与创建的容器类型相一致</li><li>虽然我们不能对内置的数组进行拷贝或对象赋值操作，但是array并无此限制</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    array&lt;<span class="keyword">int</span> ,10&gt; num_1;<span class="comment">//定义了一个保存10个int的数组</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:num_1)</span><br><span class="line">    cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">array&lt;<span class="keyword">int</span> ,10&gt; num_2=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:num_2)</span><br><span class="line">    cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">int</span> d[<span class="number">5</span>]=&#123;<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">15</span>&#125;;</span><br><span class="line"><span class="comment">//int b[5]=d; 这是错误的，内置数组不支持拷贝和赋值</span></span><br><span class="line"></span><br><span class="line">array&lt;<span class="keyword">int</span> ,6&gt; try_1=&#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line">array&lt;<span class="keyword">int</span> ,6&gt; try_2=try_1;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:try_2)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/IiUtXSK.png" class="lazyload" data-srcset="https://i.imgur.com/IiUtXSK.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h2><h3 id="swap和assign"><a href="#swap和assign" class="headerlink" title="swap和assign"></a>swap和assign</h3><ul><li><strong>a.swap(b)</strong>:用于交换两个容器中的元素，两个容器必须具有相同的类型</li><li><strong>swap(a,b)</strong>:用于交换两个相同类型的容器中的元素</li><li><strong>a.assign(1_iterator,2_iterator)</strong>:将a中的元素替换为迭代器1_iterator和2_iterator范围中的元素，迭代器不能指向a中的元素</li><li><strong>a.assign(value_list)</strong>: 将a中的元素初始化为初始化列表value_list中的元素</li><li><strong>a.assign(n,value)</strong>:将a中的元素替换为n个值为value的元素</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; a=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; b;</span><br><span class="line">b.<span class="built_in">assign</span>(&#123;<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>&#125;);</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:b)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">b.<span class="built_in">assign</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:b)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* swap操作交换两个相同类型容器的内容</span></span><br><span class="line"><span class="comment">* assing操作用参数所指定的元素(即拷贝)替换左边容器中的所有元素。</span></span><br><span class="line"><span class="comment">* assign允许我们从不同但相容的类型赋值，或者从一个容器的子序列赋值</span></span><br><span class="line"><span class="comment">* 除了string外，指向容器的迭代器、引用和指针在swap操作后都不会失效</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; temp=&#123;<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">66</span>,<span class="number">77</span>,<span class="number">88</span>&#125;;</span><br><span class="line">b.<span class="built_in">swap</span>(temp);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;temp: &quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;size-&quot;</span>&lt;&lt;temp.<span class="built_in">size</span>()&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i=temp.<span class="built_in">begin</span>();i != temp.<span class="built_in">end</span>();i++)</span><br><span class="line">    cout&lt;&lt;*i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;b: &quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;size-&quot;</span>&lt;&lt;b.<span class="built_in">size</span>()&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> j=b.<span class="built_in">begin</span>();j != b.<span class="built_in">end</span>();j++)</span><br><span class="line">    cout&lt;&lt;*j&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/DltXOoC.png" class="lazyload" data-srcset="https://i.imgur.com/DltXOoC.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="向容器中添加元素（array不支持这些操作）"><a href="#向容器中添加元素（array不支持这些操作）" class="headerlink" title="向容器中添加元素（array不支持这些操作）"></a>向容器中添加元素（array不支持这些操作）</h3><table><thead><tr><th align="center">&ensp;</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">C.push_back(t)<br>C.emplace_back(args)</td><td align="center">在C的尾部创建一个值为t或由args创建的元素。返回void类型</td></tr><tr><td align="center">C.push_front(t)<br>C.emplace_front(args)</td><td align="center">在C的头部创建一个值为t或由args创建的元素，返回指向新添加的元素的迭代器</td></tr><tr><td align="center">C.insert(p_iterator,t)<br>C.emplace(p_iterator,args)</td><td align="center">在迭代器p_iterator之前插入一个值为t或由args创建的元素，返回指向新添加的元素的迭代器</td></tr><tr><td align="center">C.insert(p_iterator,n,t)</td><td align="center">在迭代器p_iterator指向的元素之前插入n个值为t的元素，返回指向新插入的第一个元素的迭代器，若n为0，则返回p_iterator</td></tr><tr><td align="center">C.insert(p_iterator,a_iterator,b_iterator)</td><td align="center">将迭代器a_iterator和b_iterator指定的范围内的元素插入到迭代器p_iterator指向的元素之前，迭代器范围不能指向C中的元素。返回指向第一个新添加的元素的迭代器，若范围为空，则返回p_iterator</td></tr><tr><td align="center">C.insert(p_iterator,li)</td><td align="center">将由花括号括起来的元素值列表li插入待迭代器p_iterator所指的元素之前。返回新添加的第一个元素的迭代器，若列表为空，则返回p_iterator</td></tr></tbody></table><ul><li>向一个vector、string或deque中插入元素会使所有指向容器的迭代器、引用和指针失效</li><li>记住，insert函数将元素插入到迭代器所指定的位置之前</li><li>当我们用一个对象来初始化容器时，或将一个对象插入到容器中的时，实际上放入到容器中的是对象的值的拷贝，而不是对象本身</li><li>vector、list、deque、string都支持insert成员，forward_list提供了特殊版本的insert成员</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">operated_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;string&gt; ss&#123;<span class="string">&quot;shansan&quot;</span>,<span class="string">&quot;wocao&quot;</span>,<span class="string">&quot;yeshan&quot;</span>&#125;;</span><br><span class="line">vector&lt;string&gt; v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:ss)</span><br><span class="line">    v.<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:v)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">operated_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">list&lt;<span class="keyword">int</span>&gt; ls;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> num=<span class="number">3</span>;num&gt;=<span class="number">0</span>;num--)</span><br><span class="line">        ls.<span class="built_in">push_front</span>(num);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">5</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">        ls.<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i=ls.<span class="built_in">begin</span>();i != ls.<span class="built_in">end</span>(); i++)</span><br><span class="line">   cout&lt;&lt;*i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">operated_3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v_1&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v_2&#123;<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line">v_1.<span class="built_in">insert</span>(v_1.<span class="built_in">begin</span>(),<span class="number">66</span>);<span class="comment">//在迭代器v_1.begin()所指的元素之前插入一个元素66</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp: v_1)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">v_1.<span class="built_in">insert</span>(v_1.<span class="built_in">begin</span>(),v_2.<span class="built_in">begin</span>(),v_2.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">//在迭代器v_1.begin()所指的元素之前，插入迭代器v_2.begin()到v_2.end()指顶范围内的元素</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> temp:v_1)</span><br><span class="line">        cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">operated_1</span>();</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">operated_2</span>();</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">operated_3</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/30/Fm5CWt.md.png" class="lazyload" data-srcset="https://s1.ax1x.com/2018/11/30/Fm5CWt.md.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Fm5CWt.md.png"></p><h4 id="emplace操作"><a href="#emplace操作" class="headerlink" title="emplace操作"></a>emplace操作</h4><blockquote><p>当调用一个insert或push成员函数时，我们将元素类型的对象传递给它们，这些对象被拷贝到容器中<br>当调用一个emplace函数时，则是将参数传递给元素类型的构造函数。emplace成员直接使用这些参数在容器管理的内存空间中直接构造函数</p></blockquote><p><font color="red">emplace函数在容器中直接构造函数。传递给emplace函数的参数必须与元素类型的构造函数相匹配</font></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">student</span>(string str,<span class="keyword">int</span> a):<span class="built_in">name</span>(str),<span class="built_in">age</span>(a)&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;name: &quot;</span>&lt;&lt;<span class="keyword">this</span>-&gt;name&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;<span class="string">&quot;Age: &quot;</span>&lt;&lt;<span class="keyword">this</span>-&gt;age&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line">string name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;student&gt; s;<span class="comment">//我们将student存到了vector中</span></span><br><span class="line"></span><br><span class="line">s.<span class="built_in">emplace_back</span>(<span class="string">&quot;shansan&quot;</span>,<span class="number">18</span>);<span class="comment">//使用student对象的构造函数</span></span><br><span class="line">    <span class="keyword">auto</span> temp=s.<span class="built_in">begin</span>();</span><br><span class="line">    (*temp).<span class="built_in">print_1</span>();</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//s.push_back(&quot;try&quot;,66);//error：没有接受两个参数的push_back版本</span></span><br><span class="line"></span><br><span class="line">s.<span class="built_in">push_back</span>(<span class="built_in">student</span>(<span class="string">&quot;try&quot;</span>,<span class="number">66</span>));<span class="comment">//创建一个临时的student对象传递给push_back</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i:s)</span><br><span class="line">        i.<span class="built_in">print_1</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/30/Fmo5dg.png" class="lazyload" data-srcset="https://s1.ax1x.com/2018/11/30/Fmo5dg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Fmo5dg.png"></p><h3 id="访问容器中的元素"><a href="#访问容器中的元素" class="headerlink" title="访问容器中的元素"></a>访问容器中的元素</h3><table><thead><tr><th align="center">访问操作</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">c.back()</td><td align="center">返回c中尾元素的引用。若c为空，函数行为未定义</td></tr><tr><td align="center">c.front()</td><td align="center">返回c中首元素的引用。若c为空，函数行为未定义</td></tr><tr><td align="center">c[n]</td><td align="center">返回c中下标为n的元素的引用，n是一个无符号整数。若n&gt;=c.size()，则函数行为未定义</td></tr><tr><td align="center">c.at(n)</td><td align="center">返回下标为n的元素的引用。如果下标越界，则抛出一个out_of_range异常</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 不要对一个空的容器使用front和back操作</span></span><br><span class="line"><span class="comment">* at和下标操作只适用于string、vector、deque和array</span></span><br><span class="line"><span class="comment">* back不适用于forward_list</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v&#123;<span class="number">1</span>,<span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a = v.<span class="built_in">front</span>();</span><br><span class="line">a=<span class="number">33</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v[0]=&quot;</span>&lt;&lt;v[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> &amp;refer = v.<span class="built_in">front</span>();</span><br><span class="line">refer =<span class="number">33</span>;<span class="comment">//改变了v[0]的值</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v[0]=&quot;</span>&lt;&lt;v[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于访问成员函数的返回值是引用类型，如果是非const的，我们可以使用它来改变元素的值</p><h3 id="删除容器中的元素"><a href="#删除容器中的元素" class="headerlink" title="删除容器中的元素"></a>删除容器中的元素</h3><table><thead><tr><th align="center">删除操纵</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">c.pop_back()</td><td align="center">删除c的尾元素，如果c是空的，则函数行为未定义。函数返回void</td></tr><tr><td align="center">c.pop_front()</td><td align="center">删除c的首元素，如果c是空的，则函数行为未定义。函数返回void</td></tr><tr><td align="center">c.erase(p_iterator)</td><td align="center">删除迭代器p_iterator所指定的元素，返回一个指向被删除的元素之后元素的迭代器，若p_iterator指向尾元素，则返回尾后迭代器，若p_iterator是尾后迭代器，则函数行为未定义</td></tr><tr><td align="center">c.erase(a_iterator,b_iterator)</td><td align="center">删除迭代器a_iterator和b_iterator所指定范围内的元素，返回一个指向最后一个被删元素之后元素的迭代器，若b_iterator本身就是尾后迭代器，则返回尾后迭代器</td></tr><tr><td align="center">c.clear()</td><td align="center">删除c中所有的元素</td></tr></tbody></table><p><strong>删除deque中除首尾位置之外的任何元素都会使迭代器、引用和指针失效。指向vector或string中删除点位置之后的迭代器、引用和指针都会失效</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;string&gt; str&#123;<span class="string">&quot;shansan&quot;</span>,<span class="string">&quot;wocao&quot;</span>,<span class="string">&quot;555&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:str)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">str.<span class="built_in">pop_back</span>();</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:str)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">str.<span class="built_in">erase</span>(str.<span class="built_in">begin</span>(),str.<span class="built_in">end</span>());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:str)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">    list&lt;<span class="keyword">int</span>&gt; lst=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line">    <span class="keyword">auto</span> it = lst.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">while</span>(it != lst.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(*it%<span class="number">2</span>)</span><br><span class="line">        it = lst.<span class="built_in">erase</span>(it);<span class="comment">//删除奇数元素,返回指向被删除元素的下一个元素的迭代器</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            it++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:lst)</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/QmwV39Y.png" class="lazyload" data-srcset="https://i.imgur.com/QmwV39Y.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="改变容器大小"><a href="#改变容器大小" class="headerlink" title="改变容器大小"></a>改变容器大小</h3><blockquote><ul><li><strong>c.resize(n)</strong>:调整c的大小为n个元素。若n&lt;c.size()，则多出的元素被丢弃；若必须添加新元素，对新元素进行值初始化</li><li><strong>c.resize(n,t)</strong>:调整c的大小为n个元素，任何新添加的元素都初始化为值t</li></ul></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v&#123;<span class="number">22</span>,<span class="number">33</span>,<span class="number">3</span>&#125;;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v capacity:&quot;</span>&lt;&lt;v.<span class="built_in">capacity</span>()&lt;&lt;endl;</span><br><span class="line">v.<span class="built_in">resize</span>(<span class="number">6</span>,<span class="number">1</span>);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v size:&quot;</span>&lt;&lt;v.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v capacity:&quot;</span>&lt;&lt;v.<span class="built_in">capacity</span>()&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:v)</span><br><span class="line">    cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 使用reserve操作通知容器应该为我们预留多少空间</span></span><br><span class="line"><span class="comment">- resize成员函数只改变容器中成员函数的数目，不改变容器的容量</span></span><br><span class="line"><span class="comment">- 容器的size操作指的是它已经保存的元素的数目</span></span><br><span class="line"><span class="comment">- capacity则是在不不分配新的内存空间的前提下知道它最多可以保存多少个元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">v.<span class="built_in">reserve</span>(<span class="number">100</span>);</span><br><span class="line">cout&lt;&lt;endl&lt;&lt;<span class="string">&quot;v capacity:&quot;</span>&lt;&lt;v.<span class="built_in">capacity</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;v size:&quot;</span>&lt;&lt;v.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/foIu4wG.png" class="lazyload" data-srcset="https://i.imgur.com/foIu4wG.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Keep on moving ！</title>
      <link href="2018/11/27/Keep-on-moving-%EF%BC%81/"/>
      <url>2018/11/27/Keep-on-moving-%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://i.imgur.com/P1TgIck.jpg" class="lazyload" data-srcset="https://i.imgur.com/P1TgIck.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><p>比赛终于完了！<br>又可以安心打代码看书了<br>emmmmmmm</p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>再探函数</title>
      <link href="2018/11/22/%E5%86%8D%E6%8E%A2%E5%87%BD%E6%95%B0/"/>
      <url>2018/11/22/%E5%86%8D%E6%8E%A2%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="main-处理命令行"><a href="#main-处理命令行" class="headerlink" title="main:处理命令行"></a>main:处理命令行</h1><pre><code>//main函数的两种定义形式int main(int argc,char **argv[])int main(int argc,char *argv[])</code></pre><ul><li>argc:指的是命令行中输入参数的个数</li><li>argv:一个数组，它存储了所有的命令行参数</li></ul><span id="more"></span><p><img src="https://raw.githubusercontent.com/yeshan333/git_images/master/text.png" class="lazyload" data-srcset="https://raw.githubusercontent.com/yeshan333/git_images/master/text.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>参数使用示例子:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//file_name:test.cpp</span></span><br><span class="line"><span class="comment">//author:shansan</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;argc;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;argv[%d]=%s\n&quot;</span>,i,argv[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/nCsaA2L.gif" class="lazyload" data-srcset="https://i.imgur.com/nCsaA2L.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="含有可变形参的函数"><a href="#含有可变形参的函数" class="headerlink" title="含有可变形参的函数"></a>含有可变形参的函数</h1><h2 id="initializer-list形参"><a href="#initializer-list形参" class="headerlink" title="initializer_list形参"></a>initializer_list形参</h2><ul><li>initializer_list是一种标准库类型，用于表示某种特定类型的值的数组</li><li>initializer_list也是一种模板类型</li><li>支持size(),begin(),end()等操作</li><li>向initializer_list形参中传递一个值的序列，则必须把序列放在花括号中</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_1</span><span class="params">(initializer_list&lt;string&gt; str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//遍历实参表列,使用initializer_list对象的成员begin和end进行遍历</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;parameter nums: &quot;</span>&lt;&lt;str.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp = str.<span class="built_in">begin</span>();temp != str.<span class="built_in">end</span>(); ++temp)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;*temp&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//用范围for语句遍历表列</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> beg : str)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;beg&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">const</span> string a = <span class="string">&quot;shansan&quot;</span>;</span><br><span class="line">string b = <span class="string">&quot;yeshan333&quot;</span>;</span><br><span class="line">string c = <span class="string">&quot;wocao&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向initializer_list形参中传递一个值的序列需放在花括号内部</span></span><br><span class="line">    <span class="built_in">print_1</span>(&#123;a,b,c&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/RdxXrcD.png" class="lazyload" data-srcset="https://i.imgur.com/RdxXrcD.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="函数返回值—–列表初始化返回值"><a href="#函数返回值—–列表初始化返回值" class="headerlink" title="函数返回值—–列表初始化返回值"></a>函数返回值—–列表初始化返回值</h1><ul><li>函数可以返回花括号包围的值的列表</li><li>如果函数返回的是内置类型，则花括号包围的列表最多包含一个值，而且该值所占空间不应该大于目标类型的空间</li><li>如果函数返回的是类类型，由类本身定义初始值如何使用</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">process</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;<span class="string">&quot;shansan&quot;</span>,<span class="string">&quot;yeshan333&quot;</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;string&gt; v;</span><br><span class="line">v = <span class="built_in">process</span>();</span><br><span class="line"><span class="comment">//遍历vector对象</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp : v)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;temp&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/1cZJ4Uu.png" class="lazyload" data-srcset="https://i.imgur.com/1cZJ4Uu.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="调试帮助，预定义跟踪调试"><a href="#调试帮助，预定义跟踪调试" class="headerlink" title="调试帮助，预定义跟踪调试"></a>调试帮助，预定义跟踪调试</h1><p>编译器为我们定义的</p><ul><li><strong>func</strong>:存放当前调试函数的名字</li><li><strong>FILE</strong>:存放文件名的字符串字面值常量</li><li><strong>LINE</strong>:存放文件当前行号的整型字面值</li><li><strong>TIME</strong>:存放文件编译时间的字符串字面值常量</li><li><strong>DATE</strong>:存放文件编译日期的字符串字面值常量</li></ul><p><img src="https://i.imgur.com/zYffeTU.png" class="lazyload" data-srcset="https://i.imgur.com/zYffeTU.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IO类型</title>
      <link href="2018/11/22/IO%E7%B1%BB%E5%9E%8B/"/>
      <url>2018/11/22/IO%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="IO库"><a href="#IO库" class="headerlink" title="IO库"></a>IO库</h1><p>** IO库设施: **</p><ul><li><code>istream</code>类型:提供输入操作</li><li><code>ostream</code>类型:提供输出操作</li><li><code>cin</code>:一个istream对象，从标准输入读取数据</li><li><code>cout</code>:一个ostream对象，从标准输出写入数据</li><li><code>cerr</code>:一个ostream对象，通常用于输出程序错误信息，写入到标准错误</li><li><code>&gt;&gt;</code>运算符:用来从一个istream对象读取输入数据</li><li><code>&lt;&lt;</code>运算符:用来向一个ostream对象写入数据</li><li><code>getline</code>函数:从一个给定的istream读取一行数据，存入一个给定的string对象中</li></ul><span id="more"></span><h2 id="IO类"><a href="#IO类" class="headerlink" title="IO类"></a>IO类</h2><table><thead><tr><th align="center">头文件</th><th align="center">IO库类型</th></tr></thead><tbody><tr><td align="center">iostream</td><td align="center">istream,wistream从流读取数据<br>ostream,wostream向流写入数据<br>iostream,wiostream读写流</td></tr><tr><td align="center">fstream</td><td align="center">ifstream,wistream从文件读取数据<br>ofstream,wofstream向文件写入数据<br>fstream,wfstream读写文件</td></tr><tr><td align="center">sstream</td><td align="center">istringstream,wistringstream从string读取数据<br>ostringstream,wostringstream向string写入数据<br>stringstream,wstringstream读写string</td></tr></tbody></table><ul><li><font color="green">IO对象没有拷贝或赋值</font></li><li><font color="green">定义函数时不能将形参设置为流类型</font></li><li><font color="green">进行IO操作的函数通常使用引用方式传递和返回流</font></li></ul><p>因为读写一个IO对象会改变其状态，因此传递和返回的引用不能是const类型的</p><p>一个流一旦发生错误，其后续的IO操作都会失败</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">istream&amp; <span class="title">read_print</span><span class="params">(istream &amp;s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">while</span>(s&gt;&gt;score)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;score&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">    s.clear();<span class="comment">//流复位，清楚所有错误标志位</span></span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">read_print(<span class="built_in">cin</span>);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;shansan&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="输出缓冲管理"><a href="#输出缓冲管理" class="headerlink" title="输出缓冲管理"></a>输出缓冲管理</h3><pre><code>cout&lt;&lt;&quot;shansan&quot;</code></pre><p>文本串可能立即打印出来，但也有可能被操作系统保存在操作系统的缓冲区中，随后再打印。<br>缓冲机制的存在可以让操作系统将程序的多个输出操作组合成单一的系统级写操作<br>由于设备写操作可能很耗时间，允许操作系统将多个输出操作组合为单一的设备写操作可以带来很大的便利</p><p>** 使用操纵符刷新缓冲区 **</p><ul><li>endl:完成换行机制并且刷新缓冲区</li><li>ends:仅刷新缓冲区</li><li>flush:仅刷新缓冲区</li></ul><p>程序崩溃，输出缓冲区不会刷新</p><h2 id="文件IO"><a href="#文件IO" class="headerlink" title="文件IO"></a>文件IO</h2><p><a href="https://shansan.top/2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++-2/#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6-amp-amp-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6">https://shansan.top/2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++-2/#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6-amp-amp-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6</a><br>头文件定义了三个文件类型来支持文件IO</p><ul><li>ifstream:从文件读取数据</li><li>ofstream:向文件写入数据</li><li>fstream:读和写操作都能进行</li></ul><p>每一个文件流对象都定义了一个名为open的成员函数，它完成了一些系统相关的操作，来定位给定的文件，并视情况打开为读或写模式<br>一旦一个文件流已经打开，它就保持与对应文件的关联。对一个已经打开的文件流调用open会失败，并会导致failbit被置位，随后试图使用文件流的操作都会失败</p><p>** ifstream、ofstream、fstream对象上的操作，以下操作都适用</p><table><thead><tr><th align="center">操作</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">fstream file</td><td align="center">创建一个未绑定的文件流</td></tr><tr><td align="center">fstream file(file_name)</td><td align="center">创建一个fstream对象，并打开名字为file_name的文件。file_name可以是一个指向C风格的字符串，也可以是一个string类型</td></tr><tr><td align="center">fstream file(file_name,mode)</td><td align="center">mode为指定的打开模式</td></tr><tr><td align="center">fstream.close()</td><td align="center">关闭与fstream绑定的文件</td></tr><tr><td align="center">fstream.is_open()</td><td align="center">返回一个bool值，指出与fstream关联的文件是否成功被打开且尚未被关闭</td></tr></tbody></table><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ofstream file;</span><br><span class="line">file.open(<span class="string">&quot;shansan.txt&quot;</span>);</span><br><span class="line">    <span class="comment">//等价于fstream file(&quot;shanshan.txt&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//像文件写入数据</span></span><br><span class="line">file&lt;&lt;<span class="string">&quot;shansan&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">file&lt;&lt;<span class="string">&quot;shansan.top&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">file&lt;&lt;<span class="string">&quot;yeshan333.github.io&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">file.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">string</span> buffer;</span><br><span class="line">    <span class="function">ifstream <span class="title">read_file</span><span class="params">(<span class="string">&quot;shansan.txt&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; v;</span><br><span class="line"><span class="keyword">while</span>(getline(read_file,buffer))<span class="comment">//每次从read_file读取一行给buffer</span></span><br><span class="line">    v.push_back(buffer);<span class="comment">//将buffer存到vector对象v中</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:v)</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;temp&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">write();</span><br><span class="line">read_print();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/Rtdn8Ax.gif" class="lazyload" data-srcset="https://i.imgur.com/Rtdn8Ax.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="文件模式"><a href="#文件模式" class="headerlink" title="文件模式"></a>文件模式</h2><p>每一个流都有一个关联的文件模式，用来指出如何使用文件。<br>每一个文件流都定义了一个默认的文件模式</p><ul><li>与ifstream关联的文件默认以in模式打开</li><li>与ofstream关联的文件默认以out模式打开</li><li>与fstream关联的文件默认以in和out模式打开</li></ul><table><thead><tr><th align="center">文件模式</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">in</td><td align="center">以读方式打开文件</td></tr><tr><td align="center">out</td><td align="center">以写方式打开文件</td></tr><tr><td align="center">app</td><td align="center">每次写操作前均定位到文件末尾</td></tr><tr><td align="center">ate</td><td align="center">打开文件后立即定位到文件末尾</td></tr><tr><td align="center">trunc</td><td align="center">截断文件</td></tr><tr><td align="center">binary</td><td align="center">以二进制方式进行IO</td></tr></tbody></table><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>排序算法</title>
      <link href="2018/11/20/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
      <url>2018/11/20/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="稳定的直接插入排序"><a href="#稳定的直接插入排序" class="headerlink" title="稳定的直接插入排序"></a>稳定的直接插入排序</h2><p>基本思想:<br>我们将一个待排序序列分为有序区和无序区（一般开始的时候将第一个元素作为有序区，剩下的元素作为无序区），每次将无序区的第一个元素作为待插入记录，按大小插入到前面已经排好的有序区中的适当位置，直到记录全部插入完成为止。(如果待插入的元素与有序序列中的某个元素相等，则将待插入元素插入到相等元素的后面)</p><p><img src="https://i.loli.net/2020/03/19/caSr79khlpmREqT.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/19/caSr79khlpmREqT.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="插入排序"></p><span id="more"></span><p><strong>C++ 实现</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_sort_1</span><span class="params">(<span class="keyword">int</span> a[],<span class="keyword">int</span> n)</span><span class="comment">//对n个元素从小到大排序</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = a[i];<span class="comment">//待插入元素</span></span><br><span class="line">j = i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(temp&lt;a[j] &amp;&amp; j)</span><br><span class="line">&#123;</span><br><span class="line">a[j+<span class="number">1</span>] = a[j];<span class="comment">//将大的往后挪</span></span><br><span class="line">j--;<span class="comment">//顺利的话可以减到-1，要么就是减到可以插入的位置的前一个位置</span></span><br><span class="line">    <span class="comment">//所以后面的j需要加1</span></span><br><span class="line">&#125;</span><br><span class="line">a[j+<span class="number">1</span>]=temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Python 实现</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">def <span class="title">insert_sort</span><span class="params">(arr: List[<span class="keyword">int</span>], n: <span class="keyword">int</span>)</span> -&gt; None:</span></span><br><span class="line"><span class="function">    for i in range(<span class="number">1</span>, n):</span></span><br><span class="line"><span class="function">        j: int =</span> i - <span class="number">1</span></span><br><span class="line">        wait_insert_ele: <span class="keyword">int</span> = arr[i]</span><br><span class="line">        <span class="keyword">while</span> j &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> arr[j] &gt; wait_insert_ele:</span><br><span class="line">                arr[j+<span class="number">1</span>] = arr[j]  # 将大于待插入元素的往后移</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">        arr[j + <span class="number">1</span>] = wait_insert_ele  # 插入数据</span><br></pre></td></tr></table></figure><h2 id="稳定的冒泡排序"><a href="#稳定的冒泡排序" class="headerlink" title="稳定的冒泡排序"></a>稳定的冒泡排序</h2><p>基本思想:<br>我们把待排序元素序列竖直放置，每趟<strong>对相邻的元素</strong>进行<strong>两两比较</strong>，顺序相反则进行交换，每趟会将最小或最大的元素“浮”到元素序列的顶端，最终元素序列达到有序</p><p><img src="https://i.loli.net/2020/04/22/JZPxfMrFWntuobd.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/22/JZPxfMrFWntuobd.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="冒泡排序示例"></p><p><strong>实现示例</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubble_sort</span><span class="params">(<span class="keyword">int</span> array[],<span class="keyword">int</span> n)</span><span class="comment">// 对 n 个数从小到大排序，注意数组下标从 0 开始</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)<span class="comment">// 进行 n-1 趟比较</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;n<span class="number">-1</span>-i;j++)<span class="comment">// 每趟进行 n-1-i 次比较</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(array[j+<span class="number">1</span>]&lt;array[j])</span><br><span class="line">&#123;</span><br><span class="line">    temp = array[j+<span class="number">1</span>];</span><br><span class="line">    array[j+<span class="number">1</span>] = array[j];</span><br><span class="line">    array[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>优化（一但有一趟不需要比较，就表明可以结束了）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">arr: <span class="type">List</span>[<span class="built_in">int</span>], n: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        flag: <span class="built_in">bool</span> = <span class="literal">False</span>  <span class="comment"># 标记某趟是否还需要比较</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, n-i-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> arr[j] &gt; arr[j+<span class="number">1</span>]:</span><br><span class="line">                arr[j+<span class="number">1</span>], arr[j] = arr[j], arr[j+<span class="number">1</span>]</span><br><span class="line">                flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> flag:  <span class="comment"># 一但有一趟不需要比较，就表明可以结束了</span></span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="不稳定的快速排序"><a href="#不稳定的快速排序" class="headerlink" title="不稳定的快速排序"></a>不稳定的快速排序</h2><p>快速排序是分治思想在排序算法上的应用，从本质上来讲快速排序应该是在冒泡排序基础上的递归分治法。</p><p>算法步骤:</p><ol><li>从待排数列中选出一个元素作为基准，一般选第一个元素</li><li>重新排序待排数列，所有元素比基准小的摆放在基准前面，所有元素比基准大的摆放在基准后面（相同的数可以放在任意一边）。在这个分区退出后，该基准就处于中间位置。（这个即为分区操作(partion)）。</li><li>递归地把小于基准元素的子数列和大于基准元素的子数列进行排序。</li></ol><p><strong>实现</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">arr: <span class="type">List</span>[<span class="built_in">int</span>], left: <span class="built_in">int</span>, right: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    <span class="keyword">if</span> left &gt;= right:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    index = partition(arr, left, right)</span><br><span class="line">    quick_sort(arr, left, index - <span class="number">1</span>)</span><br><span class="line">    quick_sort(arr, index + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">arr: <span class="type">List</span>[<span class="built_in">int</span>], left: <span class="built_in">int</span>, right: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    pivot = arr[right]</span><br><span class="line">    index = left</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(left, right):</span><br><span class="line">        <span class="keyword">if</span> arr[j] &lt; pivot:</span><br><span class="line">            arr[j], arr[index] = arr[index], arr[j]</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">    arr[index], arr[right] = arr[right], arr[index]</span><br><span class="line">    <span class="keyword">return</span> index</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/23/MVtB1dAEOvhYZcm.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/23/MVtB1dAEOvhYZcm.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="快排示例"></p><p><img src="https://i.loli.net/2020/03/19/u1rQk8RPE7fydet.png" class="lazyload" data-srcset="https://i.loli.net/2020/03/19/u1rQk8RPE7fydet.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="quickSort.gif"></p><p><strong>另类 C 实现</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">101</span>],n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quick_sort</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j,temp;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="keyword">if</span>(left &gt; right)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">temp = a[left];<span class="comment">//基准数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">i = left;</span><br><span class="line">j = right;</span><br><span class="line"><span class="keyword">while</span>(i != j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//顺序很重要，先从右往左找</span></span><br><span class="line">    <span class="keyword">while</span>( a[j] &gt;= temp &amp;&amp; i&lt;j)</span><br><span class="line">&#123;</span><br><span class="line">j--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//再从左边往右找</span></span><br><span class="line"><span class="keyword">while</span>( a[j] &lt;= temp &amp;&amp; i&lt;j)</span><br><span class="line">&#123;</span><br><span class="line">i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//交换两个数在数组中的位置</span></span><br><span class="line"><span class="keyword">if</span>(i&lt;j)<span class="comment">//两个哨兵没有相遇</span></span><br><span class="line">&#123;</span><br><span class="line">t = a[i];</span><br><span class="line">a[i] = a[j];</span><br><span class="line">a[j] = t;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//最终将基准数归位,</span></span><br><span class="line"></span><br><span class="line">a[left] = a[i];</span><br><span class="line"></span><br><span class="line">a[i] = temp;<span class="comment">//归位</span></span><br><span class="line"></span><br><span class="line">quick_sort(left,i<span class="number">-1</span>);<span class="comment">//继续处理左边的数</span></span><br><span class="line">quick_sort(i+<span class="number">1</span>,right);<span class="comment">//继续处理右边的数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=n; i++)<span class="comment">//下表从1开始</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line"></span><br><span class="line">quick_sort(<span class="number">1</span>,n);<span class="comment">//sort</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[j]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="https://blog.csdn.net/adusts/article/details/80882649">https://blog.csdn.net/adusts/article/details/80882649</a></p></li><li><p><a href="https://github.com/hustcc/JS-Sorting-Algorithm">https://github.com/hustcc/JS-Sorting-Algorithm</a></p></li><li><p><a href="https://time.geekbang.org/column/article/41913">极客时间-数据结构与算法之美</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二分查找</title>
      <link href="2018/11/19/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"/>
      <url>2018/11/19/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="二分查找算法"><a href="#二分查找算法" class="headerlink" title="二分查找算法"></a>二分查找算法</h1><blockquote><p>二分查找的基本思想: 将 n 个元素分成大致相等的两部分，取 a[n/2] 与 x(查找目标值) 做比较，如果<code>x == a[n/2]</code> ,则找到 x,算法中止；否则，如果<code>x &lt; a[n/2]</code>,则只要在数组 a 的左半部分继续搜索 x,如果<code>x &gt; a[n/2]</code>, 则只要在数组 a 的右半部搜索 x。</p></blockquote><p>使用二分查找算法的<strong>前提</strong>：待查找序列是有序的</p><h1 id="时间复杂度分析"><a href="#时间复杂度分析" class="headerlink" title="时间复杂度分析"></a>时间复杂度分析</h1><p>由算法核心思想可知：每次对比都将下一步的比对范围缩小一半。每次比对后剩余数据项如下表:</p><p><img src="https://img.vim-cn.com/ea/4e858038b377ee0c3ff1d6539001791b4a7644.jpg" class="lazyload" data-srcset="https://img.vim-cn.com/ea/4e858038b377ee0c3ff1d6539001791b4a7644.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="剩余数据项表"></p><h2 id="最好情况"><a href="#最好情况" class="headerlink" title="最好情况"></a>最好情况</h2><p>即要找的元素正好在初始查找序列的中间一次比较出结果，时间复杂度为 $ O(1) $。</p><h2 id="最坏情况"><a href="#最坏情况" class="headerlink" title="最坏情况"></a>最坏情况</h2><p>即比对范围只剩下 1 个数据项的情况这个数据项即为正要找的元素。这时，可求解如下方程组($ i $ 为比较次数)：</p><p>$$ \frac{n}{2^i}=1 $$</p><p>时间复杂度为 $ O(log(n)) $</p><h2 id="平均时间复杂度"><a href="#平均时间复杂度" class="headerlink" title="平均时间复杂度"></a>平均时间复杂度</h2><p>进行平均时间复杂度分析时需要讨论：随着元素个数n的增多，需要几步算法才能终止？查找成功有多少种情况？查找失败有多少种情况？</p><p>设 $ n=2^k-1 $, $ k $ 为比较次数。易知，对于 $$ t=1,2,…, \lfloor log(n) \rfloor + 1 $$, 会有 $ 2^{t-1} $ 个元素在 $ t $ 步之后使算法成功终止。总共有 $ (2n+1) $ 种情况，$ n $ 种情况为成功结束，$ (n+1) $ 种情况为失败终止。</p><p>由此可得二分搜索的平均比较次数为 $ (k = \lfloor log(n) \rfloor + 1) $：<br>$$ A(n)= \frac{1}{2n+1}(\sum_{i=1}^{k}i2^{i-1} + k(n+1)) $$<br>根据初等数学等差乘等比数列求和的错位相减法/裂项相消法。易知,<br>$$ \sum_{i=1}^{k}i2^{i-1} = 2^k(k-1)+1 $$</p><blockquote><p>使用裂项相消法<br>由 $ \sum_{i=1}^{k}i2^{i-1} $，设 $ a_i=i2^{i-1},(i=1,…,k) $。注意到，$ a_i=(k-1)2^k-(k-2)2^{k-1} $。<br>$$ \sum_{i=1}^{k}i2^{i-1}=0\times2^1+1+1\times2^2-0\times2^1+2\times2^3-1\times2^2+…+(k-1)2^k-(k-2)2^{k-1}=2^k(k-1)+1 $$</p></blockquote><p>$$ A(n)= \frac{1}{2n+1}(\sum_{i=1}^{k}i2^{i-1} + k(n+1)) $$<br>$$ \sum_{i=1}^{k}i2^{i-1} = 2^k(k-1)+1 $$<br>综上可得，$$ A(n) = \frac{1}{2n+1}((k-1)2^{k}+1+k2^k) $$</p><p>当 $ n $ 非常大时，可得<br>$$ A(n) \approx \frac{1}{2^{k+1}}((k-1)2^{k}+k2^k)=\frac{(k-1)}{2}+\frac{k}{2}=k-\frac{1}{2} $$<br>所以 $ A(n)&lt;k=O(log(n)) $ ，平均时间复杂度为$ O(log(n)) $。</p><h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># binary_search</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search</span>(<span class="params">list_1, item</span>):</span></span><br><span class="line"></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="built_in">len</span>(list_1)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;使用 // 整除运算符可以不用int进行类型转换&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment">#每次都检查中间的元素</span></span><br><span class="line">        mid = (low + high)/<span class="number">2</span></span><br><span class="line">        guess = list_1[<span class="built_in">int</span>(mid)]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> guess == item:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(mid)<span class="comment">#返回所在位置的索引</span></span><br><span class="line">        <span class="keyword">if</span> guess &lt; item:   <span class="comment">#猜的数字小了，修改low</span></span><br><span class="line">            low = mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> guess &gt; item:   <span class="comment">#猜的数字大了，修改high</span></span><br><span class="line">            high = mid-<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"></span><br><span class="line">    list_2 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(binary_search(list_2, <span class="number">8</span>))</span><br><span class="line">    <span class="built_in">print</span>(binary_search(list_2, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/5V9geRk.png" class="lazyload" data-srcset="https://i.imgur.com/5V9geRk.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行效果"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binary_search</span><span class="params">(<span class="keyword">int</span> a[<span class="number">9</span>],<span class="keyword">int</span> n,<span class="keyword">int</span> x)</span><span class="comment">//n为元素个数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid;</span><br><span class="line">    <span class="keyword">int</span> high,low=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> guess;</span><br><span class="line"></span><br><span class="line">    high = n<span class="number">-1</span>;<span class="comment">//数组下标从0开始</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(low &lt;= high)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = (high+low)/<span class="number">2</span>;</span><br><span class="line">        guess = a[mid];</span><br><span class="line">        <span class="keyword">if</span>(guess == x)</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        <span class="keyword">if</span>(guess &gt; x)</span><br><span class="line">            high = mid<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(guess &lt; x)</span><br><span class="line">    low = mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">9</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="built_in"><span class="keyword">sizeof</span></span>(a)/<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(<span class="built_in"><span class="keyword">sizeof</span></span>(a)/<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>)).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">    temp = <span class="built_in">binary_search</span>(a,<span class="built_in"><span class="keyword">sizeof</span></span>(a)/<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>),<span class="number">5</span>);</span><br><span class="line">cout&lt;&lt;temp&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/4IuXQTE.png" class="lazyload" data-srcset="https://i.imgur.com/4IuXQTE.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行效果"></p><p>附：C++ 使用头文件typeinfo下的typeid(parameter).name()可获取参数获取类型名</p><p><img src="https://i.imgur.com/U3uKacO.png" class="lazyload" data-srcset="https://i.imgur.com/U3uKacO.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="示例"></p>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-8</title>
      <link href="2018/11/15/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-8/"/>
      <url>2018/11/15/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="使用struct关键字定义类"><a href="#使用struct关键字定义类" class="headerlink" title="使用struct关键字定义类"></a>使用struct关键字定义类</h1><p>*** 使用class和struct定义类的唯一区别就是默认的访问权限 ***]</p><ul><li>使用struct关键字，定义在第一个访问说明符之前的成员是public</li><li>使用class关键字，定义在第一个访问说明符之前的成员是private</li></ul><p>定义在类内的成员函数是自动inline的</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sales_data</span>&#123;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- isbn成员函数用于返回对象的ISBN编号</span></span><br><span class="line"><span class="comment">- combine成员函数，用于将一个Sales_data对象加到另一个对象上</span></span><br><span class="line"><span class="comment">- avg_price成员函数，用于返回售出书籍的平均价格</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">string <span class="title">isbn</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;<span class="keyword">return</span> bookNo;&#125;<span class="comment">//这是一个常量成员函数，不能改变调用它的对象的内容</span></span><br><span class="line"><span class="function">Sales_data&amp; <span class="title">combine</span><span class="params">(<span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">avg_price</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">string bookNo;              <span class="comment">//ISBN</span></span><br><span class="line"><span class="keyword">unsigned</span> units_sold = <span class="number">0</span>;    <span class="comment">//销售总数</span></span><br><span class="line"><span class="keyword">double</span>  revenue = <span class="number">0.0</span>;      <span class="comment">//收益</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Sales_data::avg_price</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(units_sold)</span><br><span class="line">    <span class="keyword">return</span> revenue/units_sold;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data&amp; <span class="title">Sales_data::combine</span><span class="params">(<span class="keyword">const</span> Sales_data &amp;rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">units_sold += rhs.units_sold;</span><br><span class="line">revenue += rhs.revenue;</span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;<span class="comment">//返回调用该函数的对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Salse_data的非成员接口函数：</span></span><br><span class="line"><span class="comment">- add函数，执行两个Sales_data对象的加法</span></span><br><span class="line"><span class="comment">- read函数，将数据从istream读入到Sales_data对象中</span></span><br><span class="line"><span class="comment">- print函数，将Sales_data对象的值输出到ostream</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">Sales_data <span class="title">add</span><span class="params">(<span class="keyword">const</span> Sales_data&amp; ,<span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function">ostream &amp;<span class="title">print</span><span class="params">(ostream&amp; , <span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function">istream &amp;<span class="title">read</span><span class="params">(istream&amp; , <span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输入的交易信息包括ISBN、售出总数、售出价格</span></span><br><span class="line"><span class="function">istream &amp;<span class="title">read</span><span class="params">(istream &amp;is, Sales_data &amp;item)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">0.0</span>;</span><br><span class="line">is&gt;&gt;item.bookNo&gt;&gt;item.units_sold&gt;&gt;price;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ostream &amp;<span class="title">print</span><span class="params">(ostream &amp;os, <span class="keyword">const</span> Sales_data &amp;item)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    os&lt;&lt;item.<span class="built_in">isbn</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;item.units_sold&lt;&lt;<span class="string">&quot; &quot;</span></span><br><span class="line">  &lt;&lt;item.revenue&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;item.<span class="built_in">avg_price</span>();</span><br><span class="line"><span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data <span class="title">add</span><span class="params">(<span class="keyword">const</span> Sales_data &amp;lhs, <span class="keyword">const</span> Sales_data &amp;rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Sales_data sum = lhs;<span class="comment">//把lhs的数据成员拷贝给sum</span></span><br><span class="line">sum.<span class="built_in">combine</span>(rhs);</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Sales_data total;</span><br><span class="line">string temp;</span><br><span class="line">temp = <span class="string">&quot;shansan&quot;</span>;</span><br><span class="line">total.bookNo = temp;</span><br><span class="line"><span class="comment">//total.bookNo = &quot;shansan&quot;;</span></span><br><span class="line">cout&lt;&lt;total.bookNo&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;total.<span class="built_in">isbn</span>()&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/ypJrUqp.png" class="lazyload" data-srcset="https://i.imgur.com/ypJrUqp.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="使用-default保留默认的构造函数-amp-构造函数初始值列表"><a href="#使用-default保留默认的构造函数-amp-构造函数初始值列表" class="headerlink" title="使用=default保留默认的构造函数 &amp; 构造函数初始值列表"></a>使用<code>=default</code>保留默认的构造函数 &amp; 构造函数初始值列表</h1><ul><li>当我们需要其他构造函数的时，同时也希望保留默认的构造函数时候，可以使用<code>= default</code></li><li>构造函数初始值是成员函数的一个列表，每个名字后面紧跟括号括起来的（或则在花括号内的）成员初始值。不同成员的初始值通过逗号分隔</li><li>构造函数初始值列表只说明用于初始化成员的值,而不限定初始化的具体执行顺序</li><li>但是如果一个成员是用另一个成员来初始化的，那么这两个成员的初始化顺序就很重要</li><li>consturctor(parameter):initializer_list,注意那个冒号，构造函数不能被声明成const的</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sales_data</span>&#123;</span></span><br><span class="line">    <span class="comment">//新增构造函数</span></span><br><span class="line">    <span class="comment">//使用构造函数初始值列表，注意那个冒号</span></span><br><span class="line">    <span class="comment">//这两个构造函数的函数体都是空的，构造函数没有返回类型</span></span><br><span class="line"><span class="built_in">Sales_data</span>() = <span class="keyword">default</span>;<span class="comment">//保留默认构造函数</span></span><br><span class="line"><span class="built_in">Sales_data</span>(<span class="keyword">const</span> string &amp;s) :<span class="built_in">bookNo</span>(s) &#123;&#125;</span><br><span class="line"><span class="built_in">Sales_data</span>(<span class="keyword">const</span> string &amp;s, <span class="keyword">unsigned</span> n, <span class="keyword">double</span> p):<span class="built_in">bookNo</span>(s),<span class="built_in">units_sold</span>(n),<span class="built_in">revenue</span>(p*n) &#123;&#125;</span><br><span class="line"><span class="comment">//声明一个constructor，定义放在类外了</span></span><br><span class="line"><span class="built_in">Sales_data</span>(istream&amp;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">isbn</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;<span class="keyword">return</span> bookNo;&#125;<span class="comment">//这是一个常量成员函数，不能改变调用它的对象的内容</span></span><br><span class="line"><span class="function">Sales_data&amp; <span class="title">combine</span><span class="params">(<span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">avg_price</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">string bookNo;</span><br><span class="line"><span class="keyword">unsigned</span> units_sold = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span>  revenue = <span class="number">0.0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Sales_data::avg_price</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(units_sold)</span><br><span class="line">    <span class="keyword">return</span> revenue/units_sold;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data&amp; <span class="title">Sales_data::combine</span><span class="params">(<span class="keyword">const</span> Sales_data &amp;rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">units_sold += rhs.units_sold;</span><br><span class="line">revenue += rhs.revenue;</span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;<span class="comment">//返回调用该函数的对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Salse_data的非成员接口函数：</span></span><br><span class="line"><span class="comment">- add函数，执行两个Sales_data对象的加法</span></span><br><span class="line"><span class="comment">- read函数，将数据从istream读入到Sales_data对象中</span></span><br><span class="line"><span class="comment">- print函数，将Sales_data对象的值输出到ostream</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">Sales_data <span class="title">add</span><span class="params">(<span class="keyword">const</span> Sales_data&amp; ,<span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function">ostream &amp;<span class="title">print</span><span class="params">(ostream&amp; , <span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"><span class="function">istream &amp;<span class="title">read</span><span class="params">(istream&amp; , <span class="keyword">const</span> Sales_data&amp;)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输入的交易信息包括ISBN、售出总数、售出价格</span></span><br><span class="line"><span class="function">istream &amp;<span class="title">read</span><span class="params">(istream &amp;is, Sales_data &amp;item)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">0.0</span>;</span><br><span class="line">is&gt;&gt;item.bookNo&gt;&gt;item.units_sold&gt;&gt;price;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ostream &amp;<span class="title">print</span><span class="params">(ostream &amp;os, <span class="keyword">const</span> Sales_data &amp;item)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    os&lt;&lt;item.<span class="built_in">isbn</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;item.units_sold&lt;&lt;<span class="string">&quot; &quot;</span></span><br><span class="line">  &lt;&lt;item.revenue&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;item.<span class="built_in">avg_price</span>()&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data <span class="title">add</span><span class="params">(<span class="keyword">const</span> Sales_data &amp;lhs, <span class="keyword">const</span> Sales_data &amp;rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Sales_data sum = lhs;<span class="comment">//把lhs的数据成员拷贝给sum</span></span><br><span class="line">sum.<span class="built_in">combine</span>(rhs);</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类外定义新的构造函数</span></span><br><span class="line">Sales_data::<span class="built_in">Sales_data</span>(istream &amp;is)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">read</span>(is,*<span class="keyword">this</span>);<span class="comment">//从is中读入一条信息存到this对象中</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Sales_data total;<span class="comment">//调用默认的构造函数</span></span><br><span class="line">string temp;</span><br><span class="line">temp = <span class="string">&quot;shansan&quot;</span>;</span><br><span class="line">total.bookNo = temp;</span><br><span class="line"><span class="comment">//total.bookNo = &quot;shansan&quot;;</span></span><br><span class="line">cout&lt;&lt;total.bookNo&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;total.<span class="built_in">isbn</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data <span class="title">let</span><span class="params">(<span class="string">&quot;shansan.top&quot;</span>,<span class="number">33</span>,<span class="number">33</span>)</span></span>;<span class="comment">//调用构造函数Sales_data(const string &amp;s, unsigned n, double p)</span></span><br><span class="line">cout&lt;&lt;let.bookNo&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;let.units_sold&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;let.revenue&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">Sales_data read_print;<span class="comment">//调用默认的构造函数</span></span><br><span class="line"><span class="built_in">read</span>(cin,read_print);</span><br><span class="line"><span class="built_in">print</span>(cout,read_print);</span><br><span class="line"></span><br><span class="line"><span class="function">Sales_data <span class="title">dada</span><span class="params">(cin)</span></span>;<span class="comment">//调用构造函数Sales_data(istream &amp;is)</span></span><br><span class="line"><span class="built_in">print</span>(cout,dada);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/v0yNjIS.gif" class="lazyload" data-srcset="https://i.imgur.com/v0yNjIS.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="委托构造函数"><a href="#委托构造函数" class="headerlink" title="委托构造函数"></a>委托构造函数</h1><ul><li>一个委托构造函数使用它所属类的其他构造函数执行它自己的初始化过程</li><li>它把自己的一些或全部职责委托给了其他构造函数</li><li>一个委托构造函数和其他构造函数一样也有一个成员初始值列表和一个函数体</li><li>委托构造函数的成员初始值列表只有一个入口，就是类名本身。类名后面紧跟圆括号括起来的初始值列表，参数列表必须与另一个构造函数匹配</li><li>当一个构造函数委托给另一个构造函数时，受委托的构造函数的初始值列表和函数体被依次执行</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//非委托构造函数使用对应的实参初始化成员</span></span><br><span class="line">        <span class="built_in">People</span>(string m,string x,<span class="keyword">int</span> n):<span class="built_in">first_name</span>(m),<span class="built_in">last_name</span>(x),<span class="built_in">age</span>(n) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//其余构造函数全部委托给另一个构造函数</span></span><br><span class="line"><span class="comment">//注意使用冒号</span></span><br><span class="line"><span class="built_in">People</span>(): <span class="built_in">People</span>(<span class="string">&quot;li&quot;</span>,<span class="string">&quot;lei&quot;</span>,<span class="number">18</span>)&#123;&#125;</span><br><span class="line"><span class="built_in">People</span>(string insert): <span class="built_in">People</span>(insert,<span class="string">&quot;wan&quot;</span>,<span class="number">33</span>)&#123;&#125;</span><br><span class="line">        <span class="built_in">People</span>(<span class="keyword">int</span> a): <span class="built_in">People</span>(<span class="string">&quot;wu&quot;</span>,<span class="string">&quot;ge&quot;</span>,a)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print_info</span><span class="params">(People temp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;temp.first_name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.last_name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.age&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">string first_name;</span><br><span class="line">string last_name;</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">People <span class="title">num_1</span><span class="params">(<span class="string">&quot;shan&quot;</span>,<span class="string">&quot;san&quot;</span>,<span class="number">18</span>)</span></span>;<span class="comment">//调用构造函数 People(string m,string x,int n)</span></span><br><span class="line">    num_1.<span class="built_in">print_info</span>(num_1);</span><br><span class="line"></span><br><span class="line">    People num_2;<span class="comment">//调用委托构造函数 People(&quot;li&quot;,&quot;lei&quot;,18)</span></span><br><span class="line">    num_2.<span class="built_in">print_info</span>(num_2);</span><br><span class="line"></span><br><span class="line">    <span class="function">People <span class="title">num_3</span><span class="params">(<span class="string">&quot;six&quot;</span>)</span></span>;<span class="comment">//调用委托构造函数 People(string insert)</span></span><br><span class="line">num_3.<span class="built_in">print_info</span>(num_3);</span><br><span class="line"></span><br><span class="line"><span class="function">People <span class="title">num_4</span><span class="params">(<span class="number">100</span>)</span></span>;<span class="comment">//调用委托构造函数 People(int a)</span></span><br><span class="line">num_4.<span class="built_in">print_info</span>(num_4);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/5wf8lji.png" class="lazyload" data-srcset="https://i.imgur.com/5wf8lji.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>精度(precision)控制</title>
      <link href="2018/11/06/%E7%B2%BE%E5%BA%A6-precision-%E6%8E%A7%E5%88%B6/"/>
      <url>2018/11/06/%E7%B2%BE%E5%BA%A6-precision-%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="C-输出精度（precision）控制-格式化输出"><a href="#C-输出精度（precision）控制-格式化输出" class="headerlink" title="C++输出精度（precision）控制,格式化输出"></a>C++输出精度（precision）控制,格式化输出</h1><h2 id="使用cout对象的成员"><a href="#使用cout对象的成员" class="headerlink" title="使用cout对象的成员"></a>使用cout对象的成员</h2><ul><li>setprecision()</li><li>setf()</li><li>width()</li><li>fill()</li><li>flags(ios::fixed)</li></ul><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> a=<span class="number">3.1415926</span>;</span><br><span class="line"><span class="keyword">double</span> c=<span class="number">66.666666</span>;</span><br><span class="line"></span><br><span class="line">cout.<span class="built_in">precision</span>(<span class="number">3</span>);        <span class="comment">//控制输出流显示的有效数字个数</span></span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;c&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">8</span>);           <span class="comment">//控制输出宽度</span></span><br><span class="line">cout.<span class="built_in">setf</span>(ios::right);   <span class="comment">//设置对齐方式</span></span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout.<span class="built_in">setf</span>(ios::right);</span><br><span class="line">cout.<span class="built_in">fill</span>(<span class="string">&#x27;#&#x27;</span>);          <span class="comment">//设置填充字符</span></span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">8</span>);</span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout.<span class="built_in">flags</span>(ios::fixed); <span class="comment">//flags(ios::fixed)和precision()配合使用控制精度</span></span><br><span class="line">cout.<span class="built_in">precision</span>(<span class="number">4</span>);</span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/PHoahko.png" class="lazyload" data-srcset="https://i.imgur.com/PHoahko.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="使用头文件iomanip中的setprecision-和setiosflags-ios-fixed-进行精度控制"><a href="#使用头文件iomanip中的setprecision-和setiosflags-ios-fixed-进行精度控制" class="headerlink" title="使用头文件iomanip中的setprecision()和setiosflags(ios::fixed)进行精度控制"></a>使用头文件iomanip中的setprecision()和setiosflags(ios::fixed)进行精度控制</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> e = <span class="number">2.7182818</span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="built_in">setprecision</span>(<span class="number">3</span>)&lt;&lt;e&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="built_in">setiosflags</span>(ios::fixed)&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">setprecision</span>(<span class="number">3</span>)&lt;&lt;e&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/5IDLZTl.png" class="lazyload" data-srcset="https://i.imgur.com/5IDLZTl.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>参考自：<br><a href="https://blog.csdn.net/yanglingwell/article/details/49507463">https://blog.csdn.net/yanglingwell/article/details/49507463</a></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++标准库类型</title>
      <link href="2018/11/05/C++-%E6%A0%87%E5%87%86%E5%BA%93%E7%B1%BB%E5%9E%8B/"/>
      <url>2018/11/05/C++-%E6%A0%87%E5%87%86%E5%BA%93%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="标准库类型string"><a href="#标准库类型string" class="headerlink" title="标准库类型string"></a>标准库类型string</h1><ul><li>标准库类型string表示可变长的字符序列</li><li>使用string类型必须包含string头文件，string定义在命名空间std中</li></ul><h2 id="定义和初始化string对象"><a href="#定义和初始化string对象" class="headerlink" title="定义和初始化string对象"></a>定义和初始化string对象</h2><p>初始化string对象的方式</p><table><thead><tr><th align="left">初始化方式</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">string s1</td><td align="left">默认初始化，s1是一个空字符串</td></tr><tr><td align="left">string s2(s1)</td><td align="left">s2是s1的副本</td></tr><tr><td align="left">string s2=s1</td><td align="left">等价于s2(s1)，s2是s1的副本</td></tr><tr><td align="left">string s3(“shansan”)</td><td align="left">s3是字面值”shansan”的副本，除了字面值最后的那个空字符串外</td></tr><tr><td align="left">string s3=”shansan”</td><td align="left">等价于s3(“shansan”)</td></tr><tr><td align="left">string s4(n,’c’)</td><td align="left">把s4初始化为由连续n个字符c组成的串</td></tr></tbody></table><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string s1;</span><br><span class="line">cout&lt;&lt;s1&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;1&quot;</span>&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">string s2 = <span class="string">&quot;shansan&quot;</span>;</span><br><span class="line">cout&lt;&lt;s2&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">s3</span><span class="params">(s2)</span></span>;</span><br><span class="line">cout&lt;&lt;s3&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">s4</span><span class="params">(<span class="number">6</span>,<span class="string">&#x27;s&#x27;</span>)</span></span>;</span><br><span class="line">cout&lt;&lt;s4&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/KacK6Mf.png" class="lazyload" data-srcset="https://i.imgur.com/KacK6Mf.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="string对象上的操作"><a href="#string对象上的操作" class="headerlink" title="string对象上的操作"></a>string对象上的操作</h2><ul><li>getline(is,s):从is中读取一行赋给s，返回is</li><li>s.empty():s为空返回true</li><li>s.size():返回s中字符的个数</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//empty(),getline(),size()</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string s;</span><br><span class="line"></span><br><span class="line">cin&gt;&gt;s;</span><br><span class="line"><span class="comment">//* 读取时string对象会默认忽略掉开头的空白（即空格符、换行符、制表符等）</span></span><br><span class="line"><span class="comment">//* 从第一个真正的字符开始读起，直到遇见下一处空白为止</span></span><br><span class="line">cout&lt;&lt;s&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;s.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!s.<span class="built_in">empty</span>())<span class="comment">//如果string对象非空</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the string is not empty !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string line;</span><br><span class="line"><span class="comment">//每次读取一整行，遇到换行符结束</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">getline</span>(cin,line))</span><br><span class="line">    cout&lt;&lt;line&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/d0rQ9vw.gif" class="lazyload" data-srcset="https://i.imgur.com/d0rQ9vw.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="标准库类型vector"><a href="#标准库类型vector" class="headerlink" title="标准库类型vector"></a>标准库类型vector</h1><p>** #include<vector> **</p><ul><li>标准库类型表示对象的集合，其中所有的对象类型都相同</li><li>集合中的每一个对象都有一个与之对应的索引，索引用于访问对象</li></ul><h2 id="定义和初始化vector对象"><a href="#定义和初始化vector对象" class="headerlink" title="定义和初始化vector对象"></a>定义和初始化vector对象</h2><table><thead><tr><th align="left">定义和初始化vector对象的方法</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">vector<T> v1</td><td align="left">v1是一个空vector，它潜在的元素是T类型的，执行默认初始化</td></tr><tr><td align="left">vector<T> v2(v1)</td><td align="left">v2中包含有v1所有元素的副本</td></tr><tr><td align="left">vector<T> v2=v1</td><td align="left">等价于v2(v1)</td></tr><tr><td align="left">vector<T> v3(n,value)</td><td align="left">v3包含了n个重复的元素，每个元素的值都是value</td></tr><tr><td align="left">vector<T> v4(n)</td><td align="left">v4包含了n个重复地执行了值初始化的对象</td></tr><tr><td align="left">vector<T> v5{a,b,c,…}</td><td align="left">v5包含了初始值的个数的元素，每元素被赋予相应的初始值</td></tr><tr><td align="left">vector<T> v5={a,b,c,…}</td><td align="left">等价于v5</td></tr></tbody></table><h2 id="vector对象上的操作"><a href="#vector对象上的操作" class="headerlink" title="vector对象上的操作"></a>vector对象上的操作</h2><ul><li>v.empty():如果v不含有任何元素，返回真，否者返回假</li><li>v.size():返回v中元素的个数</li><li>v.push_back(t):向v的尾端添加一个值为t的元素</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; s=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;;<span class="comment">//列表初始化vector对象s</span></span><br><span class="line"><span class="comment">//- 可使用下标访问vector对象</span></span><br><span class="line">cout&lt;&lt;s[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">8</span>,<span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:a)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">string word;</span><br><span class="line">vector&lt;string&gt; text;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;word)</span><br><span class="line">&#123;</span><br><span class="line">text.<span class="built_in">push_back</span>(word);<span class="comment">//push_back()</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> str:text)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;str&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/GWogUU7.gif" class="lazyload" data-srcset="https://i.imgur.com/GWogUU7.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="使用范围for语句处理vector对象"><a href="#使用范围for语句处理vector对象" class="headerlink" title="使用范围for语句处理vector对象"></a>使用范围for语句处理vector对象</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;num)<span class="comment">//获取元素值</span></span><br><span class="line">&#123;</span><br><span class="line">v.<span class="built_in">push_back</span>(num);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;i:v)<span class="comment">//求元素值的平方</span></span><br><span class="line">&#123;</span><br><span class="line">i = i*i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp:v)<span class="comment">//输出v中每一个元素</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/UGVxERa.png" class="lazyload" data-srcset="https://i.imgur.com/UGVxERa.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="不可用下标形式为vector对象添加元素"><a href="#不可用下标形式为vector对象添加元素" class="headerlink" title="不可用下标形式为vector对象添加元素"></a>不可用下标形式为vector对象添加元素</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v;<span class="comment">//空的vector对象</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">decltype</span>(v.<span class="built_in">size</span>()) i =<span class="number">0</span>;i!=<span class="number">6</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">v[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// -v是一个空的vector，不存在任何元素，不能通过下标去访问</span></span><br><span class="line"><span class="comment">// -应该使用vector对象的成员函数push_back()为vector对象添加元素较为安全</span></span><br><span class="line">cout&lt;&lt;v[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/wnFCgYu.png" class="lazyload" data-srcset="https://i.imgur.com/wnFCgYu.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><font color="red">vector对象(以及string对象)的下标运算符可用于访问已存在的元素，而不能用于添加元素</font></p><h1 id="使用标准库函数begin-和end-遍历数组"><a href="#使用标准库函数begin-和end-遍历数组" class="headerlink" title="使用标准库函数begin()和end()遍历数组"></a>使用标准库函数begin()和end()遍历数组</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//库函数begin和end，以数组名作为参数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sums[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *beg = <span class="built_in">begin</span>(sums);        <span class="comment">//指向sums首元素的指针</span></span><br><span class="line"><span class="keyword">int</span> *last = <span class="built_in">end</span>(sums);         <span class="comment">//指向sums尾元素的下一位置的指针</span></span><br><span class="line"><span class="keyword">int</span> *temp;</span><br><span class="line"><span class="keyword">for</span>(temp = beg;temp != last;temp++)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;*temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/mQfE3Y9.png" class="lazyload" data-srcset="https://i.imgur.com/mQfE3Y9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li>begin()函数返回指向数组sums首元素的指针</li><li>end()函数返回指向数组sums尾元素下一位置的指针</li></ul><h1 id="使用可迭代对象（容器-string对象）的成员begin-和end-进行遍历"><a href="#使用可迭代对象（容器-string对象）的成员begin-和end-进行遍历" class="headerlink" title="使用可迭代对象（容器||string对象）的成员begin()和end()进行遍历"></a>使用可迭代对象（容器||string对象）的成员begin()和end()进行遍历</h1><ul><li>end成员返回指向容器(string对象)“尾元素下一位置（one past the end）”的迭代器（尾后迭代器）</li><li>begin成员负责返回指向第一个元素（或者第一个字符的迭代器）</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string s=<span class="string">&quot;shan san&quot;</span>;<span class="comment">//s(&quot;shan san&quot;);</span></span><br><span class="line">cout&lt;&lt;s&lt;&lt;endl;</span><br><span class="line"><span class="comment">//首字母改成大写形式</span></span><br><span class="line"><span class="keyword">if</span>(s.<span class="built_in">begin</span>() != s.<span class="built_in">end</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> it = s.<span class="built_in">begin</span>();<span class="comment">//令it指向s的第一个元素</span></span><br><span class="line">*it = <span class="built_in">toupper</span>(*it);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;s&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全部字母改成大写形式,&amp;&amp; !isspace(*temp)</span></span><br><span class="line"><span class="comment">//temp是个迭代器，通过 * 运算符解引用迭代器获得迭代器所指的对象</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp=s.<span class="built_in">begin</span>();temp != s.<span class="built_in">end</span>() ; temp++)</span><br><span class="line">&#123;</span><br><span class="line">*temp = <span class="built_in">toupper</span>(*temp);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;s&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a=<span class="number">8</span>;</span><br><span class="line"><span class="comment">//a=0;</span></span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> c[<span class="number">10</span>]=<span class="string">&quot;123456789&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">strcpy</span>(b,c);</span><br><span class="line">cout&lt;&lt;b[<span class="number">1</span>]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/6FIwWel.png" class="lazyload" data-srcset="https://i.imgur.com/6FIwWel.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++11特性-1</title>
      <link href="2018/11/05/C++-11%E7%89%B9%E6%80%A7-1/"/>
      <url>2018/11/05/C++-11%E7%89%B9%E6%80%A7-1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="c-11特性"><a href="#c-11特性" class="headerlink" title="c++11特性"></a>c++11特性</h1><h2 id="列表初始化"><a href="#列表初始化" class="headerlink" title="列表初始化"></a>列表初始化</h2><ul><li>使用花括号来初始化对象</li><li>使用列表初始化内置类型的变量，可能会存在丢失信息的风险<span id="more"></span><img src="https://i.imgur.com/424Ebkh.png" class="lazyload" data-srcset="https://i.imgur.com/424Ebkh.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></li></ul><h2 id="auto类型说明符号decltype类型说明符"><a href="#auto类型说明符号decltype类型说明符" class="headerlink" title="auto类型说明符号decltype类型说明符"></a>auto类型说明符号decltype类型说明符</h2><h2 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h2><ul><li>auto让编译器通过初始值来推算变量的类型</li><li>使用auto也能在一条语句中声明多个变量。因为一条声明语句只能有一个基本数据类型，所以该语句中的所有变量的初始基本数据类型都必须一样</li><li>编译器推断出来的auto类型有时候和初始值的类型并不完全一样，编译器会适当地改变结果类型使其更符合初始化规则</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">33</span>;</span><br><span class="line"><span class="keyword">double</span> pi = <span class="number">3.1415926</span>;</span><br><span class="line"><span class="keyword">auto</span> b=a;</span><br><span class="line"><span class="comment">//auto c=1.414,d=1;//[Error] inconsistent deduction for &#x27;auto&#x27;: &#x27;double&#x27; and then &#x27;int&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(pi).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(a).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line"><span class="comment">//cout&lt;&lt;typeid(c).name()&lt;&lt;endl;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/zEnxwi5.png" class="lazyload" data-srcset="https://i.imgur.com/zEnxwi5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="delctype"><a href="#delctype" class="headerlink" title="delctype"></a>delctype</h2><ul><li>从表达式的类型推断出要定义的变量的类型，不使用该表达式的值初始化变量</li><li>编译器分析表达式并得到它的类型，却不实际计算表达式的值</li><li>如果decltype使用的表达式不是一个变量，则返回表达式结果对用的类型</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a=<span class="number">1</span>,b=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> &amp;refer_a=a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">decltype</span>(a+b) temp=<span class="number">33</span>;</span><br><span class="line"><span class="keyword">decltype</span>(refer_a) en=b;<span class="comment">//引用类型定义时就必须初始化</span></span><br><span class="line"><span class="keyword">decltype</span>((a)) refer=b;<span class="comment">//decltype((variable))的结果永远是引用，使用了双层括号</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;<span class="string">&quot;it&#x27;s type:&#x27;&quot;</span>&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(temp).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;refer_a;</span><br><span class="line">cout&lt;&lt;en&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;refer&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/41jvbQ0.png" class="lazyload" data-srcset="https://i.imgur.com/41jvbQ0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="范围for语句"><a href="#范围for语句" class="headerlink" title="范围for语句"></a>范围for语句</h2><p>基本形式：</p><pre><code>for(declaration : expression)    statement</code></pre><ul><li>expression部分是一个对象，用于表示一个序列</li><li>declaration部分负责定义一个变量，该变量将被用于访问序列中的基础元素。每次迭代，declaration部分的变量都会被初始化为expression部分的下一个元素值</li></ul><h3 id="使用范围for语句遍历string对象"><a href="#使用范围for语句遍历string对象" class="headerlink" title="使用范围for语句遍历string对象"></a>使用范围for语句遍历string对象</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;shan san&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过编译器来决定变量的类型</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> s : str)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;s&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp : str)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;temp;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用引用,使字符串对象str变为大写</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;a : str)</span><br><span class="line">&#123;</span><br><span class="line">a = <span class="built_in">toupper</span>(a);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;str&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用下标进行迭代,改变字符串对象str的大小写状态</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">decltype</span>(str.<span class="built_in">size</span>()) index = <span class="number">0</span>; index != str.<span class="built_in">size</span>(); ++index)</span><br><span class="line">&#123;</span><br><span class="line">str[index] = <span class="built_in">toupper</span>(str[index]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;str;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/vcUvaGh.png" class="lazyload" data-srcset="https://i.imgur.com/vcUvaGh.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="使用范围for语句遍历二维数组"><a href="#使用范围for语句遍历二维数组" class="headerlink" title="使用范围for语句遍历二维数组"></a>使用范围for语句遍历二维数组</h2><p>*** 使用范围for语句处理多维数组，除了最内层的循环外，其他所有循环的控制变量都应该是引用类型 ***</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="keyword">size_t</span> rowCnt = <span class="number">3</span>,colCnt = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">int</span> a[rowCnt][colCnt];</span><br><span class="line"></span><br><span class="line"><span class="comment">//二位数组初始化</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i != rowCnt; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">size_t</span> j=<span class="number">0</span>; j != colCnt;j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//将元素的位置索引作为它的值</span></span><br><span class="line">a[i][j] = i*colCnt + j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp;temp : a)           <span class="comment">//对于外层数组的每一个元素</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> lim :temp)       <span class="comment">//对于内层数组的每一个元素</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;lim&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用范围for语句遍历vector对象"><a href="#使用范围for语句遍历vector对象" class="headerlink" title="使用范围for语句遍历vector对象"></a>使用范围for语句遍历vector对象</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> scores;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;scores)</span><br><span class="line">&#123;</span><br><span class="line">    v.<span class="built_in">push_back</span>(scores);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> temp : v)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;temp&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/gsUr526.png" class="lazyload" data-srcset="https://i.imgur.com/gsUr526.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python生成器回顾</title>
      <link href="2018/11/02/python%E7%94%9F%E6%88%90%E5%99%A8%E5%9B%9E%E9%A1%BE/"/>
      <url>2018/11/02/python%E7%94%9F%E6%88%90%E5%99%A8%E5%9B%9E%E9%A1%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="python生成器（generator）"><a href="#python生成器（generator）" class="headerlink" title="python生成器（generator）"></a>python生成器（generator）</h1><ul><li>生成器是一种使用普通函数语法定义的迭代器</li><li>包含yield语句的函数都是生成器，它是一个不断产生值的函数</li><li>生成器每次使用yield产生一个值后，函数都将冻结，即在此处停止执行，等待重新被唤醒。被唤醒后从停止的地方开始继续执行</li></ul><h2 id="生成器推导（生成器表达式）"><a href="#生成器推导（生成器表达式）" class="headerlink" title="生成器推导（生成器表达式）"></a>生成器推导（生成器表达式）</h2><p>*** 使用圆括号<code>()</code>创建一个生成器推导 ***,它创建了一个可迭代的对象<br>使用next()函数可以获得生成器推导的下一个返回值</p><pre><code>g = (i**2 for i in range(10))</code></pre><span id="more"></span><p><img src="https://i.imgur.com/wmTo1u5.png" class="lazyload" data-srcset="https://i.imgur.com/wmTo1u5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="simple-generator"><a href="#simple-generator" class="headerlink" title="simple generator"></a>simple generator</h2><p>** demo_1 **</p><blockquote><p>斐波拉契数列（Fibonacci），除第一个和第二个数外，任意一个数都可由前两个数相加得到</p></blockquote><p><img src="https://i.imgur.com/NgdbD2D.png" class="lazyload" data-srcset="https://i.imgur.com/NgdbD2D.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>** demo_2_generator **</p><p><img src="https://i.imgur.com/hEt9tRq.png" class="lazyload" data-srcset="https://i.imgur.com/hEt9tRq.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="recursive-generator"><a href="#recursive-generator" class="headerlink" title="recursive generator"></a>recursive generator</h2><p>处理多层嵌套列表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flagtten</span>(<span class="params">nested</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> sublist <span class="keyword">in</span> nested:</span><br><span class="line">            <span class="keyword">for</span> element <span class="keyword">in</span> flagtten(sublist):</span><br><span class="line">                <span class="keyword">yield</span> element</span><br><span class="line">    <span class="keyword">except</span> TypeError:<span class="comment">#处理迭代单个对象引起的typeerror异常</span></span><br><span class="line">        <span class="keyword">yield</span> nested</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    s = <span class="built_in">list</span>(flagtten([<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>]]))</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flagtten</span>(<span class="params">nested</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#不迭代类似于字符串的对象</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            nested + <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">except</span> TypeError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError</span><br><span class="line">        <span class="keyword">for</span> sublist <span class="keyword">in</span> nested:</span><br><span class="line">            <span class="keyword">for</span> temp <span class="keyword">in</span> flagtten(sublist):</span><br><span class="line">                <span class="keyword">yield</span> temp</span><br><span class="line">    <span class="keyword">except</span> TypeError:</span><br><span class="line">        <span class="keyword">yield</span> nested</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    s = <span class="built_in">list</span>(flagtten([<span class="string">&quot;haha&quot;</span>,[<span class="string">&quot;shan&quot;</span>,<span class="string">&quot;san&quot;</span>]]))</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/8YyFVoE.gif" class="lazyload" data-srcset="https://i.imgur.com/8YyFVoE.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scrapy爬虫框架</title>
      <link href="2018/10/31/Scrapy%E7%88%AC%E8%99%AB%E6%A1%86%E6%9E%B6/"/>
      <url>2018/10/31/Scrapy%E7%88%AC%E8%99%AB%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="网络爬虫框架scrapy"><a href="#网络爬虫框架scrapy" class="headerlink" title="网络爬虫框架scrapy"></a>网络爬虫框架<a href="https://scrapy.org/">scrapy</a></h1><p>（配置型爬虫）</p><p>什么是爬虫框架？</p><ul><li>爬虫框架是实现爬虫功能的一个软件结构和功能组件集合</li><li>爬虫框架是个半成品，帮助用户实现专业网络爬虫</li></ul><h1 id="scrapy框架结构-“5-2”结构"><a href="#scrapy框架结构-“5-2”结构" class="headerlink" title="scrapy框架结构(“5+2”结构)"></a>scrapy框架结构(“5+2”结构)</h1><p><img src="https://i.imgur.com/Wlai3fH.png" class="lazyload" data-srcset="https://i.imgur.com/Wlai3fH.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ol><li>spider:</li></ol><ul><li>解析downloader返回的响应（Response）</li><li>产生爬取项（scraped item）</li><li>产生额外的爬去请求（Request）<br>需要用户编写配置代码</li></ul><ol start="2"><li>engine(引擎):</li></ol><ul><li>控制所有模块之间的数据流</li><li>根据条件触发事件<br>不需要用户修改</li></ul><ol start="3"><li>scheduler(调度器):</li></ol><ul><li>对所有爬取请求进行调度处理<br>不需要用户修改</li></ul><ol start="4"><li>downloader(下载器):</li></ol><ul><li>根据请求下载网页<br>不需要用户修改</li></ul><ol start="5"><li>item pipelines():</li></ol><ul><li>以流水线处理spider产生的爬取项</li><li>由一组操作顺序组成，类似流水线，每个操作是一个Item Pipeline类型</li><li>可能操作包括：清理、检验和查重爬取项中的HTML数据，将数据存储到数据库中<br>需要用户编写配置代码</li></ul><ol start="6"><li>downloader middleware(中间件):</li></ol><ul><li>目的：实施engine、scheduler和downloader之间进行用户可配置的控制</li><li>功能：修改、丢弃、新增请求或响应<br>用户可以编写配置代码</li></ul><ol start="7"><li>spider middleware(中间件):</li></ol><ul><li>目的：对请求和爬去项的再处理</li><li>功能：修改、丢弃、新增请求或爬取项<br>用户可以编写配置代码</li></ul><h1 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h1><p><img src="https://i.imgur.com/MDlRnll.png" class="lazyload" data-srcset="https://i.imgur.com/MDlRnll.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li>1.Engine从Spider处获得爬取请求(Request)</li><li>2.Engine将爬取请求转发给Scheduler,用于调度</li><li>3.Engine从Scheduler处获得下一个爬取的请求</li><li>4.Engine将爬取请求通过中间件发送给Downloader</li><li>5.爬取网页后，Downloader形成响应(Response)，通过中间件(Middleware)发给Engine</li><li>6.Engine将收到的响应通过中间件发送给Spider处理</li><li>7.Spider处理响应后产生爬取项（scraped item）和新的爬取请求(Requests)给Engine</li><li>8.Engine将爬取项发送给Item Pipeline(框架出口)</li><li>9.Engine将爬取请求发送给Scheduler</li></ul><p><img src="https://i.imgur.com/MX9Xf0k.png" class="lazyload" data-srcset="https://i.imgur.com/MX9Xf0k.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li>Engine控制各模块数据流，不间断从Scheduler处获得爬取请求，直到请求为空</li><li>框架入口：Spider的初始爬取请求</li><li>框架出口：Item Pipeline</li></ul><h1 id="scrapy命令行"><a href="#scrapy命令行" class="headerlink" title="scrapy命令行"></a>scrapy命令行</h1><p>格式</p><pre><code>scrapy &lt;command&gt; [options] [args]</code></pre><p><img src="https://i.imgur.com/x3YVAxJ.png" class="lazyload" data-srcset="https://i.imgur.com/x3YVAxJ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>** 常用命令 **</p><table><thead><tr><th align="left">命令</th><th align="left">说明</th><th align="left">格式</th></tr></thead><tbody><tr><td align="left">startproject</td><td align="left">创建一个新工程</td><td align="left">scrapy startproject <nane> [dir]</td></tr><tr><td align="left">genspider</td><td align="left">创建一个爬虫</td><td align="left">scrapy genspider [options] <name> [domain]</td></tr><tr><td align="left">settings</td><td align="left">获得爬虫配置信息</td><td align="left">scrapy settings [options]</td></tr><tr><td align="left">crawl</td><td align="left">运行一个爬虫</td><td align="left">scrapy crawl <spider></td></tr><tr><td align="left">list</td><td align="left">列出工程中所有的爬虫</td><td align="left">scrapy list</td></tr><tr><td align="left">shell</td><td align="left">启动URL调试命令行</td><td align="left">scrapy shell [url]</td></tr></tbody></table><h1 id="demohttps-python123-io-ws-demo-html"><a href="#demohttps-python123-io-ws-demo-html" class="headerlink" title="demohttps://python123.io/ws/demo.html"></a>demo<a href="https://python123.io/ws/demo.html">https://python123.io/ws/demo.html</a></h1><h2 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h2><pre><code>scrapy startproject python123demo</code></pre><p><img src="https://i.imgur.com/P71Hcws.png" class="lazyload" data-srcset="https://i.imgur.com/P71Hcws.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="https://i.imgur.com/WnOOhZS.png" class="lazyload" data-srcset="https://i.imgur.com/WnOOhZS.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="创建爬虫"><a href="#创建爬虫" class="headerlink" title="创建爬虫"></a>创建爬虫</h2><pre><code>scrapy genspider demo python123.io//生成了一个名为demo的spider//在spider目录下增加代码文件demo.py（该文件也可以手工生成）</code></pre><p><img src="https://i.imgur.com/d0pJFsx.gif" class="lazyload" data-srcset="https://i.imgur.com/d0pJFsx.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>** demo.py文件 **</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;demo&#x27;</span></span><br><span class="line">    allowed_domains = [<span class="string">&#x27;python123.io&#x27;</span>]</span><br><span class="line">    start_urls = [<span class="string">&#x27;http://python123.io/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/z8KTfb6.png" class="lazyload" data-srcset="https://i.imgur.com/z8KTfb6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="配置产生的spider爬虫"><a href="#配置产生的spider爬虫" class="headerlink" title="配置产生的spider爬虫"></a>配置产生的spider爬虫</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;demo&#x27;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&#x27;python123.io&#x27;]</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://python123.io/ws/demo.html&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="comment">#存储文件名demo.html</span></span><br><span class="line">        file_name = response.url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(response.body)</span><br><span class="line">            self.log(<span class="string">&#x27;Saved file %s&#x27;</span> % file_name)<span class="comment">#日志</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>*** 另一个版本 **</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;demo&#x27;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&#x27;python123.io&#x27;]</span></span><br><span class="line">    <span class="comment">#start_urls = [&#x27;http://python123.io/ws/demo.html&#x27;]</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_requests</span>(<span class="params">self</span>):</span></span><br><span class="line">        urls = [</span><br><span class="line">                   <span class="string">&#x27;http://python123.io/ws/demo.html&#x27;</span></span><br><span class="line">               ]</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(url=url, callback=self.parse)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="comment">#存储文件名demo.html</span></span><br><span class="line">        file_name = response.url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(response.body)</span><br><span class="line">            self.log(<span class="string">&#x27;Saved file %s&#x27;</span> % file_name)<span class="comment">#日志</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="运行爬虫"><a href="#运行爬虫" class="headerlink" title="运行爬虫"></a>运行爬虫</h2><pre><code>scrapy crawl demo</code></pre><h1 id="Scrapy爬虫数据类型"><a href="#Scrapy爬虫数据类型" class="headerlink" title="Scrapy爬虫数据类型"></a>Scrapy爬虫数据类型</h1><ul><li>Request类</li><li>Response类</li><li>Item类</li></ul><h2 id="Request类"><a href="#Request类" class="headerlink" title="Request类"></a>Request类</h2><pre><code>class scrapy.http.Request()</code></pre><ul><li>Request对象表示一个HTTP请求</li><li>由Spider生成，由Downloader执行</li></ul><table><thead><tr><th align="left">属性</th><th align="left">方法</th></tr></thead><tbody><tr><td align="left">.url</td><td align="left">Requests对应的请求URL地址</td></tr><tr><td align="left">.method</td><td align="left">对应的请求方法，’GEt’、’POST’等</td></tr><tr><td align="left">.headers</td><td align="left">字典类型风格的请求头</td></tr><tr><td align="left">.body</td><td align="left">请求内容主体，字符串类型</td></tr><tr><td align="left">.meta</td><td align="left">用户添加的扩展信息，在Scrapy内部模块间传递信息使用</td></tr><tr><td align="left">.copy</td><td align="left">复制该请求</td></tr></tbody></table><h2 id="Response类"><a href="#Response类" class="headerlink" title="Response类"></a>Response类</h2><pre><code>class scrapy.http.Response()</code></pre><ul><li>Response对象表示一个HTTp响应</li><li>由Downloader生成，由Spider处理</li></ul><table><thead><tr><th align="left">属性或方法</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">.url</td><td align="left">Response对应的URL地址</td></tr><tr><td align="left">.status</td><td align="left">HTTP状态码，默认是200</td></tr><tr><td align="left">.headers</td><td align="left">Response对应的头部信息</td></tr><tr><td align="left">.body</td><td align="left">Response对应的内容信息，字符串类型</td></tr><tr><td align="left">.flags</td><td align="left">一组标记</td></tr><tr><td align="left">.request</td><td align="left">产生Response类型对应的Request对象</td></tr><tr><td align="left">.copy()</td><td align="left">复制该响应</td></tr></tbody></table><h2 id="Item类"><a href="#Item类" class="headerlink" title="Item类"></a>Item类</h2><pre><code>class scrapy.item.Item()</code></pre><ul><li>Item对象表示一个从HTML页面中提取的信息内容</li><li>由Spider生成，由Item Pipeline处理</li><li>Item类似字典类型，可以按照字典类型操作</li></ul><h1 id="Scrapy爬虫的使用步骤"><a href="#Scrapy爬虫的使用步骤" class="headerlink" title="Scrapy爬虫的使用步骤"></a>Scrapy爬虫的使用步骤</h1><ol><li>创建一个工程和Spider模板</li><li>编写Spider</li><li>编写Item Pipeline</li><li>优化配置策略</li></ol><h1 id="scrapy爬虫信息提取方法"><a href="#scrapy爬虫信息提取方法" class="headerlink" title="scrapy爬虫信息提取方法"></a>scrapy爬虫信息提取方法</h1><ul><li>Beautifui Soup</li><li>lxml</li><li>re</li><li>XPath Selector</li><li>CSS Selector</li></ul><hr>]]></content>
      
      
      <categories>
          
          <category> Scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML试水</title>
      <link href="2018/10/30/HTML%E8%AF%95%E6%B0%B4/"/>
      <url>2018/10/30/HTML%E8%AF%95%E6%B0%B4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1> 一级标题 </h1><h2> 二级标题 </h2><span id="more"></span><p>倚天屠龙记</p><p>张无忌</p><p>这是另一段</p><h2 id="锚点"><a href="#锚点" class="headerlink" title="锚点"></a>锚点</h2><p><a href = "https://shansan.top">这是我的个人博客</a><br><a href = "https://shansan.top" target="_blank">这是我的个人博客，新标签页打开</a></p><!-- more --><p><a href="mailto:1329441308@qq.com" target="_top">邮箱联系我</a></p><h1 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h1><p>** img是自关标记，不需要结束标记 **<br><img src="https://www.baidu.com/img/bd_logo1.png" class="lazyload" data-srcset="https://www.baidu.com/img/bd_logo1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" width="500" height="500"></p><h2 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h2><p><b>这里是粗体</b></p><p><i>这里是斜体</i></p><p><strong>what</strong></p><p><em>这里还是斜体</em></p><p><ins>插入字体，下划线</ins></p><p><del>删除线</del></p><p>~~~ 还是删除线 ~~~</p><p>下标&amp;&amp;上标<br>H<sub>2</sub>O<sub>2</sub></p><p>嗯<sup>我飘了</sup></p><p><code>#include<stdio.h><br>int main()<br>&#123;<br>    printf("wocao!");<br>&#125;</code></p><p>正常字<br><small>小号字</small></p><p><q>短引用，双引号包围</q></p><blockquote>长引用土地是以它的肥沃和收获而被估价的；才能也是土地，不过它生产的不是粮食，而是真理。如果只能滋生瞑想和幻想的话，即使再大的才能也只是砂地或盐池，那上面连小草也长不出来的。 —— 别林斯基</blockquote><p>22222222222<br>22222222222222<br>2222</p><h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><pre><code>&lt;table&gt;...&lt;/table&gt;:定义表格&lt;th&gt;...&lt;/th&gt;:定义表格的标题栏（文字加粗体）&lt;tr&gt;...&lt;/tr&gt;:定义表格的行&lt;td&gt;...&lt;/td&gt;:定义表格的列</code></pre><table border="1"><tr><td>row 1, cell 1</td><td>row 1, cell 2</td></tr><tr><td>row 2, cell 1</td><td>row 2, cell 2</td></tr></table><h3 id="跨列表格"><a href="#跨列表格" class="headerlink" title="跨列表格"></a>跨列表格</h3><table border="1"><tr>  <th>姓名</th>  <th colspan="2">电话</th></tr><tr>  <td>shansan</td>  <td>1329441308</td>  <td>164354491</td></tr><table><h3>跨行表格</h3><table border="1"><tr>  <th>姓名</th>  <td>shansan</td></tr><tr>  <th rowspan="2">电话</th>  <td>1329441308</td></tr><tr>  <td>164354491</td></tr></table><h2 id="syntax"><a href="#syntax" class="headerlink" title="syntax"></a>syntax</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"># HTML试水</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> 一级标题 <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span> 二级标题 <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>倚天屠龙记<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>张无忌<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是另一段<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">## 锚点</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&quot;https://shansan.top&quot;</span>&gt;</span>这是我的个人博客<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&quot;https://shansan.top&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>这是我的个人博客，新标签页打开<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:1329441308@qq.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span>邮箱联系我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 图像</span><br><span class="line"></span><br><span class="line">** img是自关标记，不需要结束标记 **</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://www.baidu.com/img/bd_logo1.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;500&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">## 文本</span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>这里是粗体<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>这里是斜体<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>what<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span>这里还是斜体<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>插入字体，下划线<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span>删除线<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br><span class="line"></span><br><span class="line">~~~ 还是删除线 ~~~</span><br><span class="line"></span><br><span class="line">下标&amp;&amp;上标</span><br><span class="line">H<span class="tag">&lt;<span class="name">sub</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sub</span>&gt;</span>O<span class="tag">&lt;<span class="name">sub</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sub</span>&gt;</span></span><br><span class="line"></span><br><span class="line">嗯<span class="tag">&lt;<span class="name">sup</span>&gt;</span>我飘了<span class="tag">&lt;/<span class="name">sup</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span>#include<span class="tag">&lt;<span class="name">stdio.h</span>&gt;</span></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;wocao!&quot;);</span><br><span class="line">&#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">正常字</span><br><span class="line"><span class="tag">&lt;<span class="name">small</span>&gt;</span>小号字<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">q</span>&gt;</span>短引用，双引号包围<span class="tag">&lt;/<span class="name">q</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">blockquote</span>&gt;</span>长引用</span><br><span class="line">土地是以它的肥沃和收获而被估价的；才能也是土地，不过它生产的不是粮食，而是真理。</span><br><span class="line">如果只能滋生瞑想和幻想的话，即使再大的才能也只是砂地或盐池，那上面连小草也长不出来的。</span><br><span class="line"> —— 别林斯基</span><br><span class="line"><span class="tag">&lt;/<span class="name">blockquote</span>&gt;</span></span><br><span class="line"></span><br><span class="line">22222222222</span><br><span class="line">22222222222222</span><br><span class="line">2222</span><br><span class="line"></span><br><span class="line">## 表格</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>row 1, cell 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>row 1, cell 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>row 2, cell 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>row 2, cell 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">### 跨列表格</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>shansan<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>1329441308<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>164354491<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>跨行表格<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>shansan<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>1329441308<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>164354491<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> HTML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>竖式问题</title>
      <link href="2018/10/24/%E7%AB%96%E5%BC%8F%E9%97%AE%E9%A2%98/"/>
      <url>2018/10/24/%E7%AB%96%E5%BC%8F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="字符串处理函数strchr-amp-amp-竖式问题"><a href="#字符串处理函数strchr-amp-amp-竖式问题" class="headerlink" title="字符串处理函数strchr() &amp;&amp; 竖式问题"></a>字符串处理函数strchr() &amp;&amp; 竖式问题</h1><p><img src="https://i.imgur.com/9VzJmQT.jpg" class="lazyload" data-srcset="https://i.imgur.com/9VzJmQT.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="竖式问题"><a href="#竖式问题" class="headerlink" title="竖式问题"></a>竖式问题</h1><span id="more"></span><table><thead><tr><th align="left">题目描述</th></tr></thead><tbody><tr><td align="left">找出所有形如abc*de（三位数乘两位数）的算式，使得在完整的竖式中，所有数字都属于一个特定的数字集合。</td></tr><tr><td align="left">输入：</td></tr><tr><td align="left">输入一个数字集合（相邻数字之间没有空格）</td></tr><tr><td align="left">输出：</td></tr><tr><td align="left">输出所有竖式.每个竖式前应该编号，之后应该有一个空行。最后输出解的总数。</td></tr><tr><td align="left">样例输入：</td></tr><tr><td align="left">2357</td></tr><tr><td align="left">样例输出：</td></tr><tr><td align="left">(1)<br>&ensp;&ensp;775<br>x&ensp;&ensp;33<br>—–<br>&ensp;2325<br>2325&ensp;<br>—–<br>25575<br><br>The number of solution = 1</td></tr></tbody></table><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>小学的乘法运算<br><img src="https://i.imgur.com/Vi1NJh6.png" class="lazyload" data-srcset="https://i.imgur.com/Vi1NJh6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">20</span>],buf[<span class="number">99</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> abc = <span class="number">111</span>;abc &lt;= <span class="number">999</span>;abc++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> de = <span class="number">11</span>;de &lt;= <span class="number">99</span>;de++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> x = abc*(de%<span class="number">10</span>),y = abc*(de/<span class="number">10</span>),z = abc*de;</span><br><span class="line"><span class="built_in">sprintf</span>(buf,<span class="string">&quot;%d%d%d%d%d&quot;</span>,abc,de,x,y,z);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 使用sprintf()把信息输出到字符串</span></span><br><span class="line"><span class="comment">- strchr()函数的作用是在一个字符串中查找单个字符</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> ok = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(buf);i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strchr</span>(s,buf[i])==<span class="literal">NULL</span>) ok = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(ok)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;(%d)\n&quot;</span>,++count);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%5d\nx%4d\n-----\n%5d\n%4d\n-----\n%5d\n\n&quot;</span>,abc,de,x,y,z);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;The number of solutions = %d\n&quot;</span>,count);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/ngNCi2n.gif" class="lazyload" data-srcset="https://i.imgur.com/ngNCi2n.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="字符处理函数strchr"><a href="#字符处理函数strchr" class="headerlink" title="字符处理函数strchr()"></a>字符处理函数strchr()</h2><p>strchr() 用来查找某字符在字符串中首次出现的位置，其原型为：<br>    char * strchr (const char *str, int c);</p><ul><li>strchr() 将会找出 str 字符串中第一次出现的字符 c 的地址，然后将该地址返回。</li><li>如果找到指定的字符则返回该字符所在地址，否则返回 NULL。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *s=<span class="string">&quot;666shansan&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> *p;</span><br><span class="line">p = <span class="built_in">strchr</span>(s,<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,p);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果</p><pre><code>shansan</code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>坑人的C++-2</title>
      <link href="2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++-2/"/>
      <url>2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="C-文件和流"><a href="#C-文件和流" class="headerlink" title="C++文件和流"></a>C++文件和流</h1><p><br><font color="green">在C++中进行文件处理，可使用标准库<code>fstream</code></font></p><p>它定义了三个新的数据类型，用于从文件写入流和从文件读取流</p><table><thead><tr><th align="center">数据类型</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">ofstream</td><td align="center">该数据类型表示输出文件流，用于创建文件并向文件中写入信息</td></tr><tr><td align="center">ifstream</td><td align="center">该数据类型表示输入文件流，用于从文件中读取信息</td></tr><tr><td align="center">fstream</td><td align="center">该数据类型通常表示文件流，同时具有ofstream和ifstream两种功能，他可以创建文件，向文件中写入信息，从文件中读取信息</td></tr></tbody></table><span id="more"></span><h2 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h2><p><code>ofstream</code>和<code>ifstream</code>对象都可以open()函数打开文件进行写操作。open()函数是ofstream、ifstream、fstream对象的一个成员。<br>open()函数标准语法</p><pre><code>void open(const char *filename,ios::openmode mode)</code></pre><ul><li>第一个参数为要打开的文件名称和位置</li><li>第二个参数为文件打开的模式</li></ul><table><thead><tr><th align="center">模式标志</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">ios::app</td><td align="center">追加模式。所有写入都追加到文件末尾</td></tr><tr><td align="center">ios::ate</td><td align="center">文件打开后定位到文件末尾</td></tr><tr><td align="center">ios::in</td><td align="center">打开文件用于读取</td></tr><tr><td align="center">ios::out</td><td align="center">打开文件用于写入</td></tr><tr><td align="center">ios::trunc</td><td align="center">如果文件已经存在，其内容在打开文件之前被截断，即把文件长度设为0</td></tr></tbody></table><p><code>打开模式可以两个或者多个结合使用</code></p><pre><code>ofstream outfile;outfile.open(&quot;file.data&quot;,ios::out|ios::trunc)//outfile.open(&quot;file.data&quot;,ios::out|ios::in)</code></pre><h2 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h2><p>C++程序终止时，它会自动关闭刷新所有流，释放所有分配的内存，并关闭所有打开的文件。<br>听说优秀的程序员会在程序终止前关闭打开的文件<br>    使用close()函数</p><h2 id="写入文件-amp-amp-读取文件"><a href="#写入文件-amp-amp-读取文件" class="headerlink" title="写入文件 &amp;&amp; 读取文件"></a>写入文件 &amp;&amp; 读取文件</h2><ul><li>使用流插入运算符（&lt;&lt;）向文件写入信息，就像使用该运算符输出信息到屏幕上一样，但用的不是cout对象，而是ofstream或者fstream对象</li></ul><p>-使用流提取运算符（&gt;&gt;）从文件中读取信息。这里使用的是ifstream或者fstream对象</p><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> data[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//以写模式打开文件</span></span><br><span class="line">ofstream outfile;</span><br><span class="line">outfile.<span class="built_in">open</span>(<span class="string">&quot;afile.data&quot;</span>);<span class="comment">//这里使用了相对路径</span></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;writing to the file&quot;</span>&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;enter your name:&quot;</span>;</span><br><span class="line">cin.<span class="built_in">getline</span>(data,<span class="number">100</span>);<span class="comment">//cin对象的附加函数，getline()从外部读取一行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//向文件写入用户输入的数据</span></span><br><span class="line">outfile&lt;&lt;data&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;enter your age:&quot;</span>;</span><br><span class="line">cin&gt;&gt;data;</span><br><span class="line">cin.<span class="built_in">ignore</span>();<span class="comment">//忽略掉之前读语句留下的多余字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//再次向文件写入用户输入的数据</span></span><br><span class="line">outfile&lt;&lt;data&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">outfile.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//以读模式打开文件</span></span><br><span class="line">ifstream infile;</span><br><span class="line">infile.<span class="built_in">open</span>(<span class="string">&quot;afile.data&quot;</span>);</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;reading from the file&quot;</span>&lt;&lt;endl;</span><br><span class="line">infile&gt;&gt;data;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在屏幕上读取数据</span></span><br><span class="line">cout&lt;&lt;data&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//再次从文件中读取数据并显示它</span></span><br><span class="line">infile&gt;&gt;data;</span><br><span class="line">cout&lt;&lt;data&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">infile.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/NkfTo7g.gif" class="lazyload" data-srcset="https://i.imgur.com/NkfTo7g.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>坑人的C++</title>
      <link href="2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++/"/>
      <url>2018/10/22/%E5%9D%91%E4%BA%BA%E7%9A%84C++/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="C-自定义命名空间"><a href="#C-自定义命名空间" class="headerlink" title="C++自定义命名空间"></a>C++自定义命名空间</h1><p>使用关键字namespace</p><pre><code>namespace namespace_name&#123;    //代码声明&#125;</code></pre><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">namespace</span> print_myname&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;myname: shansan&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> print_font&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    std::cout&lt;&lt;<span class="string">&quot;什么鬼 ！&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> print_myname;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> print_font;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//print_myname::func();</span></span><br><span class="line"><span class="built_in">func</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//print_font::func_1();</span></span><br><span class="line"><span class="built_in">func_1</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/IvaQsEx.png" class="lazyload" data-srcset="https://i.imgur.com/IvaQsEx.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/cmrUaSk.png" class="lazyload" data-srcset="https://i.imgur.com/cmrUaSk.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="不连续的命名空间"><a href="#不连续的命名空间" class="headerlink" title="不连续的命名空间"></a>不连续的命名空间</h2><blockquote><p>命名空间可以定义在几个不同的部分中，因此命名空间是由几个单独定义的部分组成的。一个命名空间的组成部分可以分布在多个文件中<br>所以，如果命名空间中某个组成部分需要请求定义在另一个文件中的名称，仍然需要声明该名称。<br>下面的命名空间可以定义一个新的命名空间，也可以是为已有的命名空间增加新的元素。</p></blockquote><pre><code>namespace namespace_name&#123;    //代码生明&#125;</code></pre><h2 id="嵌套的命名空间"><a href="#嵌套的命名空间" class="headerlink" title="嵌套的命名空间"></a>嵌套的命名空间</h2><p>可以在一个命名空间中定义另一个命名空间</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> my_firstname</span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_firstname</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;shan &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> my_lastname</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_lastname</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;san&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//using namespace my_firstname;</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> my_firstname::my_lastname;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//print_firstname();</span></span><br><span class="line"><span class="comment">//my_lastname::print_lastname();</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print_lastname</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="C-异常处理"><a href="#C-异常处理" class="headerlink" title="C++异常处理"></a>C++异常处理</h1><ul><li>异常是在程序执行期间产生的问题。</li><li>C++异常是指在程序运行时发生的特殊情况，比如尝试除以零的操作。</li><li>异常提供了一种转移程序控制权的方式。</li></ul><p><font color="red">C++异常处理关键字</font></p><ul><li><code>throw</code>:当问题出现时，程序会抛出一个异常。通过throw关键字来完成。</li><li><code>catch</code>:在想要处理问题的地方，通过异常处理程序捕获异常。catch关键字用于捕获异常。</li><li><code>try</code>:try块中的代码标识将被激活的特定异常。他后面通常跟着一个或者多个catch块<br>如果您想让 catch 块能够处理 try 块抛出的任何类型的异常，则必须在异常声明的括号内使用省略号<code>...</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">&#123;</span><br><span class="line">    //被保护代码块</span><br><span class="line">&#125;</span><br><span class="line">catch(...)</span><br><span class="line">    &#123;</span><br><span class="line">        //能处理任何异常代码</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">division</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(b == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="string">&quot;Division by zero condition!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (a/b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">double</span> temp;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">temp = <span class="built_in">division</span>(a,b);</span><br><span class="line">cout&lt;&lt;temp&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*由于我们抛出了一个类型为 const char* 的异常，</span></span><br><span class="line"><span class="comment">因此，当捕获该异常时，我们必须在 catch 块中使用 const char*。*/</span></span><br><span class="line"><span class="built_in"><span class="keyword">catch</span></span>(<span class="keyword">const</span> <span class="keyword">char</span> *msg)</span><br><span class="line">&#123;</span><br><span class="line">cerr&lt;&lt;msg&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/9QFbzHU.gif" class="lazyload" data-srcset="https://i.imgur.com/9QFbzHU.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>丘一丘正则表达式</title>
      <link href="2018/10/18/%E4%B8%98%E4%B8%80%E4%B8%98%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>2018/10/18/%E4%B8%98%E4%B8%80%E4%B8%98%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="正则表达式-regular-expression-regex-RE"><a href="#正则表达式-regular-expression-regex-RE" class="headerlink" title="正则表达式(regular expression,regex,RE)"></a>正则表达式(regular expression,regex,RE)</h1><ul><li>正则表达式是一种用来简洁表达一组字符串的表达式</li><li>正则表达式是一种通用的字符串表达框架</li><li>正则表达式是一种针对字符串表达“简洁”和“特征”思想的工具</li><li>正则表达式可以用来判断某字符串的特征归属</li></ul><span id="more"></span><h2 id="正则表达式常用操作符"><a href="#正则表达式常用操作符" class="headerlink" title="正则表达式常用操作符"></a>正则表达式常用操作符</h2><table><thead><tr><th align="left">操作符</th><th align="left">说明</th><th align="left">实例</th></tr></thead><tbody><tr><td align="left">.</td><td align="left">表示任意单个字符</td><td align="left">py. 可以匹配pyc,pyy,py!等等</td></tr><tr><td align="left">[ ]</td><td align="left">字符集，对单个字符给出取值范围</td><td align="left">[abc]可以匹配a或b或c；[0-9a-zA-z\_]可以匹配一个数字、一个字母或者一个下划线</td></tr><tr><td align="left">[^ ]</td><td align="left">非字符集，对单个字符给出排除范围</td><td align="left">[^abc]可以匹配非a或非b或非c的单个字符</td></tr><tr><td align="left">*</td><td align="left">前一个字符0次或多次扩展</td><td align="left">abc* 可以匹配ab、abc、abcc、abccc等等</td></tr><tr><td align="left">+</td><td align="left">前一个字符的1次或多次扩展</td><td align="left">abc+可以匹配abc、abcc、abccc等等</td></tr><tr><td align="left">?</td><td align="left">前一个字符0次或1次扩展</td><td align="left">abc?可以匹配ab、abc</td></tr><tr><td align="left">&#124;</td><td align="left">左右表达式任意一个</td><td align="left">abc&#124;def表示abc、def</td></tr><tr><td align="left">{m}</td><td align="left">扩展前一个字符m次</td><td align="left">ab{2}c匹配abbc</td></tr><tr><td align="left">{m,n}</td><td align="left">扩展前一个字符m至n次数（含n）</td><td align="left">ab{1，2}c可以匹配abc、abbc</td></tr><tr><td align="left">^</td><td align="left">匹配字符串开头</td><td align="left">^abc表示abc且在一个字符串的开头,^\d表示必须以数字开头</td></tr><tr><td align="left">$</td><td align="left">匹配字符串结尾</td><td align="left">abc表示abc且在一个字符串的结尾、\d$白哦是必须以数字结尾</td></tr><tr><td align="left">( )</td><td align="left">分组标记,内部只能使用&#124;操作符</td><td align="left">(abc&#124;def)表示abc、def</td></tr><tr><td align="left">\d</td><td align="left">可以匹配一个数字，相当于[0-9]</td><td align="left">\d{3}表示匹配3个数字，如010</td></tr><tr><td align="left">\w</td><td align="left">可以匹配一个字母或者数字或者下划线，相当于[a-zA-Z0-9_]</td><td align="left">\w\w\d可以匹配’py3’</td></tr><tr><td align="left">\s</td><td align="left">可以匹配一个空格（也包括Tab等空白字符）</td><td align="left">\s+表示至少有一个空格，如’ ‘、’  ‘</td></tr></tbody></table><h2 id="精确匹配"><a href="#精确匹配" class="headerlink" title="精确匹配"></a>精确匹配</h2><p>在正则表达式中，如果直接给出字符，就是精确匹配</p><ul><li>‘pyt’                 匹配’pyt’</li><li>‘00\d’               可以匹配’007’</li><li>‘\w\d’              可以匹配’!5’</li><li>‘ye.’                 可以匹配’yes’</li><li>‘(P&#124;p)python’    可以匹配’Python’、’python’</li></ul><h2 id="高阶精确匹配-经典实例"><a href="#高阶精确匹配-经典实例" class="headerlink" title="高阶精确匹配,经典实例"></a>高阶精确匹配,经典实例</h2><ul><li>^[A-Za-z]+$   匹配由26个英文字母组成的字符串,如’abrg’、’abgsfsfga’</li><li>[a-zA-Z\_][0-9a-zA-Z\_]* 可以匹配由字母或者下划线开头、后接任意一个由字母、数字或者下划线组成的字符串，也就是python的合法变量</li><li>^-?\d+$      匹配整数形式的字符串</li><li>^[0-9]<em>[1-9][0-9]</em>$    匹配正整数形式的字符串</li><li>[1-9]\d{5}   中国境内邮政编码,6位</li><li>[\u4e00-\u9fa5]    匹配中文字符</li><li>\d{3}-\d{8}&#124;\d{4}-\d{7}   国内电话号码,010-68913536</li></ul><h1 id="python正则表达式模块，（Re模块）"><a href="#python正则表达式模块，（Re模块）" class="headerlink" title="python正则表达式模块，（Re模块）"></a>python正则表达式模块，（Re模块）</h1><ul><li>re是python的标准库，主要用于字符串匹配</li><li>re库采用raw string类型(原生字符串类型)表示正则表达式，例如<code>r&#39;[1-9]\d&#123;5&#125;&#39;</code>,raw string是不包含对转义符再次转义的字符串</li><li>re库也可以采用string类型表示正则表达，但是较为繁琐，例如<code>&#39;[1-9]\\d&#123;5&#125;&#39;</code></li></ul><p><img src="https://i.imgur.com/lVBuhYo.png" class="lazyload" data-srcset="https://i.imgur.com/lVBuhYo.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="re库功能函数"><a href="#re库功能函数" class="headerlink" title="re库功能函数"></a>re库功能函数</h2><table><thead><tr><th align="center">函数</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">re.search()</td><td align="center">在一个字符串中搜索匹配正则表达式的第一个位置，返回match对象</td></tr><tr><td align="center">re.match()</td><td align="center">从一个字符串的开始位置起匹配正则表达式，返回match对象</td></tr><tr><td align="center">re.findall()</td><td align="center">搜索字符串，以列表类型返回全部能匹配的子串</td></tr><tr><td align="center">re.split()</td><td align="center">将一个字符串按照正则表达式匹配结果进行分割，返回列表类型</td></tr><tr><td align="center">re.finditer</td><td align="center">搜索字符串，返回一个匹配结果的迭代类型，每个迭代元素是match对象</td></tr><tr><td align="center">re.sub()</td><td align="center">在字符串中替换所有匹配正则表达式的子串，返回替换后的字符串</td></tr></tbody></table><pre><code>1. re.search(pattern,string,flags=0)</code></pre><p>在一个字符串中搜索匹配正则表达式的第一个位置，返回match对象</p><ul><li><code>pattern</code>:正则表达式的字符串或原生字符串表示</li><li><code>string</code>:待匹配字符串</li><li><code>flags</code>： 正则表达式使用时的控制标记</li></ul><p><img src="https://i.imgur.com/X9WaiN1.png" class="lazyload" data-srcset="https://i.imgur.com/X9WaiN1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><table><thead><tr><th align="center">常用标记</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">re.I&ensp;re.IGNORECASE</td><td align="center">忽略正则表达式的大小写，[A-Z]能够匹配小写字符</td></tr><tr><td align="center">re.M&ensp;re.MULTILINE</td><td align="center">正则表达式中的^操作符能够将给定字符串的每行当做匹配开始</td></tr><tr><td align="center">re.s&ensp;re.DOTALL</td><td align="center">正则表达式中的.操作符能够匹配所有字符串，默认匹配除换行外的所有字符串</td></tr></tbody></table><pre><code>2. re.match(pattern,string,flags=0)</code></pre><p>从一个字符串的开始位置起匹配正则表达式，返回match对象</p><ul><li><code>pattern</code>:正则表达式的字符串或者原生字符串表示</li><li><code>string</code>:待匹配字符串</li><li><code>flags</code>:正则表达式使用时的控制标记</li></ul><p><img src="http://pflr7ix8q.bkt.clouddn.com/%E5%BD%95%E5%88%B6_2018_10_18_01_18_31_80.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/%E5%BD%95%E5%88%B6_2018_10_18_01_18_31_80.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/1inU7F0.png" class="lazyload" data-srcset="https://i.imgur.com/1inU7F0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><pre><code>3. re.findall(pattern,string,flags=0)</code></pre><p>搜索字符串，以列表类型返回全部能匹配的字符串<br><img src="https://i.imgur.com/GcMBPR8.png" class="lazyload" data-srcset="https://i.imgur.com/GcMBPR8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><pre><code>4. re.split(pattern,string,maxsplit=0,flags=0)</code></pre><p>将一个字符串按照正则匹配结果进行分割，返回列表类型</p><ul><li><code>maxsplt</code>:最大分割数，剩余部分作为最后一个元素输出</li></ul><p><img src="https://i.imgur.com/qjizjnw.png" class="lazyload" data-srcset="https://i.imgur.com/qjizjnw.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><pre><code>5. re.finditer(pattern,string,flags=0)</code></pre><p>搜索字符串，返回一个匹配结果的迭代类型，每个迭代类型是match对象</p><p><img src="https://i.imgur.com/hMVJvPg.png" class="lazyload" data-srcset="https://i.imgur.com/hMVJvPg.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><pre><code>6. re.sub(pattern,repl,string,cout=0,flags=0)</code></pre><p>在一个字符串中替换所有匹配正则表达式的子串，返回替换后的字符串</p><ul><li><code>repl</code>:替换匹配字符串的字符串</li><li><code>cout</code>:匹配的最大替换次数</li></ul><p><img src="https://i.imgur.com/cklxzNj.png" class="lazyload" data-srcset="https://i.imgur.com/cklxzNj.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="re库的面向对象用法"><a href="#re库的面向对象用法" class="headerlink" title="re库的面向对象用法"></a>re库的面向对象用法</h2><p>在python中使用正则表达式的时候，re模块内部会做两件事：</p><ol><li><p>编译正则表达式，如果正则表达式本身不合法，会报错</p></li><li><p>用编译后的正则表达式去匹配字符串</p><p> regex = re.compile(pattern,flags=0)<br> 将正则表达式的字符串形式编译成正则表达式对象</p></li></ol><ul><li><code>pattern</code>:正则表达式的字符串或原生字符串表示</li><li><code>flags</code>:正则表达式使用时的控制标记</li></ul><p><img src="https://i.imgur.com/sX4AKNn.png" class="lazyload" data-srcset="https://i.imgur.com/sX4AKNn.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br>compile后生成了regular expression对象，由于该1对象包含了正则表达式，所以调用对应的方法不用给出正则字符串</p><h2 id="re库的Match对象"><a href="#re库的Match对象" class="headerlink" title="re库的Match对象"></a>re库的Match对象</h2><ul><li>Match对象是一次匹配的结果，包含很多信息</li></ul><p><img src="https://i.imgur.com/lYM5asv.png" class="lazyload" data-srcset="https://i.imgur.com/lYM5asv.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="Match对象的属性"><a href="#Match对象的属性" class="headerlink" title="Match对象的属性"></a>Match对象的属性</h3><table><thead><tr><th align="center">属性</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">.string</td><td align="center">待匹配的文本</td></tr><tr><td align="center">.re</td><td align="center">匹配使用的pattern对象(正则表达式)</td></tr><tr><td align="center">.pos</td><td align="center">正则表达式搜索文本的开始位置</td></tr><tr><td align="center">.endpos</td><td align="center">正则表达式搜索文本的结束位置</td></tr></tbody></table><p><img src="https://i.imgur.com/He93M8y.png" class="lazyload" data-srcset="https://i.imgur.com/He93M8y.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="Match对象的方法"><a href="#Match对象的方法" class="headerlink" title="Match对象的方法"></a>Match对象的方法</h3><table><thead><tr><th align="center">方法</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">.group(0)</td><td align="center">获得匹配后的字符串</td></tr><tr><td align="center">.start()</td><td align="center">匹配字符串在原始字符串的开始位置</td></tr><tr><td align="center">.end()</td><td align="center">匹配字符串在原始字符串的结束位置</td></tr><tr><td align="center">.span()</td><td align="center">返回(.start(),.end())一个元组</td></tr></tbody></table><p><img src="https://i.imgur.com/RHLtKVc.png" class="lazyload" data-srcset="https://i.imgur.com/RHLtKVc.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/6j5rlHZ.png" class="lazyload" data-srcset="https://i.imgur.com/6j5rlHZ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="re库的贪婪匹配和最小匹配"><a href="#re库的贪婪匹配和最小匹配" class="headerlink" title="re库的贪婪匹配和最小匹配"></a>re库的贪婪匹配和最小匹配</h2><p><font color="red">re库默认使用贪婪匹配，即匹配最长的子串</font></p><p><img src="https://i.imgur.com/jWn9dqY.png" class="lazyload" data-srcset="https://i.imgur.com/jWn9dqY.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><font color="red">最小匹配</font></p><p><img src="https://i.imgur.com/Zrdq7QE.png" class="lazyload" data-srcset="https://i.imgur.com/Zrdq7QE.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>** 最小匹配操作符 **</p><table><thead><tr><th align="center">操作符</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">*?</td><td align="center">前一个字符0次或者无限次扩展，最小匹配</td></tr><tr><td align="center">+?</td><td align="center">前一个字符1次或者无限次扩展，最小匹配</td></tr><tr><td align="center">??</td><td align="center">前一个字符0次或1次扩展，最小匹配</td></tr><tr><td align="center">{m,n}?</td><td align="center">扩展前一个字符m至n次(包含n)，最小匹配</td></tr></tbody></table><p>只要输出长度可能不同的，都可以通过在操作符后面加<code>?</code>变成最小匹配</p><p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143193331387014ccd1040c814dee8b2164bb4f064cff000">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143193331387014ccd1040c814dee8b2164bb4f064cff000</a></p><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-7</title>
      <link href="2018/10/16/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-7/"/>
      <url>2018/10/16/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://i.imgur.com/wIL9Cmo.jpg" class="lazyload" data-srcset="https://i.imgur.com/wIL9Cmo.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="banner"></p><h1 id="数据抽象"><a href="#数据抽象" class="headerlink" title="数据抽象"></a>数据抽象</h1><blockquote><p>数据抽象(data abstraction)是与面向对象(object-oriented)并列的一种编程范式(programming paradigm)。数据抽象也成为抽象数据类型(abstract data type/ADT)。<br>数据抽象是一种依赖于接口和实现分离的编程（设计）技术。</p></blockquote><p><a href="https://wizardforcel.gitbooks.io/sicp-py/content/2.2.html">https://wizardforcel.gitbooks.io/sicp-py/content/2.2.html</a><br><a href="http://wj196.iteye.com/blog/860303">http://wj196.iteye.com/blog/860303</a><br><a href="https://blog.csdn.net/Solstice/article/details/6707148">https://blog.csdn.net/Solstice/article/details/6707148</a></p><p>C++类为数据抽象提供了可能。它们向外界提供了大量用于操作对象数据的公共方法，也就是说，外界实际上并不清楚类的内部实现。<br>数据抽象仅为用户暴露接口，而把具体的实现隐藏了起来</p><span id="more"></span><h2 id="数据抽象的两个优势"><a href="#数据抽象的两个优势" class="headerlink" title="数据抽象的两个优势"></a>数据抽象的两个优势</h2><ul><li>类的内部受到保护，不会因为无意的用户级错误导致对象状态受损。</li><li>类实现可能随着时间的推移而发生变化，以便应对不断变化的需求，或者应对哪些不改变用户级代码的错误报告。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//example：</span></span><br><span class="line"><span class="comment">//demo</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">//对外隐藏的数据</span></span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line">    <span class="built_in">Student</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Constructor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对外的接口</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SetNum</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;num = number;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对外的接口</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SetScore</span><span class="params">(<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;score = s;</span><br><span class="line"><span class="keyword">return</span> score;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Student A;</span><br><span class="line">cout&lt;&lt;A.<span class="built_in">SetScore</span>(<span class="number">20</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;A.<span class="built_in">SetNum</span>(<span class="number">17001</span>)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/USkfOBR.png" class="lazyload" data-srcset="https://i.imgur.com/USkfOBR.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="数据封装"><a href="#数据封装" class="headerlink" title="数据封装"></a>数据封装</h1><blockquote><p>数据封装是一种把数据和操作数据的函数捆绑在一起的机制。<br>C++程序中，任何带有公有和私有成员的类都可以作为数据封装和数据抽象的实例</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adder</span>//求和类</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">//对外隐藏的数据，数据隐藏</span></span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Adder</span>(<span class="keyword">int</span> i=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">total = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对外接口</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addNum</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">total += number;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对外接口</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getTotal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Adder A;</span><br><span class="line">    A.<span class="built_in">addNum</span>(<span class="number">10</span>);</span><br><span class="line">    A.<span class="built_in">addNum</span>(<span class="number">33</span>);</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Total: &quot;</span>&lt;&lt;A.<span class="built_in">getTotal</span>()&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 公有成员addNum和getTotal是对外的接口，用户需要知道他们以便使用类。</span></span><br><span class="line"><span class="comment">- 私有成员total是对外的隐藏，用户不需要了解它，但它又是类能正常工作所必须的。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="接口（抽象类）"><a href="#接口（抽象类）" class="headerlink" title="接口（抽象类）"></a>接口（抽象类）</h1><p><font color="red">如果类中至少有一个函数被声明为纯虚函数，则这个类就是抽象类。</font><br>抽象类是一种只能定义，不能生成对象的类。</p><ul><li>抽象类不能用于实例化对象，只能作为接口使用</li><li>如果一个抽象类的子类需要被实例化，则必须实现每个虚函数。即必须在派生类中重载虚函数</li><li>接口描述了类的行为和功能，而不需要完成类的特定实现</li><li>用于实例化对象的类被称为具体类</li><li>抽象类的派类依然可以不完善基类中的纯虚函数，继续作为抽象类被派生，知道给出所有的纯虚函数定义，则成为一个具体类，才可以实例化对象</li><li>抽象类因为抽象、无法具化，所以不能作为参数类型、返回值、强转类型</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">//example:</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">class Shape&#123;                //基类</span><br><span class="line">protected:</span><br><span class="line">int width;</span><br><span class="line">int height;</span><br><span class="line">public:</span><br><span class="line">//提供接口框架的纯虚函数</span><br><span class="line">virtual int getArea() = 0;</span><br><span class="line"></span><br><span class="line">void setWidth(int w)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;width = w;</span><br><span class="line">&#125;</span><br><span class="line">void setHeight(int h)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;height = h;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//派生类</span><br><span class="line">class Rectangle:public Shape&#123;</span><br><span class="line">public:</span><br><span class="line">int getArea()</span><br><span class="line">&#123;</span><br><span class="line">return width*height;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class Triangle:public Shape&#123;</span><br><span class="line">public:</span><br><span class="line">int getArea()</span><br><span class="line">&#123;</span><br><span class="line">return (width*height)/2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">Rectangle A;  //矩形</span><br><span class="line">Triangle B;   //三角形</span><br><span class="line"></span><br><span class="line">A.setHeight(3);</span><br><span class="line">A.setWidth(4);</span><br><span class="line"></span><br><span class="line">B.setHeight(3);</span><br><span class="line">B.setWidth(4);</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;&quot;Total Rectangle area: &quot;&lt;&lt;A.getArea()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;&quot;Total Triangle area: &quot;&lt;&lt;B.getArea()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/7XBzj3e.png" class="lazyload" data-srcset="https://i.imgur.com/7XBzj3e.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="total"><a href="#total" class="headerlink" title="total"></a>total</h1><ul><li>数据抽象是一种仅向用户暴露接口而把具体实现细节隐藏起来的一种机制</li><li>数据封装是一种把数据和操作数据的函数捆绑在一起的机制</li><li>抽象类作为接口使用，不能用于实例化对象</li></ul><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>recording</title>
      <link href="2018/10/16/recording/"/>
      <url>2018/10/16/recording/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="辽宁一分钟"><a href="#辽宁一分钟" class="headerlink" title="辽宁一分钟"></a>辽宁一分钟</h1><p>harage</p><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=c0727umgu56" allowFullScreen="true"></iframe><span id="more"></span><h1 id="四川一分钟"><a href="#四川一分钟" class="headerlink" title="四川一分钟"></a>四川一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=l07293p1s2m" allowFullScreen="true"></iframe><h1 id="湖北一分钟"><a href="#湖北一分钟" class="headerlink" title="湖北一分钟"></a>湖北一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=n07301l0haa" allowFullScreen="true"></iframe><h1 id="西藏一分钟"><a href="#西藏一分钟" class="headerlink" title="西藏一分钟"></a>西藏一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=x0732h3tq17" allowFullScreen="true"></iframe><h1 id="云南一分钟"><a href="#云南一分钟" class="headerlink" title="云南一分钟"></a>云南一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=j07334buqif" allowFullScreen="true"></iframe><h1 id="山东一分钟"><a href="#山东一分钟" class="headerlink" title="山东一分钟"></a>山东一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=s0735al03y9" allowFullScreen="true"></iframe><h1 id="河南一分钟"><a href="#河南一分钟" class="headerlink" title="河南一分钟"></a>河南一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=z07367jxkci" allowFullScreen="true"></iframe><h1 id="陕西一分钟"><a href="#陕西一分钟" class="headerlink" title="陕西一分钟"></a>陕西一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=z0738ssdvln" allowFullScreen="true"></iframe><h1 id="江西一分钟"><a href="#江西一分钟" class="headerlink" title="江西一分钟"></a>江西一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=l07408sn2df" allowFullScreen="true"></iframe><h1 id="深圳一分钟"><a href="#深圳一分钟" class="headerlink" title="深圳一分钟"></a>深圳一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=r07413itac9" allowFullScreen="true"></iframe><h1 id="宁夏一分钟"><a href="#宁夏一分钟" class="headerlink" title="宁夏一分钟"></a>宁夏一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=e07415ouyl2" allowFullScreen="true"></iframe><h1 id="贵州一分钟"><a href="#贵州一分钟" class="headerlink" title="贵州一分钟"></a>贵州一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=n0743jlef7u" allowFullScreen="true"></iframe><h1 id="重庆一分钟"><a href="#重庆一分钟" class="headerlink" title="重庆一分钟"></a>重庆一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=d0745k6nych" allowFullScreen="true"></iframe><h1 id="江苏一分钟"><a href="#江苏一分钟" class="headerlink" title="江苏一分钟"></a>江苏一分钟</h1><iframe frameborder="0" src="https://v.qq.com/txp/iframe/player.html?vid=h0746na4ml0" allowFullScreen="true"></iframe><hr>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定向爬虫-中国大学MOOC-python网络爬虫实例</title>
      <link href="2018/10/15/%E5%AE%9A%E5%90%91%E7%88%AC%E8%99%AB-%E4%B8%AD%E5%9B%BD%E5%A4%A7%E5%AD%A6MOOC-python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%AE%9E%E4%BE%8B/"/>
      <url>2018/10/15/%E5%AE%9A%E5%90%91%E7%88%AC%E8%99%AB-%E4%B8%AD%E5%9B%BD%E5%A4%A7%E5%AD%A6MOOC-python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%AE%9E%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>定向爬虫:仅对输入URL进行爬取，不扩展爬取<br><a href="http://www.zuihaodaxue.cn/zuihaodaxuepaiming2018.html">中国大学排名2018</a></p><p><img src="https://i.imgur.com/5sll5d0.png" class="lazyload" data-srcset="https://i.imgur.com/5sll5d0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><h1 id="format格式化输出"><a href="#format格式化输出" class="headerlink" title="format格式化输出"></a>format格式化输出</h1><p><img src="https://i.imgur.com/06d74Hk.png" class="lazyload" data-srcset="https://i.imgur.com/06d74Hk.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>看下所需信息位置<br><img src="https://i.imgur.com/J15TrKJ.png" class="lazyload" data-srcset="https://i.imgur.com/J15TrKJ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="程序大体框架"><a href="#程序大体框架" class="headerlink" title="程序大体框架"></a>程序大体框架</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillUnivList</span>(<span class="params">ulist,html</span>):</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printUnivList</span>(<span class="params">ulist,num</span>):</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Suc&quot;</span>+<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">uinfo = []</span><br><span class="line">url = <span class="string">&quot;&quot;</span></span><br><span class="line">html = getHTMLText(url)</span><br><span class="line">fillUnivList(uinfo,html)</span><br><span class="line">printUnivList(uinfo,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h2 id="getHTMLText"><a href="#getHTMLText" class="headerlink" title="getHTMLText()"></a>getHTMLText()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetHTMLText</span>(<span class="params">url</span>):</span>       <span class="comment">#获取网页内容</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">r = requests.get(url)</span><br><span class="line">r.raise_for_status()   <span class="comment">#用于捕获异常</span></span><br><span class="line">r.encoding = r.apparent_encoding</span><br><span class="line"><span class="keyword">return</span> r.text</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="fillUnivList"><a href="#fillUnivList" class="headerlink" title="fillUnivList()"></a>fillUnivList()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillUnivList</span>(<span class="params">ulist, html</span>):</span>         <span class="comment"># 把网页内容放到数据结构中</span></span><br><span class="line">    soup = BeautifulSoup(html,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;一个tr标签存放一所大学的信息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> soup.find(<span class="string">&quot;tbody&quot;</span>).children:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(tr,bs4.element.Tag):  <span class="comment">#仅仅遍历标签,过滤掉非标签类型的其它信息</span></span><br><span class="line">            tds = tr(<span class="string">&#x27;td&#x27;</span>)  <span class="comment">#将所有的td标签存放到列表tds中，等价于tr.find_all(&#x27;td&#x27;)返回一个列表类型</span></span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;由于进行了遍历，使用print打印tds会得到多个列表&#x27;&#x27;&#x27;</span></span><br><span class="line">            ulist.append([tds[<span class="number">0</span>].string, tds[<span class="number">1</span>].string, tds[<span class="number">3</span>].string])<span class="comment">#向ulist中增加所需要的信息</span></span><br></pre></td></tr></table></figure><h2 id="printUnivList"><a href="#printUnivList" class="headerlink" title="printUnivList()"></a>printUnivList()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printUnivlist</span>(<span class="params">ulist, num</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;排名&quot;</span>,<span class="string">&quot;学校&quot;</span>,<span class="string">&quot;总分&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>]))</span><br></pre></td></tr></table></figure><h2 id="main"><a href="#main" class="headerlink" title="main"></a>main</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> bs4   <span class="comment"># 用到instance</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetHTMLText</span>(<span class="params">url</span>):</span>       <span class="comment">#获取网页内容</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">r = requests.get(url)</span><br><span class="line">r.raise_for_status()   <span class="comment">#用于捕获异常</span></span><br><span class="line">r.encoding = r.apparent_encoding</span><br><span class="line"><span class="keyword">return</span> r.text</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillUnivList</span>(<span class="params">ulist, html</span>):</span>         <span class="comment"># 把网页内容放到数据结构中</span></span><br><span class="line">    soup = BeautifulSoup(html,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;一个tr标签存放一所大学的信息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> soup.find(<span class="string">&quot;tbody&quot;</span>).children:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(tr,bs4.element.Tag):  <span class="comment">#仅仅遍历标签,过滤掉非标签类型的其它信息</span></span><br><span class="line">            tds = tr(<span class="string">&#x27;td&#x27;</span>)  <span class="comment">#将所有的td标签存放到列表tds中，等价于tr.find_all(&#x27;td&#x27;)返回一个列表类型</span></span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;由于进行了遍历，使用print打印tds会得到多个列表&#x27;&#x27;&#x27;</span></span><br><span class="line">            ulist.append([tds[<span class="number">0</span>].string, tds[<span class="number">1</span>].string, tds[<span class="number">3</span>].string])<span class="comment">#向ulist中增加所需要的信息</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printUnivlist</span>(<span class="params">ulist, num</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;排名&quot;</span>,<span class="string">&quot;学校&quot;</span>,<span class="string">&quot;总分&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    uinfo = []</span><br><span class="line">    url = <span class="string">&quot;http://www.zuihaodaxue.cn/zuihaodaxuepaiming2018.html&quot;</span></span><br><span class="line">    html = GetHTMLText(url)</span><br><span class="line">    fillUnivList(uinfo,html)</span><br><span class="line">    printUnivlist(uinfo,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/SJSG4OB.png" class="lazyload" data-srcset="https://i.imgur.com/SJSG4OB.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="代码优化，使用chr-12288-解决中文对齐问题"><a href="#代码优化，使用chr-12288-解决中文对齐问题" class="headerlink" title="代码优化，使用chr(12288)解决中文对齐问题"></a>代码优化，使用chr(12288)解决中文对齐问题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> bs4   <span class="comment"># 用到instance</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetHTMLText</span>(<span class="params">url</span>):</span>       <span class="comment">#获取网页内容</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">r = requests.get(url)</span><br><span class="line">r.raise_for_status()   <span class="comment">#用于捕获异常</span></span><br><span class="line">r.encoding = r.apparent_encoding</span><br><span class="line"><span class="keyword">return</span> r.text</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillUnivList</span>(<span class="params">ulist, html</span>):</span>         <span class="comment"># 把网页内容放到数据结构中</span></span><br><span class="line">    soup = BeautifulSoup(html,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;一个tr标签存放一所大学的信息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> soup.find(<span class="string">&quot;tbody&quot;</span>).children:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(tr,bs4.element.Tag):  <span class="comment">#仅仅遍历标签,过滤掉非标签类型的其它信息</span></span><br><span class="line">            tds = tr(<span class="string">&#x27;td&#x27;</span>)  <span class="comment">#将所有的td标签存放到列表tds中，等价于tr.find_all(&#x27;td&#x27;)返回一个列表类型</span></span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;由于进行了遍历，使用print打印tds会得到多个列表&#x27;&#x27;&#x27;</span></span><br><span class="line">            ulist.append([tds[<span class="number">0</span>].string, tds[<span class="number">1</span>].string, tds[<span class="number">3</span>].string])<span class="comment">#向ulist中增加所需要的信息</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;def printUnivlist(ulist, num):</span></span><br><span class="line"><span class="string">    print(&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;.format(&quot;排名&quot;,&quot;学校&quot;,&quot;总分&quot;))</span></span><br><span class="line"><span class="string">    for i in range(num):</span></span><br><span class="line"><span class="string">        u = ulist[i]</span></span><br><span class="line"><span class="string">        print(&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;.format(u[0],u[1],u[2]))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;优化输出格式，中文对齐问题,使用chr(12288)表示一个中文空格，utf-8编码&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printUnivlist</span>(<span class="params">ulist, num</span>):</span></span><br><span class="line">    tplt = <span class="string">&quot;&#123;0:^10&#125;\t&#123;1:&#123;3&#125;^10&#125;\t&#123;2:^10&#125;&quot;</span>   <span class="comment">#输出模板，&#123;3&#125;使用format函数第三个变量进行填充，即使用中文空格进行填充</span></span><br><span class="line">    <span class="built_in">print</span>(tplt.<span class="built_in">format</span>(<span class="string">&quot;排名&quot;</span>,<span class="string">&quot;学校&quot;</span>,<span class="string">&quot;总分&quot;</span>,<span class="built_in">chr</span>(<span class="number">12288</span>)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        <span class="built_in">print</span>(tplt.<span class="built_in">format</span>(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>],<span class="built_in">chr</span>(<span class="number">12288</span>)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    uinfo = []</span><br><span class="line">    url = <span class="string">&quot;http://www.zuihaodaxue.cn/zuihaodaxuepaiming2018.html&quot;</span></span><br><span class="line">    html = GetHTMLText(url)</span><br><span class="line">    fillUnivList(uinfo,html)</span><br><span class="line">    printUnivlist(uinfo,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://i.imgur.com/8X92UkB.png" class="lazyload" data-srcset="https://i.imgur.com/8X92UkB.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></h2>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Eyes candy</title>
      <link href="2018/10/15/Eyes-candy/"/>
      <url>2018/10/15/Eyes-candy/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://i.imgur.com/6hQACUc.jpg" class="lazyload" data-srcset="https://i.imgur.com/6hQACUc.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><p><img src="https://i.imgur.com/0cIchiA.jpg" class="lazyload" data-srcset="https://i.imgur.com/0cIchiA.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/Vs2gTr7.jpg" class="lazyload" data-srcset="https://i.imgur.com/Vs2gTr7.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/D8ueTlT.jpg" class="lazyload" data-srcset="https://i.imgur.com/D8ueTlT.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-6</title>
      <link href="2018/10/14/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-6/"/>
      <url>2018/10/14/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="C-多态"><a href="#C-多态" class="headerlink" title="C++多态"></a>C++多态</h1><p><code>C++的多态意味着调用成员函数时，会根据调用的对象的类型来执行不同的函数</code></p><p>编译时的多态，编译时就确定了具体的操作过程。<br>运行时的多态，程序运行过程中才确定的操作过程。<br>操作的过程即称为联编，也称为绑定。</p><span id="more"></span><ul><li>静态联编（早绑定），在编译和连接时确认的。比如函数重载，函数模板。效率高</li><li>动态联编（后期绑定），运行的时候才能确定是哪块代码段。灵活</li></ul><h2 id="静态联编"><a href="#静态联编" class="headerlink" title="静态联编"></a>静态联编</h2><p>函数调用在程序执行前就准备好了</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI 3.1415926</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">int</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Point</span>(<span class="keyword">int</span> x=<span class="number">0</span>,<span class="keyword">int</span> y=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;x=x;</span><br><span class="line"><span class="keyword">this</span>-&gt;y=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span>:</span> <span class="keyword">public</span> Point</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Circle</span>(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> R):<span class="built_in">Point</span>(x,y)<span class="comment">//基基类中有带参数的构造函数，派生类中的构造函数需要自定义</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;r=R;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> r*r*PI;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Point <span class="title">A</span><span class="params">(<span class="number">3</span>,<span class="number">3</span>)</span></span>;<span class="comment">//一个点</span></span><br><span class="line"><span class="function">Circle <span class="title">B</span><span class="params">(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span></span>;   <span class="comment">//一个圆</span></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;A.<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;B.<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">Point *ptr;  <span class="comment">//Point类型的指针</span></span><br><span class="line">ptr = &amp;B;    <span class="comment">//指向了Circle类型</span></span><br><span class="line">cout&lt;&lt;ptr-&gt;<span class="built_in">area</span>()&lt;&lt;endl;<span class="comment">//输出结果不理想</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/Armhnbc.png" class="lazyload" data-srcset="https://i.imgur.com/Armhnbc.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p>第三个cout输出0的原因:编译器在编译时就依据ptr的类型来执行那个are，指针ptr虽然指向了Circle类型的B，但是指针ptr为Point类型，所以执行Point类里的are方法。这里实行的即为静态编译。此时编译器看的是指针的类型而非内容。</p><h2 id="动态编译"><a href="#动态编译" class="headerlink" title="动态编译"></a>动态编译</h2><p>使用虚函数进行动态联编。程序在任意点可以根据所调用的对象类型来选择调用的函数，这种操作即为动态联编，也成为后期绑定。</p><h3 id="虚函数"><a href="#虚函数" class="headerlink" title="虚函数"></a>虚函数</h3><p>在基类中使用<code>virtual</code>关键字进行声明的函数。</p><pre><code>virtual 函数返回值 函数名(形参)&#123;    函数体&#125;</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI 3.1415926</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">int</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Point</span>(<span class="keyword">int</span> x=<span class="number">0</span>,<span class="keyword">int</span> y=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;x=x;</span><br><span class="line"><span class="keyword">this</span>-&gt;y=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span>:</span> <span class="keyword">public</span> Point</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Circle</span>(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> R):<span class="built_in">Point</span>(x,y)<span class="comment">//基基类中有带参数的构造函数，派生类中的构造函数需要自定义</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;r=R;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> r*r*PI;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Point <span class="title">A</span><span class="params">(<span class="number">3</span>,<span class="number">3</span>)</span></span>;<span class="comment">//一个点</span></span><br><span class="line"><span class="function">Circle <span class="title">B</span><span class="params">(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span></span>;   <span class="comment">//一个圆</span></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;A.<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;B.<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">Point *ptr;  <span class="comment">//Point类型的指针</span></span><br><span class="line">ptr = &amp;B;</span><br><span class="line">cout&lt;&lt;ptr-&gt;<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;(*ptr).<span class="built_in">area</span>()&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/Hp4HVUm.png" class="lazyload" data-srcset="https://i.imgur.com/Hp4HVUm.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h3 id="纯虚函数"><a href="#纯虚函数" class="headerlink" title="纯虚函数"></a>纯虚函数</h3><p>在基类中不能对虚函数给出有意义的实现，这时侯就使用到了纯虚函数。包含纯虚函数的类是抽象类。抽象类至少包含一个纯虚函数。</p><p>定义方式:</p><pre><code>virtual 返回值 函数名(形参)  = 0;</code></pre><p><img src="https://i.imgur.com/4duEkpt.png" class="lazyload" data-srcset="https://i.imgur.com/4duEkpt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h3 id="虚析构函数"><a href="#虚析构函数" class="headerlink" title="虚析构函数"></a>虚析构函数</h3><blockquote><p>在C++中，不能把构造函数定义为虚构造函数，因为在实例化一个对象时才会调用构造函数，而且虚函数的实现，其实际本质是通过一个虚函数表指针来调用的，还没有对象更没有没内存空间当然无法调用，故没有实例化一个对象之前的构造函数没有意义也不能实现。<br>析构函数可以为虚函数，而且大多数时候都声明为虚析构函数。这样就可以在基类的指针指向派生类的对象在释放时，可以根据所指向的对象类型动态联编调用子类的析构函数，实现真正的对象内存释放。</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="keyword">int</span> *str;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Point</span>(<span class="keyword">int</span> x=<span class="number">0</span>,<span class="keyword">int</span> y=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;x=x;</span><br><span class="line"><span class="keyword">this</span>-&gt;y=y;</span><br><span class="line">str = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">100</span>];</span><br><span class="line">&#125;</span><br><span class="line">~<span class="built_in">Point</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> []str;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Called Point&#x27;s Destructor and Delete str !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span>:</span><span class="keyword">public</span> Point</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> r;</span><br><span class="line"><span class="keyword">int</span> *str;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Circle</span>(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> r):<span class="built_in">Point</span>(x,y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;r=r;</span><br><span class="line">str = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">100</span>];</span><br><span class="line">&#125;</span><br><span class="line">~<span class="built_in">Circle</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> []str;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Called Circle&#x27;s Destructor and Delete str !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Point *p;</span><br><span class="line">p = <span class="keyword">new</span> <span class="built_in">Circle</span>(<span class="number">10</span>,<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">delete</span> p;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/mx2KoAK.png" class="lazyload" data-srcset="https://i.imgur.com/mx2KoAK.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="green">仅调用了基类的析构函数，这样一来派生类中new出来的4*100字节的内存就会残留，造成内存泄漏！</font></p><p><img src="https://i.imgur.com/bkZuSA5.png" class="lazyload" data-srcset="https://i.imgur.com/bkZuSA5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Just relax</title>
      <link href="2018/10/13/Just-relax/"/>
      <url>2018/10/13/Just-relax/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=498286736&auto=1&height=66"></iframe><span id="more"></span>![](https://i.imgur.com/SHZN1xr.jpg)<p><img src="https://i.imgur.com/axpCGXn.jpg" class="lazyload" data-srcset="https://i.imgur.com/axpCGXn.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> Astronomy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-5</title>
      <link href="2018/10/12/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-5/"/>
      <url>2018/10/12/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=113839&auto=1&height=66"></iframe><h1 id="派生类的构造函数"><a href="#派生类的构造函数" class="headerlink" title="派生类的构造函数"></a>派生类的构造函数</h1><p>attention:</p><ul><li>在创建一个派生类的时候，系统会先创建一个基类。</li><li>派生类会吸收基类的全部成员，但不包括构造函数和析构函数。</li><li>派生类在调用自己的构造函数之前，会先调用基类的构造函数。</li></ul><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> h;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="keyword">int</span> s;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Clock</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Clock&#x27;s consturctor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlarmClock</span>:</span><span class="keyword">public</span> Clock</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> ah;</span><br><span class="line"><span class="keyword">int</span> am;</span><br><span class="line"><span class="keyword">int</span> as;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">AlarmClock</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;AlarmClock&#x27;s constructor called!&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">AlarmClock A;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/JohcfbR.png" class="lazyload" data-srcset="https://i.imgur.com/JohcfbR.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="red">当基类的构造函数带参的时候，派生类的构造函数应该这么定义：</font><br>    派生类狗制造函数名字(总形参表列):基类构造函数(实参表类)    //注意这里基类的构造函数用了是实际参数</p><p><font color="red">一但基类中有带参数的构造函数，派生类则必须有显式传参的派生类构造函数，来实现基类中参数的传递，完成初始化工作</font></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> h;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="keyword">int</span> s;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Clock</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Clock&#x27;s constructor called&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Clock</span>(<span class="keyword">int</span> h,<span class="keyword">int</span> m,<span class="keyword">int</span> s)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Clock&#x27;s consturctor with paramter called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlarmClock</span>:</span><span class="keyword">public</span> Clock</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> ah;</span><br><span class="line"><span class="keyword">int</span> am;</span><br><span class="line"><span class="keyword">int</span> as;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">AlarmClock</span>()</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;AlarmClock&#x27;s constructor called!&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">AlarmClock</span>(<span class="keyword">int</span> h,<span class="keyword">int</span> m,<span class="keyword">int</span> s):<span class="built_in">Clock</span>(h,m,s)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;AlarmClock&#x27;s constructor with paramter called!&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">AlarmClock A;</span><br><span class="line"><span class="function">AlarmClock <span class="title">B</span><span class="params">(<span class="number">20</span>,<span class="number">47</span>,<span class="number">55</span>)</span></span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/KIPU9lP.png" class="lazyload" data-srcset="https://i.imgur.com/KIPU9lP.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="派生类的析构函数"><a href="#派生类的析构函数" class="headerlink" title="派生类的析构函数"></a>派生类的析构函数</h1><p>构造函数调用顺序:基类-&gt;派生类<br>析构函数调用顺序:派生类-&gt;基类</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">int</span> h;</span><br><span class="line">        <span class="keyword">int</span> m;</span><br><span class="line">        <span class="keyword">int</span> s;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Clock</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;Clock&#x27;s consturctor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">        ~<span class="built_in">Clock</span>()</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Clock&#x27;s destructor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlarmClock</span>:</span><span class="keyword">public</span> Clock</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">int</span> ah;</span><br><span class="line">        <span class="keyword">int</span> am;</span><br><span class="line">        <span class="keyword">int</span> as;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">AlarmClock</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;AlarmClock&#x27;s constructor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">        ~<span class="built_in">AlarmClock</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;AlarmClock&#x27;s destructor called !&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AlarmClock A;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/vIp2xc5.png" class="lazyload" data-srcset="https://i.imgur.com/vIp2xc5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><hr><h1 id="虚基类，使用virtual进行声明"><a href="#虚基类，使用virtual进行声明" class="headerlink" title="虚基类，使用virtual进行声明"></a>虚基类，使用<code>virtual</code>进行声明</h1><ul><li><p>虚继承的出现成为了解决多继承中二义性问题的一种方式</p></li><li><p>如果一个派生类有多个直接基类，而这些直接基类又有一个共同的基类，则在最终的派生类中会保留该间接共同基类数据成员的多份同名成员，这时就产生了二义性问题。</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">grandfather</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">int</span> key;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">father_1</span>:</span><span class="keyword">public</span> grandfather</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">father_2</span>:</span><span class="keyword">public</span> grandfather</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">grandson</span>:</span><span class="keyword">public</span> father_1,<span class="keyword">public</span> father_2</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">grandson A;</span><br><span class="line">A.key = <span class="number">10</span>; <span class="comment">//[Error]</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/yTDNM8f.png" class="lazyload" data-srcset="https://i.imgur.com/yTDNM8f.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p>在继承的时候在继承类型public之前用virtual修饰一下</p><ul><li><p>虚基类并不是在声明基类时声明的，而是在声明派生类时，指定继承方式时声明的。</p></li><li><p>为了保证虚基类在派生类中只继承一次，应当在该基类的所有直接派生类中声明为虚基类。否则仍然会出现对基类的多次继承。</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">grandfather</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">int</span> key;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">father_1</span>:</span><span class="keyword">virtual</span> <span class="keyword">public</span> grandfather</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">father_2</span>:</span><span class="keyword">virtual</span> <span class="keyword">public</span> grandfather</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">grandson</span>:</span><span class="keyword">public</span> father_1,<span class="keyword">public</span> father_2</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">grandson A;</span><br><span class="line">A.key = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,A.key);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/yiranlaobaitu/p/3764422.html">https://www.cnblogs.com/yiranlaobaitu/p/3764422.html</a><br><a href="https://blog.csdn.net/bxw1992/article/details/77726390">https://blog.csdn.net/bxw1992/article/details/77726390</a></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>天文学学习记录</title>
      <link href="2018/10/12/XXX/"/>
      <url>2018/10/12/XXX/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>图床已挂，需要跨越 G-F-W</p></blockquote><p><img src="https://i.imgur.com/3ExmrYT.gif" class="lazyload" data-srcset="https://i.imgur.com/3ExmrYT.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><p><img src="https://i.imgur.com/6KaA8bx.jpg" class="lazyload" data-srcset="https://i.imgur.com/6KaA8bx.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/xejoAul.jpg" class="lazyload" data-srcset="https://i.imgur.com/xejoAul.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/iJzSDhl.jpg" class="lazyload" data-srcset="https://i.imgur.com/iJzSDhl.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> Astronomy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>信息标记</title>
      <link href="2018/10/12/%E4%BF%A1%E6%81%AF%E6%A0%87%E8%AE%B0/"/>
      <url>2018/10/12/%E4%BF%A1%E6%81%AF%E6%A0%87%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="信息标记的三种形式"><a href="#信息标记的三种形式" class="headerlink" title="信息标记的三种形式"></a>信息标记的三种形式</h1><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=442869498&auto=1&height=66"></iframe><ul><li>XML(eXtensible Markup Language)</li><li>YAML(YAML Ain’t Markup Language)</li><li>JSON(JaveScript Object Notation)<span id="more"></span><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2>使用标签标记信息的表达形式<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">people</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--这是注释--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">firstname</span>&gt;</span>Shan<span class="tag">&lt;/<span class="name">firstname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lastname</span>&gt;</span>Ye<span class="tag">&lt;/<span class="name">lastname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">streetAddre</span>&gt;</span>None<span class="tag">&lt;/<span class="name">streetAddre</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">city</span>&gt;</span>Gui Lin<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">zipcode</span>&gt;</span>541004<span class="tag">&lt;/<span class="name">zipcode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">prof</span>&gt;</span>boy<span class="tag">&lt;/<span class="name">prof</span>&gt;</span><span class="tag">&lt;<span class="name">prof</span>&gt;</span>boring<span class="tag">&lt;/<span class="name">prof</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">people</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><p>有类型键值对标记信息的表达形式</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;firstname&quot;</span>: <span class="string">&quot;Shan&quot;</span>,</span><br><span class="line"><span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Ye&quot;</span>,</span><br><span class="line"><span class="attr">&quot;address&quot;</span>:</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="attr">&quot;streetAddre&quot;</span>:<span class="string">&quot;None&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;city&quot;</span>: <span class="string">&quot;Gui Lin&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;zipcode&quot;</span>: <span class="string">&quot;541004&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="YML"><a href="#YML" class="headerlink" title="YML"></a>YML</h2><p>无类型键值对标记信息的表达形式</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">firstname:</span> <span class="string">Shan</span></span><br><span class="line"><span class="attr">lastname:</span> <span class="string">Ye</span></span><br><span class="line"><span class="attr">address:</span>   <span class="comment">#缩进表达所属关系</span></span><br><span class="line">    <span class="attr">streetAddre:</span> <span class="string">None</span></span><br><span class="line">    <span class="attr">city:</span> <span class="string">Gui</span> <span class="string">Lin</span></span><br><span class="line">    <span class="attr">zipcode:</span> <span class="number">541004</span></span><br><span class="line"><span class="attr">prof:</span>  <span class="comment">#this is a comment</span></span><br><span class="line"><span class="string">-boy</span>     <span class="comment">#并列关系</span></span><br><span class="line"><span class="string">-boring</span></span><br><span class="line"></span><br><span class="line"><span class="attr">text:</span> <span class="string">|</span>     <span class="comment">#整块数据</span></span><br><span class="line"><span class="string">ACM国际大学生程序设计竞赛（英文全称：ACM</span> <span class="string">International</span> <span class="string">Collegiate</span> <span class="string">Programming</span> <span class="string">Contest（简称ACM-ICPC或ICPC））</span></span><br><span class="line"><span class="string">是由国际计算机协会（ACM）主办的，一项旨在展示大学生创新能力、团队精神和在压力下编写程序、分析和解决问题能力的年度竞赛。</span></span><br><span class="line"><span class="string">经过近40年的发展，ACM国际大学生程序设计竞赛已经发展成为全球最具影响力的大学生程序设计竞赛。赛事目前由IBM公司赞助。</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">提取HTMl中的所有信息</span></span><br><span class="line"><span class="string">（1）搜索到所有的&lt;a&gt;标签</span></span><br><span class="line"><span class="string">（2）解析&lt;a&gt;标签格式，提取href后的链接内容</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://python123.io/ws/demo.html&quot;</span></span><br><span class="line">r = requests.get(url)</span><br><span class="line">demo = r.text</span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;a&#x27;</span>):</span><br><span class="line"><span class="built_in">print</span>(link.get(<span class="string">&quot;href&quot;</span>))</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/dwdhoVj.png" class="lazyload" data-srcset="https://i.imgur.com/dwdhoVj.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h1 id="基于bs4库的信息提取的一般方法"><a href="#基于bs4库的信息提取的一般方法" class="headerlink" title="基于bs4库的信息提取的一般方法"></a>基于bs4库的信息提取的一般方法</h1><h2 id="lt-gt-find-all-方法"><a href="#lt-gt-find-all-方法" class="headerlink" title="&lt;&gt;.find_all()方法"></a><code>&lt;&gt;.find_all()方法</code></h2><pre><code>&lt;&gt;.find_all(name,attrs,recursive,string,**kwargs)</code></pre><ul><li>name: 对应标签名称的检索字符串</li><li>attrs:对应标签属性值的检索字符串，可标注属性检索</li><li>recursive：是否对子孙全部检索，默认为True</li><li>string：&lt;&gt;…&lt;/&gt;字符串区域的检索字符串</li></ul><p><font color="red">soup.find_all(…)等价于soup(…)</font><br><font color="red"><tag>.find_all(…)等价于<tag>(…)</font></p><p><img src="https://i.imgur.com/Klgrnal.png" class="lazyload" data-srcset="https://i.imgur.com/Klgrnal.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="https://i.imgur.com/wbedsUF.png" class="lazyload" data-srcset="https://i.imgur.com/wbedsUF.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="https://i.imgur.com/PwChHtw.png" class="lazyload" data-srcset="https://i.imgur.com/PwChHtw.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="扩展方法"><a href="#扩展方法" class="headerlink" title="扩展方法"></a>扩展方法</h2><table><thead><tr><th align="center">方法</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">&lt;&gt;.find()</td><td align="center">搜索且只返回一个结果，同.find_all()参数</td></tr><tr><td align="center">&lt;&gt;.find_parents()</td><td align="center">在先辈节点中搜索，返回列表类型，同.find_all()参数</td></tr><tr><td align="center">&lt;&gt;.find_parent()</td><td align="center">在先辈节点中返回一个结果，同.find()参数</td></tr><tr><td align="center">&lt;&gt;.find_next_siblings()</td><td align="center">在后续平行节点中搜索，返回一个列表，同.find_all()参数</td></tr><tr><td align="center">&lt;&gt;.find_next_sibling()</td><td align="center">在后续节点中返回一个结果，用.find()参数</td></tr><tr><td align="center">&lt;&gt;find_previous_siblings()</td><td align="center">在前续平行结点中搜索，返回列表类型，同.find_all()参数</td></tr><tr><td align="center">&lt;&gt;find.previous_sibling()</td><td align="center">在前续节点中返回一个节点，同.find()参数</td></tr></tbody></table><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
            <tag> 信息标记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-4</title>
      <link href="2018/10/11/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-4/"/>
      <url>2018/10/11/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=461748517&auto=1&height=66"></iframe><h1 id="继承和派生"><a href="#继承和派生" class="headerlink" title="继承和派生"></a>继承和派生</h1><blockquote><p>新类拥有原有类的全部属性为继承！原有类产生新类的过程为派生。</p></blockquote><p>原有类称为基类，产生的新类称为派生类。<br><a href="http://www.dotcpp.com/course/cpp/200027.html">http://www.dotcpp.com/course/cpp/200027.html</a></p><h2 id="继承方式（派生权限）"><a href="#继承方式（派生权限）" class="headerlink" title="继承方式（派生权限）"></a>继承方式（派生权限）</h2><ul><li>公有继承</li><li>私有继承</li><li>保护继承</li></ul><span id="more"></span><h3 id="公有继承"><a href="#公有继承" class="headerlink" title="公有继承"></a>公有继承</h3><ul><li>基类中的公有成员，在派生类中仍然为公有成员。无论派生类的成员函数还是成员对象都可以访问。</li><li>基类中的私有成员，无论在派生类的成员还是派生类对象都不可以访问。</li><li>基类中的保护成员，在派生类中仍然是保护类型，可以通过派生类的成员函数访问，但派生类对象不可以访问！</li></ul><h3 id="私有继承"><a href="#私有继承" class="headerlink" title="私有继承"></a>私有继承</h3><ul><li>基类中的公有和受保护类型，被派生类私有吸收后，都变为派生类的私有类型，即在类的成员函数里可以访问，不能在类外访问。</li><li>基类的私有成员，在派生类类内和类外都不可以访问。</li></ul><h3 id="保护继承"><a href="#保护继承" class="headerlink" title="保护继承"></a>保护继承</h3><ul><li>基类的公共成员和保护类型成员在派生类中为保护成员。</li><li>基类的私有成员在派生类中不能被直接访问。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>                   //基类</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Set</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;number=number;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;he or she number:&quot;</span>&lt;&lt;number&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Score</span>:</span><span class="keyword">public</span> Student      <span class="comment">//公有继承，派生类</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">set_score</span><span class="params">(<span class="keyword">int</span> score)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;score=score;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show_score</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the score is :&quot;</span>&lt;&lt;score&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Score A;</span><br><span class="line">A.<span class="built_in">Set</span>(<span class="number">17007101</span>);</span><br><span class="line">A.<span class="built_in">Show</span>();</span><br><span class="line">A.<span class="built_in">set_score</span>(<span class="number">99</span>);</span><br><span class="line">A.<span class="built_in">show_score</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/jpF5xiJ.png" class="lazyload" data-srcset="https://i.imgur.com/jpF5xiJ.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="多继承"><a href="#多继承" class="headerlink" title="多继承"></a>多继承</h2><p>一个子类可以有多个父类，继承多个父类的特性<br>    class &lt;派生类名&gt;:&lt;继承方式&gt;&lt;基类名1&gt;,&lt;继承方式&gt;&lt;基类名2&gt;,…{派生类类体}</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">Shape</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">width = w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setHight</span><span class="params">(<span class="keyword">int</span> h)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">height = h;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="keyword">int</span> width;</span><br><span class="line"><span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PaintCost</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">GetCost</span><span class="params">(<span class="keyword">int</span> area)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> area*<span class="number">70</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span> <span class="keyword">public</span> Shape,<span class="keyword">public</span> PaintCost   <span class="comment">//派生类</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getArea</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (width*height);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Rectangle Rect;</span><br><span class="line"><span class="keyword">int</span> area;</span><br><span class="line"></span><br><span class="line">Rect.<span class="built_in">setWidth</span>(<span class="number">10</span>);</span><br><span class="line">Rect.<span class="built_in">setHight</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">area = Rect.<span class="built_in">getArea</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出对象面积</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Total area: &quot;</span>&lt;&lt;Rect.<span class="built_in">getArea</span>()&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出总花费</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Total paint cost: &quot;</span>&lt;&lt;Rect.<span class="built_in">GetCost</span>(area)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/QwAzhpK.png" class="lazyload" data-srcset="https://i.imgur.com/QwAzhpK.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅尝BeautifulSoup</title>
      <link href="2018/10/10/%E6%B5%85%E5%B0%9DBeautifulSoup/"/>
      <url>2018/10/10/%E6%B5%85%E5%B0%9DBeautifulSoup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup <span class="comment">#引入BeautifulSoup类</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://python123.io/ws/demo.html&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.status_code)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#demo = r.text    #html格式信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#soup = BeautifulSoup(demo,&quot;html.parser&quot;)#使用html.parser对demo进行html解析</span></span><br><span class="line">soup = BeautifulSoup(<span class="built_in">open</span>(<span class="string">r&quot;C:\Users\Administrator\Desktop\beautifulsoup\demo.html&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(soup.prettify())</span><br></pre></td></tr></table></figure><p><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup官方文档</a></p><span id="more"></span><h1 id="BeautifulSoup库解析器"><a href="#BeautifulSoup库解析器" class="headerlink" title="BeautifulSoup库解析器"></a>BeautifulSoup库解析器</h1><table><thead><tr><th align="center">解析器</th><th align="center">使用方法</th><th align="center">条件</th></tr></thead><tbody><tr><td align="center">bs4的HTML解析器</td><td align="center">beautiful(mk,”html.parser”)</td><td align="center">安装bs4库</td></tr><tr><td align="center">lxml的HTML解析器</td><td align="center">BeautifulSoup(mk,”lxml”)</td><td align="center">安装lxml库</td></tr><tr><td align="center">lxml的xml解析器</td><td align="center">BeautifulSoup(mk,”xml”)</td><td align="center">安装lxml库</td></tr><tr><td align="center">html5lib的解析器</td><td align="center">BeautifulSoup(mk,”html5lib”)</td><td align="center">安装html5lib库</td></tr></tbody></table><h1 id="BeautifulSoup库的基本元素"><a href="#BeautifulSoup库的基本元素" class="headerlink" title="BeautifulSoup库的基本元素"></a>BeautifulSoup库的基本元素</h1><table><thead><tr><th align="center">基本元素</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">Tag</td><td align="center">标签，最基本的信息组织单元，分别用&lt;&gt;&lt;/&gt;标明开头和结尾</td></tr><tr><td align="center">Name</td><td align="center">标签的名字，<code>&lt;p&gt;...&lt;/p&gt;</code>的名字是‘p’,格式:<code>&lt;tag&gt;.name</code></td></tr><tr><td align="center">Attributes</td><td align="center">标签的属性,字典形式组织，格式:<code>&lt;tag&gt;.attrs</code></td></tr><tr><td align="center">NavigableString</td><td align="center">标签内非属性字符串,&lt;&gt;…&lt;/&gt;中字符串，格式:<code>&lt;tag&gt;.string</code></td></tr><tr><td align="center">Comment</td><td align="center">标签内字符串的注释部分，一种特殊的Comment类型</td></tr><tr><td align="center"><img src="https://i.imgur.com/E3iOdKm.png" class="lazyload" data-srcset="https://i.imgur.com/E3iOdKm.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></td><td align="center"></td></tr><tr><td align="center"><img src="https://i.imgur.com/IQm7qi8.png" class="lazyload" data-srcset="https://i.imgur.com/IQm7qi8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></td><td align="center"></td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tag的Comment元素</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(<span class="string">&quot;&lt;b&gt;&lt;!--This is a comment--&gt;&lt;/b&gt;&lt;p&gt;This is not a comment&lt;/p&gt;&quot;</span>,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(soup.b.string)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(soup.b.string))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(soup.p.string)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(soup.p.string))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/77Ka7Qb.png" class="lazyload" data-srcset="https://i.imgur.com/77Ka7Qb.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li>BeautifulSoup对应一个HTML/XML文档的全部内容</li><li>任何存在于HTMl语法中的标签都可以用<code>soup.&lt;tag&gt;</code>访问获得，当HTML文档中存在多个相同<code>&lt;tag&gt;</code>对应内容时，<code>soup.&lt;tag&gt;</code>返回第一个</li><li>每个<code>&lt;tag&gt;</code>都有自己的名字，通过<code>&lt;tag&gt;.name</code>获取，字符串类型</li><li>一个<code>&lt;tag&gt;</code>可以有0或多个属性，字典类型</li><li>NavigableString可以跨越多个层次</li></ul><h1 id="基于bs4库的HTML内容遍历方法"><a href="#基于bs4库的HTML内容遍历方法" class="headerlink" title="基于bs4库的HTML内容遍历方法"></a>基于bs4库的HTML内容遍历方法</h1><p><img src="https://i.imgur.com/9ka0fPA.png" class="lazyload" data-srcset="https://i.imgur.com/9ka0fPA.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="https://i.imgur.com/QqwbSXq.png" class="lazyload" data-srcset="https://i.imgur.com/QqwbSXq.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="标签数的下行遍历"><a href="#标签数的下行遍历" class="headerlink" title="标签数的下行遍历"></a>标签数的下行遍历</h2><table><thead><tr><th align="center">属性</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">.contents</td><td align="center">子节点的列表，将<tag>所有儿子节点存人列表</td></tr><tr><td align="center">.children</td><td align="center">子节点的迭代类型，于.contents类似，用于循环遍历儿子节点</td></tr><tr><td align="center">.descendants</td><td align="center">子孙节点的迭代类型，包含所有子孙节点，用于循环遍历</td></tr><tr><td align="center"><img src="https://i.imgur.com/x0ptQee.png" class="lazyload" data-srcset="https://i.imgur.com/x0ptQee.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></td><td align="center"></td></tr><tr><td align="center"><img src="https://i.imgur.com/aoz6x9u.png" class="lazyload" data-srcset="https://i.imgur.com/aoz6x9u.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></td><td align="center"></td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标签树的下行遍历</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://python123.io/ws/demo.html&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url)</span><br><span class="line"></span><br><span class="line">demo = r.text</span><br><span class="line">soup = BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;for child in soup.body.children:  #遍历儿子节点</span></span><br><span class="line"><span class="string">    print(child)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> soup.body.descendants:  <span class="comment">#遍历子孙节点</span></span><br><span class="line">    <span class="built_in">print</span>(child)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="标签树的上行遍历"><a href="#标签树的上行遍历" class="headerlink" title="标签树的上行遍历"></a>标签树的上行遍历</h2><table><thead><tr><th align="center">属性</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">.parent</td><td align="center">节点的父亲标签</td></tr><tr><td align="center">.parents</td><td align="center">节点先辈标签的的迭代类型，用于循环遍历先辈节点</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标签树的上行遍历</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://python123.io/ws/demo.html&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url)</span><br><span class="line"></span><br><span class="line">demo = r.text</span><br><span class="line">soup = BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> parent <span class="keyword">in</span> soup.a.parents:  <span class="comment">#遍历所有先辈节点，包括soup本身，soup的先辈不存在name信息</span></span><br><span class="line">    <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(parent)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(parent.name)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/WEKGdLU.png" class="lazyload" data-srcset="https://i.imgur.com/WEKGdLU.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="标签树的平行遍历"><a href="#标签树的平行遍历" class="headerlink" title="标签树的平行遍历"></a>标签树的平行遍历</h2><p>平行遍历发生在同一个父节点下的各节点之间</p><table><thead><tr><th align="center">属性</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">.next_sibling</td><td align="center">返回按照HTML文本顺序的下一个平行节点标签</td></tr><tr><td align="center">.previous_sibling</td><td align="center">返回按照HTML文本顺序的上一个平行节点标签</td></tr><tr><td align="center">.next_siblings</td><td align="center">迭代类型，返回按照HTML文本顺序的后续所有平行节点标签</td></tr><tr><td align="center">.previous_siblings</td><td align="center">迭代类型，返回按照HTML文本顺序的前续所有平行节点标签</td></tr></tbody></table><p><img src="https://i.imgur.com/TECSzL4.png" class="lazyload" data-srcset="https://i.imgur.com/TECSzL4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标签树的平行遍历</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://python123.io/ws/demo.html&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url)</span><br><span class="line"></span><br><span class="line">demo = r.text</span><br><span class="line">soup = BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sibling <span class="keyword">in</span> soup.a.next_sibling:</span><br><span class="line">    <span class="built_in">print</span>(sibling)                  <span class="comment">#遍历后续节点</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;for sibling in soup.a.previous_sibling:</span></span><br><span class="line"><span class="string">    print(sibling)                  #遍历前续节点</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="基于bs4库的HTML格式输出—prettify-方法"><a href="#基于bs4库的HTML格式输出—prettify-方法" class="headerlink" title="基于bs4库的HTML格式输出—prettify()方法"></a>基于bs4库的HTML格式输出—prettify()方法</h1><ul><li>.prettify()为HTML文本<code>&lt;&gt;</code>及其内容增加’\n’</li><li>.prettify()可用于标签,方法:<code>&lt;tag&gt;.perttify()</code></li></ul><p><img src="https://i.imgur.com/4BJpNgt.png" class="lazyload" data-srcset="https://i.imgur.com/4BJpNgt.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="https://i.imgur.com/bHQdzDW.png" class="lazyload" data-srcset="https://i.imgur.com/bHQdzDW.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p align="right"><font color="red" size="3">bs4库将任何HTML输入都变成utf-8编码</font></p><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
            <tag> BeautifulSoup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-3</title>
      <link href="2018/10/09/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-3/"/>
      <url>2018/10/09/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="友元函数和友元类"><a href="#友元函数和友元类" class="headerlink" title="友元函数和友元类"></a>友元函数和友元类</h1><blockquote><p>友元的对象可以是全局的一般函数，也可以是其它类里的成员函数，这种叫做友元函数。<br>友元还可以是一个类，这种叫做友元类，这时整个类的所有成员都是友元</p></blockquote><p><img src="https://i.imgur.com/jJBlXph.png" class="lazyload" data-srcset="https://i.imgur.com/jJBlXph.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></p><span id="more"></span><h2 id="一、友元函数"><a href="#一、友元函数" class="headerlink" title="一、友元函数"></a>一、友元函数</h2><ol><li>类的友元函数定义在类的外部，但是有权访问类的所有私有成员和保护成员。但友元函数并不是成员函数。</li><li>有元函数的声明使用<code>friend</code>关键字</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">double</span> x;</span><br><span class="line"><span class="keyword">double</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Point</span>(<span class="keyword">double</span> a,<span class="keyword">double</span> b)    <span class="comment">//Constructor</span></span><br><span class="line">&#123;</span><br><span class="line">x=a;</span><br><span class="line">y=b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetPoint</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;(&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;)&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">friend</span> <span class="keyword">double</span> <span class="title">Distance</span><span class="params">(Point &amp;a,Point &amp;b)</span></span>;<span class="comment">//声明友元函数</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Distance</span><span class="params">(Point &amp;a,Point&amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> xx;</span><br><span class="line"><span class="keyword">double</span> yy;</span><br><span class="line">xx = a.x-b.x;</span><br><span class="line">yy = a.y-b.y;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">sqrt</span>(xx*xx+yy*yy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Point <span class="title">A</span><span class="params">(<span class="number">2.0</span>,<span class="number">3.0</span>)</span></span>;</span><br><span class="line"><span class="function">Point <span class="title">B</span><span class="params">(<span class="number">1.0</span>,<span class="number">2.0</span>)</span></span>;</span><br><span class="line">A.<span class="built_in">GetPoint</span>();</span><br><span class="line">B.<span class="built_in">GetPoint</span>();</span><br><span class="line"><span class="keyword">double</span> dis;</span><br><span class="line">dis = <span class="built_in">Distance</span>(A,B);</span><br><span class="line">cout&lt;&lt;dis&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/l0VH5l2.png" class="lazyload" data-srcset="https://i.imgur.com/l0VH5l2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p>友元函数没有this指针，参数的情况；</p><ul><li>要访问非static成员时，需要对象做参数</li><li>要访问static成员或全局变量时，则不需要对象做参数</li><li>如果做参数的对象时全局对象，则不需要对象做参数，可直接调用友元函数，不需要通过对象或指针。</li></ul><h2 id="二、友元类"><a href="#二、友元类" class="headerlink" title="二、友元类"></a>二、友元类</h2><p>把一个类A声明为另一个类B的友元类,则类A中的所有成员函数都可以访问类B中的成员。在类B中声明即可。<br>    friend class A;</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> x;</span><br><span class="line"><span class="keyword">double</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Point</span>(<span class="keyword">double</span> a,<span class="keyword">double</span> b)<span class="comment">//Constructor</span></span><br><span class="line">&#123;</span><br><span class="line">x=a;</span><br><span class="line">y=b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetPoint</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;(&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;)&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">Tool</span>;</span><span class="comment">//声明友元类</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tool</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Get_x</span><span class="params">(Point &amp;A )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> A.x;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Get_y</span><span class="params">(Point &amp;A)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> A.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Distance</span><span class="params">(Point &amp;A)</span>  <span class="comment">//求一点到原点的距离</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sqrt</span>(A.x*A.x+A.y*A.y)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">sqrt</span>(A.x*A.x+A.y*A.y);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Point <span class="title">A</span><span class="params">(<span class="number">3.0</span>,<span class="number">3.0</span>)</span></span>;</span><br><span class="line">A.<span class="built_in">GetPoint</span>();</span><br><span class="line">Tool T;</span><br><span class="line">T.<span class="built_in">Get_x</span>(A);</span><br><span class="line">T.<span class="built_in">Get_y</span>(A);</span><br><span class="line">T.<span class="built_in">Distance</span>(A);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/mfBflqX.png" class="lazyload" data-srcset="https://i.imgur.com/mfBflqX.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象-2</title>
      <link href="2018/10/06/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-2/"/>
      <url>2018/10/06/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="类的构造函数-Constructor-和析构函数-Destructor"><a href="#类的构造函数-Constructor-和析构函数-Destructor" class="headerlink" title="类的构造函数(Constructor)和析构函数(Destructor)"></a>类的构造函数(Constructor)和析构函数(Destructor)</h1><iframe src="http://open.iqiyi.com/developer/player_js/coopPlayerIndex.html?vid=c5d7868e19457dd682738eee9b4b05af&tvId=11980807509&accessToken=2.f22860a2479ad60d8da7697274de9346&appKey=3955c3425820435e86d0f4cdfe56f5e7&appId=1368&height=50%&width=100%" frameborder="0" allowfullscreen="true" width="100%" height="100%"></iframe><span id="more"></span><ul><li>构造函数是类的一种特殊的成员函数，它会在每次创建类的新对象时执行。构造函数的名称与类的名称是完全相同的，并且不会反回任何类型，也不会反回void。</li><li>析构函数也是类的一种特殊的成员函数，它会在每次删除所创建的对象时执行。函数名称与类的名称完全相同，只是在前面加了个<code>~</code>波浪线作为前缀，它不会返回任何值，也不能带有任何参数。</li></ul><h2 id="1-构造函数（Constructor）"><a href="#1-构造函数（Constructor）" class="headerlink" title="1.构造函数（Constructor）"></a>1.构造函数（Constructor）</h2><p>&ensp; 当我们定义一个类的对象时，系统就会自动调用它，进行专门的初始化对象用。如果我们没有定义构造函数，系统会默认生成一个默认形式，隐藏着的构造函数，这个构造函数的函数体是空的，它不具有任何功能。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Student</span>(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s);</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Set</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Student::<span class="built_in">Student</span>(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)<span class="comment">//定义了一个带默认参数的构造函数</span></span><br><span class="line">&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="built_in">strcpy</span>(name,str);</span><br><span class="line">score=s;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Constructor&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::Set</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="built_in">strcpy</span>(name,str);</span><br><span class="line">score=s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Student <span class="title">A</span><span class="params">(<span class="number">1700710135</span>,<span class="string">&quot;yeshan&quot;</span>,<span class="number">99</span>)</span></span>;</span><br><span class="line">A.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Student C;这样定义对象会报错，因为我们在类中定义了一个带默认参数的构造函数</span></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="function">Student <span class="title">B</span><span class="params">(<span class="number">1700710134</span>,<span class="string">&quot;xu jie&quot;</span>,<span class="number">100</span>)</span></span>;</span><br><span class="line">B.<span class="built_in">print</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/d2l2W40.png" class="lazyload" data-srcset="https://i.imgur.com/d2l2W40.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="green">由于在程序中定义了一个带默认参数的构造函数，则系统不会再自动生成，这个时候定义对象时也要传入三个默认初始值，因为构造函数可以重载，可以有多个兄弟，系统会找最匹配的一个函数</font></p><h2 id="2-析构函数（Destructor）"><a href="#2-析构函数（Destructor）" class="headerlink" title="2.析构函数（Destructor）"></a>2.析构函数（Destructor）</h2><p>&ensp;对象销毁时自动调用的一个函数，<code>析构函数不能重载，一个类只能有一个析构函数</code>，析构函数有助于跳出程序前释放内存。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Student</span>(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s);</span><br><span class="line">~<span class="built_in">Student</span>();</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Set</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Student::<span class="built_in">Student</span>(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)<span class="comment">//构造函数</span></span><br><span class="line">&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="built_in">strcpy</span>(name,str);</span><br><span class="line">score=s;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Constructor&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student::~<span class="built_in">Student</span>()<span class="comment">//析构函数</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;destructor&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::Set</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> *str,<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="built_in">strcpy</span>(name,str);</span><br><span class="line">score=s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Student <span class="title">A</span><span class="params">(<span class="number">100</span>,<span class="string">&quot;dot&quot;</span>,<span class="number">11</span>)</span></span>;</span><br><span class="line"><span class="function">Student <span class="title">B</span><span class="params">(<span class="number">101</span>,<span class="string">&quot;cpp&quot;</span>,<span class="number">12</span>)</span></span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/di0YIID.png" class="lazyload" data-srcset="https://i.imgur.com/di0YIID.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="green">对象A和B的构造函数的调用顺序以及构造函数的调用顺序，完全相反！原因在于A和B对象同属局部对象，也在栈区存储，也遵循“先进后出”的顺序！</font></p><h2 id="拷贝构造函数"><a href="#拷贝构造函数" class="headerlink" title="拷贝构造函数"></a>拷贝构造函数</h2><blockquote><p>拷贝构造函数是一种特殊的构造函数，具有单个形参，该形参（常用const修饰）是对该类类型的引用。<br>它在创建对象时，是使用同一类中之前创建的对象来初始化新创建的对象。<br>当定义一个新对象并用同一个类型的对象对它进行初始化时，将显示使用拷贝构造函。</p></blockquote><p>只包含类类型成员或内置类型（但不是指针类型）成员的类，无须显式地定义拷贝构造函数也可以拷贝。</p><pre><code>显示定义拷贝构造函数的情况：类有数据成员是指针；有成员表示在构造函数中分配的其他资源</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Age</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetAge</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="built_in">Age</span>(<span class="keyword">int</span> age);           <span class="comment">//Constructor</span></span><br><span class="line"><span class="built_in">Age</span>(<span class="keyword">const</span> Age&amp; A);      <span class="comment">//Copy Constructor</span></span><br><span class="line">~<span class="built_in">Age</span>();                 <span class="comment">//Desconstructor</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> *ptr;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Age::<span class="built_in">Age</span>(<span class="keyword">int</span> age)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;调用构造函数&quot;</span>&lt;&lt;endl;</span><br><span class="line">ptr = <span class="keyword">new</span> <span class="keyword">int</span>;<span class="comment">//为指针分配内存</span></span><br><span class="line">*ptr = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Age::<span class="built_in">Age</span>(<span class="keyword">const</span> Age&amp; A)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;调用拷贝构造函数，并为指针ptr分配内存&quot;</span>&lt;&lt;endl;</span><br><span class="line">ptr = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line"></span><br><span class="line">*ptr = *A.ptr;   <span class="comment">//拷贝值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Age::~<span class="built_in">Age</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;释放内存&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">delete</span> ptr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Age::GetAge</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *ptr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_age</span><span class="params">(Age A)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the age: &quot;</span>&lt;&lt;A.<span class="built_in">GetAge</span>()&lt;&lt;endl; <span class="comment">//这里也调用了拷贝构造函数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Age <span class="title">member_1</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">Age <span class="title">member_2</span><span class="params">(member_2)</span></span>;<span class="comment">//相当于Age member_2 = member_1;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/OoobZof.png" class="lazyload" data-srcset="https://i.imgur.com/OoobZof.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><img src="https://i.imgur.com/qDMYpUF.png" class="lazyload" data-srcset="https://i.imgur.com/qDMYpUF.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"><br><img src="https://i.imgur.com/7bc9q3L.png" class="lazyload" data-srcset="https://i.imgur.com/7bc9q3L.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><img src="https://i.imgur.com/KuxSQ5t.png" class="lazyload" data-srcset="https://i.imgur.com/KuxSQ5t.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><img src="https://i.imgur.com/rhUaMLy.png" class="lazyload" data-srcset="https://i.imgur.com/rhUaMLy.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p><font color="red">成员变量中加一个了指针成员，初始化中需要动态开辟内存，如果不自定义拷贝构造函数，而是用默认生成的，则会出现极大的安全隐患。<br/>默认的拷贝构造函数仅仅是进行数值赋值，并不能为指针开辟内存空间。相当于代码<code>This-&gt;str=str</code>.本质上也就是两个指针指向了一块堆空间。程序结束回收对象的时候，会调用自己的析构函数，释放这块内存空间，由于两个对象要调用两次，即delete两次，就会出现错误</font></p><p align="right"><font size=4>[引自](http://www.dotcpp.com/course/cpp/200020.html)</font></p><h2 id="C-中的this指针"><a href="#C-中的this指针" class="headerlink" title="C++中的this指针"></a>C++中的this指针</h2><p>对象中隐藏的指针</p><ul><li>每一个对象都能通过this指针来访问自己的地址。this指针是所有成员函数额隐含参数。因此在成员函数内部，它可以用来指向调用的对象。</li><li>如果程序中有多个属于同一类的对象，因成员函数的代码仅有一份，所以为了区分它们是哪个对象调用的成员函数，编译器也是转化成this-&gt;成员函数这种形式来使用的。</li><li>友元函数没有this指针，因为友元不是类的成员。只有成员函数才有this指针。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Age</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Age</span>(<span class="keyword">int</span> your_age=<span class="number">18</span>)  <span class="comment">//Constructor function</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Constructor now&quot;</span>&lt;&lt;endl;</span><br><span class="line">age=your_age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetAge</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compare</span><span class="params">(Age member)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>-&gt;<span class="built_in">GetAge</span>()&gt;member.<span class="built_in">GetAge</span>();   <span class="comment">//看这里</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Age <span class="title">member_1</span><span class="params">(<span class="number">20</span>)</span>,<span class="title">member_2</span><span class="params">(<span class="number">24</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(member_1.<span class="built_in">compare</span>(member_2))</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;member_1 is older than member_2&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;member_1 is younger than member_2&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/P3GTC8O.png" class="lazyload" data-srcset="https://i.imgur.com/P3GTC8O.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h4 id="关键字new和delete"><a href="#关键字new和delete" class="headerlink" title="关键字new和delete"></a>关键字new和delete</h4><ol><li>new（新建）用于新建一个对象。new 运算符总是返回一个指针。由 new 创建。</li><li>delete（删除）释放程序动态申请的内存空间。delete 后面通常是一个指针或者数组 []，并且只能 delete 通过 new 关键字申请的指针。</li></ol><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++面向对象</title>
      <link href="2018/10/05/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
      <url>2018/10/05/C++-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="类-amp-对象"><a href="#类-amp-对象" class="headerlink" title="类 &amp; 对象"></a>类 &amp; 对象</h1><blockquote><p><font color="red">类是对象的抽象和概括，而对象是类的具体和实例</font></p></blockquote><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=1308818967&auto=1&height=66"></iframe><span id="more"></span><ul><li>类用于指定对象的形式，它包含了数据表示法和用于处理数据的方法。</li><li>类中的数据和方法称为类的成员。(成员有变量也有函数，分别成为类的属性和方法)</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*class Student</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">int num;</span></span><br><span class="line"><span class="comment">char name[100];</span></span><br><span class="line"><span class="comment">int score;</span></span><br><span class="line"><span class="comment">int print()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">cout&lt;&lt;num&lt;&lt;&quot; &quot;&lt;&lt;name&lt;&lt;&quot; &quot;&lt;&lt;score;</span></span><br><span class="line"><span class="comment">return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;;*/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Student A;</span><br><span class="line">A.num=<span class="number">1700710135</span>;</span><br><span class="line"><span class="built_in">strcpy</span>(A.name,<span class="string">&quot;ye shan&quot;</span>);</span><br><span class="line">A.score=<span class="number">100</span>;</span><br><span class="line"><span class="comment">//A.print();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Student *Ap;</span></span><br><span class="line"><span class="comment">//Ap=&amp;A;</span></span><br><span class="line"><span class="comment">//Ap-&gt;print();</span></span><br><span class="line"></span><br><span class="line">Student&amp; A_reference=A;  <span class="comment">//引用定义时就要初始化</span></span><br><span class="line"><span class="comment">//A_reference=A;  错误</span></span><br><span class="line">A_reference.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/f8XiWyi.png" class="lazyload" data-srcset="https://i.imgur.com/f8XiWyi.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="类的定义"><a href="#类的定义" class="headerlink" title="类的定义"></a>类的定义</h2><blockquote><p>定义一个类，本质上是定义一个数据类型的蓝图。它定义类的对象包括了什么，以及可以在这个对象上执行哪些操作。</p></blockquote><p>类的定义以关键字<code>class</code>开头，后面跟类的名称。类的主体包含在一对花括号中。类定义后必须跟着<code>一个分号或一个声明列表</code>。</p><h3 id="写法1"><a href="#写法1" class="headerlink" title="写法1"></a>写法1</h3><p>成员函数定义在在类里</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:       <span class="comment">//声明公有成员，可被类的任何对象访问</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="写法2"><a href="#写法2" class="headerlink" title="写法2"></a>写法2</h3><p>成员函数定义在类外，使用范围解析运算符(作用域限定符)<code>::</code><br>    在::限定符前必须使用类名</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;name&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;score;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="对象的建立和使用"><a href="#对象的建立和使用" class="headerlink" title="对象的建立和使用"></a>对象的建立和使用</h2><blockquote><p>类就是包含函数的结构体，是一种自定义数据类型，用它定义出来变量，就是对象，这就是所谓的“对象是类的具体和实例”，定义了一个这个类的对象，也可以说实例化了一个对象，就是这个意思！</p></blockquote><ol><li>声明类的对象，就像声明基本的变量类型一样</li><li>访问公共数据成员可以使用直接成员访问运算符<code>.</code>来访问</li></ol><pre><code>Student A;    //声明A，类型为StudentA.num=1700710135;strcpy(name,&quot;ye shan&quot;);A.score=100;A.print();</code></pre><h3 id="类的访问修饰符"><a href="#类的访问修饰符" class="headerlink" title="类的访问修饰符"></a>类的访问修饰符</h3><ul><li>private</li><li>protected</li><li>public</li></ul><ol><li>成员和类的默认访问修饰符是<code>private</code><br>&ensp; 私有成员变量或函数在类的外部是不可访问的，甚至是不可查看的。只有类和友元函数可以访问私有成员。</li><li>保护成员修饰符<code>protected</code>，保护成员变量或函数与私有成员十分相似，但有一点不同，保护成员变量在派生类（即子类）中是可以访问的。</li><li>公有成员在程序中类的外部是可以访问的。可以在不适用任何成员函数来设置和获取公有变量的值</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetNum</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetScore</span><span class="params">(<span class="keyword">int</span> s)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::GetNum</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::GetScore</span><span class="params">(<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">score=s;</span><br><span class="line"><span class="keyword">return</span> score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Student A;</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcpy</span>(A.name,<span class="string">&quot;yeshan&quot;</span>);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the name is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.name&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//A.num=1700710135，成员num是稀有的，不可这样用</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the num is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.<span class="built_in">GetNum</span>(<span class="number">1700710135</span>)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the score is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.<span class="built_in">GetScore</span>(<span class="number">100</span>)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/l9YSrb0.png" class="lazyload" data-srcset="https://i.imgur.com/l9YSrb0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><p>派生类中使用protected成员变量</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="keyword">int</span> score;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetNum</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">GetScore</span><span class="params">(<span class="keyword">int</span> s)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Small_Student</span>:</span>Student<span class="comment">//Small_Student是派生类</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Get_Score_1</span><span class="params">(<span class="keyword">int</span> temp)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Small_Student::Get_Score_1</span><span class="params">(<span class="keyword">int</span> temp)</span>   <span class="comment">//子类成员函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">score=temp;</span><br><span class="line"><span class="keyword">return</span> score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::GetNum</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num=n;</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Student::GetScore</span><span class="params">(<span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">score=s;</span><br><span class="line"><span class="keyword">return</span> score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Student A;</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcpy</span>(A.name,<span class="string">&quot;yeshan&quot;</span>);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the name is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.name&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//A.num=1700710135，成员num是稀有的，不可这样用</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the num is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.<span class="built_in">GetNum</span>(<span class="number">1700710135</span>)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the score is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;A.<span class="built_in">GetScore</span>(<span class="number">100</span>)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">Small_Student B;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the score is&quot;</span>&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;B.<span class="built_in">Get_Score_1</span>(<span class="number">520</span>)&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/ycHrArS.png" class="lazyload" data-srcset="https://i.imgur.com/ycHrArS.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="类的静态成员"><a href="#类的静态成员" class="headerlink" title="类的静态成员"></a>类的静态成员</h2><p>使用<code>static</code>关键字把类成员定义为静态的</p><h2 id="静态成员数据"><a href="#静态成员数据" class="headerlink" title="静态成员数据"></a>静态成员数据</h2><ul><li>静态成员在类的所有对象中是共享的。如果不存在其它初始化语句，在创建第一个对象时，所有的静态数据都会被初始化为零。</li><li>不能把静态成员放置在类的定义中，但是可以在类的外部通过使用范围解析运算符<code>::</code>来重新声明静态变量，从而对它进行初始化。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Area</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> length;</span><br><span class="line"><span class="keyword">double</span> width;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> object_count;</span><br><span class="line">    <span class="built_in">Area</span>(<span class="keyword">double</span> x,<span class="keyword">double</span> y)</span><br><span class="line">&#123;</span><br><span class="line">length = x;</span><br><span class="line">width = y;</span><br><span class="line">object_count++;<span class="comment">//每次创建对象时加一</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Print_Area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> length*width;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Area::object_count=<span class="number">0</span>;<span class="comment">//初始化类Area的静态成员</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Area <span class="title">number_1</span><span class="params">(<span class="number">3</span>,<span class="number">4</span>)</span></span>;</span><br><span class="line"><span class="function">Area <span class="title">number_2</span><span class="params">(<span class="number">5</span>,<span class="number">6</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;creat &quot;</span>&lt;&lt;Area::object_count&lt;&lt;<span class="string">&quot; object&quot;</span>&lt;&lt;endl;  <span class="comment">//使用    类名+范围解析运算符::+静态成员变量    访问静态成员数据</span></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;the area of number_1 is &quot;</span>&lt;&lt;number_1.<span class="built_in">Print_Area</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/c1JTCaS.png" class="lazyload" data-srcset="https://i.imgur.com/c1JTCaS.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="静态成员函数"><a href="#静态成员函数" class="headerlink" title="静态成员函数"></a>静态成员函数</h2><ul><li>静态成员函数即使在类对象不存在的情况下也能被调用。</li><li>静态成员函数只能访问静态数据成员，不能访问其他静态成员函数和类外部的函数</li><li>静态成员函数有一个类范围，他们不能访问类的this指针。可以用静态成员函数来判断某些对象是否已被创建。</li><li>调用时使用 类名+范围解析运算符+静态成员函数名</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Area</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> length;</span><br><span class="line"><span class="keyword">double</span> width;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> object_count;       <span class="comment">//静态成员数据</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">get_count</span><span class="params">()</span>        <span class="comment">//静态成员函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> object_count;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="built_in">Area</span>(<span class="keyword">double</span> x,<span class="keyword">double</span> y)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Constructor&quot;</span>&lt;&lt;endl;</span><br><span class="line">length = x;</span><br><span class="line">width = y;</span><br><span class="line">object_count++;<span class="comment">//每次创建对象时加一</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Print_Area</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> length*width;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Area::object_count=<span class="number">0</span>;<span class="comment">//初始化类Area的静态成员</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;number of objects:&quot;</span>&lt;&lt;Area::<span class="built_in">get_count</span>()&lt;&lt;endl;</span><br><span class="line"><span class="function">Area <span class="title">number_1</span><span class="params">(<span class="number">3</span>,<span class="number">4</span>)</span></span>;</span><br><span class="line"><span class="function">Area <span class="title">number_2</span><span class="params">(<span class="number">5</span>,<span class="number">6</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;<span class="string">&quot;after creat object ,number of objects:&quot;</span>&lt;&lt;Area::<span class="built_in">get_count</span>()&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++入坑记(3)</title>
      <link href="2018/10/04/C++-%E5%85%A5%E5%9D%91%E8%AE%B0-3/"/>
      <url>2018/10/04/C++-%E5%85%A5%E5%9D%91%E8%AE%B0-3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="变量初始化问题"><a href="#变量初始化问题" class="headerlink" title="变量初始化问题"></a>变量初始化问题</h1><p>当局部变量被定义时，系统不会自动对其初始化；<br>当全局变量被定义时，系统会初始化为下列值:</p><table><thead><tr><th align="center">数据类型</th><th align="left">初始化默认值</th></tr></thead><tbody><tr><td align="center">int</td><td align="left">0</td></tr><tr><td align="center">float</td><td align="left">0</td></tr><tr><td align="center">double</td><td align="left">0</td></tr><tr><td align="center">char</td><td align="left">‘\0’</td></tr><tr><td align="center">pointer</td><td align="left">NULL</td></tr></tbody></table><span id="more"></span><h1 id="C-储存类"><a href="#C-储存类" class="headerlink" title="C++储存类"></a>C++储存类</h1><ul><li>auto</li><li>static</li><li>extern</li><li>register</li><li>mutable</li><li>thread_local</li></ul><h3 id="static储存类"><a href="#static储存类" class="headerlink" title="static储存类"></a>static储存类</h3><blockquote><p>用于指示编译器在程序的生命周期内保持局部变量的存在，而不需要每次在它进入和离开作用域时进行创建和销毁。</p></blockquote><ol><li>static修饰局部变量，可以在函数调用之间保持局部变量的值</li><li>static修饰全局变量，会使变量的作用域限制在生明它的文件内<br><a href="http://www.runoob.com/cplusplus/cpp-storage-classes.html">参考</a></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> count=<span class="number">10</span>;  <span class="comment">//全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> i=<span class="number">5</span>;  <span class="comment">//局部静态变量</span></span><br><span class="line">i++;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;变量i为:&quot;</span>&lt;&lt;i;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;,变量count为:&quot;</span>&lt;&lt;count&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(count--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/kKvsKof.png" class="lazyload" data-srcset="https://i.imgur.com/kKvsKof.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h3 id="extern储存类"><a href="#extern储存类" class="headerlink" title="extern储存类"></a>extern储存类</h3><blockquote><p>用于提供一个全局变量的引用，全局变量对所有的程序文件都是可见的。使用extern时，对于无法初始化的变量，会把变量名指向一个之前已经定义过的存储位置。<br>当有多个文件且定义了一个就可在其他文件中使用的全局变量或函数时，可以在其他文件中使用extern来得到已定义的变量或函数的引用。</p></blockquote><h1 id="C-引用"><a href="#C-引用" class="headerlink" title="C++引用"></a>C++引用</h1><blockquote><p>引用变量是一个别名。它是某个已存在的变量的另一个名字。一旦把引用初始化为某个变量，就可以使用该引用名称或变量名称来指向变量</p></blockquote><h3 id="引用与指针的差别"><a href="#引用与指针的差别" class="headerlink" title="引用与指针的差别"></a>引用与指针的差别</h3><ul><li>不存在空引用，引用必须连接到一块合法的内存。</li><li>一旦引用被初始化为一个对象，就不能被指向到另一个对象。指针可以在任何时候指向到另一个对象。</li><li>引用必须在创建时被初始化。指针可以在任何时间被初始化。</li></ul><p>引用可以当成变量附属在内存的第二个标签</p><pre><code>int i;//为i声明一个引用变量int&amp; r=i;</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">double</span> d;</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明引用变量</span></span><br><span class="line"><span class="keyword">int</span>&amp; r=i;</span><br><span class="line"><span class="keyword">double</span>&amp; s=d;</span><br><span class="line"></span><br><span class="line">i=<span class="number">3</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Value of i：&quot;</span>&lt;&lt;i&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Value of i reference:：&quot;</span>&lt;&lt;r&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">d=<span class="number">5.20</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;d= &quot;</span>&lt;&lt;d&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Value of d reference：&quot;</span>&lt;&lt;s&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/leM5bJC.png" class="lazyload" data-srcset="https://i.imgur.com/leM5bJC.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="用引用做函数形参"><a href="#用引用做函数形参" class="headerlink" title="用引用做函数形参"></a>用引用做函数形参</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>&amp; x,<span class="keyword">int</span>&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line">temp = x;</span><br><span class="line">x = y;</span><br><span class="line">y = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;<span class="string">&quot;b=&quot;</span>&lt;&lt;b&lt;&lt;endl;</span><br><span class="line"><span class="built_in">swap</span>(a,b);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;after exchange:&quot;</span>&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;<span class="string">&quot; b=&quot;</span>&lt;&lt;b&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/zNTinnC.png" class="lazyload" data-srcset="https://i.imgur.com/zNTinnC.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="引用做返回值"><a href="#引用做返回值" class="headerlink" title="引用做返回值"></a>引用做返回值</h2><p>当函数返回一个引用时，则返回一个指向返回值的隐式指针。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vals[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>&amp; <span class="title">setValues</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> vals[i];<span class="comment">//返回第i个元素的引用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;before change:&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;vals[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setValues</span>(<span class="number">1</span>)=<span class="number">520</span>;   <span class="comment">//change the second value</span></span><br><span class="line"><span class="built_in">setValues</span>(<span class="number">3</span>)=<span class="number">1314</span>;  <span class="comment">//change the forth value</span></span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl&lt;&lt;<span class="string">&quot;after change:&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;vals[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/dytdmF0.png" class="lazyload" data-srcset="https://i.imgur.com/dytdmF0.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工具小整合</title>
      <link href="2018/10/03/%E5%B7%A5%E5%85%B7%E5%B0%8F%E6%95%B4%E5%90%88/"/>
      <url>2018/10/03/%E5%B7%A5%E5%85%B7%E5%B0%8F%E6%95%B4%E5%90%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="https://i.imgur.com/HTg1isz.jpg" class="lazyload" data-srcset="https://i.imgur.com/HTg1isz.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><p>百度文库、知网文章下载<br><a href="https://pan.baidu.com/s/1-BY2B4hBn_3wHgYlXkFLCg">https://pan.baidu.com/s/1-BY2B4hBn_3wHgYlXkFLCg</a></p><p>百度云下载提速软件<br><a href="https://pan.baidu.com/s/1EYy5AN9JVv7m42f6NNmvlA" title="https://pan.baidu.com/s/1EYy5AN9JVv7m42f6NNmvlA">https://pan.baidu.com/s/1EYy5AN9JVv7m42f6NNmvlA</a></p><p>微软PE工具箱<br><a href="https://pan.baidu.com/s/1J1Nud9qTU6jSP6cTpk8Zlg">https://pan.baidu.com/s/1J1Nud9qTU6jSP6cTpk8Zlg</a></p><p>window10数字权利激活工具</p><p>github:</p><ol><li><a href="https://github.com/TGSAN/CMWTAT_Digital_Edition/releases">https://github.com/TGSAN/CMWTAT_Digital_Edition/releases</a></li><li><a href="https://github.com/vyvojar/slshim/releases">https://github.com/vyvojar/slshim/releases</a></li></ol><p><a href="https://www.spturate.xyz/2018/10/03/1/">激活方法参考</a><br><a href="https://pan.baidu.com/s/1_VqJiuBeCHLyRp5Xcc562w">https://pan.baidu.com/s/1_VqJiuBeCHLyRp5Xcc562w</a><br><a href="https://pan.baidu.com/s/1iNGBlhhef20PtMGdUNsaWA">kms激活工具</a><br><a href="https://msdn.itellyou.cn/">win10下载</a></p><p>Gif制作工具<br><a href="https://pan.baidu.com/s/1Eu_O-7EPSB81cwmR-R1zvw">https://pan.baidu.com/s/1Eu_O-7EPSB81cwmR-R1zvw</a><br>提取码:q51n</p><p>录屏软件<br><a href="https://pan.baidu.com/s/1VsN5XClhZiRCqUyxbTJ_tg">https://pan.baidu.com/s/1VsN5XClhZiRCqUyxbTJ_tg</a><br>提取码:vlrb</p><p><a href="https://pan.baidu.com/s/1qRiQdT-NvKgLVtEzJHPbLA">CamStudio汉化版</a><br>提取码:kckg</p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++入坑记(2)</title>
      <link href="2018/10/03/C++-%E5%85%A5%E5%9D%91%E8%AE%B0-2/"/>
      <url>2018/10/03/C++-%E5%85%A5%E5%9D%91%E8%AE%B0-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="函数，默认参数的使用"><a href="#函数，默认参数的使用" class="headerlink" title="函数，默认参数的使用"></a>函数，默认参数的使用</h1><p>在C++中，允许在自定义函数的形参列表中，给形参一个默认的值，这样在调用的时候如果有实参，那么按照实参传递给形参的方法使用；若调用的时候没有指定对应的实参，则形参将使用默认值。<br>由于参数的传递顺序是从右至左入栈，所以有默认值的参数必须在放在形参列表的最右边！</p><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> a=<span class="number">4</span>,<span class="keyword">int</span> b=<span class="number">5</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in">Sum</span>(<span class="number">5</span>,<span class="number">7</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">Sum</span>()&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">Sum</span>(<span class="number">9</span>)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/vz6wOh3.png" class="lazyload" data-srcset="https://i.imgur.com/vz6wOh3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h1><p>函数重载即两个或以上的函数，函数名相同，但形参类型或个数不同，编译器根据调用方传入的参数的类型和个数，自动选择最适合的一个函数来进行绑定调用，自动实现选择。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sum</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sum</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">double</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">1</span>,<span class="number">2</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">1.414</span>,<span class="number">2.526</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">3.14</span>,<span class="number">6</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">8</span>,<span class="number">9.9</span>)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/xP82hjI.png" class="lazyload" data-srcset="https://i.imgur.com/xP82hjI.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h1 id="函数模板（template）"><a href="#函数模板（template）" class="headerlink" title="函数模板（template）"></a>函数模板（template）</h1><p>模板是创建泛型类或函数的蓝图或公式。是泛型编程的基础。<br>函数模板，是可以创建一个通用的函数，可以支持多种形参。用关键字<code>template</code>来定义<br><strong>模板函数定义的一般形式</strong></p><pre><code>template&lt;class 类型名1,class 类型名2&gt;返回值 函数名(形参列表)&#123;    函数体&#125;</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T1,class T2&gt;</span></span><br><span class="line"><span class="function">T1 <span class="title">sum</span><span class="params">(T1 a,T2 b)</span></span></span><br><span class="line"><span class="function"><span class="comment">//模板函数中的T1和T2类型将根据实际传入的类型变成具体类型。这个化成就叫做模板的实例化。</span></span></span><br><span class="line"><span class="function"><span class="comment">//T1、T2是函数所使用的数据类型的占位符名称。这个名称可以在函数定义中使用。</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in"><span class="keyword">sizeof</span></span>(T1)&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;<span class="built_in"><span class="keyword">sizeof</span></span>(T2)&lt;&lt;<span class="string">&quot;\t&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">1</span>,<span class="number">2</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="number">3.14</span>,<span class="number">1.414</span>)&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="built_in">sum</span>(<span class="string">&#x27;A&#x27;</span>,<span class="number">2</span>)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/qmwhban.png" class="lazyload" data-srcset="https://i.imgur.com/qmwhban.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="运行结果"></p><h2 id="inline内联函数"><a href="#inline内联函数" class="headerlink" title="inline内联函数"></a>inline内联函数</h2><ul><li>内联函数的基本思想在于将每个函数调用都以它的代码体来替换</li><li>内联函数减少了不必要的函数<a href="https://baike.baidu.com/item/%E6%A0%88%E5%B8%A7/5662951?fr=aladdin">栈帧</a>的开销,节约内存</li><li>内联函数以空间换取了时间，但是inline对编译器只是一个建议，如果定义的函数体内有循环或递归等，编译器优化时会自动忽略掉内联</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a&gt;b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">Max</span>(<span class="number">3</span>,<span class="number">5</span>)&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">Max</span>(<span class="number">7</span>,<span class="number">9</span>)&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em><strong>内联函数的定义要在调用之前出现</strong></em></p><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACM入门（占个位）</title>
      <link href="2018/10/02/ACM%E5%85%A5%E9%97%A8/"/>
      <url>2018/10/02/ACM%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="A-B-for-Input-Output-Practice-using-C"><a href="#A-B-for-Input-Output-Practice-using-C" class="headerlink" title="A+B for Input-Output Practice(using C++)"></a>A+B for Input-Output Practice(using C++)</h1><h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to Calculate a + b. Too easy?! Of course! I specially designed the problem for acm beginners. You must have found that some problems have the same titles with this one, yes, all these problems were designed for the same aim</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">The input will consist of a series of pairs of integers a and b, separated by a space, one pair of integers per line.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each pair of input integers a and b you should output the sum of a and b in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">1 6<br>1 20</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">7<br>21</td></tr></tbody></table><span id="more"></span><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;x&gt;&gt;y)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;x+y&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">The first line integer means the number of input integer a and b. Your task is to Calculate a + b.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Your task is to Calculate a + b. The first line integer means the numbers of pairs of input integers.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each pair of input integers a and b you should output the sum of a and b in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">2<br>10 20<br>22 36</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">30<br>58</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,i;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">cout&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to Calculate a + b.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Input contains multiple test cases. Each test case contains a pair of integers a and b, one pair of integers per line. A test case containing 0 0 terminates the input and this test case is not to be processed.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each pair of input integers a and b you should output the sum of a and b in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">1 5<br>10 20<br>0 0</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">6<br>30</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;a&gt;&gt;b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a==<span class="number">0</span>&amp;&amp;b==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    cout&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to Calculate the sum of some integers.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Input contains multiple test cases. Each test case contains a integer N, and then N integers follow in the same line. A test case starting with 0 terminates the input and this test case is not to be processed.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each group of input integers you should output their sum in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">4 1 2 3 4<br>5 1 2 3 4 5<br>0</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">10<br>15</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(n==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> x,sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">sum+=x;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to calculate the sum of some integers.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Input contains an integer N in the first line, and then N lines follow. Each line starts with a integer M, and then M integers follow in the same line.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each group of input integers you should output their sum in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">2<br>4 1 2 3 4<br>5 1 2 3 4 5</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">10<br>15</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">int</span> n,x;</span><br><span class="line">cin&gt;&gt;N;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> x,sum=<span class="number">0</span>;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">sum += x;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to calculate the sum of some integers.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Input contains multiple test cases, and one case one line. Each case starts with an integer N, and then N integers follow in the same line.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each test case you should output the sum of N integers in one line, and with one line of output for each line in input.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">4 1 2 3 4 5<br>5 1 2 3 4 5</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">10<br>15</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> x,sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">sum +=x;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">sum=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7"><a href="#7" class="headerlink" title="7."></a>7.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to Calculate a + b.</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">The input will consist of a series of pairs of integers a and b, separated by a space, one pair of integers per line.</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each pair of input integers a and b you should output the sum of a and b, and followed by a blank line.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">1 5<br>10 20</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">6<br><br>30</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;x&gt;&gt;y)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;x+y&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8"><a href="#8" class="headerlink" title="8."></a>8.</h2><table><thead><tr><th align="left">Problem Description</th></tr></thead><tbody><tr><td align="left">Your task is to calculate the sum of some integers</td></tr><tr><td align="left">Input</td></tr><tr><td align="left">Input contains an integer N in the first line, and then N lines follow. Each line starts with a integer M, and then M integers follow in the same line</td></tr><tr><td align="left">Output</td></tr><tr><td align="left">For each group of input integers you should output their sum in one line, and you must note that there is a blank line between outputs.</td></tr><tr><td align="left">Sample Input</td></tr><tr><td align="left">3<br>4 1 2 3 4<br>5 1 2 3 4 5<br>6 1 2 3 4 5 6</td></tr><tr><td align="left">Sample Output</td></tr><tr><td align="left">10<br><br>15<br><br>21</td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">int</span> n,x;</span><br><span class="line"><span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">cin&gt;&gt;N;</span><br><span class="line"><span class="keyword">while</span>(N--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">sum +=x;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">sum=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++入坑记</title>
      <link href="2018/10/02/C++-%E5%85%A5%E5%9D%91%E8%AE%B0/"/>
      <url>2018/10/02/C++-%E5%85%A5%E5%9D%91%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="C-关键字"><a href="#C-关键字" class="headerlink" title="C++关键字"></a>C++关键字</h1><p><a href="https://www.runoob.com/w3cnote/cpp-keyword-intro.html">https://www.runoob.com/w3cnote/cpp-keyword-intro.html</a></p><table><thead><tr><th align="center">asm</th><th align="center">else</th><th align="center">new</th><th align="center">this</th></tr></thead><tbody><tr><td align="center">auto</td><td align="center">enum</td><td align="center">operator</td><td align="center">throw</td></tr><tr><td align="center">bool</td><td align="center">explicit</td><td align="center">private</td><td align="center">true</td></tr><tr><td align="center">break</td><td align="center">export</td><td align="center">protected</td><td align="center">try</td></tr><tr><td align="center">case</td><td align="center">extern</td><td align="center">public</td><td align="center">typedef</td></tr><tr><td align="center">catch</td><td align="center">false</td><td align="center">register</td><td align="center">typeid</td></tr><tr><td align="center">char</td><td align="center">for</td><td align="center">return</td><td align="center">union</td></tr><tr><td align="center">const</td><td align="center">friend</td><td align="center">short</td><td align="center">unsigned</td></tr><tr><td align="center">const_cast</td><td align="center">goto</td><td align="center">signed</td><td align="center">using</td></tr><tr><td align="center">continue</td><td align="center">if</td><td align="center">sizeof</td><td align="center">virtual</td></tr><tr><td align="center">default</td><td align="center">inline</td><td align="center">static</td><td align="center">void</td></tr><tr><td align="center">delete</td><td align="center">int</td><td align="center">static_cast</td><td align="center">volatile</td></tr><tr><td align="center">do</td><td align="center">long</td><td align="center">struct</td><td align="center">wchar_t</td></tr><tr><td align="center">double</td><td align="center">mutable</td><td align="center">switch</td><td align="center">while</td></tr><tr><td align="center">dynamic_cast</td><td align="center">namespace</td><td align="center">template</td><td align="center">…</td></tr></tbody></table><span id="more"></span><h1 id="入坑C"><a href="#入坑C" class="headerlink" title="入坑C++"></a>入坑C++</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span>         <span class="comment">//文件包含，包含iostream标准库</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;       <span class="comment">//声明一个叫std的命名空间</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">string my_name;</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line">cin&gt;&gt;my_name&gt;&gt;age;</span><br><span class="line">cout&lt;&lt;my_name&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;age;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;\nHello C++ !&quot;</span>&lt;&lt;endl&lt;&lt;<span class="string">&quot;Nice&quot;</span>&lt;&lt;<span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Nice to meet you !&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>流提取运算符<code>&gt;&gt;</code><br>流插入运算符<code>&lt;&lt;</code></p><h2 id="什么是命名空间"><a href="#什么是命名空间" class="headerlink" title="什么是命名空间"></a>什么是命名空间</h2><blockquote><p>命名空间(namespace)为防止名字冲突提供了更加可控的机制。</p></blockquote><blockquote><p>一个命名空间的定义包含两部分：首先是关键字namespace，随后是命名空间的名字。在命名空间名字后面是一系列由花括号括起来的声明和定义。只要能出现在全局作用域中的声明就能置于命名空间内，主要包括：类、变量(及其初始化操作)、函数(及其定义)、模板和其它命名空间。命名空间结束后无须分号，这一点与块类似。和其它名字一样，命名空间的名字也必须在定义它的作用域内保持唯一。命名空间既可以定义在全局作用域内，也可以定义在其它命名空间中，但是不能定义在函数或类的内部。命名空间作用域后面无须分号。</p></blockquote><p><a href="https://blog.csdn.net/fengbingchun/article/details/78575978?utm_source=copy">https://blog.csdn.net/fengbingchun/article/details/78575978?utm_source=copy</a><br>只是新标准中使用不带.h的头文件包含时，必须要声明命名空间，并且包含头文件在前，声明使用的名字空间在后。</p><p>例如标准C++库提供的对象都存在std这个标准名字中，比如cin，cout，endl。</p><h3 id="写法–1"><a href="#写法–1" class="headerlink" title="写法–1"></a>写法–1</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line">cin&gt;&gt;a;</span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Hello World!&quot;</span>&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="写法–2"><a href="#写法–2" class="headerlink" title="写法–2"></a>写法–2</h3><p>使用域限定符<code>::</code>来逐个制定,cout和endl前面分别用std::指明，表示来自std</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">std::cin&gt;&gt;a;</span><br><span class="line">std::cout&lt;&lt;a&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line">std::cout&lt;&lt;<span class="string">&quot;Hello World!&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="写法–3"><a href="#写法–3" class="headerlink" title="写法–3"></a>写法–3</h3><p>用using和域限定符一起制定用哪些名字</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line">cin&gt;&gt;a;</span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Hello World!&quot;</span>&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;**************************\n&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在用cin和cout输入和输出数据时，不需要手动控制数据类型就可以使用</p><p><img src="https://i.loli.net/2020/04/01/Ij7rbfRXvmPhQT3.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/01/Ij7rbfRXvmPhQT3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="哆啦A梦"></p><hr><p>更新于2018/10/4 23:15:56</p><hr><p><strong>I/O库头文件</strong></p><p><code>&lt;iostream&gt;、&lt;iomanip&gt;、&lt;fstream&gt;</code></p><table><thead><tr><th align="center">头文件</th><th align="center">函数和描述</th></tr></thead><tbody><tr><td align="center">iostream</td><td align="center">该文件定义了cin、cout、cerr和clog对象，分别对应于标准输入流、标准输出流、非缓冲标准错误和缓冲标准错误流</td></tr><tr><td align="center">iomanip</td><td align="center">该文件通过所谓的参数化的流操纵器（比如setw和setprecision），来声明对执行标准化I/O有用的服务</td></tr><tr><td align="center">fstream</td><td align="center">该文件为用户控制的文件处理声明服务</td></tr></tbody></table><hr>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Requests库入门(2)</title>
      <link href="2018/10/01/Requests%E5%BA%93%E5%85%A5%E9%97%A8-2/"/>
      <url>2018/10/01/Requests%E5%BA%93%E5%85%A5%E9%97%A8-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="requests库入门实操"><a href="#requests库入门实操" class="headerlink" title="requests库入门实操"></a>requests库入门实操</h1><ul><li>京东商品页面爬取</li><li>亚马逊商品页面的爬取</li><li>百度/360搜索关键字提交</li><li>IP地址归属地查询</li><li>网络图片的爬取和储存</li></ul><span id="more"></span><h2 id="1-京东商品页面的爬取"><a href="#1-京东商品页面的爬取" class="headerlink" title="1.京东商品页面的爬取"></a>1.京东商品页面的爬取</h2><p><a href="https://item.jd.com/30185690434.html">华为nova3</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text[:<span class="number">1000</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;爬取失败&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;https://item.jd.com/30185690434.html&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(GetHTMLText(url))</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/01/jEGhayRogB56b37.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/01/jEGhayRogB56b37.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="输出"></p><h2 id="2-亚马孙商品页面的爬取"><a href="#2-亚马孙商品页面的爬取" class="headerlink" title="2.亚马孙商品页面的爬取"></a>2.亚马孙商品页面的爬取</h2><p>某些网站可能有反爬机制。通常的反爬策略有:</p><ol><li>通过Headers反爬虫</li><li>基于用户行为反爬虫</li><li>动态页面的反爬虫</li></ol><p><a href="https://www.cnblogs.com/sishuinianhua/p/5501883.html">参考</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如网站对Headers的User-Agent进行检测，可定制请求头伪装成浏览器</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#定制请求头</span></span><br><span class="line">        headers = &#123;<span class="string">&quot;user-agent&quot;</span>:<span class="string">&quot;Mozilla/5.0&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">        r = requests.get(url,headers = headers)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text[:<span class="number">1000</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;爬取失败&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;https://www.amazon.cn/gp/product/B01M8L5Z3Y&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(GetHTMLText(url))</span><br></pre></td></tr></table></figure><h2 id="3-百度-360搜索关键字提交"><a href="#3-百度-360搜索关键字提交" class="headerlink" title="3.百度/360搜索关键字提交"></a>3.百度/360搜索关键字提交</h2><p>使用params参数,利用接口keyword</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#百度搜索引擎关键词提交接口: http://www.baidu.com/s?wd=keyword</span></span><br><span class="line"><span class="comment">#360搜索引擎关键词提交接口: http://www.so.com/s?q=keyword</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Get</span>(<span class="params">url</span>):</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;user-agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0&#x27;</span>&#125;</span><br><span class="line">    key_word = &#123;<span class="string">&#x27;wd&#x27;</span>:<span class="string">&#x27;python&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r=requests.get(url,headers=headers,params=key_word)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="built_in">print</span>(r.request.url)</span><br><span class="line">        <span class="comment">#return r.request.url</span></span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;爬取失败&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;http://www.baidu.com/s&quot;</span></span><br><span class="line">    <span class="comment">#print(Get(url))</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(Get(url)))</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/01/HqX9RTdiLbB6Uok.png" class="lazyload" data-srcset="https://i.loli.net/2020/04/01/HqX9RTdiLbB6Uok.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="输出"></p><h2 id="4-IP地址归属地查询"><a href="#4-IP地址归属地查询" class="headerlink" title="4.IP地址归属地查询"></a>4.IP地址归属地查询</h2><p>使用IP138的API接口<br><a href="http://m.ip138.com/ip.asp?ip=ipaddress">http://m.ip138.com/ip.asp?ip=ipaddress</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ip地址查询</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url =<span class="string">&quot;http://m.ip138.com/ip.asp?ip=&quot;</span></span><br><span class="line">ip = <span class="built_in">str</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r= requests.get(url+ip)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    <span class="built_in">print</span>(r.status_code)</span><br><span class="line">    <span class="comment">#r.encoding = r.apparent_encoding</span></span><br><span class="line">    <span class="built_in">print</span>(r.text[-<span class="number">500</span>:])</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;failed&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="http://pflr7ix8q.bkt.clouddn.com/GIF.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/GIF.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></p><h2 id="5-网络图片的爬取和储存"><a href="#5-网络图片的爬取和储存" class="headerlink" title="5.网络图片的爬取和储存"></a>5.网络图片的爬取和储存</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spider_for_imgs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://n.sinaimg.cn/sinacn12/w495h787/20180315/1923-fyscsmv9949374.jpg&quot;</span></span><br><span class="line"><span class="comment">#C:\Users\Administrator\Desktop\spider\first week\imgs/</span></span><br><span class="line">root = <span class="string">&quot;C://Users/Administrator/Desktop/spider/first week/imgs/&quot;</span></span><br><span class="line"></span><br><span class="line">path = root + url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(root):</span><br><span class="line">        os.mkdir(root)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(r.content)</span><br><span class="line">            f.close()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;save successfully!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;file already exist!&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;spider fail&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="http://pflr7ix8q.bkt.clouddn.com/122.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/122.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></p><p><img src="http://pflr7ix8q.bkt.clouddn.com/1923-fyscsmv9949374.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/1923-fyscsmv9949374.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo1"></p><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Requests </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优雅的Markdown（2）</title>
      <link href="2018/09/30/%E4%BC%98%E9%9B%85%E7%9A%84Markdown%EF%BC%882%EF%BC%89/"/>
      <url>2018/09/30/%E4%BC%98%E9%9B%85%E7%9A%84Markdown%EF%BC%882%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="Markdown编辑器使用-MarkdownPad2"><a href="#Markdown编辑器使用-MarkdownPad2" class="headerlink" title="Markdown编辑器使用-MarkdownPad2"></a>Markdown编辑器使用-MarkdownPad2</h1><blockquote><p>imgur已被GFW干掉</p></blockquote><h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">粗体</td><td align="center">ctrl+B</td></tr><tr><td align="center">斜体</td><td align="center">ctrl+I</td></tr><tr><td align="center">引用</td><td align="center">ctrl+Q</td></tr><tr><td align="center">代码</td><td align="center">ctrl+K</td></tr><tr><td align="center">超链接</td><td align="center">ctrl+L</td></tr><tr><td align="center">图片</td><td align="center">ctrl+G</td></tr><tr><td align="center">无序列表</td><td align="center">ctrl+U</td></tr><tr><td align="center">有序列表</td><td align="center">ctrl+shift+O</td></tr><tr><td align="center">水平标尺</td><td align="center">ctrl+R</td></tr><tr><td align="center">时间戳</td><td align="center">ctrl+T</td></tr><tr><td align="center">撤销</td><td align="center">ctrl+Z</td></tr><tr><td align="center">重做</td><td align="center">ctrl+Y</td></tr></tbody></table><span id="more"></span><h2 id="插入图片时间可使用MarkdownPad2默认的图床"><a href="#插入图片时间可使用MarkdownPad2默认的图床" class="headerlink" title="插入图片时间可使用MarkdownPad2默认的图床"></a>插入图片时间可使用MarkdownPad2默认的图床</h2><p><img src="http://pflr7ix8q.bkt.clouddn.com/qIWhafe.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/qIWhafe.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="demo"></p><p>MarkdownPad2使用的默认图床是<a href="https://imgur.com/">imgur</a></p><p><img src="http://pflr7ix8q.bkt.clouddn.com/tSexzok.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/tSexzok.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="图片演示"></p><h2 id="插入视频演示"><a href="#插入视频演示" class="headerlink" title="插入视频演示"></a>插入视频演示</h2><p><a href="https://imgur.com/Uuabq5B">戳这里</a></p><p><img src="http://pflr7ix8q.bkt.clouddn.com/wocao.gif" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/wocao.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="gif演示"></p>]]></content>
      
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单爬虫</title>
      <link href="2018/09/29/%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB/"/>
      <url>2018/09/29/%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="Requests库入门"><a href="#Requests库入门" class="headerlink" title="Requests库入门"></a>Requests库入门</h1><blockquote><ul><li><a href="http://www.python-requests.org/en/master/">http://www.python-requests.org/en/master/</a></li><li><a href="http://www.python-requests.org/en/master/">requests</a></li></ul></blockquote><h2 id="Requests库的7个主要方法"><a href="#Requests库的7个主要方法" class="headerlink" title="Requests库的7个主要方法"></a>Requests库的7个主要方法</h2><table><thead><tr><th align="center">方法</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">requests.request()</td><td align="center">构造一个请求，支撑以下各方法的基本方法</td></tr><tr><td align="center">requests.get()</td><td align="center">获取HTML网面的方法</td></tr><tr><td align="center">requests.head()</td><td align="center">获取HTML网页头部信息的方法</td></tr><tr><td align="center">requests.post()</td><td align="center">向HTML网页提交POST请求的方法</td></tr><tr><td align="center">requests.put()</td><td align="center">向HTML页面提交PUT请求的方法</td></tr><tr><td align="center">requests.patch()</td><td align="center">向HTML网页提交局部修改请求</td></tr><tr><td align="center">requests.delete()</td><td align="center">向HTML网页提交删除请求</td></tr></tbody></table><span id="more"></span><h2 id="Requests库的get-方法"><a href="#Requests库的get-方法" class="headerlink" title="Requests库的get()方法"></a>Requests库的get()方法</h2><p><code>requests.get(url,params=None,**kwargs)</code></p><ol><li>url：拟获取页面的url链接</li><li>params：url中的额外参数，字典或字节流格式，可选</li><li>**kwargs：12个控制访问的参数</li></ol><p> <code>r = requests.get(url)</code></p><ul><li>r为一个包含服务器资源的Response对象(即为requests.get()返回内容)</li><li>get()方法和url构造了一个向服务器请求资源的Request对象</li></ul><h3 id="Response对象"><a href="#Response对象" class="headerlink" title="Response对象"></a>Response对象</h3><p>Response对象包含服务器反回的所有信息，也包含请求的Request信息</p><h5 id="Response对象的属性"><a href="#Response对象的属性" class="headerlink" title="Response对象的属性"></a>Response对象的属性</h5><table><thead><tr><th align="center">属性</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">r.stats_code</td><td align="center">HTTP请求的返回状态，200表示连接成功</td></tr><tr><td align="center">r.txt</td><td align="center">HTTP响应的字符串形式</td></tr><tr><td align="center">r.encoding</td><td align="center">从HTTP header中猜测的响应方式的内容编码</td></tr><tr><td align="center">r.apparent_enconding</td><td align="center">从内容中分析出的响应内容编码方式（备选编码方式）</td></tr><tr><td align="center">r.content</td><td align="center">HTTP响应内容编码的二进制形式</td></tr></tbody></table><ol><li>r.encoding:如果charset不存在，则默认编码为ISO-8859-1，r.text根据r.encoding显示网页内容</li><li>r.apparent_encoding：根据网页内容分析出的编码方式</li></ol><p><font size="3" color="green">理解Response异常</font><br><code>r.raise_for_status()</code>如果不是200，产生异常requests.HTTPError异常</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.raise_for_status()在方法内部判断r.statu_code是否等于200，不需要增加额外的if语句，该语句便于try-except进行异常处理</span><br></pre></td></tr></table></figure><h3 id="Requests库的异常"><a href="#Requests库的异常" class="headerlink" title="Requests库的异常"></a>Requests库的异常</h3><table><thead><tr><th align="center">异常</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">requests.ConnectonError</td><td align="center">网路连接错误异常</td></tr><tr><td align="center">requests.HTTPError</td><td align="center">HTTP错误异常</td></tr><tr><td align="center">requests.URLRequire</td><td align="center">URL缺失异常</td></tr><tr><td align="center">requests.TooManyRedirects</td><td align="center">超过最大重定向次数，产生重定向异常</td></tr><tr><td align="center">requests.ConnectTimeout</td><td align="center">连接远程服务器异常</td></tr><tr><td align="center">requests.Timeout</td><td align="center">请求URL超时，产生超时异常</td></tr></tbody></table><h2 id="python爬取网页代码通用框架"><a href="#python爬取网页代码通用框架" class="headerlink" title="python爬取网页代码通用框架"></a>python爬取网页代码通用框架</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url,timeout = <span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()<span class="comment">#如果状态不是200，产生HTTPError异常</span></span><br><span class="line">        <span class="comment">#print(r.status_code)</span></span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;产生异常&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(getHTMLText(url))</span><br></pre></td></tr></table></figure><h2 id="Requests库的request-方法"><a href="#Requests库的request-方法" class="headerlink" title="Requests库的request()方法"></a>Requests库的request()方法</h2><pre><code>requests.request(method, url, **kwargs)</code></pre><ul><li>method: 请求方式，对应get/put/delete等7种</li><li>url:拟获取页面的url链接</li><li>**kwargs: 控制访问的参数</li></ul><h3 id="kwargs-控制访问参数，（可选）"><a href="#kwargs-控制访问参数，（可选）" class="headerlink" title="kwargs:控制访问参数，（可选）"></a>kwargs:控制访问参数，（可选）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">params：字典或字节序列，作为参数增加到URL中</span><br><span class="line">data：字典、字节序列或文章对象，作为Request的内容</span><br><span class="line">json：Json格式的数据</span><br><span class="line">headers：HTTP定制头</span><br><span class="line">cookies：字典或CookieJar，Request中的cookie</span><br><span class="line">auth：元组，支持HTTP认证功能</span><br><span class="line">file：字典类型，传输文件</span><br><span class="line">timeout：设置超时时间，单位为秒</span><br><span class="line">proxies：字典类型，设定访问代理服务器，可以增加登录认证</span><br><span class="line">allow_redirects：True/False，默认为True，重定向开关</span><br><span class="line">strem：True/False，默认为True，获取页面立即下载开关</span><br><span class="line">verify：True/False，默认为True,认证SSl证书开关</span><br><span class="line">cert：本地SSL证书</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Requests </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网易云音乐外链插入测试</title>
      <link href="2018/09/28/music/"/>
      <url>2018/09/28/music/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="网易云音乐"><a href="#网易云音乐" class="headerlink" title="网易云音乐"></a>网易云音乐</h1><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=2788529&auto=0&height=66"></iframe><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=100% height=86 src="//music.163.com/outchain/player?type=2&id=4341314&auto=1&height=66"></iframe><span id="more"></span>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优雅的Markdown</title>
      <link href="2018/09/28/%E4%BC%98%E9%9B%85%E7%9A%84Markdown/"/>
      <url>2018/09/28/%E4%BC%98%E9%9B%85%E7%9A%84Markdown/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="Markdown浅尝"><a href="#Markdown浅尝" class="headerlink" title="Markdown浅尝"></a>Markdown浅尝</h1><h2 id="一、勾选框"><a href="#一、勾选框" class="headerlink" title="一、勾选框"></a>一、勾选框</h2><p><strong>注意[]前后都要有空格</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- [x] 干的漂亮</span><br><span class="line">- [x] 吃饭</span><br><span class="line">- [x] 写代码</span><br><span class="line">- [ ] 睡觉</span><br></pre></td></tr></table></figure><ul><li><input checked="" disabled="" type="checkbox"> 干的漂亮</li><li><input checked="" disabled="" type="checkbox"> 吃饭</li><li><input checked="" disabled="" type="checkbox"> 写代码</li><li><input disabled="" type="checkbox"> 睡觉<span id="more"></span></li></ul><h2 id="二、列表"><a href="#二、列表" class="headerlink" title="二、列表"></a>二、列表</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#无序列列表 * 换成 - 也行</span><br><span class="line">* 你</span><br><span class="line">* 你好</span><br><span class="line">* 你好呀</span><br><span class="line">- 你很好啊</span><br></pre></td></tr></table></figure><ul><li>你</li><li>你好</li><li>你好呀</li></ul><ul><li>你很好啊</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#有序列表 . 后面有个空格</span><br><span class="line">1. 我</span><br><span class="line">2. 是我</span><br><span class="line">3. 是我呀</span><br><span class="line">4. 还是我呀</span><br></pre></td></tr></table></figure><ol><li>我</li><li>是我</li><li>是我呀</li><li>还是我呀</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#多级列表</span><br><span class="line">* 数学</span><br><span class="line">* 高等代数</span><br><span class="line">* 解析几何</span><br><span class="line">* 离散数学</span><br><span class="line">* 数学分析</span><br><span class="line">* 实变函数</span><br></pre></td></tr></table></figure><ul><li>数学<ul><li>高等代数</li><li>解析几何<ul><li>离散数学</li><li>数学分析<ul><li>实变函数</li></ul></li></ul></li></ul></li></ul><h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 姓名 | 性别 | 是否同性恋 |</span><br><span class="line">| ---- |---- | --------- |</span><br><span class="line">|张三|男|否|</span><br><span class="line">|李四|男|是|</span><br></pre></td></tr></table></figure><table><thead><tr><th>姓名</th><th>性别</th><th>是否同性恋</th></tr></thead><tbody><tr><td>张三</td><td>男</td><td>否</td></tr><tr><td>李四</td><td>男</td><td>是</td></tr></tbody></table><h3 id="可用-设置对齐方式"><a href="#可用-设置对齐方式" class="headerlink" title="可用:设置对齐方式"></a>可用<code>:</code>设置对齐方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 姓名 | 性别 | 是否同性恋 |</span><br><span class="line">| ---- |:----: | :---------:|</span><br><span class="line">|张三|男|否|</span><br><span class="line">|李四|男|是|</span><br></pre></td></tr></table></figure><table><thead><tr><th>姓名</th><th align="center">性别</th><th align="center">是否同性恋</th></tr></thead><tbody><tr><td>张三</td><td align="center">男</td><td align="center">否</td></tr><tr><td>李四</td><td align="center">男</td><td align="center">是</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 姓名 | 性别 | 是否同性恋 |</span><br><span class="line">| ---- |----: | :---------:|</span><br><span class="line">|张三|男|否|</span><br><span class="line">|李四|男|是|</span><br></pre></td></tr></table></figure><table><thead><tr><th>姓名</th><th align="right">性别</th><th align="center">是否同性恋</th></tr></thead><tbody><tr><td>张三</td><td align="right">男</td><td align="center">否</td></tr><tr><td>李四</td><td align="right">男</td><td align="center">是</td></tr></tbody></table><h2 id="插入代码"><a href="#插入代码" class="headerlink" title="插入代码"></a>插入代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#行内代码</span><br><span class="line">`printf(&quot;hello world!&quot;);`</span><br></pre></td></tr></table></figure><p><code>printf(&quot;hello world!&quot;);</code></p><p><strong>代码块</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#每行前四个空格或一个tab</span><br><span class="line">php:echo &quot;Hello World&quot;</span><br><span class="line">VBscript：Msgbox &quot;Hello World&quot;</span><br></pre></td></tr></table></figure><pre><code>php:echo &quot;Hello World&quot;VBscript：Msgbox &quot;Hello World&quot;</code></pre><p><del><em><strong>有行标代码块</strong></em></del><br><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-28/60378882.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-28/60378882.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><del><em><strong>无行标</strong></em></del><br><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-28/72647084.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-28/72647084.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p><u>bash换成python</u>使用语法高亮</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#下划线使用&lt;u&gt;</span><br><span class="line">&lt;u&gt;bash换成python&lt;/u&gt;</span><br><span class="line">#换行使用&lt;br/&gt;、&lt;br&gt;</span><br></pre></td></tr></table></figure><p>瞬间发现没什么区别</p><hr><h2 id="更新于2018-10-1-11-05-19"><a href="#更新于2018-10-1-11-05-19" class="headerlink" title="更新于2018/10/1 11:05:19"></a>更新于2018/10/1 11:05:19</h2><h2 id="上下标-使用-lt-sup-gt-、-lt-sub-gt"><a href="#上下标-使用-lt-sup-gt-、-lt-sub-gt" class="headerlink" title="上下标,使用&lt;sup&gt;、&lt;sub&gt;"></a>上下标,使用<code>&lt;sup&gt;、&lt;sub&gt;</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y=x&lt;sup&gt;2&lt;/sup&gt;</span><br><span class="line">H&lt;sub&gt;2&lt;/sub&gt;O&lt;sub&gt;2&lt;/sub&gt;</span><br></pre></td></tr></table></figure><p>y=x<sup>2</sup><br>H<sub>2</sub>O<sub>2</sub></p><h2 id="反斜杠的使用"><a href="#反斜杠的使用" class="headerlink" title="反斜杠的使用"></a>反斜杠的使用</h2><p>使用反斜杠可以避免文本中的符号被当作markdown标识符而发生不必要的转换</p><p>例如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\!</span><br><span class="line">\()</span><br><span class="line">\**不是粗体**</span><br><span class="line">\# 不是一级标题</span><br></pre></td></tr></table></figure><p>!<br>()<br>*<em>不是粗体</em>*<br># 不是一级标题</p><h2 id="使用缩进"><a href="#使用缩进" class="headerlink" title="使用缩进"></a>使用缩进</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">不断行的空白格  &amp;nbsp;  或  &amp;#160;</span><br><span class="line">半角的空格      &amp;ensp;  或  &amp;#8194;</span><br><span class="line">全角的空格      &amp;emsp;  或  &amp;#8195;</span><br><span class="line"></span><br><span class="line">示例:</span><br><span class="line">&amp;ensp; &amp;ensp今天天气好啊</span><br><span class="line">&amp;emsp;&amp;emsp;感觉倍爽啊</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;今天天气好啊<br>&emsp;&emsp;感觉倍爽啊</p><p><u><em><strong>不要忘了英文的分号</strong></em></u><br>参考自<a href="https://www.jianshu.com/p/8b41aa1fcf01">zhouie</a></p><hr>]]></content>
      
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建历程（4）</title>
      <link href="2018/09/27/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%884%EF%BC%89/"/>
      <url>2018/09/27/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%884%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="博客评论系统的选择"><a href="#博客评论系统的选择" class="headerlink" title="博客评论系统的选择"></a>博客评论系统的选择</h1><blockquote><p>怀念文：当时使用的主题是 yilla</p></blockquote><h4 id="其他评论系统参考"><a href="#其他评论系统参考" class="headerlink" title="其他评论系统参考"></a><a href="https://blog.csdn.net/weixin_41196185/article/details/79178780">其他评论系统参考</a></h4><p><font color="red">经过一波折腾，最终选择了Valine</font><br><font size="4" color="green">我喜欢它的匿名评论，23333！！！</font></p><h3 id="参考教程-作者的博客"><a href="#参考教程-作者的博客" class="headerlink" title="参考教程 作者的博客"></a>参考教程 <a href="https://ioliu.cn/2017/add-valine-comments-to-your-blog/">作者的博客</a></h3><p><a href="https://valine.js.org/">Valine文档</a></p><ul><li><a href="https://github.com/litten/hexo-theme-yilia/pull/646">https://github.com/litten/hexo-theme-yilia/pull/646</a></li><li><a href="https://www.xxwhite.com/2017/Valine.html">https://www.xxwhite.com/2017/Valine.html</a></li><li><a href="https://panjunwen.com/diy-a-comment-system/">https://panjunwen.com/diy-a-comment-system/</a></li></ul><span id="more"></span><h2 id="安装过程简记"><a href="#安装过程简记" class="headerlink" title="安装过程简记"></a>安装过程简记</h2><ul><li>注册<a href="https://leancloud.cn/">Leancloud</a></li><li>创建应用</li><li>获取appid和appkey</li><li>设置安全域名</li></ul><p><img src="https://i.imgur.com/z6ScJ8h.png" class="lazyload" data-srcset="https://i.imgur.com/z6ScJ8h.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/98lsq22.png" class="lazyload" data-srcset="https://i.imgur.com/98lsq22.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/Ppruek5.png" class="lazyload" data-srcset="https://i.imgur.com/Ppruek5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://i.imgur.com/sRNNe85.png" class="lazyload" data-srcset="https://i.imgur.com/sRNNe85.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h4 id="部署云引擎-参考"><a href="#部署云引擎-参考" class="headerlink" title="部署云引擎 参考"></a>部署云引擎 <a href="https://panjunwen.com/valine-admin-document/">参考</a></h4><p>设置好环境变量</p><h3 id="yilia主题修改"><a href="#yilia主题修改" class="headerlink" title="yilia主题修改"></a>yilia主题修改</h3><h4 id="1、修改themes-yilia-config-yml"><a href="#1、修改themes-yilia-config-yml" class="headerlink" title="1、修改themes\yilia\_config.yml"></a>1、修改<code>themes\yilia\_config.yml</code></h4><p><a href="https://github.com/litten/hexo-theme-yilia/pull/646">https://github.com/litten/hexo-theme-yilia/pull/646</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#6、Valine https://valine.js.org</span></span><br><span class="line">valine:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  appid:    <span class="comment">#LeanCloud的appId</span></span><br><span class="line">  appkey:   <span class="comment">#Leancloud的appKey</span></span><br><span class="line">  verify: <span class="literal">false</span> <span class="comment">#验证码</span></span><br><span class="line">  notifi: <span class="literal">false</span> <span class="comment">#评论回复提醒</span></span><br><span class="line">  avatar: <span class="string">&#x27; &#x27;</span><span class="comment">#评论列表头像样式</span></span><br><span class="line">  placeholder: Just go go <span class="comment">#评论占位框</span></span><br><span class="line">  pageSize: 15    <span class="comment">#评论分页</span></span><br></pre></td></tr></table></figure><h4 id="2、修改themes-yilia-layout-partial-article-ejs"><a href="#2、修改themes-yilia-layout-partial-article-ejs" class="headerlink" title="2、修改themes\yilia\layout\_partial\article.ejs"></a>2、修改<code>themes\yilia\layout\_partial\article.ejs</code></h4><p>我是在尾部位添加的<br><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-27/40764127.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-27/40764127.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.valine &amp;&amp; theme.valine.appid &amp;&amp; theme.valine.appkey)&#123; %&gt;</span><br><span class="line">    &lt;section id=<span class="string">&quot;comments&quot;</span> style=<span class="string">&quot;margin:10px;padding:10px;background:#fff;&quot;</span>&gt;</span><br><span class="line">      &lt;%- partial(<span class="string">&#x27;post/valine&#x27;</span>, &#123;</span><br><span class="line">        key: post.slug,</span><br><span class="line">        title: post.title,</span><br><span class="line">        url: config.url+url_for(post.path)</span><br><span class="line">        &#125;) %&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><h4 id="在themes-yilia-layout-partial-post下新建个·valine-ejs·文件"><a href="#在themes-yilia-layout-partial-post下新建个·valine-ejs·文件" class="headerlink" title="在themes\yilia\layout\_partial\post下新建个·valine.ejs·文件"></a>在<code>themes\yilia\layout\_partial\post</code>下新建个·valine.ejs·文件</h4><p>添加如下代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;vcomment&quot;</span> class=<span class="string">&quot;comment&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;//cdn1.lncld.net/static/js/3.0.4/av-min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;//unpkg.com/valine/dist/Valine.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">   var notify = <span class="string">&#x27;&lt;%= theme.valine.notify %&gt;&#x27;</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">   var verify = <span class="string">&#x27;&lt;%= theme.valine.verify %&gt;&#x27;</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">    window.onload = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">        new Valine(&#123;</span><br><span class="line">            el: <span class="string">&#x27;#vcomment&#x27;</span>,</span><br><span class="line">            notify: notify,</span><br><span class="line">            verify: verify,</span><br><span class="line">            app_id: <span class="string">&quot;&lt;%= theme.valine.appid %&gt;&quot;</span>,</span><br><span class="line">            app_key: <span class="string">&quot;&lt;%= theme.valine.appkey %&gt;&quot;</span>,</span><br><span class="line">            placeholder: <span class="string">&quot;&lt;%= theme.valine.placeholder %&gt;&quot;</span>,</span><br><span class="line">            avatar:<span class="string">&quot;&lt;%= theme.valine.avatar %&gt;&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="测试下效果"><a href="#测试下效果" class="headerlink" title="测试下效果"></a>测试下效果</h4><pre><code>hexo ghexo s</code></pre><p><a href="http://localhost:4000/">预览</a></p><p>没问题就部署到github吧<br>    hexo d -g</p><h1 id="定时器添加"><a href="#定时器添加" class="headerlink" title="定时器添加"></a>定时器添加</h1><p><a href="https://github.com/zhaojun1998/Valine-Admin/issues/1">https://github.com/zhaojun1998/Valine-Admin/issues/1</a></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown(2)</title>
      <link href="2018/09/26/Markdown-2/"/>
      <url>2018/09/26/Markdown-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><font size="5" color="green">兴奋于搭建了我的博客，兴奋于认识了markdown，终于可以甩开花里胡哨的word了，233333！！！</font></p><h1 id="认识Markdown"><a href="#认识Markdown" class="headerlink" title="认识Markdown"></a>认识Markdown</h1><blockquote><p>Markdown是一种可以使用普通文本编辑器编写的标记语言，通过简单的标记语法，它可以使普通文本内容具有一定的格式。</p><p>Markdown具有一系列衍生版本，用于扩展Markdown的功能（如表格、脚注、内嵌HTML等等），这些功能原初的Markdown尚不具备，它们能让Markdown转换成更多的格式，例LaTeX，Docbook。</p><p>Markdown增强版中比较有名的有Markdown Extra、MultiMarkdown、 Maruku等。这些衍生版本要么基于工具，如Pandoc；要么基于网站，如GitHub和Wikipedia，在语法上基本兼容，但在一些语法和渲染效果上有改动。<br> –引自<a href="https://baike.baidu.com/item/markdown/3245829?fr=aladdin">百度百科</a></p></blockquote><span id="more"></span><h1 id="Windows常用Markdown编辑器"><a href="#Windows常用Markdown编辑器" class="headerlink" title="Windows常用Markdown编辑器"></a>Windows常用Markdown编辑器</h1><ul><li>VSCode <a href="https://code.visualstudio.com/">下载</a></li><li>Atom <a href="https://ide.atom.io/">下载</a></li><li>CuteMarkEd <a href="http://cloose.github.io/CuteMarkEd/">下载</a></li><li>MarkdownPad2 <a href="http://markdownpad.com/">下载</a></li><li>MarkPad <a href="http://code52.org/DownmarkerWPF/">下载</a></li><li>Miu <a href="https://free.com.tw/miu/">下载</a></li><li>Typora <a href="https://www.typora.io/">下载</a></li><li>RStudio <a href="https://www.rstudio.com/">下载</a></li></ul><h3 id="Markdown语法说明-中文版"><a href="#Markdown语法说明-中文版" class="headerlink" title="Markdown语法说明-中文版"></a><a href="https://www.appinn.com/markdown/">Markdown语法说明-中文版</a></h3><h1 id="为什么使用Markdown"><a href="#为什么使用Markdown" class="headerlink" title="为什么使用Markdown"></a>为什么使用Markdown</h1><ul><li>它使我更加专注于文字内容而不是排版样式</li></ul><blockquote><p>We believe that writing is about content, about what you want to say – not about fancy formatting.</p></blockquote><h6 id="–Ulysses-for-Mac"><a href="#–Ulysses-for-Mac" class="headerlink" title="–Ulysses for Mac"></a>–Ulysses for Mac</h6><p align="right"><font size="4" color="red">[高级应用](https://blog.mariusschulz.com/2014/12/16/how-to-set-up-sublime-text-for-a-vastly-better-markdown-writing-experience)</font></p><p align="right"><font size="4" color="red">Sublime Text3+Markdown Editing</font></p><p align="right">[参考](https://blog.csdn.net/u012195214/article/details/70544181)]]></content>
      
      
      <categories>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建历程（3）</title>
      <link href="2018/09/26/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%883%EF%BC%89/"/>
      <url>2018/09/26/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%883%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="hexo生成工程文件介绍"><a href="#hexo生成工程文件介绍" class="headerlink" title="hexo生成工程文件介绍"></a>hexo生成工程文件介绍</h1><blockquote><p><a href="https://hexo.io/plugins/">hexo插件</a></p></blockquote><blockquote><p><a href="https://github.com/litten/hexo-theme-yilia">主题yilia</a></p></blockquote><h2 id="默认目录结构"><a href="#默认目录结构" class="headerlink" title="默认目录结构"></a>默认目录结构</h2><p><a href="https://www.jianshu.com/p/17d55d420d94">具体参考</a></p><span id="more"></span><pre><code>|--.deploy|--public|--scaffolds|--source|--themes|--_config.yml|--package.json</code></pre><ul><li>.deploy ：部署到GitHub上的内容目录</li><li>public：输出的静态网页内容目录</li><li>scaffolds：layout模板文件目录</li><li>source：文件源码目录</li><li>themes：主题文件目录</li><li>—config.yml：全局配置文件</li><li>package.json：项目依赖声明文件</li></ul><h1 id="给主题yilia配置干货"><a href="#给主题yilia配置干货" class="headerlink" title="给主题yilia配置干货"></a>给主题yilia配置干货</h1><h2 id="一、腾讯公益404"><a href="#一、腾讯公益404" class="headerlink" title="一、腾讯公益404"></a>一、腾讯公益404</h2><p><em><strong><a href="http://www.qq.com/404/">公益404</a></strong></em></p><p><code>hexo new page 404 #新建一个页面</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在生成的index.md文件下添加以下代码</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;]\</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;404&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js&quot;</span> charset=<span class="string">&quot;utf-8&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g<span class="comment">#直接部署到GitHub</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/liu1340308350/article/details/81744824">参考</a></p><h2 id="二、制作个网站ico"><a href="#二、制作个网站ico" class="headerlink" title="二、制作个网站ico"></a>二、制作个网站ico</h2><p><a href="http://www.favicon-icon-generator.com/">戳这里</a></p><p>也可以不弄，直接用</p><p>把你的网站ico放在<code>public\img</code>即可<br>修改<code>theme\_config.yml</code></p><p><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/70038755.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/70038755.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="三、使用网站访问量统计-使用友盟"><a href="#三、使用网站访问量统计-使用友盟" class="headerlink" title="三、使用网站访问量统计(使用友盟)"></a>三、使用网站访问量统计(使用友盟)</h2><p><strong>效果如下</strong></p><p><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/75982791.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/75982791.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h4 id="注册账号友盟官网"><a href="#注册账号友盟官网" class="headerlink" title="注册账号友盟官网"></a>注册账号<a href="https://www.umeng.com/">友盟官网</a></h4><p><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/69139019.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/69139019.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="><br><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/14156171.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/14156171.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h4 id="获取代码"><a href="#获取代码" class="headerlink" title="获取代码"></a><em>获取代码</em></h4><p><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/66278706.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/66278706.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>在<code>hemes\yilia\layout\_partial\footer.ejs</code>挑个位置放</p><p><img src="http://pflr7ix8q.bkt.clouddn.com/18-9-26/61353041.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/18-9-26/61353041.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p><strong><a href="http://localhost:4000/">看下效果</a></strong></p><p><em><strong><code>hexo d #部署到 github </code></strong></em></p><h5 id="若不想用CNZZ参考"><a href="#若不想用CNZZ参考" class="headerlink" title="若不想用CNZZ参考"></a>若不想用CNZZ<a href="https://blog.csdn.net/zxlvxj/article/details/77720934">参考</a></h5>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>baidu收录测试</title>
      <link href="2018/09/26/xuxu/"/>
      <url>2018/09/26/xuxu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="baidu收录测试"><a href="#baidu收录测试" class="headerlink" title="baidu收录测试"></a>baidu收录测试</h1><p>hexo 插件：hexo-baidu-url-submit</p><span id="more"></span>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建历程（2）</title>
      <link href="2018/09/25/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%882%EF%BC%89/"/>
      <url>2018/09/25/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%882%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="一、使用hexo-deploy部署博客到Github"><a href="#一、使用hexo-deploy部署博客到Github" class="headerlink" title="一、使用hexo deploy部署博客到Github"></a>一、使用hexo deploy部署博客到Github</h1><blockquote><p><a href="https://hexo.io/docs/deployment.html">使用参考</a></p></blockquote><p>** 先安装个扩展<code>$ npm install hexo-deployer-git --save</code> **</p><h2 id="1-修改博客根目录下的-config-yml文件"><a href="#1-修改博客根目录下的-config-yml文件" class="headerlink" title="1.修改博客根目录下的_config_yml文件"></a>1.修改博客根目录下的<code>_config_yml</code>文件</h2><p><img src="https://img.vim-cn.com/b9/242b742e41b045e48e38055e2202cdfdbbc5f3.png" class="lazyload" data-srcset="https://img.vim-cn.com/b9/242b742e41b045e48e38055e2202cdfdbbc5f3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: git@github.com:yeshan333/yeshan333.github.io.git <span class="comment"># 这个可到Github仓库拿</span></span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/44/35d14788fe4cab09d8b20da1753335ad758c23.png" class="lazyload" data-srcset="https://img.vim-cn.com/44/35d14788fe4cab09d8b20da1753335ad758c23.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><span id="more"></span><h2 id="2-部署到GitHub-repo"><a href="#2-部署到GitHub-repo" class="headerlink" title="2.部署到GitHub repo"></a>2.部署到GitHub repo</h2><h3 id="生成ssh-keys"><a href="#生成ssh-keys" class="headerlink" title="生成ssh keys"></a>生成ssh keys</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;邮件地址@youremail.com&quot;</span> <span class="comment">#生成新的key文件，邮箱地址填注册Github时用的</span></span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/37/ecb8a0a1f900c804d06651139773f0979a6270.png" class="lazyload" data-srcset="https://img.vim-cn.com/37/ecb8a0a1f900c804d06651139773f0979a6270.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/37/ecb8a0a1f900c804d06651139773f0979a6270.png"></p><h3 id="将生成的ssh-keys添加到Github的deploy-keys中"><a href="#将生成的ssh-keys添加到Github的deploy-keys中" class="headerlink" title="将生成的ssh keys添加到Github的deploy keys中"></a>将生成的ssh keys添加到Github的deploy keys中</h3><ul><li><ol><li>复制key</li></ol></li></ul><p>** 这里用到.ssh目录下，id_rsa.pub文件中的那串key**</p><p><img src="https://img.vim-cn.com/5b/a4d58b99d58d1c22ffec0e5fc6301c45b20b58.png" class="lazyload" data-srcset="https://img.vim-cn.com/5b/a4d58b99d58d1c22ffec0e5fc6301c45b20b58.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="https://img.vim-cn.com/5b/a4d58b99d58d1c22ffec0e5fc6301c45b20b58.png"></p><ul><li><ol start="2"><li><a href="https://github.com/">到GitHub</a>的yourname.hithub.io仓库添加那串key到deploy keys中</li></ol></li></ul><p><img src="https://img.vim-cn.com/1d/9e76911a5130f878845a7178b03d8977eac937.png" class="lazyload" data-srcset="https://img.vim-cn.com/1d/9e76911a5130f878845a7178b03d8977eac937.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li><ol start="3"><li>测试一下是否添加成功了:</li></ol></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/00/7d3b8f51ed72ecd2ce3f73c387944729f18ff1.png" class="lazyload" data-srcset="https://img.vim-cn.com/00/7d3b8f51ed72ecd2ce3f73c387944729f18ff1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h3 id="部署博客"><a href="#部署博客" class="headerlink" title="部署博客"></a>部署博客</h3><ol><li>先配好git用户信息</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;你的名字&quot;</span>     <span class="comment"># github用户名</span></span><br><span class="line">git config --global user.email <span class="string">&quot;邮箱@邮箱.com&quot;</span>    <span class="comment"># github邮箱</span></span><br></pre></td></tr></table></figure><ol start="2"><li>部署博客到仓库</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g <span class="comment"># 生成静态文件</span></span><br><span class="line">hexo d <span class="comment"># 部署到远程仓库</span></span><br></pre></td></tr></table></figure><p>访问<a href="https://yourname.github.io查看结果/">https://yourname.github.io查看结果</a></p><p>** 到此，整个博客搭建完成了 **</p><p>以下是写的是博客主题的更换，主题可以自己写，也可以使用别人写的，可去这里<a href="https://hexo.io/themes/">https://hexo.io/themes/</a>找喜欢的主题，如果使用的是别人的主题，需要阅读主题使用文档进行相关配置。</p><h1 id="二、Hexo主题设置"><a href="#二、Hexo主题设置" class="headerlink" title="二、Hexo主题设置"></a>二、Hexo主题设置</h1><ul><li><ol><li>更换主题</li></ol></li></ul><p>cd进themes目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure><ul><li><ol start="2"><li>对根目录下的<code>config_yml</code>文件进行修改</li></ol></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd themes/yilia</span><br><span class="line">git pull #更新主题</span><br></pre></td></tr></table></figure><p><img src="https://img.vim-cn.com/bf/e7a244bb8eacd6753b71192d4cc7396837493d.png" class="lazyload" data-srcset="https://img.vim-cn.com/bf/e7a244bb8eacd6753b71192d4cc7396837493d.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><ul><li><ol start="3"><li>预览新主题</li></ol></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean <span class="comment"># 清楚缓存，删除public目录</span></span><br><span class="line">hexo g     <span class="comment"># 生成新的博客静态文件</span></span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>去<a href="http://localhost:4000/">http://localhost:4000</a>预览，没毛病就<code>hexo d</code>部署到远程仓库。</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建历程（1）</title>
      <link href="2018/09/25/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%881%EF%BC%89/"/>
      <url>2018/09/25/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%881%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><code>我为什么要搭建自己的博客:人嘛!总会有迷茫的时候。无聊了就搭建一个博客玩玩。借此思考下人生</code><a href="https://zhuanlan.zhihu.com/p/19743861?columnSlug=cnfeat">戳这里先洗下脑</a></p><blockquote><p><a href="http://mindhacks.cn/2009/02/15/why-you-should-start-blogging-now/">[BetterExplained]为什么你应该（从现在开始就）写博客</a></p></blockquote><h1 id="使用Hexo-GitHub-Pages搭建属于自己的博客"><a href="#使用Hexo-GitHub-Pages搭建属于自己的博客" class="headerlink" title="使用Hexo+GitHub Pages搭建属于自己的博客"></a>使用Hexo+GitHub Pages搭建属于自己的博客</h1><h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><ul><li>安装Node.js</li><li>安装git</li><li>一个GitHub账号</li><li>hexo全家桶</li></ul><span id="more"></span><h3 id="一、Node-js安装参考"><a href="#一、Node-js安装参考" class="headerlink" title="一、Node.js安装参考"></a>一、Node.js安装参考</h3><p><a href="http://nodejs.cn/">Node.js官网</a></p><p><strong><font color="red">nodejs版本越高越好，不然后面安装hexo时会出现问题，Hexo官网给的建议是6.9版本以上</font></strong></p><p><a href="https://npm.taobao.org/mirrors/node/v10.16.0/node-v10.16.0-x64.msi">官网windows 64bit 下载(v10.16.0)</a></p><h3 id="二、git的安装参考"><a href="#二、git的安装参考" class="headerlink" title="二、git的安装参考"></a>二、git的安装参考</h3><p>安装需根据自己的实际情况，在cmd使用<code>git --version</code>指令可以查看安装的版本</p><p><a href="https://github.com/git-for-windows/git/releases/download/v2.19.0.windows.1/Git-2.19.0-64-bit.exe">windows 64 bit 下载（v2.19.0）</a></p><h3 id="三、使用Github-Pages"><a href="#三、使用Github-Pages" class="headerlink" title="三、使用Github Pages"></a>三、使用Github Pages</h3><ul><li><a href="https://github.com/">注册Github账号</a></li><li>创建一个repository，用于存放博客站点文件</li><li>开启Github Page</li></ul><h4 id="1、创建一个repository"><a href="#1、创建一个repository" class="headerlink" title="1、创建一个repository"></a>1、创建一个repository</h4><p><img src="https://img.vim-cn.com/0b/d84ec69ee51d0ea78240bde231d2e6f827db22.png" class="lazyload" data-srcset="https://img.vim-cn.com/0b/d84ec69ee51d0ea78240bde231d2e6f827db22.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://img.vim-cn.com/57/523b9522e73a662cb39060489ef61f3a559b47.png" class="lazyload" data-srcset="https://img.vim-cn.com/57/523b9522e73a662cb39060489ef61f3a559b47.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><del>仓库命名方式须注意下，这样命名会开启githubpage服务</del>，代码仓库命名方式随意，如果以<code>用户名+github.io</code>的形式命名，会自动开启Github Pages服务，否则需要自己在仓库的设置那里手动开启GIthub Pages服务。</p><p>Github Pages 是 github 公司提供的免费的静态网站托管服务，用起来方便而且功能强大，<del>不仅没有空间限制(为免费用户提供了500M空间)，还可以绑定自己的域名</del>，1GB空间限制（个人博客够用了），每月带宽限制100GB，自由绑定自己的域名。</p><h4 id="2、开启GitHub-Pages"><a href="#2、开启GitHub-Pages" class="headerlink" title="2、开启GitHub Pages"></a>2、开启GitHub Pages</h4><p><a href="https://pages.github.com/">GitHub Pages官方介绍</a>，Github的中文官方文档已推出<a href="https://help.github.com/cn/articles/what-is-github-pages">https://help.github.com/cn/articles/what-is-github-pages</a>(2019年7月11日更新)</p><p><img src="https://img.vim-cn.com/88/218b90bc2b18ccf6cc7f5a51b77409fcf273a8.png" class="lazyload" data-srcset="https://img.vim-cn.com/88/218b90bc2b18ccf6cc7f5a51b77409fcf273a8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><img src="https://img.vim-cn.com/40/fe0f7b5ff242c5aa99afa0f0c82b3ddde0dc31.png" class="lazyload" data-srcset="https://img.vim-cn.com/40/fe0f7b5ff242c5aa99afa0f0c82b3ddde0dc31.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p><code>点击choose a theme</code>选完主题后即可到<code>https://yourname.github.io/</code>访问自己的个人主页了，yourname记得替换成你的用户名。</p><p><strong>接下来需要使用Hexo在本地创建好博客，再将博客文件上传到刚刚创建的仓库。</strong></p><h3 id="四、Hexo配置"><a href="#四、Hexo配置" class="headerlink" title="四、Hexo配置"></a>四、Hexo配置</h3><blockquote><p>Hexo是一个静态站点生成器，如果想深入了解Hexo可以去Hexo的官网看看。<a href="https://hexo.io/zh-cn/docs/">https://hexo.io/zh-cn/docs/</a></p></blockquote><h4 id="在本地搭建博客"><a href="#在本地搭建博客" class="headerlink" title="在本地搭建博客"></a>在本地搭建博客</h4><h5 id="1-安装hexo插件套装"><a href="#1-安装hexo插件套装" class="headerlink" title="1.安装hexo插件套装"></a>1.安装hexo插件套装</h5><p>以下两条命令直接打开windows cmd执行即可，用git bash执行也行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装hexo命令行工具</span></span><br><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure><p>~~安装hexo包到全局node_modules中，修改package.json文件，将模块名和版本号添加到dependencies部分<br>npm install hexo –save~~~</p><h5 id="2-初始化hexo"><a href="#2-初始化hexo" class="headerlink" title="2.初始化hexo"></a>2.初始化hexo</h5><ul><li>这里需要新建个目录用于存放本地的博客文件</li><li>往后的命令均需要在此目录下执行，可用<code>cd</code>命令进入目录中执行往后的命令</li></ul><p><img src="https://img.vim-cn.com/2a/5a136fa1d0a4c187856395924455de40c626eb.gif" class="lazyload" data-srcset="https://img.vim-cn.com/2a/5a136fa1d0a4c187856395924455de40c626eb.gif" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init  <span class="comment"># 初始化目录，生成相关文件</span></span><br></pre></td></tr></table></figure><ul><li>目录中生成的文件如下</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── node_modules       # 存放博客依赖的npm packages</span><br><span class="line">├── scaffolds          # 存放生成博客文章、博客页面、草稿的模板目录</span><br><span class="line">├   ├── draft.md</span><br><span class="line">├   ├── page.md</span><br><span class="line">├   └── post.md</span><br><span class="line">├── source</span><br><span class="line">├   └── posts           # 用于存放博客文章</span><br><span class="line">├── _config.yml         # 博客全局配置文件</span><br><span class="line">├── .gitignore</span><br><span class="line">├── package.json        # 记录当前目录下实际安装的各个npm package的具体来源和版本号</span><br><span class="line">└── package-lock.json   # 存放锁定安装时的包的版本号，此文件一般会上传到git</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g <span class="comment"># 生成静态页面</span></span><br><span class="line">hexo s <span class="comment"># 部署到本地服务器http://localhost:4000/</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:4000/">预览效果http://localhost:4000/</a></p><p>到这里本地的博客搭建完了，接下来就是将博客上传到刚刚创建的Github仓库，上传后就可以使用外网访问了</p><p><a href="/2018/09/25/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B%EF%BC%882%EF%BC%89/">博客搭建历程（2）</a></p><h1 id="博客搭建参考教程推荐"><a href="#博客搭建参考教程推荐" class="headerlink" title="博客搭建参考教程推荐"></a>博客搭建参考教程推荐</h1><ul><li><a href="https://blog.csdn.net/gdutxiaoxu/article/details/53576018">csdn</a></li><li><a href="https://m.w3cschool.cn/hexo_blog/hexo_blog-tvpu244e.html">w3cschool</a></li><li><a href="https://www.cnblogs.com/jackyroc/p/7681938.html">博客园</a></li><li><a href="https://segmentfault.com/a/1190000004947261">思否</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown</title>
      <link href="2018/09/25/Markdown/"/>
      <url>2018/09/25/Markdown/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="体验markdown"><a href="#体验markdown" class="headerlink" title="体验markdown"></a>体验markdown</h1><p align="center">有点意思，哈！</p><h2 id="同级文件夹，的img文件夹下的图片"><a href="#同级文件夹，的img文件夹下的图片" class="headerlink" title="同级文件夹，的img文件夹下的图片"></a>同级文件夹，的img文件夹下的图片</h2><p><img src="/img/wocao.jpg" class="lazyload" data-srcset="/img/wocao.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="添加链接"><a href="#添加链接" class="headerlink" title="添加链接"></a>添加链接</h2><p><a href="https://yeshan333.github.io/">我的博客</a></p><h2 id="添加图片"><a href="#添加图片" class="headerlink" title="添加图片"></a>添加图片</h2><p><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3965705221,2010595691&fm=26&gp=0.jpg" class="lazyload" data-srcset="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3965705221,2010595691&fm=26&gp=0.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="百度上找的"></p><span id="more"></span><h2 id="一级引用"><a href="#一级引用" class="headerlink" title="一级引用"></a>一级引用</h2><blockquote><p>要判断一个人是否真正聪明，那就要看他能否根本不用动手，而工作却又能完成。</p></blockquote><h3 id="二级引用"><a href="#二级引用" class="headerlink" title="二级引用"></a>二级引用</h3><blockquote><p>在C++里, 想搬起石头砸自己的脚更为困难了。</p><blockquote><p>不过一旦你真这么做了, 整条腿都得报销!</p></blockquote></blockquote><h2 id="列表的使用"><a href="#列表的使用" class="headerlink" title="列表的使用"></a>列表的使用</h2><h3 id="一级列表"><a href="#一级列表" class="headerlink" title="一级列表"></a>一级列表</h3><ul><li>python</li><li>Java</li><li>c++</li></ul><h3 id="多级列表"><a href="#多级列表" class="headerlink" title="多级列表"></a>多级列表</h3><ul><li>数学分析<ul><li>高等代数<ul><li>解析几何</li></ul></li></ul></li></ul><h2 id="插入代码"><a href="#插入代码" class="headerlink" title="插入代码"></a>插入代码</h2><h3 id="行内代码"><a href="#行内代码" class="headerlink" title="行内代码"></a>行内代码</h3><p><code>printf(&quot; hello world &quot;); </code></p><h3 id="块代码-每行代码前四个空格或一个tab"><a href="#块代码-每行代码前四个空格或一个tab" class="headerlink" title="块代码,每行代码前四个空格或一个tab"></a>块代码,每行代码前四个空格或一个tab</h3><pre><code>Wocao    Nimei</code></pre><h3 id="Fenced-Code-Block"><a href="#Fenced-Code-Block" class="headerlink" title="Fenced Code Block"></a>Fenced Code Block</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(4):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="划重点"><a href="#划重点" class="headerlink" title="划重点"></a>划重点</h2><p><code>人生苦短</code></p><h2 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h2><p><strong>干的漂亮</strong></p><h2 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h2><p><del>这都什么鬼</del></p><p><em>这里是斜体</em><br><strong>这里是粗体</strong><br><em><strong>这里是粗斜体</strong></em></p><p>利用html标签换行<br/>有点意思</p><p><img src="http://pflr7ix8q.bkt.clouddn.com/wocao.jpg" class="lazyload" data-srcset="http://pflr7ix8q.bkt.clouddn.com/wocao.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="七牛图云"></p><h2 id="这里是表格"><a href="#这里是表格" class="headerlink" title="这里是表格"></a>这里是表格</h2><table><thead><tr><th align="center">浏览器</th><th align="center">好</th><th align="center">坏</th></tr></thead><tbody><tr><td align="center">google</td><td align="center">1</td><td align="center">0</td></tr><tr><td align="center">firefox</td><td align="center">1</td><td align="center">0</td></tr></tbody></table><h2 id="使用font标签控制字体颜色"><a href="#使用font标签控制字体颜色" class="headerlink" title="使用font标签控制字体颜色"></a>使用font标签控制字体颜色</h2><p><font color="red">红色</font>&lt;br&gt;<br><font face="微软雅黑" color="red" size="5">自定义字体样式、颜色、大小</font></p>]]></content>
      
      
      <categories>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello my first blog in here ！</title>
      <link href="2018/09/19/hello-my-first-blog-in-here-%EF%BC%81/"/>
      <url>2018/09/19/hello-my-first-blog-in-here-%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="新的开始，新的路线"><a href="#新的开始，新的路线" class="headerlink" title="新的开始，新的路线"></a>新的开始，新的路线</h1><p><fancybox><img src="https://img.vim-cn.com/bb/db444be0b7fda59c69d5c64167f9668b0b66bd.png" class="lazyload" data-srcset="https://img.vim-cn.com/bb/db444be0b7fda59c69d5c64167f9668b0b66bd.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="logo"></fancybox></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
