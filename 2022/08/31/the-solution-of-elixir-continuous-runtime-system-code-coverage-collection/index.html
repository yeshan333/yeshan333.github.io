<!DOCTYPE html>
<html lang="zh-CN,en,zh-TW,default">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#5.7.6'>
  <meta name="generator" content="Hexo 7.1.1">
  <meta name="Volantis" content="5.7.6">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
  <link rel="canonical" href="https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/"/>
  <!-- 渲染优化 -->
    <meta http-equiv='x-dns-prefetch-control' content='on' />
      <link rel='dns-prefetch' href='https://unpkg.com'>
      <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content=" default-src 'self' https:; block-all-mixed-content; base-uri 'self' https:; form-action 'self' https:; worker-src 'self' https:; connect-src 'self' https: *; img-src 'self' data: https: *; media-src 'self' https: *; font-src 'self' data: https: *; frame-src 'self' https: *; manifest-src 'self' https: *; child-src https:; script-src 'self' https: 'unsafe-inline' *; style-src 'self' https: 'unsafe-inline' *; ">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  
  <!-- Custom Files headBegin end-->
    <link rel="shortcut icon" type='image/x-icon' href="https://s1.ax1x.com/2022/10/09/xJ7yMF.png">
  <link rel="preload" href="/css/style.css" as="style">
  <link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
<link rel="preload" href="https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <!-- feed -->
        <link rel="alternate" href="/atom.xml" title="ShanSan" type="application/atom+xml">
        <link rel="alternate" href="/rss2.xml" title="ShanSan" type="application/rss+xml">
  <!-- 页面元数据 -->
  <title>the-solution-of-elixir-continuous-runtime-system-code-coverage-collection - ShanSan</title>
  <meta name="keywords" content="run-time system test coverage,ShanSan,Cloudys,shan333,shansan">
  <meta desc name="description" content="ShanSan's Blog - ShanSan - ShanSan">
  
<meta property="og:type" content="article">
<meta property="og:title" content="the-solution-of-elixir-continuous-runtime-system-code-coverage-collection">
<meta property="og:url" content="https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/index.html">
<meta property="og:site_name" content="ShanSan">
<meta property="og:description" content="zh_hans  Code coverage is an effective means to assist software engineers in verifying code quality. The runtime environment’s ability to collect code coverage fully combines black and white box test">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
<meta property="article:published_time" content="2022-08-31T22:43:10.000Z">
<meta property="article:modified_time" content="2022-08-31T22:43:10.000Z">
<meta property="article:author" content="ShanSan">
<meta property="article:tag" content="Elixir">
<meta property="article:tag" content="Test Coverage">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png">
  <style>
    /* 首屏样式 */
    #safearea {
  display: none;
}
:root {
  --color-site-body: #f4f4f4;
  --color-site-bg: #f4f4f4;
  --color-site-inner: #fff;
  --color-site-footer: #666;
  --color-card: #fff;
  --color-text: #444;
  --color-block: #f6f6f6;
  --color-inlinecode: #c74f00;
  --color-codeblock: #fff7ea;
  --color-h1: #3a3a3a;
  --color-h2: #3a3a3a;
  --color-h3: #333;
  --color-h4: #444;
  --color-h5: #555;
  --color-h6: #666;
  --color-p: #444;
  --color-list: #666;
  --color-list-hl: #146226;
  --color-meta: #888;
  --color-read-bkg: #e0d8c8;
  --color-read-post: #f8f1e2;
  --color-copyright-bkg: #f5f5f5;
}
* {
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  margin: 0;
  padding: 0;
}
*::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
*::-webkit-scrollbar-track-piece {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: #197b30;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
*::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
html {
  color: var(--color-text);
  width: 100%;
  height: 100%;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  font-size: 16px;
}
html >::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
html >::-webkit-scrollbar-track-piece {
  background: transparent;
}
html >::-webkit-scrollbar-thumb {
  background: #197b30;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
html >::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
body {
  background-color: var(--color-site-body);
  text-rendering: optimizelegibility;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  line-height: 1.6;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
body.modal-active {
  overflow: hidden;
}
@media screen and (max-width: 680px) {
  body.modal-active {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
a {
  color: #2092ec;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
a:hover {
  color: #ff5722;
}
a:active,
a:hover {
  outline: 0;
}
ul,
ol {
  padding-left: 0;
}
ul li,
ol li {
  list-style: none;
}
header {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
img {
  border: 0;
  background: none;
  max-width: 100%;
}
svg:not(:root) {
  overflow: hidden;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  height: 0;
  border: 0;
  border-radius: 1px;
  -webkit-border-radius: 1px;
  border-bottom: 1px solid rgba(68,68,68,0.1);
}
button,
input {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
  text-transform: none;
  -webkit-appearance: button;
  cursor: pointer;
}
@supports (backdrop-filter: blur(20px)) {
  .blur {
    background: rgba(255,255,255,0.9) !important;
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.shadow {
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.shadow.floatable {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.shadow.floatable:hover {
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
}
#l_cover {
  min-height: 64px;
}
.cover-wrapper {
  top: 0;
  left: 0;
  max-width: 100%;
  height: 100vh;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  align-self: center;
  align-content: center;
  color: var(--color-site-inner);
  padding: 0 16px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  overflow: hidden;
  margin-bottom: -100px;
}
.cover-wrapper .cover-bg {
  position: absolute;
  width: 100%;
  height: 100%;
  background-position: center;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
}
.cover-wrapper .cover-bg.lazyload:not(.loaded) {
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
}
.cover-wrapper .cover-bg.lazyload.loaded {
  animation-delay: 0s;
  animation-duration: 0.5s;
  animation-fill-mode: forwards;
  animation-timing-function: ease-out;
  animation-name: fadeIn;
}
@-moz-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
    transform: scale(1.02);
    -webkit-transform: scale(1.02);
    -khtml-transform: scale(1.02);
    -moz-transform: scale(1.02);
    -o-transform: scale(1.02);
    -ms-transform: scale(1.02);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 100%;
}
.cover-wrapper#full {
  height: calc(100vh + 100px);
  padding-bottom: 100px;
}
.cover-wrapper#half {
  max-height: 640px;
  min-height: 400px;
  height: calc(36vh - 64px + 200px);
}
.cover-wrapper #scroll-down {
  width: 100%;
  height: 64px;
  position: absolute;
  bottom: 100px;
  text-align: center;
  cursor: pointer;
}
.cover-wrapper #scroll-down .scroll-down-effects {
  color: #fff;
  font-size: 24px;
  line-height: 64px;
  position: absolute;
  width: 24px;
  left: calc(50% - 12px);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  animation: scroll-down-effect 1.5s infinite;
  -webkit-animation: scroll-down-effect 1.5s infinite;
  -khtml-animation: scroll-down-effect 1.5s infinite;
  -moz-animation: scroll-down-effect 1.5s infinite;
  -o-animation: scroll-down-effect 1.5s infinite;
  -ms-animation: scroll-down-effect 1.5s infinite;
}
@-moz-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  margin-top: 64px;
  margin-bottom: 100px;
}
.cover-wrapper .cover-body,
.cover-wrapper .cover-body .top,
.cover-wrapper .cover-body .bottom {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  max-width: 100%;
}
.cover-wrapper .cover-body .bottom {
  margin-top: 32px;
}
.cover-wrapper .cover-body .title {
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
  font-size: 3.125rem;
  line-height: 1.2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.cover-wrapper .cover-body .subtitle {
  font-size: 20px;
}
.cover-wrapper .cover-body .logo {
  max-height: 120px;
  max-width: calc(100% - 4 * 16px);
}
@media screen and (min-height: 1024px) {
  .cover-wrapper .cover-body .title {
    font-size: 3rem;
  }
  .cover-wrapper .cover-body .subtitle {
    font-size: 1.05rem;
  }
  .cover-wrapper .cover-body .logo {
    max-height: 150px;
  }
}
.cover-wrapper .cover-body .m_search {
  position: relative;
  max-width: calc(100% - 16px);
  width: 320px;
  vertical-align: middle;
}
.cover-wrapper .cover-body .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  width: 100%;
}
.cover-wrapper .cover-body .m_search .icon,
.cover-wrapper .cover-body .m_search .input {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.cover-wrapper .cover-body .m_search .icon {
  position: absolute;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  line-height: 2.5rem;
  width: 32px;
  top: 0;
  left: 5px;
  color: rgba(68,68,68,0.75);
}
.cover-wrapper .cover-body .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  height: 2.5rem;
  width: 100%;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  font-size: 0.875rem;
  -webkit-appearance: none;
  padding-left: 36px;
  border-radius: 1.4rem;
  -webkit-border-radius: 1.4rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--color-text);
}
@media screen and (max-width: 500px) {
  .cover-wrapper .cover-body .m_search .input {
    padding-left: 36px;
  }
}
.cover-wrapper .cover-body .m_search .input:hover {
  background: rgba(255,255,255,0.8);
}
.cover-wrapper .cover-body .m_search .input:focus {
  background: #fff;
}
.cover-wrapper .list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  -khtml-flex-wrap: wrap;
  -moz-flex-wrap: wrap;
  -o-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  align-items: stretch;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.cover-wrapper .list-h a {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 0;
  -ms-flex: 1 0;
  flex: 1 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  font-weight: 600;
}
.cover-wrapper .list-h a img {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  border-radius: 2px;
  -webkit-border-radius: 2px;
  margin: 4px;
  min-width: 40px;
  max-width: 44px;
}
@media screen and (max-width: 768px) {
  .cover-wrapper .list-h a img {
    min-width: 36px;
    max-width: 40px;
  }
}
@media screen and (max-width: 500px) {
  .cover-wrapper .list-h a img {
    margin: 2px 4px;
    min-width: 32px;
    max-width: 36px;
  }
}
@media screen and (max-width: 375px) {
  .cover-wrapper .list-h a img {
    min-width: 28px;
    max-width: 32px;
  }
}
.cover-wrapper {
  max-width: 100%;
}
.cover-wrapper.search .bottom .menu {
  margin-top: 16px;
}
.cover-wrapper.search .bottom .menu .list-h a {
  white-space: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  align-items: baseline;
  padding: 2px;
  margin: 4px;
  color: var(--color-site-inner);
  opacity: 0.75;
  -webkit-opacity: 0.75;
  -moz-opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.05);
  border-bottom: 2px solid transparent;
}
.cover-wrapper.search .bottom .menu .list-h a i {
  margin-right: 4px;
}
.cover-wrapper.search .bottom .menu .list-h a p {
  font-size: 0.9375rem;
}
.cover-wrapper.search .bottom .menu .list-h a:hover,
.cover-wrapper.search .bottom .menu .list-h a.active,
.cover-wrapper.search .bottom .menu .list-h a:active {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
  border-bottom: 2px solid var(--color-site-inner);
}
.cover-wrapper.dock .menu,
.cover-wrapper.featured .menu,
.cover-wrapper.focus .menu {
  border-radius: 6px;
  -webkit-border-radius: 6px;
}
.cover-wrapper.dock .menu .list-h a,
.cover-wrapper.featured .menu .list-h a,
.cover-wrapper.focus .menu .list-h a {
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  padding: 12px;
  line-height: 24px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  border-bottom: none;
  text-align: center;
  align-content: flex-end;
  color: rgba(68,68,68,0.7);
  font-size: 1.5rem;
}
@media screen and (max-width: 500px) {
  .cover-wrapper.dock .menu .list-h a,
  .cover-wrapper.featured .menu .list-h a,
  .cover-wrapper.focus .menu .list-h a {
    padding: 12px 8px;
  }
}
.cover-wrapper.dock .menu .list-h a i,
.cover-wrapper.featured .menu .list-h a i,
.cover-wrapper.focus .menu .list-h a i {
  margin: 8px;
}
.cover-wrapper.dock .menu .list-h a p,
.cover-wrapper.featured .menu .list-h a p,
.cover-wrapper.focus .menu .list-h a p {
  font-size: 0.875rem;
}
.cover-wrapper.dock .menu .list-h a.active,
.cover-wrapper.featured .menu .list-h a.active,
.cover-wrapper.focus .menu .list-h a.active {
  background: var(--color-card);
  backdrop-filter: none;
}
.cover-wrapper.dock .menu .list-h a.active i,
.cover-wrapper.featured .menu .list-h a.active i,
.cover-wrapper.focus .menu .list-h a.active i,
.cover-wrapper.dock .menu .list-h a.active i+p,
.cover-wrapper.featured .menu .list-h a.active i+p,
.cover-wrapper.focus .menu .list-h a.active i+p {
  color: #197b30;
}
.cover-wrapper.dock .menu .list-h a.active img+p,
.cover-wrapper.featured .menu .list-h a.active img+p,
.cover-wrapper.focus .menu .list-h a.active img+p {
  color: var(--color-text);
}
.cover-wrapper.dock .menu .list-h a:hover,
.cover-wrapper.featured .menu .list-h a:hover,
.cover-wrapper.focus .menu .list-h a:hover {
  background: var(--color-card);
}
.cover-wrapper.dock .top {
  margin-bottom: 48px;
}
.cover-wrapper.dock .menu {
  background: rgba(255,255,255,0.5);
  position: absolute;
  bottom: 0;
  max-width: 100%;
}
.cover-wrapper.dock .menu .list-h {
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  margin: 4px;
}
.cover-wrapper.dock .menu .list-h a+a {
  margin-left: 4px;
}
@media screen and (max-width: 500px) {
  .cover-wrapper.dock .menu .list-h {
    overflow-x: scroll;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar {
    height: 0;
    width: 0;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-track-piece {
    background: transparent;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-thumb {
    background: #197b30;
    cursor: pointer;
    border-radius: 0;
    -webkit-border-radius: 0;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-thumb:hover {
    background: #ff5722;
  }
}
@supports (backdrop-filter: blur(20px)) {
  .cover-wrapper.dock .menu {
    background: rgba(255,255,255,0.5);
    backdrop-filter: saturate(200%) blur(20px);
  }
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --color-site-body: #121212;
    --color-read-bkg: #1f1f1f;
    --color-read-post: #262626;
    --color-site-bg: #1f1f1f;
    --color-site-inner: rgba(238,238,238,0.871);
    --color-site-footer: rgba(170,170,170,0.871);
    --color-card: #262626;
    --color-text: rgba(238,238,238,0.871);
    --color-block: #434343;
    --color-codeblock: #1f1f1f;
    --color-inlinecode: #d56d28;
    --color-h1: rgba(255,255,255,0.871);
    --color-h2: rgba(255,255,255,0.871);
    --color-h3: rgba(255,255,255,0.6);
    --color-h4: rgba(255,255,255,0.6);
    --color-h5: rgba(255,255,255,0.6);
    --color-h6: rgba(255,255,255,0.6);
    --color-p: rgba(217,217,217,0.871);
    --color-list: rgba(217,217,217,0.871);
    --color-list-hl: #469559;
    --color-meta: rgba(191,191,191,0.871);
    --color-link: rgba(191,191,191,0.871);
    --color-copyright-bkg: #21252b;
  }
  :root:not([color-scheme]) img {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .blur {
    background: rgba(31,31,31,0.9) !important;
  }
  :root:not([color-scheme]) .white-box.blur {
    background: rgba(38,38,38,0.9) !important;
  }
  :root:not([color-scheme]) .nav-main .u-search-input {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a:hover {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .article blockquote {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .article-title a {
    color: var(--color-h1) !important;
  }
  :root:not([color-scheme]) details>summary {
    color: var(--color-p) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) details {
    border: 1px solid var(--color-site-bg) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) #u-search .modal,
  :root:not([color-scheme]) #u-search .modal-header,
  :root:not([color-scheme]) #u-search .modal-body {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #u-search .modal-body .modal-results .result:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:focus {
    background: var(--color-site-body) !important;
  }
}
[color-scheme='dark'] {
  --color-site-body: #121212;
  --color-read-bkg: #1f1f1f;
  --color-read-post: #262626;
  --color-site-bg: #1f1f1f;
  --color-site-inner: rgba(238,238,238,0.871);
  --color-site-footer: rgba(170,170,170,0.871);
  --color-card: #262626;
  --color-text: rgba(238,238,238,0.871);
  --color-block: #434343;
  --color-codeblock: #1f1f1f;
  --color-inlinecode: #d56d28;
  --color-h1: rgba(255,255,255,0.871);
  --color-h2: rgba(255,255,255,0.871);
  --color-h3: rgba(255,255,255,0.6);
  --color-h4: rgba(255,255,255,0.6);
  --color-h5: rgba(255,255,255,0.6);
  --color-h6: rgba(255,255,255,0.6);
  --color-p: rgba(217,217,217,0.871);
  --color-list: rgba(217,217,217,0.871);
  --color-list-hl: #469559;
  --color-meta: rgba(191,191,191,0.871);
  --color-link: rgba(191,191,191,0.871);
  --color-copyright-bkg: #21252b;
}
[color-scheme='dark'] img {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .blur {
  background: rgba(31,31,31,0.9) !important;
}
[color-scheme='dark'] .white-box.blur {
  background: rgba(38,38,38,0.9) !important;
}
[color-scheme='dark'] .nav-main .u-search-input {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a {
  background: var(--color-block) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a:hover {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .article blockquote {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .article-title a {
  color: var(--color-h1) !important;
}
[color-scheme='dark'] details>summary {
  color: var(--color-p) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] details {
  border: 1px solid var(--color-site-bg) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] #u-search .modal,
[color-scheme='dark'] #u-search .modal-header,
[color-scheme='dark'] #u-search .modal-body {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #u-search .modal-body .modal-results .result:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:focus {
  background: var(--color-site-body) !important;
}
@media screen and (max-width: 500px) {
  [color-scheme='dark'] .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}
@font-face {
  font-family: 'UbuntuMono';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
@font-face {
  font-family: 'Varela Round';
  src: url("https://unpkg.com/volantis-static@0.0.1654736714924/media/fonts/VarelaRound/VarelaRound-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
.l_header {
  position: fixed;
  z-index: 1000;
  top: 0;
  width: 100%;
  height: 64px;
  background: var(--color-card);
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.l_header.auto {
  transition: opacity 0.4s ease;
  -webkit-transition: opacity 0.4s ease;
  -khtml-transition: opacity 0.4s ease;
  -moz-transition: opacity 0.4s ease;
  -o-transition: opacity 0.4s ease;
  -ms-transition: opacity 0.4s ease;
  visibility: hidden;
}
.l_header.auto.show {
  opacity: 1 !important;
  -webkit-opacity: 1 !important;
  -moz-opacity: 1 !important;
  visibility: visible;
}
.l_header .container {
  margin-left: 16px;
  margin-right: 16px;
}
.l_header #wrapper {
  height: 100%;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.l_header #wrapper .nav-main,
.l_header #wrapper .nav-sub {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  justify-content: space-between;
  -webkit-justify-content: space-between;
  -khtml-justify-content: space-between;
  -moz-justify-content: space-between;
  -o-justify-content: space-between;
  -ms-justify-content: space-between;
  align-items: center;
}
.l_header #wrapper .nav-main {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.l_header #wrapper.sub .nav-main {
  transform: translateY(-64px);
  -webkit-transform: translateY(-64px);
  -khtml-transform: translateY(-64px);
  -moz-transform: translateY(-64px);
  -o-transform: translateY(-64px);
  -ms-transform: translateY(-64px);
}
.l_header #wrapper .nav-sub {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
  height: 64px;
  width: calc(100% - 2 * 16px);
  position: absolute;
}
.l_header #wrapper .nav-sub ::-webkit-scrollbar {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (min-width: 2048px) {
  .l_header #wrapper .nav-sub {
    max-width: 55vw;
    margin: auto;
  }
}
.l_header #wrapper.sub .nav-sub {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
}
.l_header #wrapper .title {
  position: relative;
  color: var(--color-text);
  padding-left: 24px;
  max-height: 64px;
}
.l_header #wrapper .nav-main .title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  line-height: 64px;
  padding: 0 24px;
  font-size: 1.25rem;
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
}
.l_header #wrapper .nav-main .title img {
  height: 64px;
}
.l_header .nav-sub {
  max-width: 1080px;
  margin: auto;
}
.l_header .nav-sub .title {
  font-weight: bold;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  line-height: 1.2;
  max-height: 64px;
  white-space: normal;
  flex-shrink: 1;
}
.l_header .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  line-height: 64px;
  align-items: center;
}
.l_header .switcher .s-toc {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (max-width: 768px) {
  .l_header .switcher .s-toc {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
  }
}
.l_header .switcher >li {
  height: 48px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  margin: 2px;
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li {
    margin: 0 1px;
    height: 48px;
  }
}
.l_header .switcher >li >a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  padding: 0.85em 1.1em;
  border-radius: 100px;
  -webkit-border-radius: 100px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  color: #197b30;
}
.l_header .switcher >li >a:hover {
  border: none;
}
.l_header .switcher >li >a.active,
.l_header .switcher >li >a:active {
  border: none;
  background: var(--color-site-bg);
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li >a {
    width: 36px;
    height: 48px;
  }
}
.l_header .nav-sub .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
}
.l_header .m_search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  height: 64px;
  width: 240px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (max-width: 1024px) {
  .l_header .m_search {
    width: 44px;
    min-width: 44px;
  }
  .l_header .m_search input::placeholder {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
  }
  .l_header .m_search:hover {
    width: 240px;
  }
  .l_header .m_search:hover input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (min-width: 500px) {
  .l_header .m_search:hover .input {
    width: 100%;
  }
  .l_header .m_search:hover .input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search {
    min-width: 0;
  }
  .l_header .m_search input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.l_header .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  width: 100%;
  align-items: center;
}
.l_header .m_search .icon {
  position: absolute;
  width: 36px;
  left: 5px;
  color: var(--color-meta);
}
@media screen and (max-width: 500px) {
  .l_header .m_search .icon {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
.l_header .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.3;
  width: 100%;
  color: var(--color-text);
  background: #fafafa;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  padding-left: 40px;
  font-size: 0.875rem;
  border-radius: 8px;
  -webkit-border-radius: 8px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (min-width: 500px) {
  .l_header .m_search .input:focus {
    box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
    -webkit-box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search .input {
    background: var(--color-block);
    padding-left: 8px;
    border: none;
  }
  .l_header .m_search .input:hover,
  .l_header .m_search .input:focus {
    border: none;
  }
}
@media (max-width: 500px) {
  .l_header .m_search {
    left: 0;
    width: 0;
    overflow: hidden;
    position: absolute;
    background: #fff;
    transition: all 0.28s ease;
    -webkit-transition: all 0.28s ease;
    -khtml-transition: all 0.28s ease;
    -moz-transition: all 0.28s ease;
    -o-transition: all 0.28s ease;
    -ms-transition: all 0.28s ease;
  }
  .l_header .m_search .input {
    border-radius: 32px;
    -webkit-border-radius: 32px;
    margin-left: 16px;
    padding-left: 16px;
  }
  .l_header.z_search-open .m_search {
    width: 100%;
  }
  .l_header.z_search-open .m_search .input {
    width: calc(100% - 120px);
  }
}
ul.m-pc >li>a {
  color: inherit;
  border-bottom: 2px solid transparent;
}
ul.m-pc >li>a:active,
ul.m-pc >li>a.active {
  border-bottom: 2px solid #197b30;
}
ul.m-pc li:hover >ul.list-v,
ul.list-v li:hover >ul.list-v {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.nav-list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  align-items: stretch;
}
ul.nav-list-h>li {
  position: relative;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  height: 100%;
  line-height: 2.4;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
ul.nav-list-h>li >a {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 600;
}
ul.list-v {
  z-index: 1;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: absolute;
  background: var(--color-card);
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  margin-top: -6px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  padding: 8px 0;
}
ul.list-v.show {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.list-v hr {
  margin-top: 8px;
  margin-bottom: 8px;
}
ul.list-v >li {
  white-space: nowrap;
  word-break: keep-all;
}
ul.list-v >li.header {
  font-size: 0.78125rem;
  font-weight: bold;
  line-height: 2em;
  color: var(--color-meta);
  margin: 8px 16px 4px;
}
ul.list-v >li.header i {
  margin-right: 8px;
}
ul.list-v >li ul {
  margin-left: 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: -40px;
}
ul.list-v .aplayer-container {
  min-height: 64px;
  padding: 6px 16px;
}
ul.list-v >li>a {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  color: var(--color-list);
  font-size: 0.875rem;
  font-weight: bold;
  line-height: 36px;
  padding: 0 20px 0 16px;
  text-overflow: ellipsis;
  margin: 0 4px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
@media screen and (max-width: 1024px) {
  ul.list-v >li>a {
    line-height: 40px;
  }
}
ul.list-v >li>a >i {
  margin-right: 8px;
}
ul.list-v >li>a:active,
ul.list-v >li>a.active {
  color: var(--color-list-hl);
}
ul.list-v >li>a:hover {
  color: var(--color-list-hl);
  background: var(--color-site-bg);
}
.l_header .menu >ul>li>a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding: 0 8px;
}
.l_header .menu >ul>li>a >i {
  margin-right: 4px;
}
.l_header ul.nav-list-h>li {
  color: var(--color-list);
  line-height: 64px;
}
.l_header ul.nav-list-h>li >a {
  max-height: 64px;
  overflow: hidden;
  color: inherit;
}
.l_header ul.nav-list-h>li >a:active,
.l_header ul.nav-list-h>li >a.active {
  color: #197b30;
}
.l_header ul.nav-list-h>li:hover>a {
  color: var(--color-list-hl);
}
.l_header ul.nav-list-h>li i.music {
  animation: rotate-effect 1.5s linear infinite;
  -webkit-animation: rotate-effect 1.5s linear infinite;
  -khtml-animation: rotate-effect 1.5s linear infinite;
  -moz-animation: rotate-effect 1.5s linear infinite;
  -o-animation: rotate-effect 1.5s linear infinite;
  -ms-animation: rotate-effect 1.5s linear infinite;
}
@-moz-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-webkit-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-o-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
.menu-phone li ul.list-v {
  right: calc(100% - 0.5 * 16px);
}
.menu-phone li ul.list-v ul {
  right: calc(100% - 0.5 * 16px);
}
#wrapper {
  max-width: 1080px;
  margin: auto;
}
@media screen and (min-width: 2048px) {
  #wrapper {
    max-width: 55vw;
  }
}
#wrapper .menu {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
  margin: 0 16px 0 0;
}
#wrapper .menu .list-v ul {
  left: calc(100% - 0.5 * 16px);
}
.menu-phone {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: 16px;
  right: 8px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.menu-phone ul {
  right: calc(100% - 0.5 * 16px);
}
@media screen and (max-width: 500px) {
  .menu-phone {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: block;
  }
}
.l_header {
  max-width: 65vw;
  left: calc((100% - 65vw) * 0.5);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}
@media screen and (max-width: 2048px) {
  .l_header {
    max-width: 1112px;
    left: calc((100% - 1112px) * 0.5);
  }
}
@media screen and (max-width: 1112px) {
  .l_header {
    left: 0;
    border-radius: 0;
    -webkit-border-radius: 0;
    max-width: 100%;
  }
}
@media screen and (max-width: 500px) {
  .l_header .container {
    margin-left: 0;
    margin-right: 0;
  }
  .l_header #wrapper .nav-main .title {
    padding-left: 16px;
    padding-right: 16px;
  }
  .l_header #wrapper .nav-sub {
    width: 100%;
  }
  .l_header #wrapper .nav-sub .title {
    overflow-y: scroll;
    margin-top: 2px;
    padding: 8px 16px;
  }
  .l_header #wrapper .switcher {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
    margin-right: 8px;
  }
  .l_header .menu {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
@media screen and (max-width: 500px) {
  .list-v li {
    max-width: 270px;
  }
}
#u-search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px 20px;
  z-index: 1001;
}
@media screen and (max-width: 680px) {
  #u-search {
    padding: 0px;
  }
}
@media screen and (prefers-color-scheme: dark) and (max-width: 500px) {
  .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}

  </style>
  <link rel="stylesheet" href="/css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  
<script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
    '.kill-t{'+
      'font-size: 2rem;'+
    '}'+
    '.kill-c{'+
      'font-size: 1.2rem;'+
    '}'+
		'#l_header,#l_body{'+
			'display: none;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        `<span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>`+
        `<span class="kill-c">微软已经于2016年终止了对 Internet Explorer (IE) 10 及更早版本的支持，<br/>继续使用存在极大的安全隐患，请使用当代主流的浏览器进行访问。</span><br/>`+
        `<a target="_blank" rel="noopener" href="https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/"><strong>了解详情 ></strong></a>`+
    '</div>');
</script>


<noscript>
	<style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
    .kill-t{
      font-size: 2rem;
    }
    .kill-c{
      font-size: 1.2rem;
    }
		#l_header,#l_body{
			display: none;
		}
	</style>
    <div class="kill-noscript">
        <span class="kill-t"><b>抱歉，您的浏览器无法访问本站</b></span><br/>
        <span class="kill-c">本页面需要浏览器支持（启用）JavaScript</span><br/>
        <a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=启用JavaScript"><strong>了解详情 ></strong></a>
    </div>
</noscript>


  <script>
  /************这个文件存放不需要重载的全局变量和全局函数*********/
  window.volantis = {}; // volantis 全局变量
  volantis.debug = "env"; // 调试模式
  volantis.dom = {}; // 页面Dom see: /source/js/app.js etc.

  volantis.GLOBAL_CONFIG ={
    debug: "env",
    cdn: {"js":{"app":"/js/app.js","parallax":"/js/plugins/parallax.js","rightMenu":"/js/plugins/rightMenu.js","rightMenus":"/js/plugins/rightMenus.js","sites":"/js/plugins/tags/sites.js","friends":"/js/plugins/tags/friends.js","contributors":"/js/plugins/tags/contributors.js","search":"/js/search/hexo.js"},"css":{"style":"/css/style.css"}},
    default: {"avatar":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg","link":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/link/8f277b4ee0ecd.svg","cover":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg","image":"https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/image/2659360.svg"},
    lastupdate: new Date(1710346207499),
    sidebar: {
      for_page: ["blogger","webinfo","category","tagcloud","wonderful_link","qrcode","my_follow"],
      for_post: ["toc"],
      webinfo: {
        lastupd: {
          enable: true,
          friendlyShow: true
        },
        runtime: {
          data: "2018/08/19",
          unit: "天"
        }
      }
    },
    plugins: {
      message: {"enable":true,"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/css/iziToast.min.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/izitoast/dist/js/iziToast.min.js","icon":{"default":"fa-solid fa-info-circle light-blue","quection":"fa-solid fa-question-circle light-blue"},"time":{"default":5000,"quection":20000},"position":"topRight","transitionIn":"bounceInLeft","transitionOut":"fadeOutRight","titleColor":"var(--color-text)","messageColor":"var(--color-text)","backgroundColor":"var(--color-card)","zindex":2147483647,"copyright":{"enable":true,"title":"知识共享许可协议","message":"请遵守 CC BY-NC-SA 4.0 协议。","icon":"far fa-copyright light-blue"},"aplayer":{"enable":true,"play":"fa-solid fa-play","pause":"fa-solid fa-pause"},"rightmenu":{"enable":true,"notice":true}},
      fancybox: {"css":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.css","js":"https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fancyapps/ui/dist/fancybox.umd.js"},
      
      aplayer: {
        id: 6729508229,
        enable:true
      },
      
      
      
      rightmenus: {"enable":true,"order":["plugins.navigation","hr","plugins.inputBox","plugins.seletctText","plugins.elementCheck","plugins.elementImage","menus.link","hr","menus.darkMode","hr","plugins.articlePage","music"],"options":{"iconPrefix":"fa-solid","articleShowLink":true,"musicAlwaysShow":true},"plugins":{"navigation":[{"id":"left","name":"转到上一页","icon":"fa-solid fa-arrow-left","event":"history.back()","group":"navigation"},{"id":"right","name":"转到下一页","icon":"fa-solid fa-arrow-right","event":"history.forward()","group":"navigation"},{"id":"redo","name":"刷新当前页面","icon":"fa-solid fa-redo","event":"window.location.reload()","group":"navigation"},{"id":"up","name":"回到顶部","icon":"fa-solid fa-arrow-up","event":"VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)","group":"navigation"}],"inputBox":[{"id":"copyPaste","name":"粘贴文本","icon":"fa-solid fa-paste","event":"copyPaste","group":"inputBox"},{"id":"copyAll","name":"全选文本","icon":"fa-solid fa-object-ungroup","event":"copyAll","group":"inputBox"},{"id":"copyCut","name":"剪切文本","icon":"fa-solid fa-cut","event":"copyCut","group":"inputBox"}],"seletctText":[{"id":"copyText","name":"复制文本","icon":"fa-solid fa-copy","event":"copyText","group":"seletctText"},{"id":"searchWord","name":"站内搜索","icon":"fa-solid fa-search","event":"OpenSearch(__text__)","group":"seletctText"},{"id":"bingSearch","name":"必应搜索","icon":"fa-solid fa-search","event":"window.open(`https://cn.bing.com/search?q=${__text__}`)","group":"seletctText"}],"elementCheck":[{"id":"openTab","name":"新标签页打开","icon":"fa-solid fa-external-link-square-alt","event":"window.open(__link__)","group":"elementCheck"},{"id":"copyLink","name":"复制链接地址","icon":"fa-solid fa-link","event":"copyLink","group":"elementCheck"}],"elementImage":[{"id":"copyImg","name":"复制图片","icon":"fa-solid fa-image","event":"copyImg","group":"elementImage"},{"id":"googleImg","name":"谷歌识图","icon":"fa-solid fa-images","event":"window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)","group":"elementImage"}],"articlePage":[{"id":"printMode","name":"打印页面","icon":"fa-solid fa-print","event":"printMode","group":"articlePage"},{"id":"readMode","name":"阅读模式","icon":"fa-solid fa-book-open","event":"readMode","group":"articlePage"}]},"menus":{"link":[{"id":"google_search","name":"Google","icon":"fa-solid fa-question","link":"https://google.com","group":"link"},{"id":"slides_share","name":"Slides","icon":"fab fa-slideshare","link":"https://slides.shan333.cn","group":"link"},"hr",{"id":"github_yeshan333","name":"GitHub","icon":"fa-solid fa-code-branch","link":"https://github.com/yeshan333","group":"link"},{"id":"shan333_site","name":"shan333.cn","icon":"fa-solid fa-code-branch","link":"https://shan333.cn","group":"link"}],"darkMode":[{"id":"darkMode","name":"暗黑模式","icon":"fa-solid fa-moon","event":"volantis.dark.toggle()","group":"darkMode"}]}}
      
    }
  }

  /******************** volantis.EventListener ********************************/
  // 事件监听器 see: /source/js/app.js
  volantis.EventListener = {}
  // 这里存放pjax切换页面时将被移除的事件监听器
  volantis.EventListener.list = []
  //构造方法
  function volantisEventListener(type, f, ele) {
    this.type = type
    this.f = f
    this.ele = ele
  }
  // 移除事件监听器
  volantis.EventListener.remove = () => {
    volantis.EventListener.list.forEach(function (i) {
      i.ele.removeEventListener(i.type, i.f, false)
    })
    volantis.EventListener.list = []
  }
  /******************** volantis.dom.$ ********************************/
  // 注：这里没有选择器，也没有forEach一次只处理一个dom，这里重新封装主题常用的dom方法，返回的是dom对象，对象包含了以下方法，同时保留dom的原生API
  function volantisDom(ele) {
    if (!ele) ele = document.createElement("div")
    this.ele = ele;
    // ==============================================================
    this.ele.find = (c) => {
      let q = this.ele.querySelector(c)
      if (q)
        return new volantisDom(q)
    }
    // ==============================================================
    this.ele.hasClass = (c) => {
      return this.ele.className.match(new RegExp('(\\s|^)' + c + '(\\s|$)'));
    }
    this.ele.addClass = (c) => {
      this.ele.classList.add(c);
      return this.ele
    }
    this.ele.removeClass = (c) => {
      this.ele.classList.remove(c);
      return this.ele
    }
    this.ele.toggleClass = (c) => {
      if (this.ele.hasClass(c)) {
        this.ele.removeClass(c)
      } else {
        this.ele.addClass(c)
      }
      return this.ele
    }
    // ==============================================================
    // 参数 r 为 true 表示pjax切换页面时事件监听器将被移除，false不移除
    this.ele.on = (c, f, r = 1) => {
      this.ele.addEventListener(c, f, false)
      if (r) {
        volantis.EventListener.list.push(new volantisEventListener(c, f, this.ele))
      }
      return this.ele
    }
    this.ele.click = (f, r) => {
      this.ele.on("click", f, r)
      return this.ele
    }
    this.ele.scroll = (f, r) => {
      this.ele.on("scroll", f, r)
      return this.ele
    }
    // ==============================================================
    this.ele.html = (c) => {
      // if(c=== undefined){
      //   return this.ele.innerHTML
      // }else{
      this.ele.innerHTML = c
      return this.ele
      // }
    }
    // ==============================================================
    this.ele.hide = (c) => {
      this.ele.style.display = "none"
      return this.ele
    }
    this.ele.show = (c) => {
      this.ele.style.display = "block"
      return this.ele
    }
    // ==============================================================
    return this.ele
  }
  volantis.dom.$ = (ele) => {
    return !!ele ? new volantisDom(ele) : null;
  }
  /******************** RunItem ********************************/
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = ()=>{
          volantis.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) =>{
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index,1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }
  /******************** Pjax ********************************/
  // /layout/_plugins/pjax/index.ejs
  // volantis.pjax.send(callBack[,"callBackName"]) 传入pjax:send回调函数
  // volantis.pjax.push(callBack[,"callBackName"]) 传入pjax:complete回调函数
  // volantis.pjax.error(callBack[,"callBackName"]) 传入pjax:error回调函数
  volantis.pjax = {};
  volantis.pjax.method = {
    complete: new RunItem(),
    error: new RunItem(),
    send: new RunItem(),
  };
  volantis.pjax = Object.assign(volantis.pjax, {
    push: volantis.pjax.method.complete.push,
    error: volantis.pjax.method.error.push,
    send: volantis.pjax.method.send.push,
  });
  /******************** RightMenu ********************************/
  // volantis.rightmenu.handle(callBack[,"callBackName"]) 外部菜单项控制
  // 可在 volantis.mouseEvent 处获取右键事件
  volantis.rightmenu = {};
  volantis.rightmenu.method = {
    handle: new RunItem(),
  }
  volantis.rightmenu = Object.assign(volantis.rightmenu, {
    handle: volantis.rightmenu.method.handle.push,
  });
  /********************  Dark Mode  ********************************/
  // /layout/_partial/scripts/darkmode.ejs
  // volantis.dark.mode 当前模式 dark or light
  // volantis.dark.toggle() 暗黑模式触发器
  // volantis.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  volantis.dark = {};
  volantis.dark.method = {
    toggle: new RunItem(),
  };
  volantis.dark = Object.assign(volantis.dark, {
    push: volantis.dark.method.toggle.push,
  });
  /********************  Message  ********************************/
  // VolantisApp.message
  /********************  isMobile  ********************************/
  // /source/js/app.js
  // volantis.isMobile
  // volantis.isMobileOld
  /********************脚本动态加载函数********************************/
  // volantis.js(src, cb)  cb 可以传入onload回调函数 或者 JSON对象 例如: volantis.js("src", ()=>{}) 或 volantis.js("src", {defer:true,onload:()=>{}})
  // volantis.css(src)

  // 返回Promise对象，如下方法同步加载资源，这利于处理文件资源之间的依赖关系，例如：APlayer 需要在 MetingJS 之前加载
  // (async () => {
  //     await volantis.js("...theme.plugins.aplayer.js.aplayer...")
  //     await volantis.js("...theme.plugins.aplayer.js.meting...")
  // })();

  // 已经加入了setTimeout
  volantis.js = (src, cb) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }
  volantis.css = (src) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  }
  /********************按需加载的插件********************************/
  // volantis.import.jQuery().then(()=>{})
  volantis.import = {
    jQuery: () => {
      if (typeof jQuery == "undefined") {
        return volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/jquery/dist/jquery.min.js")
      } else {
        return new Promise(resolve => {
          resolve()
        });
      }
    }
  }
  /********************** requestAnimationFrame ********************************/
  // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
  // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
  volantis.requestAnimationFrame = (fn)=>{
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
    }
    window.requestAnimationFrame(fn)
  }
  /************************ layoutHelper *****************************************/
  volantis.layoutHelper = (helper, html, opt)=>{
    opt = Object.assign({clean:false, pjax:true}, opt)
    function myhelper(helper, html, clean) {
      volantis.tempDiv = document.createElement("div");
      volantis.tempDiv.innerHTML = html;
      let layoutHelper = document.querySelector("#layoutHelper-"+helper)
      if (layoutHelper) {
        if (clean) {
          layoutHelper.innerHTML = ""
        }
        layoutHelper.append(volantis.tempDiv);
      }
    }
    myhelper(helper, html, opt.clean)
    if (opt.pjax) {
      volantis.pjax.push(()=>{
        myhelper(helper, html, opt.clean)
      },"layoutHelper-"+helper)
    }
  }
  /****************************** 滚动事件处理 ****************************************/
  volantis.scroll = {
    engine: new RunItem(),
    unengine: new RunItem(),
  };
  volantis.scroll = Object.assign(volantis.scroll, {
    push: volantis.scroll.engine.push,
  });
  // 滚动条距离顶部的距离
  volantis.scroll.getScrollTop = () =>{
    let scrollPos;
    if (window.pageYOffset) {
      scrollPos = window.pageYOffset;
    } else if (document.compatMode && document.compatMode != 'BackCompat') {
      scrollPos = document.documentElement.scrollTop;
    } else if (document.body) {
      scrollPos = document.body.scrollTop;
    }
    return scrollPos;
  }
  // 使用 requestAnimationFrame 处理滚动事件
  // `volantis.scroll.del` 中存储了一个数值, 该数值检测一定时间间隔内滚动条滚动的位移, 数值的检测频率是浏览器的刷新频率. 数值为正数时, 表示向下滚动. 数值为负数时, 表示向上滚动.
  volantis.scroll.handleScrollEvents = () => {
    volantis.scroll.lastScrollTop = volantis.scroll.getScrollTop()
    function loop() {
      const scrollTop = volantis.scroll.getScrollTop();
      if (volantis.scroll.lastScrollTop !== scrollTop) {
        volantis.scroll.del = scrollTop - volantis.scroll.lastScrollTop;
        volantis.scroll.lastScrollTop = scrollTop;
        // if (volantis.scroll.del > 0) {
        //   console.log("向下滚动");
        // } else {
        //   console.log("向上滚动");
        // }
        // 注销过期的unengine未滚动事件
        volantis.scroll.unengine.list=[]
        volantis.scroll.engine.start();
      }else{
        volantis.scroll.unengine.start();
      }
      volantis.requestAnimationFrame(loop)
    }
    volantis.requestAnimationFrame(loop)
  }
  volantis.scroll.handleScrollEvents()
  // 触发页面滚动至目标元素位置
  volantis.scroll.to = (ele, option = {}) =>{
    // 默认配置
    opt = {
      top: ele.getBoundingClientRect().top + document.documentElement.scrollTop,
      behavior: "smooth"
    }
    // 定义配置
    if ("top" in option) {
      opt.top = option.top
    }
    if ("behavior" in option) {
      opt.behavior = option.behavior
    }
    if ("addTop" in option) {
      opt.top += option.addTop
    }
    if (!("observerDic" in option)) {
      option.observerDic = 100
    }
    // 滚动
    window.scrollTo(opt);
    // 监视器
    // 监视并矫正元素滚动到指定位置
    // 用于处理 lazyload 引起的 cls 导致的定位失败问题
    // option.observer = false
    if (option.observer) {
      setTimeout(()=>{
        volantis.scroll.unengine.push(()=>{
          let me = ele.getBoundingClientRect().top
          if(!(me >= -option.observerDic && me <= option.observerDic)){
            volantis.scroll.to(ele, option)
          }
          volantis.scroll.unengine.remove("unengineObserver")
        },"unengineObserver")
      },1000)
    }
  }
  /********************** Content Visibility ********************************/
  // 见 source/css/first.styl 如果遇到任何问题 删除 .post-story 即可
  // 一个元素被声明 content-visibility 属性后 如果元素不在 viewport 中 浏览器不会计算其后代元素样式和属性 从而节省 Style & Layout 耗时
  // content-visibility 的副作用: 锚点失效 等等(实验初期 暂不明确), 使用此方法清除样式
  volantis.cleanContentVisibility = ()=>{
    if (document.querySelector(".post-story")) {
      console.log("cleanContentVisibility");
      document.querySelectorAll(".post-story").forEach(e=>{
        e.classList.remove("post-story")
      })
    }
  }
  /******************************************************************************/
  /******************************************************************************/
  /******************************************************************************/
  //图像加载出错时的处理
  function errorImgAvatar(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/avatar/round/3442075.svg";
    img.onerror = null;
  }
  function errorImgCover(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1654736714924/media/placeholder/cover/76b86c0226ffd.svg";
    img.onerror = null;
  }
  /******************************************************************************/
</script>

  <!-- import head_end begin -->
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  
  <!-- Custom Files headEnd end-->
</head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <!-- import body_begin begin-->
    <!-- import body_begin end-->
    <!-- Custom Files bodyBegin begin-->
    
    <!-- Custom Files bodyBegin end-->
    <header itemscope itemtype="http://schema.org/WPHeader" id="l_header" class="l_header auto shadow floatable blur show" style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self"  href="/" onclick="return false;" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self"  href="/" onclick="return false;" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
            ShanSan
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博文"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博文
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                 href="/" onclick="return false;" title="与我相关"
                  
                  
                  >
                  <i class='fas fa-ellipsis-v fa-fw'></i>与我相关
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://github.com/yeshan333" title="Github"
                  
                  
                  
                    active-action="action-https:githubcomyeshan333"
                  >
                  <i class='fab fa-github-square fa-fw'></i>Github
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://slides.shan333.cn" title="slides"
                  
                  
                  
                    active-action="action-https:slidesshan333cn"
                  >
                  <i class='fab fa-slideshare fa-fw'></i>slides
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://shansan.top/knowledge-base/" title="notes"
                  
                  
                  
                    active-action="action-https:shansantopknowledge-base"
                  >
                  <i class='far fa-sticky-note fa-fw'></i>notes
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://stats.uptimerobot.com/OknEPcNEVr" title="Monitor"
                  
                  
                  
                    active-action="action-https:statsuptimerobotcomOknEPcNEVr"
                  >
                  Monitor
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/cloud-native/" title="云原生"
                  
                  
                  
                    active-action="action-cloud-native"
                  >
                  <i class='fas fa-cloud fa-fw'></i>云原生
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="寻你所想" />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" href="/" onclick="return false;" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" href="/" onclick="return false;" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/" title="博文"
                  
                  
                  
                    active-action="action-home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博文
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/archives/" title="归档"
                  
                  
                  
                    active-action="action-archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/friends/" title="友链"
                  
                  
                  
                    active-action="action-friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/about/" title="关于"
                  
                  
                  
                    active-action="action-about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                 href="/" onclick="return false;" title="与我相关"
                  
                  
                  >
                  <i class='fas fa-ellipsis-v fa-fw'></i>与我相关
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://github.com/yeshan333" title="Github"
                  
                  
                  
                    active-action="action-https:githubcomyeshan333"
                  >
                  <i class='fab fa-github-square fa-fw'></i>Github
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://slides.shan333.cn" title="slides"
                  
                  
                  
                    active-action="action-https:slidesshan333cn"
                  >
                  <i class='fab fa-slideshare fa-fw'></i>slides
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://shansan.top/knowledge-base/" title="notes"
                  
                  
                  
                    active-action="action-https:shansantopknowledge-base"
                  >
                  <i class='far fa-sticky-note fa-fw'></i>notes
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                target="_blank" rel="noopener" href="https://stats.uptimerobot.com/OknEPcNEVr" title="Monitor"
                  
                  
                  
                    active-action="action-https:statsuptimerobotcomOknEPcNEVr"
                  >
                  Monitor
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/cloud-native/" title="云原生"
                  
                  
                  
                    active-action="action-cloud-native"
                  >
                  <i class='fas fa-cloud fa-fw'></i>云原生
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
      <!-- see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs -->
      <div id="none" class='cover-wrapper post dock' style="display: none;">
        
  <div class='cover-bg lazyload placeholder' data-bg="https://gcore.jsdelivr.net/gh/ssmath/picgo-pic/img/20210310142425.png"></div>

<div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">More & Less</p>
    
    
      <p class="subtitle">created by yeshan333</p>
    
  </div>
  <div class='bottom'>
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/archives/"
              
              
              active-action="action-archives">
              <img src='https://gcore.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f5c3.svg'><p>博文</p>
            </a>
          
            <a href="/about/"
              
              
              active-action="action-about">
              <img src='https://gcore.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f0cf.svg'><p>关于我</p>
            </a>
          
            <a href="/friends/"
              
              
              active-action="action-friends">
              <img src='https://gcore.jsdelivr.net/gh/twitter/twemoji@13.0/assets/svg/1f9ec.svg'><p>友链</p>
            </a>
          
            <a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"
              
              
              active-action="action-https:wwwtravellingscngohtml">
              <img src='https://www.travellings.cn/assets/travelling-dark.png'><p>开往</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

        <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
      </div>
    
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="http://schema.org/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/">
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ShanSan">
  </span>
  <span hidden itemprop="post" itemscope itemtype="http://schema.org/Post">
    <meta itemprop="name" content="ShanSan">
    <meta itemprop="description" content="ShanSan's Blog">
  </span>
  


  
    <div class='headimg-div'>
      <a class='headimg-a'>
        <img itemprop="image" class='headimg' src='https://s1.ax1x.com/2022/11/04/xO9340.png'/>
      </a>
    </div>
  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title" itemprop="name headline">
        the-solution-of-elixir-continuous-runtime-system-code-coverage-collection
      </h1>
      <div class='new-meta-box'>
        
          
            
<div class='new-meta-item author' itemprop="author" itemscope itemtype="http://schema.org/Person">
  <a itemprop="url" class='author' target="_blank" href="https://github.com/yeshan333" rel="nofollow noopener">
    <img itemprop="image" src="https://z3.ax1x.com/2021/11/07/I1qTFx.png" class="lazyload" data-srcset="https://z3.ax1x.com/2021/11/07/I1qTFx.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
    <p itemprop="name">yeshan333</p>
  </a>
</div>

          
        
          
            
  <div class='new-meta-item category'>
    <i class="fa-solid fa-folder-open fa-fw" aria-hidden="true"></i>
    <a class="category-link" href="/categories/Elixir/">Elixir</a>
    
      <span hidden itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/Elixir/" itemprop="url"><span itemprop="name">Elixir</span></a>
      </span>
    
  </div>


          
        
          
            <div class="new-meta-item date" itemprop="dateCreated datePublished" datetime="2022-08-31T22:43:10+00:00">
  <a class='notlink'>
    <i class="fa-solid fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2022年8月31日</p>
  </a>
</div>

          
        
          
            


<div class="new-meta-item browse">
  <a class='notlink'>
    <p>
      <i class="fa-solid fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="busuanzi_value_page_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
      
      <span>次浏览</span>
    </p>
  </a>
</div>


          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/yeshan333/explore_ast_app/blob/main/examples/README_cn.md">zh_hans</a></p>
</blockquote>
<p>Code coverage is an effective means to assist software engineers in verifying code quality. The runtime environment’s ability to collect code coverage fully combines black and white box testing capabilities and greatly increases engineers’ confidence in software quality. This article introduces a solution for code coverage collection in the Elixir runtime environment, and provides an in-depth insight into its internal principles.</p>
<h2 id="1-Brief-talk-on-code-coverage"><a href="#1-Brief-talk-on-code-coverage" class="headerlink" title="1. Brief talk on code coverage"></a>1. Brief talk on code coverage</h2><p>As a <a target="_blank" rel="noopener" href="https://hvitis.dev/google-qa-testing-article-on-manual-and-automation-test-engineers-sdet">SDET</a> or a SWE, we often need to write unit tests or integration test cases to verify the correctness of the system&#x2F;application, but at the same time we often question whether our tests are adequate. At this time, test coverage is a means of measuring the adequacy of our testing, enhancing the success rate and confidence of the software release, and giving us more reflective perspectives. The note of the value is that high code coverage does not indicate high code quality, but conversely, code coverage is low, and code quality will not be high.</p>
<p>Most programming languages come with the ability to collect unit test coverage, and the same is true for Elixir, the official <a target="_blank" rel="noopener" href="https://hexdocs.pm/mix/1.13.4/Mix.Tasks.Test.html#module-coverage">mix</a> build tool comes with the ability to collect coverage, but it is currently only suitable for offline system, not for runtime system. This article will be based on Erlang’s cover module to give a solution for the Elixir runtime system. Since <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/cover.html">cover</a> is Erlang’s built-in module, but why it works equally well with Elixir, we’ll unveil its mystery in a follow-up. Before we get started, let’s take a look at the two mainstream ways in which the open source community collects code coverage at runtime (here we look at the bytecode stubbing method of Java, which has a huge ecosystem of the language community):</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/java_bytecode_tecs.png" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/java_bytecode_tecs.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="java_bytecode_tecs"></p>
<p>Next let’s focus on the core of elixir runtime coverage collection in this article - the cover module.</p>
<h2 id="2-Delve-into-the-Erlang-Cover-coverage-collection-implementation-mechanism"><a href="#2-Delve-into-the-Erlang-Cover-coverage-collection-implementation-mechanism" class="headerlink" title="2. Delve into the Erlang Cover coverage collection implementation mechanism"></a>2. Delve into the Erlang Cover coverage collection implementation mechanism</h2><h3 id="2-1-Introduction-Erlang-Cover"><a href="#2-1-Introduction-Erlang-Cover" class="headerlink" title="2.1. Introduction Erlang Cover"></a>2.1. Introduction Erlang Cover</h3><p><a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/cover.html">cover</a> is part of Erlang’s built-in tools set, providing a powerful ability to collect code coverage.</p>
<h3 id="2-2-Erlang-code-coverage-collection-implementation-analysis"><a href="#2-2-Erlang-code-coverage-collection-implementation-analysis" class="headerlink" title="2.2. Erlang code coverage collection implementation analysis"></a>2.2. Erlang code coverage collection implementation analysis</h3><p>As you can see from Erlang’s official manual of the cover module, cover counts the number of times every executable line in the Erlang program is executed.</p>
<p>From the introduction of the official documentation, cover can be used for code coverage collection of the runtime system. When the code is instrumented, it does not modify the code source files of any modules or the beam files generated after compilation (that is the industry calls the On-The-Fly mode). Every time the executable row is called, the runtime system updates the number of calls to cover in an in-memory database (erlang ets) for storing data for subsequent coverage analysis.</p>
<p>Next, we’ll explore the details of the On-The-Fly mode under cover.</p>
<h3 id="2-3-Learn-about-BEAM-File-Format"><a href="#2-3-Learn-about-BEAM-File-Format" class="headerlink" title="2.3. Learn about BEAM File Format"></a>2.3. Learn about BEAM File Format</h3><p>Before we can further understand the details of the cover implementation, it is necessary to understand the format of the BEAM file after the elixir source code is compiled. The compiled product of the Elixir (.ex file), like the Erlang (.erl file), is a binary chunked file, which is divided into several sections to store information used when the program runs (such as virtual machine operation instructions). In Erlang&#x2F;Elixir, each module will have a corresponding BEAM file. The approximate structure of the BEAM file is as follows:</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/beam_file_format.png" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/beam_file_format.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="beam_file_format"></p>
<p>Let’s take a look at the approximate content of the beam file through an Elixir mini <a target="_blank" rel="noopener" href="https://github.com/yeshan333/explore_ast_app">demo</a> project:</p>
<ul>
<li>Step 1. Clone the project <a target="_blank" rel="noopener" href="https://github.com/yeshan333/explore_ast_app">yeshan333&#x2F;explore_ast_app</a> to the local:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/yeshan333/explore_ast_app.git</span><br><span class="line">cd explore_ast_app</span><br></pre></td></tr></table></figure>

<ul>
<li>Step 2. Build this project in <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/design_principles/release_structure.html">OTP release format</a>. (note: Elixir and Erlang need to be installed locally):</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MIX_ENV=prod mix distillery.release</span><br></pre></td></tr></table></figure>

<p>It can be noted that each Elixir module is compiled into a BEAM file (can be seen in the directory <code>_build/prod/rel/explore_ast_app/lib/explore_ast_app-0.1.0/ebin</code>).</p>
<ul>
<li>Step 3. Next, let’s view the chunks in the Beam file through Erlang’s standard library <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/beam_lib.html#">beam_lib</a>:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">open the iex console</span></span><br><span class="line">iex -S mix</span><br></pre></td></tr></table></figure>

<p>View all chunks of the compiled BEAM file (<code>Elixir.ExploreAstApp.beam</code>):</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>iex -S mix</span><br><span class="line"><span class="title class_">Erlang</span>/<span class="title class_">OTP</span> <span class="number">24</span> [erts<span class="number">-12.1</span>] [source] [<span class="number">64</span>-bit] [<span class="symbol">smp:</span><span class="number">12</span><span class="symbol">:</span><span class="number">12</span>] [<span class="symbol">ds:</span><span class="number">12</span><span class="symbol">:</span><span class="number">12</span><span class="symbol">:</span><span class="number">10</span>] [async-<span class="symbol">threads:</span><span class="number">1</span>] [jit] [dtrace]</span><br><span class="line"></span><br><span class="line"><span class="title class_">Interactive</span> <span class="title class_">Elixir</span> (<span class="number">1.12</span>.<span class="number">3</span>) - press <span class="title class_">Ctrl</span>+C to exit (type h() <span class="title class_">ENTER</span> <span class="keyword">for</span> help)</span><br><span class="line">iex(<span class="number">1</span>)&gt; beam_file_path = <span class="string">&quot;_build/prod/rel/explore_ast_app/lib/explore_ast_app-0.1.0/ebin/Elixir.ExploreAstApp.beam&quot;</span></span><br><span class="line"><span class="string">&quot;_build/prod/rel/explore_ast_app/lib/explore_ast_app-0.1.0/ebin/Elixir.ExploreAstApp.beam&quot;</span></span><br><span class="line">iex(<span class="number">2</span>)&gt; all_chunks = <span class="symbol">:beam_lib</span>.all_chunks(<span class="title class_">String</span>.to_charlist(beam_file_path))</span><br><span class="line">&#123;<span class="symbol">:ok</span>, <span class="title class_">ExploreAstApp</span>,</span><br><span class="line"> [</span><br><span class="line">   &#123;<span class="string">&#x27;AtU8&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">69</span>, <span class="number">108</span>, <span class="number">105</span>, <span class="number">120</span>, <span class="number">105</span>, <span class="number">114</span>, <span class="number">46</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">112</span>, <span class="number">108</span>, <span class="number">111</span>,</span><br><span class="line">      <span class="number">114</span>, <span class="number">101</span>, <span class="number">65</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">65</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">8</span>, <span class="number">95</span>, <span class="number">95</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">102</span>, <span class="number">111</span>, <span class="number">95</span>,</span><br><span class="line">      <span class="number">95</span>, <span class="number">10</span>, <span class="number">97</span>, <span class="number">116</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">98</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">101</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;Code&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">169</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">16</span>,</span><br><span class="line">      <span class="number">153</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">34</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">32</span>, <span class="number">59</span>, <span class="number">3</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">117</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">82</span>,</span><br><span class="line">      <span class="number">101</span>, <span class="number">98</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;StrT&#x27;</span>, <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;ImpT&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">12</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;ExpT&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;LitT&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">52</span>, <span class="number">120</span>, <span class="number">156</span>, <span class="number">99</span>, <span class="number">96</span>, <span class="number">96</span>, <span class="number">96</span>, <span class="number">98</span>, <span class="number">96</span>, <span class="number">96</span>, <span class="number">16</span>, <span class="number">106</span>, <span class="number">206</span>, <span class="number">1</span>, <span class="number">146</span>,</span><br><span class="line">      <span class="number">140</span>, <span class="number">25</span>, <span class="number">76</span>, <span class="number">229</span>, <span class="number">172</span>, <span class="number">25</span>, <span class="number">169</span>, <span class="number">57</span>, <span class="number">57</span>, <span class="number">249</span>, <span class="number">137</span>, <span class="number">12</span>, <span class="number">89</span>, <span class="number">64</span>, <span class="number">190</span>, <span class="number">88</span>,</span><br><span class="line">      <span class="number">115</span>, <span class="number">46</span>, <span class="number">144</span>, <span class="number">20</span>, <span class="number">248</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;LocT&#x27;</span>, &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;Attr&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">131</span>, <span class="number">108</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">104</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">118</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">108</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">110</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">165</span>, <span class="number">236</span>, <span class="number">94</span>, <span class="number">47</span>, <span class="number">119</span>, <span class="number">160</span>, <span class="number">184</span>, <span class="number">33</span>, <span class="number">240</span>, <span class="number">28</span>, <span class="number">89</span>, <span class="number">11</span>, <span class="number">22</span>, <span class="number">130</span>,</span><br><span class="line">      <span class="number">207</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;CInf&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">131</span>, <span class="number">108</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">104</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">118</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">105</span>, <span class="number">111</span>,</span><br><span class="line">      <span class="number">110</span>, <span class="number">107</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">56</span>, <span class="number">46</span>, <span class="number">48</span>, <span class="number">46</span>, <span class="number">51</span>, <span class="number">104</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">105</span>,</span><br><span class="line">      <span class="number">111</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;Dbgi&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">131</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">120</span>, <span class="number">156</span>, <span class="number">117</span>, <span class="number">80</span>, <span class="number">203</span>, <span class="number">78</span>, <span class="number">3</span>, <span class="number">49</span>, <span class="number">12</span>, <span class="number">76</span>, <span class="number">233</span>, <span class="number">67</span>,</span><br><span class="line">      <span class="number">162</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">65</span>, <span class="number">124</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">253</span>, <span class="number">2</span>, <span class="number">212</span>, <span class="number">67</span>, <span class="number">63</span>, <span class="number">129</span>, <span class="number">115</span>, <span class="number">148</span>, <span class="number">221</span>,</span><br><span class="line">      <span class="number">120</span>, ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;Docs&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">131</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">241</span>, <span class="number">120</span>, <span class="number">156</span>, <span class="number">93</span>, <span class="number">142</span>, <span class="number">205</span>, <span class="number">10</span>, <span class="number">194</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">132</span>, <span class="number">215</span>,</span><br><span class="line">      <span class="number">74</span>, <span class="number">91</span>, <span class="number">9</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">129</span>, <span class="number">94</span>, <span class="number">244</span>, <span class="number">82</span>, <span class="number">241</span>, <span class="number">234</span>, <span class="number">65</span>, <span class="number">40</span>, <span class="number">88</span>, <span class="number">241</span>, <span class="number">45</span>, <span class="number">108</span>,</span><br><span class="line">      ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;ExCk&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">131</span>, <span class="number">104</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">105</span>, <span class="number">120</span>, <span class="number">105</span>, <span class="number">114</span>, <span class="number">95</span>, <span class="number">99</span>, <span class="number">104</span>, <span class="number">101</span>,</span><br><span class="line">      <span class="number">99</span>, <span class="number">107</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">49</span>, <span class="number">116</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">101</span>, <span class="number">120</span>,</span><br><span class="line">      ...&gt;&gt;&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;Line&#x27;</span>,</span><br><span class="line">    &lt;&lt;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">18</span>, <span class="number">241</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">22</span>, <span class="number">108</span>, <span class="number">105</span>, <span class="number">98</span>, <span class="number">47</span>, <span class="number">101</span>, <span class="number">120</span>, <span class="number">112</span>, <span class="number">108</span>, ...&gt;&gt;&#125;</span><br><span class="line"> ]&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, the obtained chunks correspond to the previous diagram. We can also obtain the Erlang AST (abstract syntax tree) corresponding to the module (<code>ExploreAstApp</code>) through the beam_lib standard library:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">iex(<span class="number">3</span>)&gt; result = <span class="symbol">:beam_lib</span>.chunks(<span class="title class_">String</span>.to_charlist(beam_file_path), [<span class="symbol">:abstract_code</span>])</span><br><span class="line">&#123;<span class="symbol">:ok</span>,</span><br><span class="line"> &#123;<span class="title class_">ExploreAstApp</span>,</span><br><span class="line">  [</span><br><span class="line">    <span class="symbol">abstract_code:</span> &#123;<span class="symbol">:raw_abstract_v1</span>,</span><br><span class="line">     [</span><br><span class="line">       &#123;<span class="symbol">:attribute</span>, <span class="number">1</span>, <span class="symbol">:file</span>, &#123;<span class="string">&#x27;lib/explore_ast_app.ex&#x27;</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">       &#123;<span class="symbol">:attribute</span>, <span class="number">1</span>, <span class="symbol">:module</span>, <span class="title class_">ExploreAstApp</span>&#125;,</span><br><span class="line">       &#123;<span class="symbol">:attribute</span>, <span class="number">1</span>, <span class="symbol">:compile</span>, [<span class="symbol">:no_auto_import</span>]&#125;,</span><br><span class="line">       &#123;<span class="symbol">:attribute</span>, <span class="number">1</span>, <span class="symbol">:export</span>, [<span class="symbol">__info__:</span> <span class="number">1</span>, <span class="symbol">hello:</span> <span class="number">0</span>]&#125;,</span><br><span class="line">       &#123;<span class="symbol">:attribute</span>, <span class="number">1</span>, <span class="symbol">:spec</span>,</span><br><span class="line">        &#123;&#123;<span class="symbol">:__info__</span>, <span class="number">1</span>&#125;,</span><br><span class="line">         [</span><br><span class="line">           &#123;<span class="symbol">:type</span>, <span class="number">1</span>, <span class="symbol">:fun</span>,</span><br><span class="line">            [</span><br><span class="line">              &#123;<span class="symbol">:type</span>, <span class="number">1</span>, <span class="symbol">:product</span>,</span><br><span class="line">               [</span><br><span class="line">                 &#123;<span class="symbol">:type</span>, <span class="number">1</span>, <span class="symbol">:union</span>,</span><br><span class="line">                  [</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:attributes</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:compile</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:functions</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:macros</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:md5</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:exports_md5</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:module</span>&#125;,</span><br><span class="line">                    &#123;<span class="symbol">:atom</span>, <span class="number">1</span>, <span class="symbol">:deprecated</span>&#125;</span><br><span class="line">                  ]&#125;</span><br><span class="line">               ]&#125;,</span><br><span class="line">              &#123;<span class="symbol">:type</span>, <span class="number">1</span>, <span class="symbol">:any</span>, []&#125;</span><br><span class="line">            ]&#125;</span><br><span class="line">         ]&#125;&#125;,</span><br><span class="line">       &#123;<span class="symbol">:function</span>, <span class="number">0</span>, <span class="symbol">:__info__</span>, <span class="number">1</span>,</span><br><span class="line">        [</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:module</span>&#125;], [], [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="title class_">ExploreAstApp</span>&#125;]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:functions</span>&#125;], [],</span><br><span class="line">           [</span><br><span class="line">             &#123;<span class="symbol">:cons</span>, <span class="number">0</span>, &#123;<span class="symbol">:tuple</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:hello</span>&#125;, &#123;<span class="symbol">:integer</span>, <span class="number">0</span>, <span class="number">0</span>&#125;]&#125;,</span><br><span class="line">              &#123;<span class="literal">nil</span>, <span class="number">0</span>&#125;&#125;</span><br><span class="line">           ]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:macros</span>&#125;], [], [<span class="symbol">nil:</span> <span class="number">0</span>]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:exports_md5</span>&#125;], [],</span><br><span class="line">           [</span><br><span class="line">             &#123;<span class="symbol">:bin</span>, <span class="number">0</span>,</span><br><span class="line">              [</span><br><span class="line">                &#123;<span class="symbol">:bin_element</span>, <span class="number">0</span>,</span><br><span class="line">                 &#123;<span class="symbol">:string</span>, <span class="number">0</span>,</span><br><span class="line">                  [<span class="number">240</span>, <span class="number">105</span>, <span class="number">247</span>, <span class="number">119</span>, <span class="number">22</span>, <span class="number">50</span>, <span class="number">219</span>, <span class="number">207</span>, <span class="number">90</span>, <span class="number">95</span>, <span class="number">127</span>, <span class="number">92</span>, ...]&#125;,</span><br><span class="line">                 <span class="symbol">:default</span>, <span class="symbol">:default</span>&#125;</span><br><span class="line">              ]&#125;</span><br><span class="line">           ]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:match</span>, <span class="number">0</span>, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:attributes</span>&#125;&#125;],</span><br><span class="line">           [],</span><br><span class="line">           [</span><br><span class="line">             &#123;<span class="symbol">:call</span>, <span class="number">0</span>,</span><br><span class="line">              &#123;<span class="symbol">:remote</span>, <span class="number">0</span>, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:erlang</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:get_module_info</span>&#125;&#125;,</span><br><span class="line">              [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="title class_">ExploreAstApp</span>&#125;, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;]&#125;</span><br><span class="line">           ]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:match</span>, <span class="number">0</span>, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:compile</span>&#125;&#125;], [],</span><br><span class="line">           [</span><br><span class="line">             &#123;<span class="symbol">:call</span>, <span class="number">0</span>,</span><br><span class="line">              &#123;<span class="symbol">:remote</span>, <span class="number">0</span>, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:erlang</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:get_module_info</span>&#125;&#125;,</span><br><span class="line">              [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="title class_">ExploreAstApp</span>&#125;, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;]&#125;</span><br><span class="line">           ]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:match</span>, <span class="number">0</span>, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:md5</span>&#125;&#125;], [],</span><br><span class="line">           [</span><br><span class="line">             &#123;<span class="symbol">:call</span>, <span class="number">0</span>,</span><br><span class="line">              &#123;<span class="symbol">:remote</span>, <span class="number">0</span>, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:erlang</span>&#125;, &#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:get_module_info</span>&#125;&#125;,</span><br><span class="line">              [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="title class_">ExploreAstApp</span>&#125;, &#123;<span class="symbol">:var</span>, <span class="number">0</span>, <span class="symbol">:Key</span>&#125;]&#125;</span><br><span class="line">           ]&#125;,</span><br><span class="line">          &#123;<span class="symbol">:clause</span>, <span class="number">0</span>, [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:deprecated</span>&#125;], [], [<span class="symbol">nil:</span> <span class="number">0</span>]&#125;</span><br><span class="line">        ]&#125;,</span><br><span class="line">       &#123;<span class="symbol">:function</span>, <span class="number">15</span>, <span class="symbol">:hello</span>, <span class="number">0</span>, [&#123;<span class="symbol">:clause</span>, <span class="number">15</span>, [], [], [&#123;<span class="symbol">:atom</span>, <span class="number">0</span>, <span class="symbol">:world</span>&#125;]&#125;]&#125;</span><br><span class="line">     ]&#125;</span><br><span class="line">  ]&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>It can be seen that AST is expressed in the form of <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/reference_manual/data_types.html#terms">Erlang Terms</a> (called Abstract Code), which is easy to read. The Abstract Code is very useful in the on-the-fly instrumentation process of cover.</p>
<p>The above AST structure is simple and easy to read, and we can easily match it with the source code (<code>lib/explore_ast_app.ex</code>) before the module is compiled, although the AST structure is the final Erlang AST, and some extras information are added by the Erlang compiler, but does not affect reading:</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/ex_source_ast_code_mapper.png" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/ex_source_ast_code_mapper.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="ex_source_ast_code_mapper"></p>
<p>The second element in the tuple generally represents the number of source code lines. You can learn more about Erlang’s Abstract Format through the official documentation. By observing the Erlang AST structure of several BEAM files, you will be familiar with it. It is worth noting that the Abstract Code was stored in the Abstract Chunk of the BEAM file before OTP 20.</p>
<p>If you want to learn more about BEAM files in detail, you can check out the following two documents:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://beam-wisdoms.clau.se/en/latest/indepth-beam-file.html#beam-term-format">http://beam-wisdoms.clau.se/en/latest/indepth-beam-file.html#beam-term-format</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.stenmans.org/theBeamBook/#BEAM_files">https://blog.stenmans.org/theBeamBook/#BEAM_files</a></li>
</ul>
<h3 id="2-4-Elixir-source-code-compilation-process"><a href="#2-4-Elixir-source-code-compilation-process" class="headerlink" title="2.4. Elixir source code compilation process"></a>2.4. Elixir source code compilation process</h3><p>After understanding BEAM File Format, we also need to understand the compilation process of Elixir code, which will help us better understand cover. The process of compiling Elixir source code into BEAM file may not be as you imagined In the same way, instead of directly from Elixir’s AST, it becomes executable BEAM Code after being processed by the compiler backend. There is also a process in the middle, as shown in the following figure:</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/Elixir-Compilation.jpg" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/Elixir-Compilation.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Elixir-Compilation-Process"></p>
<p>The above process can be described as:</p>
<ul>
<li><p>Step 1、The Elixir source code will be parsed by a custom lexical analyzer (<a target="_blank" rel="noopener" href="https://github.com/elixir-lang/elixir/blob/main/lib/elixir/src/elixir_tokenizer.erl">elixir_tokenizer</a>) and <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/yecc.html">yacc</a> to generate the initial version of Elixir AST, which is expressed in the form of Elixir Terms; if you are interested in Elixir’s AST, you can follow this Project <a target="_blank" rel="noopener" href="https://github.com/arjan/ast_ninja">arjan&#x2F;ast_ninja</a>;</p>
</li>
<li><p>Step 2、In the Elixir AST stage, some custom and built-in Macros have not been expanded, and these Macros are expanded into the final Elixir AST in the Expanded Elixir AST stage;</p>
</li>
<li><p>Step 3、Final Elixir AST will be converted into Erlang standard AST form (<a target="_blank" rel="noopener" href="https://www.erlang.org/doc/apps/erts/absform.html">Erlang Abstract Format</a>) after being processed by Elixir Compiler;</p>
</li>
<li><p>Step 4、Finally, Elixir will use the Erlang Compiler to process the Erlang AST, converting it into BEAM bytecode executable by the BEAM Virtual Machine (VM). For details on the compiler, see: <a target="_blank" rel="noopener" href="https://github.com/elixir-lang/elixir/blob/main/lib/elixir/src/elixir_compiler.erl">elixir_compiler.erl</a> and <a target="_blank" rel="noopener" href="https://github.com/elixir-lang/elixir/blob/main/lib/elixir/src/elixir_erl.erl">elixir_erl.erl</a> source code For more details on the Erlang Compiler, see <a target="_blank" rel="noopener" href="https://blog.stenmans.org/theBeamBook/#CH-Compiler">theBeamBook&#x2F;#CH-Compiler</a>.</p>
</li>
</ul>
<h3 id="2-5-Cover-On-The-Fly-Instrumentation-Implementation"><a href="#2-5-Cover-On-The-Fly-Instrumentation-Implementation" class="headerlink" title="2.5. Cover On-The-Fly Instrumentation Implementation"></a>2.5. Cover On-The-Fly Instrumentation Implementation</h3><p>Now it’s time for dinner. Let’s see how cover performs instrumentation and coverage collection. To use cover to complete code coverage collection, we must know three dragon-slaying swords:</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/swords.jpg" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/swords.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="three dragon-slaying swords"></p>
<ul>
<li><p><code>cover:start</code>: Used to create the cover coverage collection process, it will complete the creation of the relevant ets table to store the coverage data, <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L159">cover.erl#L159</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L632">cover.erl#L632</a>, and we can also start the cover process of the remote Erlang node.</p>
</li>
<li><p><code>cover:compile_beam</code>: For instrumentation, cover will read the content of the abstract_code of the BEAM file, namely Erlang AST. The key code is in <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L1541">cover.erl#L1541</a>, and then transform and munge the Erlang AST From, it will call <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L1938">bump_call</a>, after each executable line will insert the following abstract_code:</p>
</li>
</ul>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;call,A,&#123;remote,A,&#123;atom,A,ets&#125;,&#123;atom,A,update_counter&#125;&#125;,</span><br><span class="line"> [&#123;atom,A,?COVER_TABLE&#125;,</span><br><span class="line">  &#123;tuple,A,[&#123;atom,A,?BUMP_REC_NAME&#125;,</span><br><span class="line">            &#123;atom,A,Vars#vars.module&#125;,</span><br><span class="line">            &#123;atom,A,Vars#vars.function&#125;,</span><br><span class="line">            &#123;integer,A,Vars#vars.arity&#125;,</span><br><span class="line">            &#123;integer,A,Vars#vars.clause&#125;,</span><br><span class="line">            &#123;integer,A,Line&#125;]&#125;,</span><br><span class="line">  &#123;integer,A,<span class="number">1</span>&#125;]&#125;.</span><br></pre></td></tr></table></figure>

<p>From the previous understanding of Erlang AST, we know that this is equivalent to inserting the following line of code:</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ets:update_counter(?COVER_TABLE, #bump&#123;module=Module, function=Function, arity=Arity, clause=Clause, line=Line&#125;, <span class="number">1</span>).</span><br></pre></td></tr></table></figure>

<p>Then for the mungeed Erlang AST Form, cover uses the Erlang Compiler to obtain the Erlang Beam Code (also known as object code. i.e. bytecode, VM execution instructions) from the mungeed AST expression form. <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L1580">cover.erl#L1580</a>. And then use the Erlang <a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/code.html#load_binary-3">code server</a> to replace the old object code with the new object code obtained, <code>load_binary</code> <a target="_blank" rel="noopener" href="https://github.com/erlang/otp/blob/2f0a547f78363a2504405e82e3ab3ea35b9e6a88/lib/tools/src/cover.erl#L1581">cover.erl#L1581</a> into <a target="_blank" rel="noopener" href="https://blog.stenmans.org/theBeamBook/#P-ERTS">ERTS</a> (Erlang Run Time System). cover completes the Erlang AST instrumentation process, so that whenever the executable line is Executed, the corresponding ets storage table will update the number of times the code line was called.</p>
<ul>
<li><code>cover:analyze</code>: Analyze the data stored in the ets table to obtain the number of times the executable line was executed (called), which can be used for statistical coverage data.</li>
</ul>
<blockquote>
<p>munge: Used to make a series of potentially destructive or irreversible changes to data or files.</p>
</blockquote>
<h2 id="3-Elixir-Application-runtime-coverage-collection-example"><a href="#3-Elixir-Application-runtime-coverage-collection-example" class="headerlink" title="3. Elixir Application runtime coverage collection example"></a>3. Elixir Application runtime coverage collection example</h2><p>Through the above, after understanding the implementation details of the Erlang Cover module. Let us take a deployed and running Elixir Application (we will use the previous <a target="_blank" rel="noopener" href="https://github.com/yeshan333/explore_ast_app">yesan333&#x2F;explore_ast_app</a>) as an example to perform large-scale tests (system &amp; integration tests) of the Elixir application runtime of code line-level coverage collection.</p>
<p>Here we will use a tool library: <a target="_blank" rel="noopener" href="https://github.com/yeshan333/ex_integration_coveralls">ex_integration_coveralls</a> for coverage analysis, which is an Elixir Wrapper for the Erlang module cover to collection Elixir runtime system coverage. Let’s start:</p>
<ul>
<li>Step 1、Add <code>ex_integration_coveralls</code> dependency to <code>mix.exs</code> file:</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">defp</span> <span class="title">deps</span></span> <span class="keyword">do</span></span><br><span class="line">  [</span><br><span class="line">    ...,</span><br><span class="line">    &#123;<span class="symbol">:ex_integration_coveralls</span>, <span class="string">&quot;~&gt; 0.3.0&quot;</span>&#125;</span><br><span class="line">  ]</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>Pull the dependencies and rebuild the project:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mix deps.get</span><br><span class="line">MIX_ENV=prod mix distillery.release</span><br></pre></td></tr></table></figure>

<ul>
<li>Step 2、Start the project:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_build/prod/rel/explore_ast_app/bin/explore_ast_app foreground</span><br></pre></td></tr></table></figure>

<ul>
<li>Step 3、Connect to the remote_console of the Elixir runtime application node:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_build/prod/rel/explore_ast_app/bin/explore_ast_app remote_console</span><br></pre></td></tr></table></figure>

<ul>
<li>Step 4、Use <code>ex_integration_coveralls</code> (ExIntegrationCoveralls.execute) to start cover and perform code coverage collection:</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">1</span>&gt; compiled_beam_dir_path = <span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app/_build/prod/rel/explore_ast_app/lib/explore_ast_app-0.1.0/ebin&quot;</span></span><br><span class="line"><span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app/_build/prod/rel/explore_ast_app/lib/explore_ast_app-0.1.0/ebin&quot;</span></span><br><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">2</span>&gt; <span class="title class_">ExIntegrationCoveralls</span>.execute(compiled_beam_dir_path)</span><br><span class="line">[</span><br><span class="line">  <span class="symbol">ok:</span> <span class="title class_">ExploreAstApp</span>.<span class="title class_">Router</span>,</span><br><span class="line">  <span class="symbol">ok:</span> <span class="title class_">ExploreAstApp</span>.<span class="title class_">Plug</span>.<span class="title class_">VerifyRequest</span>.<span class="title class_">IncompleteRequestError</span>,</span><br><span class="line">  <span class="symbol">ok:</span> <span class="title class_">ExploreAstApp</span>.<span class="title class_">Plug</span>.<span class="title class_">VerifyRequest</span>,</span><br><span class="line">  <span class="symbol">ok:</span> <span class="title class_">ExploreAstApp</span>.<span class="title class_">Application</span>,</span><br><span class="line">  <span class="symbol">ok:</span> <span class="title class_">ExploreAstApp</span></span><br><span class="line">]</span><br><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">3</span>&gt; compile_time_source_lib_abs_path = <span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app&quot;</span></span><br><span class="line"><span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app&quot;</span></span><br><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">4</span>&gt; source_code_abs_path = <span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app&quot;</span></span><br><span class="line"><span class="string">&quot;/Users/yeshan/oss_github/explore_ast_app&quot;</span></span><br><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">5</span>&gt; <span class="title class_">ExIntegrationCoveralls</span>.get_total_coverage(compile_time_source_lib_abs_path, source_code_abs_path)</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>As you can see, the initial coverage is 0, because no code has been called yet.</p>
<ul>
<li>Step 5、Let’s execute the following cURL. Let code be called:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl --location --request GET <span class="string">&#x27;http://localhost:8080/hello&#x27;</span></span></span><br><span class="line">hello %</span><br></pre></td></tr></table></figure>

<p>Check out the code coverage data again in iex console:</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">6</span>&gt; <span class="title class_">ExIntegrationCoveralls</span>.get_total_coverage(compile_time_source_lib_abs_path, source_code_abs_path)</span><br><span class="line"><span class="number">17.1</span></span><br></pre></td></tr></table></figure>

<p>As you can see, the cURL (test case) coverage for this project is 17.1%.</p>
<p>We can also use the following methods to view more detailed code coverage, such as viewing the code coverage of <code>lib/explore_ast_app/router.ex</code> (<code>nil</code> means the line is not an executable line):</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">7</span>&gt; result = <span class="title class_">ExIntegrationCoveralls</span>.get_coverage_report(compile_time_source_lib_abs_path, source_code_abs_path)</span><br><span class="line">.......</span><br><span class="line">iex(explore_ast_app<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span>)<span class="number">8</span>&gt; <span class="title class_">Enum</span>.at(<span class="title class_">Map</span>.get(result, <span class="symbol">:files</span>), <span class="number">3</span>)</span><br><span class="line">%<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Source</span>&#123;</span><br><span class="line">  <span class="symbol">coverage:</span> <span class="number">18.2</span>,</span><br><span class="line">  <span class="symbol">filename:</span> <span class="string">&quot;lib/explore_ast_app/router.ex&quot;</span>,</span><br><span class="line">  <span class="symbol">hits:</span> <span class="number">4</span>,</span><br><span class="line">  <span class="symbol">misses:</span> <span class="number">18</span>,</span><br><span class="line">  <span class="symbol">sloc:</span> <span class="number">22</span>,</span><br><span class="line">  <span class="symbol">source:</span> [</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">1</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;defmodule ExploreAstApp.Router do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="number">1</span>, <span class="symbol">source:</span> <span class="string">&quot;  use Plug.Router&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  use Plug.ErrorHandler&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  import Plug.Conn&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  alias ExploreAstApp.Plug.VerifyRequest&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  plug Plug.Parsers, parsers: [:urlencoded, :multipart]&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  plug VerifyRequest, fields: [\&quot;content\&quot;, \&quot;mimetype\&quot;], paths: [\&quot;/upload\&quot;]&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;  plug :match&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  plug Plug.Parsers, parsers: [:json], pass: [\&quot;application/json\&quot;], json_decoder: Jason&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  plug :dispatch&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  get \&quot;/welcome\&quot; do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    send_resp(conn, 200, \&quot;Welcome\&quot;)&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;  end&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  get \&quot;/upload\&quot; do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    send_resp(conn, 201, \&quot;Uploaded\&quot;)&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;  end&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">1</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  get \&quot;/hello\&quot; do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    # query parameter is user like this:&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    # http://localhost:4001/hello?name=John&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    # which will create %&#123;\&quot;name\&quot; =&gt; \&quot;John\&quot;&#125;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">1</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;      send_resp(conn, 200, \&quot;hello \#&#123;Map.get(conn.query_params, \&quot;name\&quot;)&#125;\&quot;)&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;  end&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  get \&quot;/hello/:name\&quot; do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    send_resp(conn, 200, \&quot;hello \#&#123;name&#125;\&quot;)&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;  end&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;  post \&quot;/hello\&quot; do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    # json body of POST request &#123;\&quot;name\&quot;: \&quot;John\&quot;&#125; is parsed to %&#123;\&quot;name\&quot; =&gt; \&quot;John\&quot;&#125;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;    # so it can be accesable with e.g. Map.get(conn.body_params, \&quot;name\&quot;) or with pattern matching&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="number">0</span>, <span class="symbol">source:</span> <span class="string">&quot;    name =&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;      case conn.body_params do&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="number">0</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;        %&#123;\&quot;name\&quot; =&gt; a_name &#125; -&gt; a_name&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;</span><br><span class="line">      <span class="symbol">coverage:</span> <span class="literal">nil</span>,</span><br><span class="line">      <span class="symbol">source:</span> <span class="string">&quot;        _ -&gt; \&quot;\&quot;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;      end&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, <span class="symbol">source:</span> <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;<span class="symbol">coverage:</span> <span class="literal">nil</span>, ...&#125;,</span><br><span class="line">    %<span class="title class_">ExIntegrationCoveralls</span>.<span class="title class_">Stats</span>.<span class="title class_">Line</span>&#123;...&#125;,</span><br><span class="line">    ...</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Based on the <code>post_cov_stats_to_ud_ci</code> interface, it is possible to further interface with internal or external <a target="_blank" rel="noopener" href="https://about.codecov.io/">Codecov</a>-like coverage systems.</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/coverage_system.jpg" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/coverage_system.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="coverage_system"></p>
<p>Based on this, we can realize the collection of code coverage with large-scale (integration &amp; system) testing capabilities without stopping the Elixir Application.</p>
<h2 id="4-Continuous-runtime-coverage-collection-solution-for-large-scale-Elixir-Erlang-Microservice-clusters"><a href="#4-Continuous-runtime-coverage-collection-solution-for-large-scale-Elixir-Erlang-Microservice-clusters" class="headerlink" title="4. Continuous runtime coverage collection solution for large-scale Elixir&#x2F;Erlang Microservice clusters"></a>4. Continuous runtime coverage collection solution for large-scale Elixir&#x2F;Erlang Microservice clusters</h2><p>With the continuous expansion of the Elixir&#x2F;Erlang microservice system, the coverage collection method shown in the previous section needs further evolution. Referring to the design of <a target="_blank" rel="noopener" href="https://prometheus.io/docs/introduction/overview/#architecture">Prometheus Pull-Base</a>, the overall design (combination of Pull &amp; Push mode) is as follows:</p>
<p><img src="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/coverage-arch.jpg" class="lazyload" data-srcset="https://github.com/yeshan333/explore_ast_app/raw/main/examples/assets/en/coverage-arch.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="coverage_system_design"></p>
<p>We expand based on <a target="_blank" rel="noopener" href="https://github.com/yeshan333/ex_integration_coveralls">ex_integration_coveralls</a>. After the Elixir Application is started, a http worker is started up to expose the code coverage data in real time, which is convenient for communication with heterogeneous systems. The Coverage Push Gateway is responsible for regularly pulling the coverage data (Gateway can be a OTP Application, which allows <code>ex_integration_coveralls</code> to directly start up the custom <a target="_blank" rel="noopener" href="https://github.com/yeshan333/ex_integration_coveralls/blob/main/lib/ex_integration_coveralls/cov_stats_worker.ex">GenServer Worker</a> for interactive integration test system in the distributed OTP system), after the integration&#x2F;system test system informs the end of the test, the Gateway pushes the coverage data to the <code>Cover Center</code> for code coverage rate display.</p>
<p>End (long way to go).</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/36f4140541f8dd555fb8aaee2fd719d59ffab041.pdf">Code Coverage at Google</a></li>
<li><a target="_blank" rel="noopener" href="https://www.erlang.org/doc/man/cover.html#description">Erlang cover</a></li>
<li><a target="_blank" rel="noopener" href="https://www.erlang.org/blog/a-brief-beam-primer/">A brief introduction to BEAM</a></li>
<li><a target="_blank" rel="noopener" href="http://gomoripeti.github.io/beam_by_example/">A peak into the Erlang compiler and BEAM bytecode</a></li>
<li><a target="_blank" rel="noopener" href="https://elixirforum.com/t/getting-each-stage-of-elixirs-compilation-all-the-way-to-the-beam-bytecode/1873/5">Getting each stage of Elixir’s compilation all the way to the BEAM bytecode</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/parroty/excoveralls">excoveralls</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hrzndhrn/beam_file">BeamFile - A peek into the BEAM file</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/KronicDeth/intellij-elixir#beam-files">https://github.com/KronicDeth/intellij-elixir#beam-files</a></li>
</ul>

  </div>
  
  
    
    <div class='footer'>
       <!-- 参考资料、相关资料等 -->
      
       <!-- 相关文章 -->
      
        
  <div class="related_posts">
    <section class='header'>
      <i class="fa-solid fa-bookmark fa-fw" aria-hidden="true"></i><span>相关文章</span>
    </section>
    <section class='body'>
      <div class="vlts-rps"><a class="item" href="/2022/06/29/elixir-run-time-code-line-level-coverage-collection/" title="Elixir 连续运行时代码覆盖率采集方案" rel="bookmark "><img src="https://s1.ax1x.com/2022/07/10/jsDAxJ.jpg" class="lazyload" data-srcset="https://s1.ax1x.com/2022/07/10/jsDAxJ.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /><span class="title">Elixir 连续运行时代码覆盖率采集方案</span></a><a class="item" href="/2022/11/26/Elixir-Tip-Case-vs-With/" title="（译）Elixir Tip: Case vs. With" rel="bookmark "><img src="https://gcore.jsdelivr.net/gh/MHG-LAB/cron@gh-pages/bing/bing.jpg" class="lazyload" data-srcset="https://gcore.jsdelivr.net/gh/MHG-LAB/cron@gh-pages/bing/bing.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /><span class="title">（译）Elixir Tip: Case vs. With</span></a><a class="item" href="/2023/08/12/elixir-deps-debug-skills/" title="Elixir 依赖 (deps) 调试的小技巧" rel="bookmark "><img src="https://s1.ax1x.com/2023/08/12/pPuQUAK.png" class="lazyload" data-srcset="https://s1.ax1x.com/2023/08/12/pPuQUAK.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /><span class="title">Elixir 依赖 (deps) 调试的小技巧</span><span class="excerpt">Elixir 依赖 (deps) 调试的小技巧</span></a><a class="item" href="/2022/02/26/profiling-flame-graph/" title="profiling & Flame Graphs" rel="bookmark "><img src="https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/flame.png" class="lazyload" data-srcset="https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/flame.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /><span class="title">profiling & Flame Graphs</span></a><a class="item" href="/2022/06/18/understanding-elixir-macros-part-1-basics/" title="(译) Understanding Elixir Macros, Part 1 Basics" rel="bookmark "><img src="https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/compile-process.png" class="lazyload" data-srcset="https://gcore.jsdelivr.net/gh/yeshan333/jsDelivrCDN@main/compile-process.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /><span class="title">(译) Understanding Elixir Macros, Part 1 Basics</span></a></div></section></div>
      
      <!-- 版权声明组件 -->
      
        
          <div class='copyright'>
            <blockquote>
              
                
                  <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

                
              
                
                  <p>本文永久链接是：<a href="https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/">https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/</a></p>
                
              
            </blockquote>
          </div>
        
      
      <!-- 打赏组件 -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateModified" datetime="2022-08-31T22:43:10+00:00">
  <a class='notlink'>
    <i class="fa-solid fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2022年8月31日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Elixir/" rel="nofollow"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i><p>Elixir</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Test-Coverage/" rel="nofollow"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i><p>Test Coverage</p></a></div>
  <span hidden itemprop="keywords">Elixir Test Coverage</span>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/&title=the-solution-of-elixir-continuous-runtime-system-code-coverage-collection - ShanSan&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qq.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qq.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/&title=the-solution-of-elixir-continuous-runtime-system-code-coverage-collection - ShanSan&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qzone.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/qzone.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/&title=the-solution-of-elixir-continuous-runtime-system-code-coverage-collection - ShanSan&summary="
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/weibo.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/weibo.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        
        <div class='hoverbox'>
          <a class='share'><img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/wechat.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/wechat.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></a>
          <div class='target'>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZgAAAGYCAAAAABaUKuJAAAGDElEQVR42u3dS25kIRAEQN//0p4DjFqQWYXl0QS7/vGggk2qkP31bfzK8aUEYAwwYAwwYAwwxhHmqxx/Tfjh/dPnp/lPz033cVrX6Tm3v2/rCQYMGDBgwIABAwYMmHuYdiG3C7x9v4XbKtz272JYMGDAgAEDBgwYMGDAxDCvFpwutD0AabBs1zutDxgwYMCAAQMGDBgwYH4fzDRQtgVpf78VJMGAAQMGDBgwYMCAAfPvwLTBa/vi3HaDKw2gYMCAAQMGDBgwYMCA+XmY6YOnF/Ha700PxrTx9utuYoIBAwYMGDBgwIAB8x/ATAOc10v1BAMGDBgwIMCAAQMGzBFmOtJAtd1Y2gqkr/d5XQ8wYMCAAQMGDBgwYMAcYdqAlDaqbhtSLdztPNOLgc8bbWDAgAEDBgwYMGDAgIkDZtogaxtqKWx7kW56AFqINrCCAQMGDBgwYMCAAQPmDPOq8XS7kWkQbN+fArbfP74PBgwYMGDAgAEDBgyYa5i2MTRtkLUbThtqbXBMv5ceiGPABAMGDBgwYMCAAQMGzMdG2Vc5vstxC9M2ptLgPD1Ia/sDAwYMGDBgwIABAwZMDdMGx2nw+i2QaYNwWi8wYMCAAQMGDBgwYMDkMFsNrRYoDbCvGmG386Xriy/8gQEDBgwYMGDAgAED5iPMVoCcBsetxtc26Kv9fHwuGDBgwIABAwYMGDBgjjBxIydsWG0FyWlA3Sr0a2gwYMCAAQMGDBgwYMDcw6QLvi1QOn/bgErn3w6Y7XrAgAEDBgwYMGDAgAEzh2kbVmkQa0Hri3SPAmYLdX0TEwwYMGDAgAEDBgwYMNcwacNsGsy2A+vrBtqroAkGDBgwYMCAAQMGDJh7mDbQpQtOX69dpAsDdDumgRUMGDBgwIABAwYMGDD3MGmAqx+8FCC31pUegGmgPQZ0MGDAgAEDBgwYMGDA1AFzK1jdFmQ78KWNvrag03UdL/yBAQMGDBgwYMCAAQPmL5jbgtw2wNKNvHpeeyC2Gm5tUAYDBgwYMGDAgAEDBswZZtrAahtCrwLkbSG2gdsACgYMGDBgwIABAwYMmB5mK2BuNZi2A227r1cH7zpgggEDBgwYMGDAgAEDpg6YW4Vs4dJ1bgXc7UB83DcYMGDAgAEDBgwYMGCOMG2ASjcw/bxtWN3Cbv3u+3J8nAcMGDBgwIABAwYMGDDXMNOFp4Fyq3F1W5Ct320F4uuACQYMGDBgwIABAwYMmOuAOQVKv7d14S4NrN/lmNbleOEPDBgwYMCAAQMGDBgw1zApVBv80uDWgm0H160GWtzBBAMGDBgwYMCAAQMGzLN/RPo1HK8KmzbGXhX++DswYMCAAQMGDBgwYMBcw0yDW1rYtPC3BZ42ztJ1bzXywIABAwYMGDBgwIABk8OsXVgLCzcFSIPuFmS67/rCHxgwYMCAAQMGDBgwYOJGWVuAaeNqq6GWrrdd31YABwMGDBgwYMCAAQMGzN7fXU4DVLrgNCCmjazpvG0gjWHBgAEDBgwYMGDAgAFzhNlqGE0D4bSA6UGaHsgW6LguMGDAgAEDBgwYMGDAXN8rSxtQ7YOn8NOLiVuFbw8CGDBgwIABAwYMGDBg5jBtY6cFbQvTQm/tZxpMr4M2GDBgwIABAwYMGDBgYpg2MKVBLYVLn7d9AG4L3h50MGDAgAEDBgwYMGDA3MO8avhMF95CTYPt1vPb9YIBAwYMGDBgwIABA+YMMx1pg2ja8Eo/b0G2DlgcsMGAAQMGDBgwYMCAAXOE2Qpwtxs4AbYbbeeZNtbS18f5wIABAwYMGDBgwIABcw3TBq04QKWNo2Ejb/tATAt/fB8MGDBgwIABAwYMGDAxTNr4+ukg9yoY3j6n3d91PcGAAQMGDBgwYMCAAfNjMO1Gti8WbjX+psG0fi4YMGDAgAEDBgwYMGB+vB/Tztc24NoAvDX/1oEGAwYMGDBgwIABAwZMD5Ne+Nu6GPgqeLYX99L1pI26uFEGBgwYMGDAgAEDBgyYtT/AkC6kDX5b80zh28bfdT3BgAEDBgwYMGDAgAFzhDF+1wADxgADxgADxgBjfBx/ACez/p6E3nTZAAAAAElFTkSuQmCC">
          </div>
        </div>
      
    
      
        <a class="-mob-share-telegram" title="" rel="external nofollow noopener noreferrer noopener"
          
            target="_blank" href="https://t.me/share/url?url=https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/&text=the-solution-of-elixir-continuous-runtime-system-code-coverage-collection - ShanSan"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/telegram.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/logo/128/telegram.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/2022/11/26/Elixir-Tip-Case-vs-With/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>（译）Elixir Tip: Case vs. With</p>
          <p class='content'>从 1.2 版本开始, with 运算符是需要点时间去理解的 ELixir 特性之一. 它经常在使用 case 的情形下使用, 反之亦然. 两者的不同在于如果没有可以匹配到的子句, with 将...</p>
        </a>
      
      
        <a class='next' href='/2022/06/29/elixir-run-time-code-line-level-coverage-collection/'>
          <p class='title'>Elixir 连续运行时代码覆盖率采集方案<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>1. 浅谈代码覆盖率作为 SET 和 SWE, 我们经常需要编写单元测试或集成测试用例来验证系统&#x2F;应用的正确性, 但同时我们也常会质疑我们的测试是否充分了. 这时测试覆盖率是可以辅助用...</p>
        </a>
      
    </div>
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  


  <article class="post white-box shadow floatable blur" id="comments">
    <span hidden>
      <meta itemprop="discussionUrl" content="/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/index.html#comments">
    </span>
    <p ct><i class='fa-solid fa-comments'></i> 评论</p>
    

    <div id="layoutHelper-comments"></div>

  </article>






</div>
<aside id='l_side' itemscope itemtype="http://schema.org/WPSideBar">
  

  
    
    
      
    
  


<div class="widget-sticky pjax">

  
  


  <section class="widget toc-wrapper desktop mobile " id="toc-div" >
    
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Brief-talk-on-code-coverage"><span class="toc-text">1. Brief talk on code coverage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Delve-into-the-Erlang-Cover-coverage-collection-implementation-mechanism"><span class="toc-text">2. Delve into the Erlang Cover coverage collection implementation mechanism</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Introduction-Erlang-Cover"><span class="toc-text">2.1. Introduction Erlang Cover</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Erlang-code-coverage-collection-implementation-analysis"><span class="toc-text">2.2. Erlang code coverage collection implementation analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Learn-about-BEAM-File-Format"><span class="toc-text">2.3. Learn about BEAM File Format</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Elixir-source-code-compilation-process"><span class="toc-text">2.4. Elixir source code compilation process</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Cover-On-The-Fly-Instrumentation-Implementation"><span class="toc-text">2.5. Cover On-The-Fly Instrumentation Implementation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Elixir-Application-runtime-coverage-collection-example"><span class="toc-text">3. Elixir Application runtime coverage collection example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Continuous-runtime-coverage-collection-solution-for-large-scale-Elixir-Erlang-Microservice-clusters"><span class="toc-text">4. Continuous runtime coverage collection solution for large-scale Elixir&#x2F;Erlang Microservice clusters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-text">References</span></a></li></ol>
    </div>
  </section>

  

</div>


<!-- 没有 pjax 占位会报错 万恶的 pjax -->

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <div class="pjax">
    <!-- pjax占位 -->
  </div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>



          <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->

<pjax>
<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  pdata.commentConfig={};
  //  see: /layout/_partial/scripts/_ctrl/coverCtrl.ejs
  
    // header
    var l_header=document.getElementById("l_header");
    
    l_header.classList.add("show");
    
    
      // cover
      var cover_wrapper=document.querySelector('#l_cover .cover-wrapper');
      var scroll_down=document.getElementById('scroll-down');
      cover_wrapper.id="none";
      cover_wrapper.style.display="none";
      scroll_down.style.display="none";
    
  
</script>
</pjax>
        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="http://schema.org/WPFooter">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='true'
      volume='0.7'
      loop='all'
      order='list'
      fixed='false'
      list-max-height='320px'
      server='netease'
      type='playlist'
      id='6729508229'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="http://schema.org/Thing">
          
            
              <a href="mailto:1329441308@qq.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://github.com/yeshan333?tab=repositories"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://music.163.com/#/my/m/music/playlist?id=2617691792"
                class="social fas fa-music flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://www.zhihu.com/people/si-kong-ji-54/activities"
                class="social fab fa-zhihu flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
            
              <a href="https://shansan.top/rss2.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer" itemprop="url">
                
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/#5.7.6" target="_blank" class="codename">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a target="_blank" rel="noopener" href="https://shansan.top/">Copyright © 2018-2024 ShanSan</a></p>

        </div>
      
    
      
        
          <div><p><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">桂ICP备19000444号</a></p>
</div>
        
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" href="/" onclick="return false;" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // 页面选择器 将dom对象缓存起来 see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // 页面主体
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // 向上
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // 整个导航栏
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1个
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // 搜索按钮   移动端 1个
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // 移动端导航栏
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // 搜索框 桌面端 移动端 1个
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  手机端 子菜单 多个
</script>

<script>
  
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/@fortawesome/fontawesome-free/css/all.min.css");
  
  
  
</script>

<!-- required -->


<!-- internal -->

<script src="/js/app.js"></script>





  













<div id="rightmenu-wrapper">
  <ul class="list-v rightmenu" id="rightmenu-content">
    
  <li class='navigation menuNavigation-Content'>


    <a class="nav icon-only fix-cursor-default" onclick="history.back()"><i class="fa-solid fa-arrow-left fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="history.forward()"><i class="fa-solid fa-arrow-right fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="window.location.reload()"><i class="fa-solid fa-redo fa-fw"></i></a>



    <a class="nav icon-only fix-cursor-default" onclick="VolantisApp.scrolltoElement(volantis.dom.bodyAnchor)"><i class="fa-solid fa-arrow-up fa-fw"></i></a>


  </li>


    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyPaste" data-event="copyPaste" data-group="inputBox">
      <i class="fa-solid fa-paste fa-fw"></i>
      粘贴文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyAll" data-event="copyAll" data-group="inputBox">
      <i class="fa-solid fa-object-ungroup fa-fw"></i>
      全选文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyCut" data-event="copyCut" data-group="inputBox">
      <i class="fa-solid fa-cut fa-fw"></i>
      剪切文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyText" data-event="copyText" data-group="seletctText">
      <i class="fa-solid fa-copy fa-fw"></i>
      复制文本
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="searchWord" data-event="OpenSearch(__text__)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      站内搜索
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="bingSearch" data-event="window.open(`https://cn.bing.com/search?q=${__text__}`)" data-group="seletctText">
      <i class="fa-solid fa-search fa-fw"></i>
      必应搜索
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="openTab" data-event="window.open(__link__)" data-group="elementCheck">
      <i class="fa-solid fa-external-link-square-alt fa-fw"></i>
      新标签页打开
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyLink" data-event="copyLink" data-group="elementCheck">
      <i class="fa-solid fa-link fa-fw"></i>
      复制链接地址
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="copyImg" data-event="copyImg" data-group="elementImage">
      <i class="fa-solid fa-image fa-fw"></i>
      复制图片
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="googleImg" data-event="window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)" data-group="elementImage">
      <i class="fa-solid fa-images fa-fw"></i>
      谷歌识图
    </span>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="google_search" target="_blank" rel="noopener" href="https://google.com" data-group="link">
      <i class="fa-solid fa-question fa-fw"></i>
      Google
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="slides_share" target="_blank" rel="noopener" href="https://slides.shan333.cn" data-group="link">
      <i class="fab fa-slideshare fa-fw"></i>
      Slides
    </a>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="github_yeshan333" target="_blank" rel="noopener" href="https://github.com/yeshan333" data-group="link">
      <i class="fa-solid fa-code-branch fa-fw"></i>
      GitHub
    </a>
  </li>



  <li class="menuLoad-Content">
    <a class="vlts-menu fix-cursor-default" id="shan333_site" target="_blank" rel="noopener" href="https://shan333.cn" data-group="link">
      <i class="fa-solid fa-code-branch fa-fw"></i>
      shan333.cn
    </a>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="darkMode" data-event="volantis.dark.toggle()" data-group="darkMode">
      <i class="fa-solid fa-moon fa-fw"></i>
      暗黑模式
    </span>
  </li>



    <hr class="menuLoad-Content" >



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="printMode" data-event="printMode" data-group="articlePage">
      <i class="fa-solid fa-print fa-fw"></i>
      打印页面
    </span>
  </li>



  <li class="menuLoad-Content">
    <span class="vlts-menu fix-cursor-default event" id="readMode" data-event="readMode" data-group="articlePage">
      <i class="fa-solid fa-book-open fa-fw"></i>
      阅读模式
    </span>
  </li>


<div id="menuMusic">
  <li class='music name menuOption-Content'>
    <p class='nav music-title fix-cursor-default'></p>
  </li>
  <li class='music ctrl'>
    <a class='nav icon-only backward fix-cursor-default' href="/" onclick="return false;" title="backward">
      <i class='fa-solid fa-step-backward fa-fw'></i>
    </a>
    <a class='nav icon-only toggle fix-cursor-default' href="/" onclick="return false;" title="toggle">
      <i class='fa-solid fa-play fa-fw'></i>
    </a>
    <a class='nav icon-only forward fix-cursor-default' href="/" onclick="return false;" title="forward">
      <i class='fa-solid fa-step-forward fa-fw'></i>
    </a>
  </li>
  <li class='music volume'>
    <div class='nav volume'>
      <div class="aplayer-volume-bar-wrap">
        <div class="aplayer-volume-bar fix-cursor-pointer">
          <div class="aplayer-volume"></div>
          <i class='left fa-solid fa-volume-off fa-fw'></i>
          <i class='right fa-solid fa-volume-up fa-fw'></i>
        </div>
      </div>
    </div>
  </li>
</div>

  </ul>
</div>
<script src="/js/plugins/rightMenus.js"></script>
<script>
  const RightMenusFunction = {};
  












  //RightMenusFunction['copyPaste'] = (fun) => {fun()}





  //RightMenusFunction['copyAll'] = (fun) => {fun()}





  //RightMenusFunction['copyCut'] = (fun) => {fun()}





  //RightMenusFunction['copyText'] = (fun) => {fun()}





  RightMenusFunction['searchWord'] = (__text__) => {OpenSearch(__text__)}





  RightMenusFunction['bingSearch'] = (__text__) => {window.open(`https://cn.bing.com/search?q=${__text__}`)}





  RightMenusFunction['openTab'] = (__link__) => {window.open(__link__)}





  //RightMenusFunction['copyLink'] = (fun) => {fun()}





  //RightMenusFunction['copyImg'] = (fun) => {fun()}





  RightMenusFunction['googleImg'] = (__link__) => {window.open(`https://www.google.com.hk/searchbyimage?image_url=${__link__}`)}

















  RightMenusFunction['darkMode'] = () => {volantis.dark.toggle()}







  //RightMenusFunction['printMode'] = (fun) => {fun()}





  //RightMenusFunction['readMode'] = (fun) => {fun()}





</script>



<!-- rightmenu要在darkmode之前（ToggleButton） darkmode要在comments之前（volantis.dark.push）-->

  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};
/**
 * 暗黑模式触发器
 */
volantis.dark.toggle=()=>{
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
  // 使用 volantis.dark.push 方法传入volantis.dark.toggle回调函数 参见layout/_partial/scripts/global.ejs
  volantis.dark.method.toggle.start();
}
/**
 * bind event for toggle button
 */

function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});
volantis.pjax.push(bindToggleButton);

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "dark";
    }
    volantis.dark.method.toggle.start();
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "light";
    }
    volantis.dark.method.toggle.start();
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>




<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("/js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("/js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("/js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
  volantis.pjax.push(()=>{
    loadIssuesJS();
  })

</script>




  <script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/vanilla-lazyload/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>




  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/flying-pages/flying-pages.min.js"></script>







  <script>
  volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.css");
  (async () => {
    // APlayer 需要在  MetingJS 之前加载
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/aplayer/dist/APlayer.min.js")
    await volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/meting/dist/Meting.min.js")
  
    // 右键 music 需要在 APlayer  MetingJS 之后加载
    await volantis.js('/js/plugins/aplayer.js')
  
  })();

  function SetAPlayerPlugin(){
    let Metings = document.querySelectorAll('meting-js');
    if (Metings.length === 0) {return;};
    if (Metings[0].aplayer && Metings[0].aplayer.on) {
      // improve the accessibility https://web.dev/button-name/
      document.querySelectorAll(".aplayer-icon-menu").forEach(e=>{
        e.setAttribute("aria-label","Aplayer Menu")
      })
      // message see: /layout/_plugins/message/script.ejs
      
        try {
          setTimeout(() => {
            Metings.forEach((item, index) => {
              const aplayerItem = item.aplayer; if(!aplayerItem) return;
              const rightAplayerCheck = 'true' === 'true'
                && item.meta.id === '6729508229';
              if(rightAplayerCheck) RightMenuAplayer.checkAPlayer();
              if(aplayerItem.events.events.play.every(item => {return item.name !== 'messagePlay'})) {
                aplayerItem.on('play', function messagePlay() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    VolantisApp.message('音乐通知', title + ' - ' + artist, {
                      icon: 'fa-solid fa-play',
                      transitionIn: 'flipInX',
                      transitionOut: 'flipOutX'
                    });
                  }, 100)
                });
              }
              if(aplayerItem.events.events.pause.every(item => {return item.name !== 'messagePause'})) {
                aplayerItem.on('pause', function messagePause() {
                  let index = aplayerItem.list.index;
                  let title = aplayerItem.list.audios[index].title;
                  let artist = aplayerItem.list.audios[index].artist;
                  setTimeout(() => {
                    // 歌曲播放结束也会触发 pause 事件，为了避免错误提示，等待一会儿
                    if(aplayerItem.paused) {
                      VolantisApp.message('音乐通知', title + ' - ' + artist, {
                        icon: 'fa-solid fa-pause',
                        transitionIn: 'flipInX',
                        transitionOut: 'flipOutX'
                      });
                    }
                  }, 100)
                });
              }
            });
          }, 500)
        } catch (error) { console.error(error); }
      
    }else{
      volantis.requestAnimationFrame(SetAPlayerPlugin)
    }
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    SetAPlayerPlugin();
  });
  volantis.pjax.push(SetAPlayerPlugin);
</script>




      <script>
  volantis.layoutHelper("comments",`<div id="artalk_container"><i class="fa-solid fa-cog fa-spin fa-fw fa-2x"></i></div>`);
  function load_artalk() {
    if(!document.querySelectorAll("#artalk_container")[0])return;
    volantis.css("https://cdn.bootcdn.net/ajax/libs/artalk/2.4.3/Artalk.css");
    volantis.js("https://cdn.bootcdn.net/ajax/libs/artalk/2.4.3/Artalk.js").then(pjax_artalk);
  }

  function pjax_artalk() {
    if(!document.querySelectorAll("#artalk_container")[0])return;
    let path = pdata.commentPath;
    let placeholder = pdata.commentPlaceholder || "" || "";
    if (path.length == 0) {
      path = '' || decodeURI(window.location.pathname);
    }
    if(!':year/:month/:day/:title/'.includes('/index.html')) {
      path = path.replaceAll('/index.html', '/').replaceAll('.html', '')
    }

    volantis.artalk = new Artalk(Object.assign({"js":"https://cdn.bootcdn.net/ajax/libs/artalk/2.4.3/Artalk.js","css":"https://cdn.bootcdn.net/ajax/libs/artalk/2.4.3/Artalk.css","server":"https://artalk.shan333.cn/api","path":null,"placeholder":null,"imageUploader":{"api":null,"token":null,"resp":null}}, {
      el: '#artalk_container',
      pageKey: path,
      pageTitle: document.title,
      placeholder: placeholder,
      useBackendConf: true,
      site: 'ShanSan',
      darkMode: volantis.dark.mode === "dark",
      pvEl: '#artalk_visitors',

      
    }));

    Artalk.use(ctx => {
      ctx.on('list-loaded', () => {
        if (typeof VolantisFancyBox === "undefined"){
          const checkFancyBox = setInterval(() => {
            if(typeof VolantisFancyBox === "undefined") return;
            clearInterval(checkFancyBox);
            VolantisFancyBox.groupBind('.atk-content img:not([atk-emoticon])', 'Comments');
          })
        } else {
          VolantisFancyBox.groupBind('.atk-content img:not([atk-emoticon])', 'Comments');
        }
      })
    })
  }

  load_artalk();
  volantis.pjax.push(()=>{
    if (typeof Artalk === "undefined") {
      load_artalk();
    } else {
      pjax_artalk();
    }
  },'artalk');

  function dark_artalk() {
    if(!document.querySelectorAll("#artalk_container")[0]) return;
    volantis.artalk.then(ctx => {
      ctx.setDarkMode(volantis.dark.mode === "dark")
    })
  }
  volantis.dark.push(dark_artalk);
</script>

    




  <script defer src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/busuanzi/js/busuanzi.pure.mini.js" data-pjax></script>


<!-- optional -->

  <script>
  const SearchServiceDataPathRoot = ("/" || "/").endsWith("/") ?
    "/" || "/" :
    "//" || "/";
  const SearchServiceDataPath = SearchServiceDataPathRoot + "content.json";

  function loadSearchScript() {
    // see: layout/_partial/scripts/_ctrl/cdnCtrl.ejs
    return volantis.js("/js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // 打开并搜索 字符串 s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // 访问含有 ?s=xxx  的链接时打开搜索 // 与搜索引擎 structured data 相关: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // 搜索输入框获取焦点时加载搜索
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>







  <script>



  function pjax_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(pjax_highlightjs_copyCode)
  volantis.pjax.push(pjax_highlightjs_copyCode)

</script>






  




<script>
  const genUuid = () => {
    let s = [];
    let hexDigits = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    for (let i = 0; i < 36; i++) {
      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1)
    }
    s[14] = "4"
    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1)
    s[8] = s[13] = s[18] = s[23] = "-"
    let uuid = s.join("")
    return uuid;
  }
  setTimeout(() => {
    let uin = localStorage.getItem('Aegis_UIN');
    if(!uin) {
      uin = genUuid();
      localStorage.setItem('Aegis_UIN', uin);
    }
    volantis.js("https://cdn-go.cn/aegis/aegis-sdk/latest/aegis.min.js").then(()=>{
      const aegis=new Aegis({id:"YrvKLIbY6p854Lqnb4",reportApiSpeed:true,reportAssetSpeed:true,spa:true,uin:uin});
    })
  }, 1000)
</script>












  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.css");
    volantis.js("https://unpkg.com/volantis-static@0.0.1654736714924/libs/swiper/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

  volantis.pjax.push(() => {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    if (typeof volantis.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>


<!-- pjax 标签必须存在于所有页面 否则 pjax error -->
<pjax>

</pjax>

<script>
  function listennSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    let targets = []
    const sections = [...navItems].map((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        decodeURI(link.getAttribute("href")).replace("#", "")
      );
      targets.push(target)
      // 解除 a 标签 href 的 锚点定位, a 标签 href 的 锚点定位 会随机启用?? 产生错位???
      link.setAttribute("onclick","return false;")
      link.setAttribute("toc-action","toc-"+decodeURI(link.getAttribute("href")).replace("#", ""))
      link.setAttribute("href","/")
      // 配置 点击 触发新的锚点定位
      link.addEventListener("click", (event) => {
        event.preventDefault();
        // 这里的 addTop 是通过错位使得 toc 自动展开.
        volantis.scroll.to(target,{addTop: 5, observer:true})
        // Anchor id
        history.pushState(null, document.title, "#" + target.id);
      });
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // 方案一：
    volantis.activateNavIndex=0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    volantis.scroll.push(()=>{
      if (targets[0].getBoundingClientRect().top >= 0) {
        volantis.activateNavIndex = 0
      }else if (targets[targets.length-1].getBoundingClientRect().top < 0) {
        volantis.activateNavIndex = targets.length-1
      } else {
        for (let index = 0; index < targets.length; index++) {
          const target0 = targets[index];
          const target1 = targets[(index+1)%targets.length];
          if (target0.getBoundingClientRect().top < 0&&target1.getBoundingClientRect().top >= 0) {
            volantis.activateNavIndex=index
            break;
          }
        }
      }
      activateNavByIndex(navItems[volantis.activateNavIndex])
    })

    // 方案二：
    // IntersectionObserver 不是完美精确到像素级别 也不是低延时性的
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
  document.addEventListener("pjax:success", ()=>{
    volantis.requestAnimationFrame(listennSidebarTOC)
  });
</script>



<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // 页面加载完毕 样式加载失败，或是当前网速慢，或是开启了省流模式
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"http://schema.org","@type":"Organization","name":"ShanSan","url":"https://yeshan333.github.io/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"http://schema.org","@type":"Person","name":"ShanSan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://yeshan333.github.io/","sameAs":["https://github.com/volantis-x"],"description":"ShanSan's Blog"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://yeshan333.github.io/","name":"ShanSan"}},{"@type":"ListItem","position":2,"item":{"@id":"https://yeshan333.github.io/categories/Elixir/","name":"Elixir"}},{"@type":"ListItem","position":3,"item":{"@id":"https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/","name":"the-solution-of-elixir-continuous-runtime-system-code-coverage-collection"}}]},{"@context":"http://schema.org","@type":"WebSite","name":"ShanSan","url":"https://yeshan333.github.io/","keywords":["ShanSan","Cloudys","shan333","shansan"],"description":"ShanSan's Blog","author":{"@type":"Person","name":"ShanSan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://yeshan333.github.io/","description":"ShanSan's Blog"},"publisher":{"@type":"Organization","name":"ShanSan","url":"https://yeshan333.github.io/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"https://yeshan333.github.io?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"http://schema.org","@type":"BlogPosting","headline":"the-solution-of-elixir-continuous-runtime-system-code-coverage-collection","description":"ShanSan's Blog","inLanguage":["zh-CN","en","zh-TW","default"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/"},"author":{"@type":"Person","name":"ShanSan","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://yeshan333.github.io/"},"publisher":{"@type":"Organization","name":"ShanSan","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1654736714924/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"https://yeshan333.github.io/2022/08/31/the-solution-of-elixir-continuous-runtime-system-code-coverage-collection/","wordCount":0,"datePublished":"2022-08-31T22:43:10.000Z","dateModified":"2022-08-31T22:43:10.000Z","articleSection":"Elixir","keywords":"Elixir,Test Coverage","image":{"@type":"ImageObject","url":"https://s1.ax1x.com/2022/11/04/xO9340.png","width":1024,"height":768}}]</script>



      
        <!--
  pjax重载区域接口：
  1.  <pjax></pjax> 标签 pjax 标签必须存在于所有页面 否则 pjax error
  2.  script[data-pjax]
  3.  .pjax-reload script
  4.  .pjax
-->



<script src="https://unpkg.com/volantis-static@0.0.1654736714924/libs/pjax/pjax.min.js"></script>


<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox]):not([onclick="return false;"]):not([onclick="return!1"]):not([target="_blank"]):not([target="view_window"]):not([href$=".xml"])',
        selectors: [
          "head title",
          "head meta[name=keywords]",
          "head meta[name=description]",
          
          "#l_main",
          "#pjax-header-nav-list",
          ".pjax",
          "pjax", // <pjax></pjax> 标签
          "script[data-pjax], .pjax-reload script" // script标签添加data-pjax 或 script标签外层添加.pjax-reload 的script代码段重载
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000,
        
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      // 使用 volantis.pjax.send 方法传入pjax:send回调函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.send.start();
    });

    document.addEventListener('pjax:complete', function () {
      // 使用 volantis.pjax.push 方法传入重载函数 参见layout/_partial/scripts/global.ejs
      volantis.pjax.method.complete.start();
    });

    document.addEventListener('pjax:error', function (e) {
      if(volantis.debug) {
        console.error(e);
        console.log('pjax error: \n' + JSON.stringify(e));
      }else{
        // 使用 volantis.pjax.error 方法传入pjax:error回调函数 参见layout/_partial/scripts/global.ejs
        volantis.pjax.method.error.start();
        window.location.href = e.triggerElement.href;
      }
    });
</script>

      
    </div>
    <!-- import body_end begin-->
    <!-- import body_end end-->
    <!-- Custom Files bodyEnd begin-->
    
    <!-- Custom Files bodyEnd end-->
  </body>
</html>
